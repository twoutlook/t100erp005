#該程式未解開Section, 採用最新樣板產出!
{<section id="apmm801.description" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0016(2016-08-22 02:48:03), PR版次:0016(2016-11-09 16:31:30)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000060
#+ Filename...: apmm801
#+ Description: 交易對象維護作業
#+ Creator....: 06814(2015-06-22 15:14:29)
#+ Modifier...: 02749 -SD/PR- 02749
 
{</section>}
 
{<section id="apmm801.global" >}
#應用 t01 樣板自動產生(Version:79)
#add-point:填寫註解說明 name="global.memo" 
#Modify......: 160318-00005#35 2016/03/28  By 07900   重复错误信息修改
#Modify......: 160318-00025#24 2016/04/25  BY 07900   校验代码重复错误讯息的修改
#Modify......: 160512-00003#11 2016/05/18  by 08172   供应商和客户惯用条件修改
#Modify......: 160516-00014#17 2016/07/29  by liyan   单身银行信息页签增加对公否和铺位编号
#Modify......: 160812-00017#8  2016/08/16  By 06137   在satatchange( )的FUNCTION中，有RETURN指令但沒有加上transaction_end( ) 造成transaction沒有結束就直接RETURN
#Modify......: 160810-00008#2  2016/06/24  By lori     1.製造與分銷整合調整
#                                                       1.1.單頭增加經銷商全名二、基本資料頁籤增加客戶價格群組、客戶經營類型、客戶生命週期、預設業務部門
#                                                       1.2.集團信用額度頁籤增加逾期帳款寬限額度、除外額度有效日期
#                                                       1.3.財務資訊增加帳齡計算基準
#                                                       1.4.整單操作上掛上axmm201、axmm202
#                                                       1.5.單身新增客戶標籤
#                                                     2.信用額度提醒設定(pmba060~pmba067)改no use,並自畫面上移除並取消相關處理邏輯
#Modify......: 160818-00017#26 2016/08/29  By lixiang 单据类作业修改，删除时需重新检查状态
#Modify......: 160908-00032#2  2016/09/14  By rainy    交易對象q_pmaa001()開窗改為q_pmaa001_4
#Modify......: 160824-00007#62 2016/10/14  By 06814   新舊值備份
#Modify......: 161109-00012#1  2016/11/09  By lori    整單操作執行axmm201,axmm202的ACTION可執行否,呼叫錯誤修正
#end add-point
#add-point:填寫註解說明(客製用) name="global.memo_customerization"

#end add-point
 
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目 name="global.import"
IMPORT FGL aoo_aooi350_01
IMPORT FGL aoo_aooi350_02
#end add-point 
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔 name="global.inc"
GLOBALS "../../aoo/4gl/aooi350_01.inc"
GLOBALS "../../aoo/4gl/aooi350_02.inc"
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_pmaa_m        RECORD
       pmaa001 LIKE pmaa_t.pmaa001, 
   pmaa002 LIKE pmaa_t.pmaa002, 
   pmaa089 LIKE pmaa_t.pmaa089, 
   pmaal004 LIKE pmaal_t.pmaal004, 
   pmaal003 LIKE pmaal_t.pmaal003, 
   pmaal006 LIKE pmaal_t.pmaal006, 
   pmaal005 LIKE pmaal_t.pmaal005, 
   pmaa003 LIKE pmaa_t.pmaa003, 
   pmaastus LIKE pmaa_t.pmaastus, 
   pmaa004 LIKE pmaa_t.pmaa004, 
   pmaa005 LIKE pmaa_t.pmaa005, 
   pmaa005_desc LIKE type_t.chr80, 
   pmaa006 LIKE pmaa_t.pmaa006, 
   pmaa006_desc LIKE type_t.chr80, 
   pmaa026 LIKE pmaa_t.pmaa026, 
   pmaa026_desc LIKE type_t.chr80, 
   pmaa200 LIKE pmaa_t.pmaa200, 
   pmaa201 LIKE pmaa_t.pmaa201, 
   pmaa202 LIKE pmaa_t.pmaa202, 
   pmaa017 LIKE pmaa_t.pmaa017, 
   pmaa016 LIKE pmaa_t.pmaa016, 
   pmaa018 LIKE pmaa_t.pmaa018, 
   pmaa019 LIKE pmaa_t.pmaa019, 
   pmaa019_desc LIKE type_t.chr80, 
   pmaa021 LIKE pmaa_t.pmaa021, 
   pmaa022 LIKE pmaa_t.pmaa022, 
   pmaa022_desc LIKE type_t.chr80, 
   pmaa020 LIKE pmaa_t.pmaa020, 
   pmaa023 LIKE pmaa_t.pmaa023, 
   pmaa023_desc LIKE type_t.chr80, 
   pmaa024 LIKE pmaa_t.pmaa024, 
   pmaa024_desc LIKE type_t.chr80, 
   pmaa025 LIKE pmaa_t.pmaa025, 
   pmaa007 LIKE pmaa_t.pmaa007, 
   pmaa007_desc LIKE type_t.chr80, 
   pmaa008 LIKE pmaa_t.pmaa008, 
   pmaa009 LIKE pmaa_t.pmaa009, 
   pmaa009_desc LIKE type_t.chr80, 
   pmaa010 LIKE pmaa_t.pmaa010, 
   pmaa011 LIKE pmaa_t.pmaa011, 
   pmaa011_desc LIKE type_t.chr80, 
   pmaa027 LIKE pmaa_t.pmaa027, 
   pmaa230 LIKE pmaa_t.pmaa230, 
   pmaa231 LIKE pmaa_t.pmaa231, 
   pmaa231_desc LIKE type_t.chr80, 
   pmaa232 LIKE pmaa_t.pmaa232, 
   pmaa232_desc LIKE type_t.chr80, 
   pmaa090 LIKE pmaa_t.pmaa090, 
   pmaa090_desc LIKE type_t.chr80, 
   pmaa091 LIKE pmaa_t.pmaa091, 
   pmaa091_desc LIKE type_t.chr80, 
   pmaa092 LIKE pmaa_t.pmaa092, 
   pmaa094 LIKE pmaa_t.pmaa094, 
   pmaa094_desc LIKE type_t.chr80, 
   pmaa093 LIKE pmaa_t.pmaa093, 
   pmaa093_desc LIKE type_t.chr80, 
   pmaa096 LIKE pmaa_t.pmaa096, 
   pmaa096_desc LIKE type_t.chr80, 
   pmaa097 LIKE pmaa_t.pmaa097, 
   pmaa097_desc LIKE type_t.chr80, 
   pmaa241 LIKE pmaa_t.pmaa241, 
   pmaa241_desc LIKE type_t.chr80, 
   pmaa242 LIKE pmaa_t.pmaa242, 
   pmaa242_desc LIKE type_t.chr80, 
   pmaa243 LIKE pmaa_t.pmaa243, 
   pmaa243_desc LIKE type_t.chr80, 
   pmaa244 LIKE pmaa_t.pmaa244, 
   pmaa244_desc LIKE type_t.chr80, 
   pmaa245 LIKE pmaa_t.pmaa245, 
   pmaa245_desc LIKE type_t.chr80, 
   pmaa246 LIKE pmaa_t.pmaa246, 
   pmaa247 LIKE pmaa_t.pmaa247, 
   pmaa248 LIKE pmaa_t.pmaa248, 
   pmaa095 LIKE pmaa_t.pmaa095, 
   pmaa095_desc LIKE type_t.chr80, 
   pmaa220 LIKE pmaa_t.pmaa220, 
   pmaa221 LIKE pmaa_t.pmaa221, 
   pmaa221_desc LIKE type_t.chr80, 
   pmaa222 LIKE pmaa_t.pmaa222, 
   pmaa222_desc LIKE type_t.chr80, 
   pmaa080 LIKE pmaa_t.pmaa080, 
   pmaa080_desc LIKE type_t.chr80, 
   pmaa084 LIKE pmaa_t.pmaa084, 
   pmaa084_desc LIKE type_t.chr80, 
   pmaa083 LIKE pmaa_t.pmaa083, 
   pmaa083_desc LIKE type_t.chr80, 
   pmaa086 LIKE pmaa_t.pmaa086, 
   pmaa086_desc LIKE type_t.chr80, 
   pmaa085 LIKE pmaa_t.pmaa085, 
   pmaa085_desc LIKE type_t.chr80, 
   pmaa051 LIKE pmaa_t.pmaa051, 
   pmaa052 LIKE pmaa_t.pmaa052, 
   pmaa052_desc LIKE type_t.chr80, 
   pmaa053 LIKE pmaa_t.pmaa053, 
   pmaa053_desc LIKE type_t.chr80, 
   pmaa054 LIKE pmaa_t.pmaa054, 
   pmaa054_desc LIKE type_t.chr80, 
   pmaa055 LIKE pmaa_t.pmaa055, 
   pmaa056 LIKE pmaa_t.pmaa056, 
   pmaa057 LIKE pmaa_t.pmaa057, 
   pmaa058 LIKE pmaa_t.pmaa058, 
   pmaa074 LIKE pmaa_t.pmaa074, 
   pmaa059 LIKE pmaa_t.pmaa059, 
   pmaa075 LIKE pmaa_t.pmaa075, 
   pmaa047 LIKE pmaa_t.pmaa047, 
   pmaa036 LIKE pmaa_t.pmaa036, 
   pmaa037 LIKE pmaa_t.pmaa037, 
   pmaa038 LIKE pmaa_t.pmaa038, 
   pmaa039 LIKE pmaa_t.pmaa039, 
   pmaa040 LIKE pmaa_t.pmaa040, 
   pmaa041 LIKE pmaa_t.pmaa041, 
   pmaa042 LIKE pmaa_t.pmaa042, 
   pmaa043 LIKE pmaa_t.pmaa043, 
   pmaa044 LIKE pmaa_t.pmaa044, 
   pmaa045 LIKE pmaa_t.pmaa045, 
   pmaa046 LIKE pmaa_t.pmaa046, 
   pmaa068 LIKE pmaa_t.pmaa068, 
   pmaa069 LIKE pmaa_t.pmaa069, 
   pmaa072 LIKE pmaa_t.pmaa072, 
   pmaa070 LIKE pmaa_t.pmaa070, 
   pmaa071 LIKE pmaa_t.pmaa071, 
   pmaa073 LIKE pmaa_t.pmaa073, 
   pmaa204 LIKE pmaa_t.pmaa204, 
   pmaa205 LIKE pmaa_t.pmaa205, 
   pmaa205_desc LIKE type_t.chr80, 
   pmaa206 LIKE pmaa_t.pmaa206, 
   pmab032 LIKE type_t.chr6, 
   pmab057 LIKE type_t.chr10, 
   pmab058 LIKE type_t.chr10, 
   pmab053 LIKE type_t.chr10, 
   pmab053_desc LIKE type_t.chr80, 
   pmab039 LIKE type_t.chr10, 
   pmab039_desc LIKE type_t.chr80, 
   pmaa081 LIKE pmaa_t.pmaa081, 
   pmaa081_desc LIKE type_t.chr80, 
   pmab033 LIKE type_t.chr10, 
   pmab033_desc LIKE type_t.chr80, 
   pmab034 LIKE type_t.chr10, 
   pmab034_desc LIKE type_t.chr80, 
   pmab035 LIKE type_t.chr10, 
   pmab056 LIKE pmab_t.pmab056, 
   pmab056_desc LIKE type_t.chr80, 
   pmab037 LIKE type_t.chr10, 
   pmab037_desc LIKE type_t.chr80, 
   pmab055 LIKE type_t.chr10, 
   pmab055_desc LIKE type_t.chr80, 
   pmab038 LIKE type_t.chr10, 
   pmab038_desc LIKE type_t.chr80, 
   pmab040 LIKE type_t.chr10, 
   pmab040_desc LIKE type_t.chr80, 
   pmab041 LIKE type_t.chr10, 
   pmab041_desc LIKE type_t.chr80, 
   pmab042 LIKE type_t.chr10, 
   pmab042_desc LIKE type_t.chr80, 
   pmab043 LIKE type_t.chr10, 
   pmab043_desc LIKE type_t.chr80, 
   pmab044 LIKE type_t.chr10, 
   pmab045 LIKE type_t.num20_6, 
   pmab046 LIKE type_t.num20_6, 
   pmab047 LIKE type_t.chr10, 
   pmab047_desc LIKE type_t.chr80, 
   pmab048 LIKE type_t.chr100, 
   pmab049 LIKE type_t.chr1, 
   l_pmab050 LIKE type_t.num5, 
   pmab051 LIKE type_t.chr1, 
   l_pmab052 LIKE type_t.chr5, 
   pmab080 LIKE type_t.chr10, 
   pmab082 LIKE type_t.chr6, 
   pmab083 LIKE type_t.chr10, 
   pmab083_desc LIKE type_t.chr80, 
   pmab084 LIKE type_t.chr10, 
   pmab084_desc LIKE type_t.chr80, 
   pmab103 LIKE type_t.chr10, 
   pmab103_desc LIKE type_t.chr80, 
   pmab104 LIKE type_t.chr10, 
   pmab104_desc LIKE type_t.chr80, 
   pmab085 LIKE type_t.chr10, 
   pmab106 LIKE type_t.chr2, 
   pmab106_desc LIKE type_t.chr80, 
   pmab087 LIKE type_t.chr10, 
   pmab087_desc LIKE type_t.chr80, 
   pmab105 LIKE type_t.chr10, 
   pmab105_desc LIKE type_t.chr80, 
   pmab088 LIKE type_t.chr10, 
   pmab088_desc LIKE type_t.chr80, 
   pmab089 LIKE type_t.chr10, 
   pmab089_desc LIKE type_t.chr80, 
   pmab107 LIKE type_t.chr10, 
   pmab108 LIKE type_t.chr10, 
   pmab090 LIKE type_t.chr10, 
   pmab090_desc LIKE type_t.chr80, 
   pmab091 LIKE type_t.chr10, 
   pmab091_desc LIKE type_t.chr80, 
   pmab092 LIKE type_t.chr10, 
   pmab092_desc LIKE type_t.chr80, 
   pmab093 LIKE type_t.chr10, 
   pmab093_desc LIKE type_t.chr80, 
   pmab094 LIKE type_t.chr10, 
   pmab095 LIKE type_t.num20_6, 
   pmab096 LIKE type_t.num20_6, 
   pmab097 LIKE type_t.chr10, 
   pmab097_desc LIKE type_t.chr80, 
   pmab098 LIKE type_t.chr100, 
   pmab099 LIKE type_t.chr1, 
   l_pmab100 LIKE type_t.num5, 
   pmab101 LIKE type_t.chr1, 
   l_pmab102 LIKE type_t.num5, 
   ooff013 LIKE type_t.chr500, 
   pmaaownid LIKE pmaa_t.pmaaownid, 
   pmaaownid_desc LIKE type_t.chr80, 
   pmaaowndp LIKE pmaa_t.pmaaowndp, 
   pmaaowndp_desc LIKE type_t.chr80, 
   pmaacrtid LIKE pmaa_t.pmaacrtid, 
   pmaacrtid_desc LIKE type_t.chr80, 
   pmaacrtdp LIKE pmaa_t.pmaacrtdp, 
   pmaacrtdp_desc LIKE type_t.chr80, 
   pmaacrtdt LIKE pmaa_t.pmaacrtdt, 
   pmaamodid LIKE pmaa_t.pmaamodid, 
   pmaamodid_desc LIKE type_t.chr80, 
   pmaamoddt LIKE pmaa_t.pmaamoddt, 
   pmaacnfid LIKE pmaa_t.pmaacnfid, 
   pmaacnfid_desc LIKE type_t.chr80, 
   pmaacnfdt LIKE pmaa_t.pmaacnfdt, 
   pmaa270 LIKE pmaa_t.pmaa270, 
   pmaa271 LIKE pmaa_t.pmaa271, 
   pmaa272 LIKE pmaa_t.pmaa272, 
   day01 LIKE type_t.chr2, 
   day02 LIKE type_t.chr1, 
   day03 LIKE type_t.chr2, 
   day04 LIKE type_t.chr2, 
   day05 LIKE type_t.chr2, 
   day06 LIKE type_t.chr2, 
   day07 LIKE type_t.chr2, 
   day08 LIKE type_t.chr2, 
   day09 LIKE type_t.chr2, 
   day10 LIKE type_t.chr2, 
   day11 LIKE type_t.chr2, 
   day12 LIKE type_t.chr2, 
   day13 LIKE type_t.chr2, 
   day14 LIKE type_t.chr2, 
   day15 LIKE type_t.chr2, 
   day16 LIKE type_t.chr2, 
   day17 LIKE type_t.chr2, 
   day18 LIKE type_t.chr2, 
   day19 LIKE type_t.chr2, 
   day20 LIKE type_t.chr2, 
   day21 LIKE type_t.chr2, 
   day22 LIKE type_t.chr2, 
   day23 LIKE type_t.chr2, 
   day24 LIKE type_t.chr2, 
   day25 LIKE type_t.chr2, 
   day26 LIKE type_t.chr2, 
   day27 LIKE type_t.chr2, 
   day28 LIKE type_t.chr2, 
   day29 LIKE type_t.chr2, 
   day30 LIKE type_t.chr2, 
   day31 LIKE type_t.chr2, 
   week01 LIKE type_t.chr1, 
   week02 LIKE type_t.chr1, 
   week03 LIKE type_t.chr1, 
   week04 LIKE type_t.chr1, 
   week05 LIKE type_t.chr1, 
   week06 LIKE type_t.chr1, 
   week07 LIKE type_t.chr1, 
   pmaa274 LIKE pmaa_t.pmaa274, 
   pmaa274_desc LIKE type_t.chr80, 
   pmaa275 LIKE pmaa_t.pmaa275, 
   pmaa276 LIKE pmaa_t.pmaa276, 
   pmaa281 LIKE pmaa_t.pmaa281, 
   pmaa281_desc LIKE type_t.chr80, 
   pmaa282 LIKE pmaa_t.pmaa282, 
   pmaa282_desc LIKE type_t.chr80, 
   pmaa283 LIKE pmaa_t.pmaa283, 
   pmaa283_desc LIKE type_t.chr80, 
   pmaa284 LIKE pmaa_t.pmaa284, 
   pmaa284_desc LIKE type_t.chr80, 
   pmaa285 LIKE pmaa_t.pmaa285, 
   pmaa285_desc LIKE type_t.chr80, 
   pmaa286 LIKE pmaa_t.pmaa286, 
   pmaa286_desc LIKE type_t.chr80, 
   pmaa287 LIKE pmaa_t.pmaa287, 
   pmaa287_desc LIKE type_t.chr80, 
   pmaa288 LIKE pmaa_t.pmaa288, 
   pmaa288_desc LIKE type_t.chr80, 
   pmaa289 LIKE pmaa_t.pmaa289, 
   pmaa289_desc LIKE type_t.chr80, 
   pmaa290 LIKE pmaa_t.pmaa290, 
   pmaa290_desc LIKE type_t.chr80, 
   pmaa291 LIKE pmaa_t.pmaa291, 
   pmaa291_desc LIKE type_t.chr80, 
   pmaa292 LIKE pmaa_t.pmaa292, 
   pmaa292_desc LIKE type_t.chr80, 
   pmaa293 LIKE pmaa_t.pmaa293, 
   pmaa293_desc LIKE type_t.chr80, 
   pmaa294 LIKE pmaa_t.pmaa294, 
   pmaa294_desc LIKE type_t.chr80, 
   pmaa295 LIKE pmaa_t.pmaa295, 
   pmaa295_desc LIKE type_t.chr80, 
   pmaa296 LIKE pmaa_t.pmaa296, 
   pmaa296_desc LIKE type_t.chr80, 
   pmaa297 LIKE pmaa_t.pmaa297, 
   pmaa297_desc LIKE type_t.chr80, 
   pmaa298 LIKE pmaa_t.pmaa298, 
   pmaa298_desc LIKE type_t.chr80, 
   pmaa299 LIKE pmaa_t.pmaa299, 
   pmaa299_desc LIKE type_t.chr80, 
   pmaa300 LIKE pmaa_t.pmaa300, 
   pmaa300_desc LIKE type_t.chr80
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_pmag_d        RECORD
       pmag002 LIKE pmag_t.pmag002, 
   pmag002_desc LIKE type_t.chr500, 
   pmag003 LIKE pmag_t.pmag003, 
   pmag004 LIKE pmag_t.pmag004, 
   pmag007 LIKE pmag_t.pmag007, 
   pmag008 LIKE pmag_t.pmag008, 
   pmagstus LIKE pmag_t.pmagstus
       END RECORD
PRIVATE TYPE type_g_pmag2_d RECORD
       pmax002 LIKE pmax_t.pmax002, 
   pmax002_desc LIKE type_t.chr500, 
   pmax003 LIKE pmax_t.pmax003, 
   pmax003_desc LIKE type_t.chr500, 
   pmaxstus LIKE pmax_t.pmaxstus
       END RECORD
PRIVATE TYPE type_g_pmag3_d RECORD
       pmay002 LIKE pmay_t.pmay002, 
   pmay002_desc LIKE type_t.chr500, 
   pmay003 LIKE pmay_t.pmay003, 
   pmay003_desc LIKE type_t.chr500, 
   pmay004 LIKE pmay_t.pmay004, 
   pmay005 LIKE pmay_t.pmay005
       END RECORD
PRIVATE TYPE type_g_pmag4_d RECORD
       pmaz002 LIKE pmaz_t.pmaz002, 
   pmaz002_desc LIKE type_t.chr500, 
   pmaz003 LIKE pmaz_t.pmaz003
       END RECORD
PRIVATE TYPE type_g_pmag5_d RECORD
       pmacstus LIKE pmac_t.pmacstus, 
   pmac003 LIKE pmac_t.pmac003, 
   pmac004 LIKE pmac_t.pmac004, 
   pmac002 LIKE pmac_t.pmac002, 
   pmac002_desc LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_pmag6_d RECORD
       pmafstus LIKE pmaf_t.pmafstus, 
   pmaf010 LIKE pmaf_t.pmaf010, 
   pmaf002 LIKE pmaf_t.pmaf002, 
   pmaf002_desc LIKE type_t.chr500, 
   pmaf003 LIKE pmaf_t.pmaf003, 
   pmaf004 LIKE pmaf_t.pmaf004, 
   pmaf011 LIKE pmaf_t.pmaf011, 
   pmaf011_desc LIKE type_t.chr500, 
   pmaf008 LIKE pmaf_t.pmaf008, 
   pmaf009 LIKE pmaf_t.pmaf009, 
   pmaf005 LIKE pmaf_t.pmaf005, 
   pmaf007 LIKE pmaf_t.pmaf007, 
   pmaf006 LIKE pmaf_t.pmaf006
       END RECORD
PRIVATE TYPE type_g_pmag7_d RECORD
       pmad003 LIKE pmad_t.pmad003, 
   pmadstus LIKE pmad_t.pmadstus, 
   pmad002 LIKE pmad_t.pmad002, 
   pmad002_desc LIKE type_t.chr500, 
   pmad004 LIKE pmad_t.pmad004
       END RECORD
PRIVATE TYPE type_g_pmag9_d RECORD
       pmae002 LIKE pmae_t.pmae002, 
   pmae002_desc LIKE type_t.chr500, 
   oocq005 LIKE type_t.chr500, 
   pmae003 LIKE pmae_t.pmae003
       END RECORD
 
 
PRIVATE TYPE type_browser RECORD
         b_statepic     LIKE type_t.chr50,
            b_pmaa001 LIKE pmaa_t.pmaa001,
   b_pmaa001_desc LIKE type_t.chr80,
   b_pmaa001_desc_desc LIKE type_t.chr80,
      b_pmaa002 LIKE pmaa_t.pmaa002,
      b_pmaa003 LIKE pmaa_t.pmaa003,
   b_num LIKE pmdn_t.pmdnseq
       END RECORD
       
#add-point:自定義模組變數(Module Variable) (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="global.variable"
DEFINE g_ooef004             LIKE ooef_t.ooef004
DEFINE g_ooef005             LIKE ooef_t.ooef005
DEFINE tok                   base.StringTokenizer 


TYPE type_g_pmag8_d RECORD
       pmad003_1      LIKE pmad_t.pmad003, 
       pmadstus_1     LIKE pmad_t.pmadstus, 
       pmad002_1      LIKE pmad_t.pmad002, 
       pmad002_1_desc LIKE type_t.chr500, 
       pmad004_1      LIKE pmad_t.pmad004
                    END RECORD
       
DEFINE g_pmag8_d       DYNAMIC ARRAY OF type_g_pmag8_d
DEFINE g_pmag8_d_t     type_g_pmag8_d
#DEFINE g_wc2_table8   STRING    #160810-00008#1 160819 by lori mark
DEFINE g_wc2_pmad      STRING    #160810-00008#1 160819 by lori add:取代 g_wc2_table8
DEFINE g_pmaa002_flag   LIKE type_t.chr1
DEFINE g_pmaa001_t2     LIKE pmaa_t.pmaa001
DEFINE g_ooef019        LIKE ooef_t.ooef019 #稅區 #sakura add

#ken---add---s 需求單號：150107-00009 項次：6
GLOBALS
 TYPE type_g_oofb_d        RECORD
       oofbstus LIKE oofb_t.oofbstus,
   oofb001 LIKE oofb_t.oofb001,
   oofb019 LIKE oofb_t.oofb019,
   oofb011 LIKE oofb_t.oofb011,
   oofb008 LIKE oofb_t.oofb008,
   oofb009 LIKE oofb_t.oofb009,
   oofb009_desc LIKE type_t.chr500,
   oofb010 LIKE oofb_t.oofb010,
   oofb012 LIKE oofb_t.oofb012,
   oofb012_desc LIKE type_t.chr500,
   oofb013 LIKE oofb_t.oofb013,
   oofb014 LIKE oofb_t.oofb014,
   oofb014_desc LIKE type_t.chr500,
   oofb015 LIKE oofb_t.oofb015,
   oofb015_desc LIKE type_t.chr500,
   oofb016 LIKE oofb_t.oofb016,
   oofb016_desc LIKE type_t.chr500,
   oofb017 LIKE oofb_t.oofb017,
   oofb022 LIKE oofb_t.oofb022,
   oofb022_desc LIKE type_t.chr500,
   oofb020 LIKE oofb_t.oofb020,
   oofb021 LIKE oofb_t.oofb021,
   oofb018 LIKE oofb_t.oofb018
       END RECORD
DEFINE g_pmba_d          DYNAMIC ARRAY OF type_g_oofb_d

 TYPE type_g_oofc_d        RECORD
       oofcstus LIKE oofc_t.oofcstus,
   oofc001 LIKE oofc_t.oofc001,
   oofc008 LIKE oofc_t.oofc008,
   oofc009 LIKE oofc_t.oofc009,
   oofc009_desc LIKE type_t.chr500,
   oofc012 LIKE oofc_t.oofc012,
   oofc010 LIKE oofc_t.oofc010,
   oofc014 LIKE oofc_t.oofc014,
   oofc011 LIKE oofc_t.oofc011,
   oofc015 LIKE oofc_t.oofc015,
   oofc013 LIKE oofc_t.oofc013
       END RECORD
DEFINE g_pmba2_d          DYNAMIC ARRAY OF type_g_oofc_d
END GLOBALS
#ken---add---e

#add by yangxf 20150506 增加編碼功能 start
DEFINE  l_oofg_return   DYNAMIC ARRAY OF RECORD
          oofg019       LIKE oofg_t.oofg019,  #field
          oofg020       LIKE oofg_t.oofg020   #value
                        END RECORD
#add by yangxf 20150506 增加編碼功能 end
DEFINE g_touch          LIKE type_t.num5      #150915-00006#1 20150915 add by beckxie
DEFINE g_pmaa091_acc    LIKE oocq_t.oocq001   #160810-00008#1 160819 by lori add
#end add-point
       
#模組變數(Module Variables)
DEFINE g_pmaa_m          type_g_pmaa_m
DEFINE g_pmaa_m_t        type_g_pmaa_m
DEFINE g_pmaa_m_o        type_g_pmaa_m
DEFINE g_pmaa_m_mask_o   type_g_pmaa_m #轉換遮罩前資料
DEFINE g_pmaa_m_mask_n   type_g_pmaa_m #轉換遮罩後資料
 
   DEFINE g_pmaa001_t LIKE pmaa_t.pmaa001
 
 
DEFINE g_pmag_d          DYNAMIC ARRAY OF type_g_pmag_d
DEFINE g_pmag_d_t        type_g_pmag_d
DEFINE g_pmag_d_o        type_g_pmag_d
DEFINE g_pmag_d_mask_o   DYNAMIC ARRAY OF type_g_pmag_d #轉換遮罩前資料
DEFINE g_pmag_d_mask_n   DYNAMIC ARRAY OF type_g_pmag_d #轉換遮罩後資料
DEFINE g_pmag2_d          DYNAMIC ARRAY OF type_g_pmag2_d
DEFINE g_pmag2_d_t        type_g_pmag2_d
DEFINE g_pmag2_d_o        type_g_pmag2_d
DEFINE g_pmag2_d_mask_o   DYNAMIC ARRAY OF type_g_pmag2_d #轉換遮罩前資料
DEFINE g_pmag2_d_mask_n   DYNAMIC ARRAY OF type_g_pmag2_d #轉換遮罩後資料
DEFINE g_pmag3_d          DYNAMIC ARRAY OF type_g_pmag3_d
DEFINE g_pmag3_d_t        type_g_pmag3_d
DEFINE g_pmag3_d_o        type_g_pmag3_d
DEFINE g_pmag3_d_mask_o   DYNAMIC ARRAY OF type_g_pmag3_d #轉換遮罩前資料
DEFINE g_pmag3_d_mask_n   DYNAMIC ARRAY OF type_g_pmag3_d #轉換遮罩後資料
DEFINE g_pmag4_d          DYNAMIC ARRAY OF type_g_pmag4_d
DEFINE g_pmag4_d_t        type_g_pmag4_d
DEFINE g_pmag4_d_o        type_g_pmag4_d
DEFINE g_pmag4_d_mask_o   DYNAMIC ARRAY OF type_g_pmag4_d #轉換遮罩前資料
DEFINE g_pmag4_d_mask_n   DYNAMIC ARRAY OF type_g_pmag4_d #轉換遮罩後資料
DEFINE g_pmag5_d          DYNAMIC ARRAY OF type_g_pmag5_d
DEFINE g_pmag5_d_t        type_g_pmag5_d
DEFINE g_pmag5_d_o        type_g_pmag5_d
DEFINE g_pmag5_d_mask_o   DYNAMIC ARRAY OF type_g_pmag5_d #轉換遮罩前資料
DEFINE g_pmag5_d_mask_n   DYNAMIC ARRAY OF type_g_pmag5_d #轉換遮罩後資料
DEFINE g_pmag6_d          DYNAMIC ARRAY OF type_g_pmag6_d
DEFINE g_pmag6_d_t        type_g_pmag6_d
DEFINE g_pmag6_d_o        type_g_pmag6_d
DEFINE g_pmag6_d_mask_o   DYNAMIC ARRAY OF type_g_pmag6_d #轉換遮罩前資料
DEFINE g_pmag6_d_mask_n   DYNAMIC ARRAY OF type_g_pmag6_d #轉換遮罩後資料
DEFINE g_pmag7_d          DYNAMIC ARRAY OF type_g_pmag7_d
DEFINE g_pmag7_d_t        type_g_pmag7_d
DEFINE g_pmag7_d_o        type_g_pmag7_d
DEFINE g_pmag7_d_mask_o   DYNAMIC ARRAY OF type_g_pmag7_d #轉換遮罩前資料
DEFINE g_pmag7_d_mask_n   DYNAMIC ARRAY OF type_g_pmag7_d #轉換遮罩後資料
DEFINE g_pmag9_d          DYNAMIC ARRAY OF type_g_pmag9_d
DEFINE g_pmag9_d_t        type_g_pmag9_d
DEFINE g_pmag9_d_o        type_g_pmag9_d
DEFINE g_pmag9_d_mask_o   DYNAMIC ARRAY OF type_g_pmag9_d #轉換遮罩前資料
DEFINE g_pmag9_d_mask_n   DYNAMIC ARRAY OF type_g_pmag9_d #轉換遮罩後資料
 
 
DEFINE g_browser         DYNAMIC ARRAY OF type_browser
DEFINE g_browser_f       DYNAMIC ARRAY OF type_browser
 
DEFINE g_master_multi_table_t    RECORD
      pmaal001 LIKE pmaal_t.pmaal001,
      pmaal004 LIKE pmaal_t.pmaal004,
      pmaal003 LIKE pmaal_t.pmaal003,
      pmaal006 LIKE pmaal_t.pmaal006,
      pmaal005 LIKE pmaal_t.pmaal005
      END RECORD
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
DEFINE g_wc2_table2   STRING
 
DEFINE g_wc2_table3   STRING
 
DEFINE g_wc2_table4   STRING
 
DEFINE g_wc2_table5   STRING
 
DEFINE g_wc2_table6   STRING
 
DEFINE g_wc2_table7   STRING
 
DEFINE g_wc2_table8   STRING
 
 
 
DEFINE g_wc2_extend          STRING
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num10           
DEFINE l_ac                  LIKE type_t.num10    
DEFINE g_curr_diag           ui.Dialog                         #Current Dialog
                                                               
DEFINE g_pagestart           LIKE type_t.num10                 
DEFINE gwin_curr             ui.Window                         #Current Window
DEFINE gfrm_curr             ui.Form                           #Current Form
DEFINE g_page_action         STRING                            #page action
DEFINE g_header_hidden       LIKE type_t.num5                  #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5                  #隱藏工作Panel
DEFINE g_page                STRING                            #第幾頁
DEFINE g_state               STRING       
DEFINE g_header_cnt          LIKE type_t.num10
DEFINE g_detail_cnt          LIKE type_t.num10                  #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num10                  #單身目前所在筆數
DEFINE g_detail_idx_tmp      LIKE type_t.num10                  #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num10                  #單身2目前所在筆數
DEFINE g_detail_idx_list     DYNAMIC ARRAY OF LIKE type_t.num10 #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num10                  #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num10                  #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num10                  #Browser目前所在筆數(暫存用)
DEFINE g_order               STRING                             #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num10                  #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                            #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num10                  #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5                   #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #是否顯示筆數提示訊息
DEFINE g_master_insert       BOOLEAN                       #確認單頭資料是否寫入
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
DEFINE g_add_browse          STRING                        #新增填充用WC
DEFINE g_update              BOOLEAN                       #確定單頭/身是否異動過
DEFINE g_idx_group           om.SaxAttributes              #頁籤群組
DEFINE g_master_commit       LIKE type_t.chr1              #確認單頭是否修改過
 
#add-point:自定義客戶專用模組變數(Module Variable) name="global.variable_customerization"

#end add-point
 
#add-point:傳入參數說明(global.argv) name="global.argv"

#end add-point
 
{</section>}
 
{<section id="apmm801.main" >}
#應用 a26 樣板自動產生(Version:7)
#+ 作業開始(主程式類型)
MAIN
   #add-point:main段define(客製用) name="main.define_customerization"
   
   #end add-point   
   #add-point:main段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="main.define"
   DEFINE l_success LIKE type_t.num5 #150308-00001#4 150309 by lori add
   #end add-point   
   
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("apm","")
 
   #add-point:作業初始化 name="main.init"
#   LET g_argv[1] = cl_replace_str(g_argv[1], '\"', '')               
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define name="main.define_sql"
                  
   #end add-point
   LET g_forupd_sql = " SELECT pmaa001,pmaa002,pmaa089,'','','','',pmaa003,pmaastus,pmaa004,pmaa005, 
       '',pmaa006,'',pmaa026,'',pmaa200,pmaa201,pmaa202,pmaa017,pmaa016,pmaa018,pmaa019,'',pmaa021,pmaa022, 
       '',pmaa020,pmaa023,'',pmaa024,'',pmaa025,pmaa007,'',pmaa008,pmaa009,'',pmaa010,pmaa011,'',pmaa027, 
       pmaa230,pmaa231,'',pmaa232,'',pmaa090,'',pmaa091,'',pmaa092,pmaa094,'',pmaa093,'',pmaa096,'', 
       pmaa097,'',pmaa241,'',pmaa242,'',pmaa243,'',pmaa244,'',pmaa245,'',pmaa246,pmaa247,pmaa248,pmaa095, 
       '',pmaa220,pmaa221,'',pmaa222,'',pmaa080,'',pmaa084,'',pmaa083,'',pmaa086,'',pmaa085,'',pmaa051, 
       pmaa052,'',pmaa053,'',pmaa054,'',pmaa055,pmaa056,pmaa057,pmaa058,pmaa074,pmaa059,pmaa075,pmaa047, 
       pmaa036,pmaa037,pmaa038,pmaa039,pmaa040,pmaa041,pmaa042,pmaa043,pmaa044,pmaa045,pmaa046,pmaa068, 
       pmaa069,pmaa072,pmaa070,pmaa071,pmaa073,pmaa204,pmaa205,'',pmaa206,'','','','','','','',pmaa081, 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','',pmaaownid,'',pmaaowndp,'',pmaacrtid,'',pmaacrtdp,'',pmaacrtdt, 
       pmaamodid,'',pmaamoddt,pmaacnfid,'',pmaacnfdt,pmaa270,pmaa271,pmaa272,'','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','',pmaa274, 
       '',pmaa275,pmaa276,pmaa281,'',pmaa282,'',pmaa283,'',pmaa284,'',pmaa285,'',pmaa286,'',pmaa287, 
       '',pmaa288,'',pmaa289,'',pmaa290,'',pmaa291,'',pmaa292,'',pmaa293,'',pmaa294,'',pmaa295,'',pmaa296, 
       '',pmaa297,'',pmaa298,'',pmaa299,'',pmaa300,''", 
                      " FROM pmaa_t",
                      " WHERE pmaaent= ? AND pmaa001=? FOR UPDATE"
   #add-point:SQL_define name="main.after_define_sql"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT DISTINCT t0.pmaa001,t0.pmaa002,t0.pmaa089,t0.pmaa003,t0.pmaastus,t0.pmaa004, 
       t0.pmaa005,t0.pmaa006,t0.pmaa026,t0.pmaa200,t0.pmaa201,t0.pmaa202,t0.pmaa017,t0.pmaa016,t0.pmaa018, 
       t0.pmaa019,t0.pmaa021,t0.pmaa022,t0.pmaa020,t0.pmaa023,t0.pmaa024,t0.pmaa025,t0.pmaa007,t0.pmaa008, 
       t0.pmaa009,t0.pmaa010,t0.pmaa011,t0.pmaa027,t0.pmaa230,t0.pmaa231,t0.pmaa232,t0.pmaa090,t0.pmaa091, 
       t0.pmaa092,t0.pmaa094,t0.pmaa093,t0.pmaa096,t0.pmaa097,t0.pmaa241,t0.pmaa242,t0.pmaa243,t0.pmaa244, 
       t0.pmaa245,t0.pmaa246,t0.pmaa247,t0.pmaa248,t0.pmaa095,t0.pmaa220,t0.pmaa221,t0.pmaa222,t0.pmaa080, 
       t0.pmaa084,t0.pmaa083,t0.pmaa086,t0.pmaa085,t0.pmaa051,t0.pmaa052,t0.pmaa053,t0.pmaa054,t0.pmaa055, 
       t0.pmaa056,t0.pmaa057,t0.pmaa058,t0.pmaa074,t0.pmaa059,t0.pmaa075,t0.pmaa047,t0.pmaa036,t0.pmaa037, 
       t0.pmaa038,t0.pmaa039,t0.pmaa040,t0.pmaa041,t0.pmaa042,t0.pmaa043,t0.pmaa044,t0.pmaa045,t0.pmaa046, 
       t0.pmaa068,t0.pmaa069,t0.pmaa072,t0.pmaa070,t0.pmaa071,t0.pmaa073,t0.pmaa204,t0.pmaa205,t0.pmaa206, 
       t0.pmaa081,t0.pmaaownid,t0.pmaaowndp,t0.pmaacrtid,t0.pmaacrtdp,t0.pmaacrtdt,t0.pmaamodid,t0.pmaamoddt, 
       t0.pmaacnfid,t0.pmaacnfdt,t0.pmaa270,t0.pmaa271,t0.pmaa272,t0.pmaa274,t0.pmaa275,t0.pmaa276,t0.pmaa281, 
       t0.pmaa282,t0.pmaa283,t0.pmaa284,t0.pmaa285,t0.pmaa286,t0.pmaa287,t0.pmaa288,t0.pmaa289,t0.pmaa290, 
       t0.pmaa291,t0.pmaa292,t0.pmaa293,t0.pmaa294,t0.pmaa295,t0.pmaa296,t0.pmaa297,t0.pmaa298,t0.pmaa299, 
       t0.pmaa300,t1.pmaal004 ,t2.oocql004 ,t3.oocql004 ,t4.ooail003 ,t5.ooail003 ,t6.oocql004 ,t7.oocql004 , 
       t8.oocgl003 ,t9.ooall004 ,t10.ooail003 ,t11.oocql004 ,t12.oocql004 ,t13.oocql004 ,t14.oocql004 , 
       t15.oocql004 ,t16.ooag011 ,t17.ooefl003 ,t18.dbaal003 ,t19.dbaal003 ,t20.dbaal003 ,t21.dbaal003 , 
       t22.ooefl003 ,t23.oocql004 ,t24.oocql004 ,t25.oocql004 ,t26.oocql004 ,t27.ooag011 ,t28.ooefl003 , 
       t29.pmaal003 ,t30.xmajl003 ,t31.ooail003 ,t32.oocql004 ,t35.oocql004 ,t55.ooag011 ,t56.ooefl003 , 
       t57.ooag011 ,t58.ooefl003 ,t59.ooag011 ,t60.ooag011 ,t61.oocql004 ,t62.oocql004 ,t63.oocql004 , 
       t64.oocql004 ,t65.oocql004 ,t66.oocql004 ,t67.oocql004 ,t68.oocql004 ,t69.oocql004 ,t70.oocql004 , 
       t71.oocql004 ,t72.oocql004 ,t73.oocql004 ,t74.oocql004 ,t75.oocql004 ,t76.oocql004 ,t77.oocql004 , 
       t78.oocql004 ,t79.oocql004 ,t80.oocql004 ,t81.oocql004",
               " FROM pmaa_t t0",
                              " LEFT JOIN pmaal_t t1 ON t1.pmaalent="||g_enterprise||" AND t1.pmaal001=t0.pmaa005 AND t1.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t2 ON t2.oocqlent="||g_enterprise||" AND t2.oocql001='261' AND t2.oocql002=t0.pmaa006 AND t2.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t3 ON t3.oocqlent="||g_enterprise||" AND t3.oocql001='250' AND t3.oocql002=t0.pmaa026 AND t3.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t4 ON t4.ooailent="||g_enterprise||" AND t4.ooail001=t0.pmaa019 AND t4.ooail002='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t5 ON t5.ooailent="||g_enterprise||" AND t5.ooail001=t0.pmaa022 AND t5.ooail002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t6 ON t6.oocqlent="||g_enterprise||" AND t6.oocql001='254' AND t6.oocql002=t0.pmaa023 AND t6.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t7 ON t7.oocqlent="||g_enterprise||" AND t7.oocql001='260' AND t7.oocql002=t0.pmaa024 AND t7.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocgl_t t8 ON t8.oocglent="||g_enterprise||" AND t8.oocgl001=t0.pmaa007 AND t8.oocgl002='"||g_dlang||"' ",
               " LEFT JOIN ooall_t t9 ON t9.ooallent="||g_enterprise||" AND t9.ooall001='4' AND t9.ooall002=t0.pmaa009 AND t9.ooall003='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t10 ON t10.ooailent="||g_enterprise||" AND t10.ooail001=t0.pmaa011 AND t10.ooail002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t11 ON t11.oocqlent="||g_enterprise||" AND t11.oocql001='2072' AND t11.oocql002=t0.pmaa232 AND t11.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t12 ON t12.oocqlent="||g_enterprise||" AND t12.oocql001='281' AND t12.oocql002=t0.pmaa090 AND t12.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t13 ON t13.oocqlent="||g_enterprise||" AND t13.oocql001='283' AND t13.oocql002=t0.pmaa091 AND t13.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t14 ON t14.oocqlent="||g_enterprise||" AND t14.oocql001='286' AND t14.oocql002=t0.pmaa094 AND t14.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t15 ON t15.oocqlent="||g_enterprise||" AND t15.oocql001='285' AND t15.oocql002=t0.pmaa093 AND t15.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t16 ON t16.ooagent="||g_enterprise||" AND t16.ooag001=t0.pmaa096  ",
               " LEFT JOIN ooefl_t t17 ON t17.ooeflent="||g_enterprise||" AND t17.ooefl001=t0.pmaa097 AND t17.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN dbaal_t t18 ON t18.dbaalent="||g_enterprise||" AND t18.dbaal001=t0.pmaa241 AND t18.dbaal002='"||g_dlang||"' ",
               " LEFT JOIN dbaal_t t19 ON t19.dbaalent="||g_enterprise||" AND t19.dbaal001=t0.pmaa242 AND t19.dbaal002='"||g_dlang||"' ",
               " LEFT JOIN dbaal_t t20 ON t20.dbaalent="||g_enterprise||" AND t20.dbaal001=t0.pmaa243 AND t20.dbaal002='"||g_dlang||"' ",
               " LEFT JOIN dbaal_t t21 ON t21.dbaalent="||g_enterprise||" AND t21.dbaal001=t0.pmaa244 AND t21.dbaal002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t22 ON t22.ooeflent="||g_enterprise||" AND t22.ooefl001=t0.pmaa095 AND t22.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t23 ON t23.oocqlent="||g_enterprise||" AND t23.oocql001='2072' AND t23.oocql002=t0.pmaa222 AND t23.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t24 ON t24.oocqlent="||g_enterprise||" AND t24.oocql001='251' AND t24.oocql002=t0.pmaa080 AND t24.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t25 ON t25.oocqlent="||g_enterprise||" AND t25.oocql001='256' AND t25.oocql002=t0.pmaa084 AND t25.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t26 ON t26.oocqlent="||g_enterprise||" AND t26.oocql001='255' AND t26.oocql002=t0.pmaa083 AND t26.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t27 ON t27.ooagent="||g_enterprise||" AND t27.ooag001=t0.pmaa086  ",
               " LEFT JOIN ooefl_t t28 ON t28.ooeflent="||g_enterprise||" AND t28.ooefl001=t0.pmaa085 AND t28.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t29 ON t29.pmaalent="||g_enterprise||" AND t29.pmaal001=t0.pmaa052 AND t29.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN xmajl_t t30 ON t30.xmajlent="||g_enterprise||" AND t30.xmajl001=t0.pmaa053 AND t30.xmajl002='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t31 ON t31.ooailent="||g_enterprise||" AND t31.ooail001=t0.pmaa054 AND t31.ooail002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t32 ON t32.oocqlent="||g_enterprise||" AND t32.oocql001='2031' AND t32.oocql002=t0.pmaa205 AND t32.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t35 ON t35.oocqlent="||g_enterprise||" AND t35.oocql001='253' AND t35.oocql002=t0.pmaa081 AND t35.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t55 ON t55.ooagent="||g_enterprise||" AND t55.ooag001=t0.pmaaownid  ",
               " LEFT JOIN ooefl_t t56 ON t56.ooeflent="||g_enterprise||" AND t56.ooefl001=t0.pmaaowndp AND t56.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t57 ON t57.ooagent="||g_enterprise||" AND t57.ooag001=t0.pmaacrtid  ",
               " LEFT JOIN ooefl_t t58 ON t58.ooeflent="||g_enterprise||" AND t58.ooefl001=t0.pmaacrtdp AND t58.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t59 ON t59.ooagent="||g_enterprise||" AND t59.ooag001=t0.pmaamodid  ",
               " LEFT JOIN ooag_t t60 ON t60.ooagent="||g_enterprise||" AND t60.ooag001=t0.pmaacnfid  ",
               " LEFT JOIN oocql_t t61 ON t61.oocqlent="||g_enterprise||" AND t61.oocql001='274' AND t61.oocql002=t0.pmaa274 AND t61.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t62 ON t62.oocqlent="||g_enterprise||" AND t62.oocql001='2037' AND t62.oocql002=t0.pmaa281 AND t62.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t63 ON t63.oocqlent="||g_enterprise||" AND t63.oocql001='2038' AND t63.oocql002=t0.pmaa282 AND t63.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t64 ON t64.oocqlent="||g_enterprise||" AND t64.oocql001='2039' AND t64.oocql002=t0.pmaa283 AND t64.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t65 ON t65.oocqlent="||g_enterprise||" AND t65.oocql001='2040' AND t65.oocql002=t0.pmaa284 AND t65.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t66 ON t66.oocqlent="||g_enterprise||" AND t66.oocql001='2041' AND t66.oocql002=t0.pmaa285 AND t66.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t67 ON t67.oocqlent="||g_enterprise||" AND t67.oocql001='2042' AND t67.oocql002=t0.pmaa286 AND t67.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t68 ON t68.oocqlent="||g_enterprise||" AND t68.oocql001='2043' AND t68.oocql002=t0.pmaa287 AND t68.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t69 ON t69.oocqlent="||g_enterprise||" AND t69.oocql001='2044' AND t69.oocql002=t0.pmaa288 AND t69.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t70 ON t70.oocqlent="||g_enterprise||" AND t70.oocql001='2045' AND t70.oocql002=t0.pmaa289 AND t70.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t71 ON t71.oocqlent="||g_enterprise||" AND t71.oocql001='2046' AND t71.oocql002=t0.pmaa290 AND t71.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t72 ON t72.oocqlent="||g_enterprise||" AND t72.oocql001='2061' AND t72.oocql002=t0.pmaa291 AND t72.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t73 ON t73.oocqlent="||g_enterprise||" AND t73.oocql001='2062' AND t73.oocql002=t0.pmaa292 AND t73.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t74 ON t74.oocqlent="||g_enterprise||" AND t74.oocql001='2063' AND t74.oocql002=t0.pmaa293 AND t74.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t75 ON t75.oocqlent="||g_enterprise||" AND t75.oocql001='2064' AND t75.oocql002=t0.pmaa294 AND t75.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t76 ON t76.oocqlent="||g_enterprise||" AND t76.oocql001='2065' AND t76.oocql002=t0.pmaa295 AND t76.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t77 ON t77.oocqlent="||g_enterprise||" AND t77.oocql001='2066' AND t77.oocql002=t0.pmaa296 AND t77.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t78 ON t78.oocqlent="||g_enterprise||" AND t78.oocql001='2067' AND t78.oocql002=t0.pmaa297 AND t78.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t79 ON t79.oocqlent="||g_enterprise||" AND t79.oocql001='2068' AND t79.oocql002=t0.pmaa298 AND t79.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t80 ON t80.oocqlent="||g_enterprise||" AND t80.oocql001='2069' AND t80.oocql002=t0.pmaa299 AND t80.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t81 ON t81.oocqlent="||g_enterprise||" AND t81.oocql001='2070' AND t81.oocql002=t0.pmaa300 AND t81.oocql003='"||g_dlang||"' ",
 
               " WHERE t0.pmaaent = " ||g_enterprise|| " AND t0.pmaa001 = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define name="main.after_refresh_sql"
 
   #end add-point
   PREPARE apmm801_master_referesh FROM g_sql
 
    
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call name="main.servicecall"
                                    
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_apmm801 WITH FORM cl_ap_formpath("apm",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL apmm801_init()   
 
      #進入選單 Menu (="N")
      CALL apmm801_ui_dialog() 
      
      #add-point:畫面關閉前 name="main.before_close"
      CALL s_aooi390_drop_tmp_table()   #add by yangxf  20150506     添加編碼功能
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_apmm801
      
   END IF 
   
   CLOSE apmm801_cl
   
   
 
   #add-point:作業離開前 name="main.exit"
   CALL s_aooi500_drop_temp() RETURNING l_success   #150308-00001#4 150309 by lori add
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
END MAIN
 
 
 
 
{</section>}
 
{<section id="apmm801.init" >}
#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION apmm801_init()
   #add-point:init段define(客製用) name="init.define_customerization"
   
   #end add-point    
   #add-point:init段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="init.define"
   DEFINE l_success LIKE type_t.num5 #150308-00001#4 150309 by lori add 
      
   #end add-point   
   
   #add-point:Function前置處理  name="init.pre_function"
   
   #end add-point
   
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1 #第一層單身指標
   LET g_detail_idx2 = 1 #第二層單身指標
   
   #各個page指標
   LET g_detail_idx_list[1] = 1 
   LET g_detail_idx_list[2] = 1
   LET g_detail_idx_list[3] = 1
   LET g_detail_idx_list[4] = 1
   LET g_detail_idx_list[5] = 1
   LET g_detail_idx_list[6] = 1
   LET g_detail_idx_list[7] = 1
   LET g_detail_idx_list[8] = 1
 
   LET g_error_show  = 1
   LET l_ac = 1 #單身指標
      CALL cl_set_combo_scc_part('pmaastus','50','N,Y,X')
 
      CALL cl_set_combo_scc('pmaa002','2014') 
   CALL cl_set_combo_scc('pmaa004','2015') 
   CALL cl_set_combo_scc('pmaa010','25') 
   CALL cl_set_combo_scc('pmaa092','2040') 
   CALL cl_set_combo_scc('pmaa051','2033') 
   CALL cl_set_combo_scc('pmaa037','2012') 
   CALL cl_set_combo_scc('pmaa073','8312') 
   CALL cl_set_combo_scc('pmaa204','6013') 
   CALL cl_set_combo_scc('pmaa270','6019') 
   CALL cl_set_combo_scc('pmac003','2013') 
 
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
   
   #page群組
   LET g_idx_group = om.SaxAttributes.create()
   CALL g_idx_group.addAttribute("'1',","1")
   CALL g_idx_group.addAttribute("'2',","1")
   CALL g_idx_group.addAttribute("'3',","1")
   CALL g_idx_group.addAttribute("'4',","1")
   CALL g_idx_group.addAttribute("'5',","1")
   CALL g_idx_group.addAttribute("'6',","1")
   CALL g_idx_group.addAttribute("'7',","1")
   CALL g_idx_group.addAttribute("'8',","1")
 
 
   #add-point:畫面資料初始化 name="init.init"
   CALL s_aooi500_create_temp() RETURNING l_success     #150308-00001#4 150309 by lori add
   CALL cl_set_combo_scc('pmab080','36')                #160810-00008#1 160819 by lori add
   CALL cl_set_combo_scc_part('pmaa092','2040','1,2')   #150616-00034#1 beckxie
   CALL cl_set_combo_scc('b_pmaa000','32')
   CALL cl_set_combo_scc('b_pmaa002','2014')
   CALL cl_set_combo_scc('pmaa220','2008')
   CALL cl_set_combo_scc('pmaa230','6018')
  #經營方式統一 6013,7/8
  #CALL cl_set_combo_scc('pmaa204','2006')
   CALL cl_set_combo_scc_part('pmaa204','6013','1,2,3,4,5')
   CALL cl_set_combo_scc('pmaa206','2007') 
   CALL cl_set_combo_scc('pmaa270','6019')
   CALL cl_set_combo_scc('pmab035','8322')
   CALL cl_set_combo_scc('pmab085','8322')
   CALL cl_set_combo_lang("pmab032")
   CALL cl_set_combo_lang("pmab082")
   CALL cl_set_combo_scc('pmab057','2087') 
   CALL cl_set_combo_scc('pmab058','2086')
   CALL cl_set_combo_scc('pmab107','2085') 
   CALL cl_set_combo_scc('pmab108','2084') 
   CALL apmm801_set_ui_init()

   LET g_ooef004 = ''
   LET g_ooef005 = ''
   SELECT ooef004,ooef005 INTO g_ooef004,g_ooef005 FROM ooef_t
    WHERE ooefent = g_enterprise
      AND ooef001 = g_site
   IF cl_null(g_ooef004) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'art-00007'
      LET g_errparam.extend = g_site
      LET g_errparam.popup = TRUE
      CALL cl_err()

   END IF   
   LET g_errshow = 1
   
   LET g_ooef019 = '' #sakura add
   CALL s_tax_get_ooef019(g_site) RETURNING l_success,g_ooef019 #sakura add  
   
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_01"), "grid_01", "Table", "s_detail1_aooi350_01")
   CALL cl_set_combo_scc('oofb008','9')   #地址類型
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_02"), "grid_02", "Table", "s_detail1_aooi350_02")
   CALL cl_set_combo_scc('oofc008','6')   #通訊類型
#   CALL s_display_rtdb001(g_prog,'pmaa083') #生命类型
   CALL s_life_cycle_display(g_prog,'pmaa083','2') #生命类型  #Add By geza 150318 
   CALL s_aooi390_cre_tmp_table() RETURNING l_success  #add by yangxf 20150506 增加編碼功能
   #160512-00003#11
   CALL cl_set_comp_required('pmab053,pmab037,pmab034,pmab084',TRUE)
   
   #160810-00008#1 160819 by lori add---(S)
   LET g_pmaa091_acc = '283'
   CALL apmm801_set_comp_visible('')
   CALL apmm801_set_comp_no_visible('')
   #160810-00008#1 160819 by lori add---(E) 

   #161109-00012#1 161109 by lori add---(S)
   CALL apmm801_set_act_visible()
   CALL apmm801_set_act_no_visible()
   #161109-00012#1 161109 by lori add---(E)
   #end add-point
   
   #初始化搜尋條件
   CALL apmm801_default_search()
    
END FUNCTION
 
{</section>}
 
{<section id="apmm801.ui_dialog" >}
#+ 功能選單
PRIVATE FUNCTION apmm801_ui_dialog()
   #add-point:ui_dialog段define(客製用) name="ui_dialog.define_customerization"
   
   #end add-point
   DEFINE li_idx     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE lb_first   BOOLEAN
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE la_param   RECORD
          prog       STRING,
          actionid   STRING,
          background LIKE type_t.chr1,
          param      DYNAMIC ARRAY OF STRING
          END RECORD
   DEFINE ls_js      STRING
   DEFINE la_output  DYNAMIC ARRAY OF STRING   #報表元件鬆耦合使用
   DEFINE  l_cmd_token           base.StringTokenizer   #報表作業cmdrun使用 
   DEFINE  l_cmd_next            STRING                 #報表作業cmdrun使用
   DEFINE  l_cmd_cnt             LIKE type_t.num5       #報表作業cmdrun使用
   DEFINE  l_cmd_prog_arg        STRING                 #報表作業cmdrun使用
   DEFINE  l_cmd_arg             STRING                 #報表作業cmdrun使用
   #add-point:ui_dialog段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="ui_dialog.define"
   DEFINE l_cmd     STRING  
   #end add-point
   
   #add-point:Function前置處理  name="ui_dialog.pre_function"
   
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   #因應查詢方案進行處理
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default動作
   #應用 a42 樣板自動產生(Version:3)
   #進入程式時預設執行的動作
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL apmm801_insert()
            #add-point:ON ACTION insert name="menu.default.insert"
                                                                        
            #END add-point
         END IF
 
      #add-point:action default自訂 name="ui_dialog.action_default"
                                    
      #end add-point
      OTHERWISE
   END CASE
 
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog  name="ui_dialog.before_dialog"
   LET g_touch = 1   #150915-00006#1 20150915 add by beckxie
   #end add-point
   
   WHILE TRUE 
   
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM
         CALL g_browser.clear()       
         INITIALIZE g_pmaa_m.* TO NULL
         CALL g_pmag_d.clear()
         CALL g_pmag2_d.clear()
         CALL g_pmag3_d.clear()
         CALL g_pmag4_d.clear()
         CALL g_pmag5_d.clear()
         CALL g_pmag6_d.clear()
         CALL g_pmag7_d.clear()
         CALL g_pmag9_d.clear()
 
         LET g_wc  = ' 1=2'
         LET g_wc2 = ' 1=1'
         LET g_action_choice = ""
         CALL apmm801_init()
      END IF
   
      CALL lib_cl_dlg.cl_dlg_before_display()
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #目前指標
               LET g_current_sw = TRUE
         
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL apmm801_fetch('') # reload data
               LET l_ac = 1
               CALL apmm801_ui_detailshow() #Setting the current row 
         
               CALL apmm801_idx_chk()
               #NEXT FIELD pmag002
         
               ON ACTION qbefield_user   #欄位隱藏設定 
                  LET g_action_choice="qbefield_user"
                  CALL cl_ui_qbefield_user()
         END DISPLAY
    
         DISPLAY ARRAY g_pmag_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #確定當下選擇的筆數
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[1] = l_ac
               CALL g_idx_group.addAttribute("'1',",l_ac)
               
               #add-point:page1, before row動作 name="ui_dialog.page1.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'1',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page1自定義行為 name="ui_dialog.page1.before_display"
                                                                                          
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
               
            #add-point:page1自定義行為 name="ui_dialog.page1.action"
                                                                        
            #end add-point
               
         END DISPLAY
        
         #第一階單身段落
         DISPLAY ARRAY g_pmag2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[2] = l_ac
               CALL g_idx_group.addAttribute("'2',",l_ac)
               
               #add-point:page2, before row動作 name="ui_dialog.body2.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'2',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_current_page = 2
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page2自定義行為 name="ui_dialog.body2.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為 name="ui_dialog.body2.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[3] = l_ac
               CALL g_idx_group.addAttribute("'3',",l_ac)
               
               #add-point:page3, before row動作 name="ui_dialog.body3.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'3',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 3
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page3自定義行為 name="ui_dialog.body3.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
         
            #add-point:page3自定義行為 name="ui_dialog.body3.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[4] = l_ac
               CALL g_idx_group.addAttribute("'4',",l_ac)
               
               #add-point:page4, before row動作 name="ui_dialog.body4.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'4',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 4
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page4自定義行為 name="ui_dialog.body4.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_4)
            
         
            #add-point:page4自定義行為 name="ui_dialog.body4.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[5] = l_ac
               CALL g_idx_group.addAttribute("'5',",l_ac)
               
               #add-point:page5, before row動作 name="ui_dialog.body5.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'5',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_current_page = 5
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page5自定義行為 name="ui_dialog.body5.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_5)
            
         
            #add-point:page5自定義行為 name="ui_dialog.body5.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag6_d TO s_detail6.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail6")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[6] = l_ac
               CALL g_idx_group.addAttribute("'6',",l_ac)
               
               #add-point:page6, before row動作 name="ui_dialog.body6.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'6',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail6")
               LET g_current_page = 6
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page6自定義行為 name="ui_dialog.body6.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_6)
            
         
            #add-point:page6自定義行為 name="ui_dialog.body6.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail7")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[7] = l_ac
               CALL g_idx_group.addAttribute("'7',",l_ac)
               
               #add-point:page7, before row動作 name="ui_dialog.body7.before_row"
                                                                                          
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'7',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail7")
               LET g_current_page = 7
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page7自定義行為 name="ui_dialog.body7.before_display"
                                                                                          
               #end add-point
      
            #自訂ACTION(detail_show,page_7)
            
         
            #add-point:page7自定義行為 name="ui_dialog.body7.action"
                                                                        
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_pmag9_d TO s_detail9.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail9")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[8] = l_ac
               CALL g_idx_group.addAttribute("'8',",l_ac)
               
               #add-point:page8, before row動作 name="ui_dialog.body9.before_row"
               
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'8',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail9")
               LET g_current_page = 8
               #顯示單身筆數
               CALL apmm801_idx_chk()
               #add-point:page8自定義行為 name="ui_dialog.body9.before_display"
               
               #end add-point
      
            #自訂ACTION(detail_show,page_8)
            
         
            #add-point:page8自定義行為 name="ui_dialog.body9.action"
            
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array name="ui_dialog.more_displayarray"
         DISPLAY ARRAY g_pmag8_d TO s_detail8.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL apmm801_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail8")
               LET g_detail_idx = l_ac
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail8")
               LET g_current_page = 8
               #顯示單身筆數
               CALL apmm801_idx_chk()
       
         END DISPLAY
         
         SUBDIALOG aoo_aooi350_01.aooi350_01_display
         SUBDIALOG aoo_aooi350_02.aooi350_02_display
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            #先填充browser資料
            CALL apmm801_browser_fill("")
            CALL cl_notice()
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            
            #確保g_current_idx位於正常區間內
            #小於,等於0則指到第1筆
            IF g_current_idx <= 0 THEN
               LET g_current_idx = 1
            END IF
            #超過最大筆數則指到最後1筆
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            LET g_current_sw = TRUE
            LET g_current_row = g_current_idx #目前指標
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL apmm801_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL apmm801_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL apmm801_idx_chk()
            CALL cl_ap_performance_cal()
            #add-point:ui_dialog段before_dialog2 name="ui_dialog.before_dialog2"
            #150612-00018#5 15/06/16 by s983961 add(s) 呼叫 action元件裡的 aoos010申請流程控管
            CALL apmm801_set_act_visible()   
            CALL apmm801_set_act_no_visible()
            #150612-00018#5 15/06/16 by s983961 add(e)
            
            CALL apmm801_set_comp_no_visible('')    #160620-00004#1 160623 by lori add
            CALL apmm801_set_comp_visible('')       #160620-00004#1 160623 by lori add
            
            IF lb_first THEN
               LET lb_first = FALSE
               #NEXT FIELD pmaastus
               IF g_pmaa_m.pmaa002 = '2' THEN       #160620-00004#1 160623 by lori add
                  NEXT FIELD pmae002                #160620-00004#1 160623 by lori add
               ELSE                                 #160620-00004#1 160623 by lori add   
                  NEXT FIELD pmacstus              
               END IF                               #160620-00004#1 160623 by lori add
            END IF
            #end add-point
 
         #add-point:ui_dialog段more_action name="ui_dialog.more_action"
         
         #end add-point
 
         #狀態碼切換
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL apmm801_statechange()
            #根據資料狀態切換action狀態
            CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
            CALL apmm801_set_act_visible()   
            CALL apmm801_set_act_no_visible()
            IF NOT (g_pmaa_m.pmaa001 IS NULL
 
              ) THEN
               #組合條件
               LET g_add_browse = " pmaaent = " ||g_enterprise|| " AND",
                                  " pmaa001 = '", g_pmaa_m.pmaa001, "' "
 
               #填到對應位置
               CALL apmm801_browser_fill("")
            END IF
         
          
         #查詢方案選擇 
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               INITIALIZE g_wc2_table2 TO NULL
 
               INITIALIZE g_wc2_table3 TO NULL
 
               INITIALIZE g_wc2_table4 TO NULL
 
               INITIALIZE g_wc2_table5 TO NULL
 
               INITIALIZE g_wc2_table6 TO NULL
 
               INITIALIZE g_wc2_table7 TO NULL
 
               INITIALIZE g_wc2_table8 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "pmaa_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "pmag_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "pmax_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmay_t" 
                        LET g_wc2_table3 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmaz_t" 
                        LET g_wc2_table4 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmac_t" 
                        LET g_wc2_table5 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmaf_t" 
                        LET g_wc2_table6 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmad_t" 
                        LET g_wc2_table7 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmae_t" 
                        LET g_wc2_table8 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
                  OR NOT cl_null(g_wc2_table2)
 
                  OR NOT cl_null(g_wc2_table3)
 
                  OR NOT cl_null(g_wc2_table4)
 
                  OR NOT cl_null(g_wc2_table5)
 
                  OR NOT cl_null(g_wc2_table6)
 
                  OR NOT cl_null(g_wc2_table7)
 
                  OR NOT cl_null(g_wc2_table8)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  #組合g_wc2
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
                  END IF
 
                  IF g_wc2_table3 <> " 1=1" AND NOT cl_null(g_wc2_table3) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
                  END IF
 
                  IF g_wc2_table4 <> " 1=1" AND NOT cl_null(g_wc2_table4) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
                  END IF
 
                  IF g_wc2_table5 <> " 1=1" AND NOT cl_null(g_wc2_table5) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table5
                  END IF
 
                  IF g_wc2_table6 <> " 1=1" AND NOT cl_null(g_wc2_table6) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table6
                  END IF
 
                  IF g_wc2_table7 <> " 1=1" AND NOT cl_null(g_wc2_table7) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table7
                  END IF
 
                  IF g_wc2_table8 <> " 1=1" AND NOT cl_null(g_wc2_table8) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table8
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
 
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
               END IF
               CALL apmm801_browser_fill("F")   #browser_fill()會將notice區塊清空
               CALL cl_notice()   #重新顯示,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            END IF
         
         #查詢方案選擇
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               INITIALIZE g_wc2_table2 TO NULL
 
               INITIALIZE g_wc2_table3 TO NULL
 
               INITIALIZE g_wc2_table4 TO NULL
 
               INITIALIZE g_wc2_table5 TO NULL
 
               INITIALIZE g_wc2_table6 TO NULL
 
               INITIALIZE g_wc2_table7 TO NULL
 
               INITIALIZE g_wc2_table8 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "pmaa_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "pmag_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "pmax_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmay_t" 
                        LET g_wc2_table3 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmaz_t" 
                        LET g_wc2_table4 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmac_t" 
                        LET g_wc2_table5 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmaf_t" 
                        LET g_wc2_table6 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmad_t" 
                        LET g_wc2_table7 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "pmae_t" 
                        LET g_wc2_table8 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1)
                  OR NOT cl_null(g_wc2_table2)
 
                  OR NOT cl_null(g_wc2_table3)
 
                  OR NOT cl_null(g_wc2_table4)
 
                  OR NOT cl_null(g_wc2_table5)
 
                  OR NOT cl_null(g_wc2_table6)
 
                  OR NOT cl_null(g_wc2_table7)
 
                  OR NOT cl_null(g_wc2_table8)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
                  END IF
 
                  IF g_wc2_table3 <> " 1=1" AND NOT cl_null(g_wc2_table3) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
                  END IF
 
                  IF g_wc2_table4 <> " 1=1" AND NOT cl_null(g_wc2_table4) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
                  END IF
 
                  IF g_wc2_table5 <> " 1=1" AND NOT cl_null(g_wc2_table5) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table5
                  END IF
 
                  IF g_wc2_table6 <> " 1=1" AND NOT cl_null(g_wc2_table6) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table6
                  END IF
 
                  IF g_wc2_table7 <> " 1=1" AND NOT cl_null(g_wc2_table7) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table7
                  END IF
 
                  IF g_wc2_table8 <> " 1=1" AND NOT cl_null(g_wc2_table8) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table8
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
                  #取得條件後需要重查、跳到結果第一筆資料的功能程式段
                  CALL apmm801_browser_fill("F")
                  IF g_browser_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "" 
                     LET g_errparam.code = "-100" 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     CLEAR FORM
                  ELSE
                     CALL apmm801_fetch("F")
                  END IF
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            CALL cl_notice()
          
         #應用 a49 樣板自動產生(Version:4)
            #過濾瀏覽頁資料
            ON ACTION filter
               LET g_action_choice = "fetch"
               #add-point:filter action name="ui_dialog.action.filter"
            
               #end add-point
               CALL apmm801_filter()
               EXIT DIALOG
 
 
 
         
         ON ACTION first
            LET g_action_choice = "fetch"
            CALL apmm801_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL apmm801_idx_chk()
            
         ON ACTION previous
            LET g_action_choice = "fetch"
            CALL apmm801_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL apmm801_idx_chk()
            
         ON ACTION jump
            LET g_action_choice = "fetch"
            CALL apmm801_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL apmm801_idx_chk()
            
         ON ACTION next
            LET g_action_choice = "fetch"
            CALL apmm801_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL apmm801_idx_chk()
            
         ON ACTION last
            LET g_action_choice = "fetch"
            CALL apmm801_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL apmm801_idx_chk()
          
         #excel匯出功能          
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               #browser
               CALL g_export_node.clear()
               IF g_main_hidden = 1 THEN
                  LET g_export_node[1] = base.typeInfo.create(g_browser)
                  LET g_export_id[1]   = "s_browse"
                  CALL cl_export_to_excel()
               #非browser
               ELSE
                  LET g_export_node[1] = base.typeInfo.create(g_pmag_d)
                  LET g_export_id[1]   = "s_detail1"
                  LET g_export_node[2] = base.typeInfo.create(g_pmag2_d)
                  LET g_export_id[2]   = "s_detail2"
                  LET g_export_node[3] = base.typeInfo.create(g_pmag3_d)
                  LET g_export_id[3]   = "s_detail3"
                  LET g_export_node[4] = base.typeInfo.create(g_pmag4_d)
                  LET g_export_id[4]   = "s_detail4"
                  LET g_export_node[5] = base.typeInfo.create(g_pmag5_d)
                  LET g_export_id[5]   = "s_detail5"
                  LET g_export_node[6] = base.typeInfo.create(g_pmag6_d)
                  LET g_export_id[6]   = "s_detail6"
                  LET g_export_node[7] = base.typeInfo.create(g_pmag7_d)
                  LET g_export_id[7]   = "s_detail7"
                  LET g_export_node[8] = base.typeInfo.create(g_pmag9_d)
                  LET g_export_id[8]   = "s_detail9"
 
                  #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel"
                  #ken---add---s 需求單號：150107-00009 項次：6
                  LET g_export_node[8] = base.typeInfo.create(g_pmba_d)
                  LET g_export_id[8]   = "s_detail1_aooi350_01"
                  LET g_export_node[9] = base.typeInfo.create(g_pmba2_d)
                  LET g_export_id[9]   = "s_detail1_aooi350_02"
                  #ken---add---e
                  #END add-point
                  CALL cl_export_to_excel_getpage()
                  CALL cl_export_to_excel()
               END IF
            END IF
        
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
    
         #主頁摺疊
         ON ACTION mainhidden       
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
               CALL cl_notice()
            END IF
            
         #瀏覽頁折疊
         ON ACTION worksheethidden   
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD pmag002
            END IF
       
         #單頭摺疊，可利用hot key "Alt-s"開啟/關閉單頭
         ON ACTION controls     
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL apmm801_modify()
               #add-point:ON ACTION modify name="menu.modify"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL apmm801_modify()
               #add-point:ON ACTION modify_detail name="menu.modify_detail"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page12
            LET g_action_choice="touch_page12"
            IF cl_auth_chk_act("touch_page12") THEN
               
               #add-point:ON ACTION touch_page12 name="menu.touch_page12"
               LET g_touch = 12   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page8
            LET g_action_choice="touch_page8"
            IF cl_auth_chk_act("touch_page8") THEN
               
               #add-point:ON ACTION touch_page8 name="menu.touch_page8"
               LET g_touch = 8   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION open_axmm202
            LET g_action_choice="open_axmm202"
            IF cl_auth_chk_act("open_axmm202") THEN
               
               #add-point:ON ACTION open_axmm202 name="menu.open_axmm202"
               #160810-00008#1 by lori add---(S)
               IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                  IF g_pmaa_m.pmaa002 <> '1' THEN
                     LET la_param.prog = 'axmm202'
                     LET la_param.param[1] = g_site
                     LET la_param.param[2] = g_pmaa_m.pmaa001  
                     LET ls_js = util.JSON.stringify( la_param)   #161109-00012#1 161109 by lori add
                     CALL cl_cmdrun(ls_js)                        #161109-00012#1 161109 by lori add
                  END IF  
                 #LET ls_js = util.JSON.stringify( la_param)   #161109-00012#1 161109 by lori mark
                 #CALL cl_cmdrun(ls_js)                        #161109-00012#1 161109 by lori mark
               END IF               
               #160810-00008#1 by lori add---(E)
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page10
            LET g_action_choice="touch_page10"
            IF cl_auth_chk_act("touch_page10") THEN
               
               #add-point:ON ACTION touch_page10 name="menu.touch_page10"
               LET g_touch = 10   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page5
            LET g_action_choice="touch_page5"
            IF cl_auth_chk_act("touch_page5") THEN
               
               #add-point:ON ACTION touch_page5 name="menu.touch_page5"
               LET g_touch = 5   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page9
            LET g_action_choice="touch_page9"
            IF cl_auth_chk_act("touch_page9") THEN
               
               #add-point:ON ACTION touch_page9 name="menu.touch_page9"
               LET g_touch = 9   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL apmm801_delete()
               #add-point:ON ACTION delete name="menu.delete"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL apmm801_insert()
               #add-point:ON ACTION insert name="menu.insert"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION modify_pmaa089
            LET g_action_choice="modify_pmaa089"
            IF cl_auth_chk_act("modify_pmaa089") THEN
               
               #add-point:ON ACTION modify_pmaa089 name="menu.modify_pmaa089"
                IF g_pmaa_m.pmaa001 IS NULL  THEN
                   INITIALIZE g_errparam TO NULL 
                   LET g_errparam.extend = "" 
                   LET g_errparam.code   = "std-00003" 
                   LET g_errparam.popup  = FALSE 
                   CALL cl_err()
                   RETURN
                else
                   if g_pmaa_m.pmaa089='Y' THEN
                      INITIALIZE g_errparam TO NULL 
                      LET g_errparam.extend = "" 
                      LET g_errparam.code   = "apm-01112" 
                      LET g_errparam.popup  = FALSE 
                      CALL cl_err()
                   else
                      let  g_pmaa_m.pmaa089='Y'
                      UPDATE pmaa_t SET pmaa089 = g_pmaa_m.pmaa089
                      WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001
                      DISPLAY BY NAME  g_pmaa_m.pmaa089                  
                   END IF
               end if 
                
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page11
            LET g_action_choice="touch_page11"
            IF cl_auth_chk_act("touch_page11") THEN
               
               #add-point:ON ACTION touch_page11 name="menu.touch_page11"
               LET g_touch = 11   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page13
            LET g_action_choice="touch_page13"
            IF cl_auth_chk_act("touch_page13") THEN
               
               #add-point:ON ACTION touch_page13 name="menu.touch_page13"
               LET g_touch = 13   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output name="menu.output"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION quickprint
            LET g_action_choice="quickprint"
            IF cl_auth_chk_act("quickprint") THEN
               
               #add-point:ON ACTION quickprint name="menu.quickprint"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL apmm801_reproduce()
               #add-point:ON ACTION reproduce name="menu.reproduce"
                                                                                          
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION open_axmm201
            LET g_action_choice="open_axmm201"
            IF cl_auth_chk_act("open_axmm201") THEN
               
               #add-point:ON ACTION open_axmm201 name="menu.open_axmm201"
               #160810-00008#1 by lori add---(S)
               IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                  IF g_pmaa_m.pmaa002 <> '1' THEN
                     LET la_param.prog = 'axmm201'
                     LET la_param.param[1] = g_pmaa_m.pmaa001
                     LET ls_js = util.JSON.stringify( la_param)   #161109-00012#1 161109 by lori add
                     CALL cl_cmdrun(ls_js)                        #161109-00012#1 161109 by lori add
                  END IF  
                 #LET ls_js = util.JSON.stringify( la_param)   #161109-00012#1 161109 by lori mark
                 #CALL cl_cmdrun(ls_js)                        #161109-00012#1 161109 by lori mark
               END IF               
               #160810-00008#1 by lori add---(E)
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL apmm801_query()
               #add-point:ON ACTION query name="menu.query"
                                                    
               #END add-point
               #應用 a59 樣板自動產生(Version:3)  
               CALL g_curr_diag.setCurrentRow("s_detail1",1)
               CALL g_curr_diag.setCurrentRow("s_detail2",1)
               CALL g_curr_diag.setCurrentRow("s_detail3",1)
               CALL g_curr_diag.setCurrentRow("s_detail4",1)
               CALL g_curr_diag.setCurrentRow("s_detail5",1)
               CALL g_curr_diag.setCurrentRow("s_detail6",1)
               CALL g_curr_diag.setCurrentRow("s_detail7",1)
               CALL g_curr_diag.setCurrentRow("s_detail9",1)
 
 
 
 
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page2
            LET g_action_choice="touch_page2"
            IF cl_auth_chk_act("touch_page2") THEN
               
               #add-point:ON ACTION touch_page2 name="menu.touch_page2"
               LET g_touch = 2   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION ins_pmab
            LET g_action_choice="ins_pmab"
            IF cl_auth_chk_act("ins_pmab") THEN
               
               #add-point:ON ACTION ins_pmab name="menu.ins_pmab"
               CALL s_pmab_ins_pmab()   #160511-00037#4 20160519 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION open_aooi350
            LET g_action_choice="open_aooi350"
            IF cl_auth_chk_act("open_aooi350") THEN
               
               #add-point:ON ACTION open_aooi350 name="menu.open_aooi350"
              
#               IF (NOT cl_null(g_pmaa_m.pmaa001)) AND (NOT cl_null(g_pmaa_m.pmaa027)) THEN
#                  LET l_cmd = "aooi350 '"||g_pmaa_m.pmaa027||"'"
#                  CALL cl_cmdrun_wait(l_cmd)
#               END IF  
               IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                  CASE g_pmaa_m.pmaa002
                     WHEN '1' LET la_param.prog = 'apmi100'
                              LET la_param.param[1] = g_pmaa_m.pmaa001
                              LET ls_js = util.JSON.stringify( la_param )                      
                     WHEN '2' LET la_param.prog = 'axmi100'
                              LET la_param.param[1] = g_pmaa_m.pmaa001
                              LET ls_js = util.JSON.stringify( la_param )
                     WHEN '3' LET la_param.prog = 'apmi005'
                              LET la_param.param[1] = g_pmaa_m.pmaa001
                              LET ls_js = util.JSON.stringify( la_param )
                  END CASE
                  CALL cl_cmdrun(ls_js)
               END IF
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page1
            LET g_action_choice="touch_page1"
            IF cl_auth_chk_act("touch_page1") THEN
               
               #add-point:ON ACTION touch_page1 name="menu.touch_page1"
               LET g_touch = 1   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page4
            LET g_action_choice="touch_page4"
            IF cl_auth_chk_act("touch_page4") THEN
               
               #add-point:ON ACTION touch_page4 name="menu.touch_page4"
               LET g_touch = 4   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION modify_credit
            LET g_action_choice="modify_credit"
            IF cl_auth_chk_act("modify_credit") THEN
               
               #add-point:ON ACTION modify_credit name="menu.modify_credit"
               CALL apmm801_input2('u')
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page3
            LET g_action_choice="touch_page3"
            IF cl_auth_chk_act("touch_page3") THEN
               
               #add-point:ON ACTION touch_page3 name="menu.touch_page3"
               LET g_touch = 3   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page6
            LET g_action_choice="touch_page6"
            IF cl_auth_chk_act("touch_page6") THEN
               
               #add-point:ON ACTION touch_page6 name="menu.touch_page6"
               LET g_touch = 6   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION touch_page7
            LET g_action_choice="touch_page7"
            IF cl_auth_chk_act("touch_page7") THEN
               
               #add-point:ON ACTION touch_page7 name="menu.touch_page7"
               LET g_touch = 7   #150915-00006#1 20150915 add by beckxie
               #END add-point
               
            END IF
 
 
 
 
         
         #應用 a46 樣板自動產生(Version:3)
         #新增相關文件
         ON ACTION related_document
            CALL apmm801_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document name="ui_dialog.dialog.related_document"
               
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL apmm801_set_pk_array()
            #add-point:ON ACTION agendum name="ui_dialog.dialog.agendum"
            
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL apmm801_set_pk_array()
            #add-point:ON ACTION followup name="ui_dialog.dialog.followup"
            
            #END add-point
            CALL cl_user_overview_follow('')
 
 
 
         
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
    
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
      END DIALOG
 
      #(ver:79) ---add start---
      #add-point:ui_dialog段 after dialog name="ui_dialog.exit_dialog"
      
      #end add-point
      #(ver:79) --- add end ---
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         #add-point:ui_dialog段離開dialog前 name="ui_dialog.b_exit"
         
         #end add-point
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
 
{</section>}
 
{<section id="apmm801.browser_fill" >}
#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION apmm801_browser_fill(ps_page_action)
   #add-point:browser_fill段define(客製用) name="browser_fill.define_customerization"
   
   #end add-point  
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   #add-point:browser_fill段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="browser_fill.define"
                  
   #end add-point    
   
   #add-point:Function前置處理 name="browser_fill.before_browser_fill"
   #150127-00003#1 Mark-S By Ken 150426
   #CALL aooi350_01_clear_detail()  
   #CALL aooi350_02_clear_detail() 
   #150127-00003#1 Mark-E
   #end add-point
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前 name="browser_fill.before_foreach"
 
   #end add-point
   
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT DISTINCT pmaa001 ",
                      " FROM pmaa_t ",
                      " ",
                      " LEFT JOIN pmag_t ON pmagent = pmaaent AND pmaa001 = pmag001 ", "  ",
                      #add-point:browser_fill段sql(pmag_t1) name="browser_fill.cnt.join.}"
 
                      #end add-point
                      " LEFT JOIN pmax_t ON pmaxent = pmaaent AND pmaa001 = pmax001", "  ",
                      #add-point:browser_fill段sql(pmax_t1) name="browser_fill.cnt.join.pmax_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmay_t ON pmayent = pmaaent AND pmaa001 = pmay001", "  ",
                      #add-point:browser_fill段sql(pmay_t1) name="browser_fill.cnt.join.pmay_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmaz_t ON pmazent = pmaaent AND pmaa001 = pmaz001", "  ",
                      #add-point:browser_fill段sql(pmaz_t1) name="browser_fill.cnt.join.pmaz_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmac_t ON pmacent = pmaaent AND pmaa001 = pmac001", "  ",
                      #add-point:browser_fill段sql(pmac_t1) name="browser_fill.cnt.join.pmac_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmaf_t ON pmafent = pmaaent AND pmaa001 = pmaf001", "  ",
                      #add-point:browser_fill段sql(pmaf_t1) name="browser_fill.cnt.join.pmaf_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmad_t ON pmadent = pmaaent AND pmaa001 = pmad001", "  ",
                      #add-point:browser_fill段sql(pmad_t1) name="browser_fill.cnt.join.pmad_t1"
                      
                      #end add-point
 
                      " LEFT JOIN pmae_t ON pmaeent = pmaaent AND pmaa001 = pmae001", "  ",
                      #add-point:browser_fill段sql(pmae_t1) name="browser_fill.cnt.join.pmae_t1"
                      
                      #end add-point
 
 
 
                      " LEFT JOIN pmaal_t ON pmaalent = "||g_enterprise||" AND pmaa001 = pmaal001 AND pmaal002 = '",g_dlang,"' ", 
                      " ", 
                      " ",                      
 
                      " ",                      
 
                      " ",                      
 
                      " ",                      
 
                      " ",                      
 
                      " ",                      
 
                      " ",                      
 
 
 
                      " WHERE pmaaent = " ||g_enterprise|| " AND pmagent = " ||g_enterprise|| " AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("pmaa_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT DISTINCT pmaa001 ",
                      " FROM pmaa_t ", 
                      "  ",
                      "  LEFT JOIN pmaal_t ON pmaalent = "||g_enterprise||" AND pmaa001 = pmaal001 AND pmaal002 = '",g_dlang,"' ",
                      " WHERE pmaaent = " ||g_enterprise|| " AND ",l_wc CLIPPED, cl_sql_add_filter("pmaa_t")
   END IF
   
   #add-point:browser_fill,cnt wc name="browser_fill.cnt_sqlwc"
   
   #end add-point
   
   LET g_sql = " SELECT COUNT(1) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前 name="browser_fill.before_count"
                     IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE pmaa001 ",
                        " FROM pmaa_t ",
                              " LEFT JOIN pmab_t ON pmaaent = pmabent AND pmabsite = 'ALL' AND pmaa001 = pmab001", #sakura add
                              " LEFT JOIN pmag_t ON pmagent = pmaaent AND pmaa001 = pmag001 ",
                              " LEFT JOIN pmax_t ON pmaxent = pmaaent AND pmaa001 = pmax001", 
                              " LEFT JOIN pmay_t ON pmayent = pmaaent AND pmaa001 = pmay001", 
                              " LEFT JOIN pmaz_t ON pmazent = pmaaent AND pmaa001 = pmaz001", 
                              " LEFT JOIN pmac_t ON pmacent = pmaaent AND pmaa001 = pmac001", 
                              " LEFT JOIN pmaf_t ON pmafent = pmaaent AND pmaa001 = pmaf001", 
                              " LEFT JOIN pmad_t ON pmadent = pmaaent AND pmaa001 = pmad001", 
                              " LEFT JOIN oofb_t ON oofbent = pmaaent AND pmaa027 = oofb002", 
                              " LEFT JOIN oofc_t ON oofcent = pmaaent AND pmaa027 = oofc002", 
                              " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ", 
                       " WHERE pmaaent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE pmaa001 ",
                        " FROM pmaa_t ", 
                              " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
                        "WHERE pmaaent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED
   END IF
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   #end add-point
   
   IF g_sql.getIndexOf(" 1=2",1) THEN
      DISPLAY "INFO: 1=2 jumped!"
   ELSE
      PREPARE header_cnt_pre FROM g_sql
      EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
      FREE header_cnt_pre
   END IF
    
   IF g_browser_cnt > g_max_browse THEN
      IF g_error_show = 1 THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_browser_cnt
         LET g_errparam.code = 9035 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
      END IF
      LET g_browser_cnt = g_max_browse
   END IF
   
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #根據行為確定資料填充位置及WC
   IF cl_null(g_add_browse) THEN
      #清除畫面
      CLEAR FORM                
      INITIALIZE g_pmaa_m.* TO NULL
      CALL g_pmag_d.clear()        
      CALL g_pmag2_d.clear() 
      CALL g_pmag3_d.clear() 
      CALL g_pmag4_d.clear() 
      CALL g_pmag5_d.clear() 
      CALL g_pmag6_d.clear() 
      CALL g_pmag7_d.clear() 
      CALL g_pmag9_d.clear() 
 
      #add-point:browser_fill g_add_browse段額外處理 name="browser_fill.add_browse.other"
      
      #end add-point   
      CALL g_browser.clear()
      LET g_cnt = 1
   ELSE
      LET l_wc  = g_add_browse
      LET l_wc2 = " 1=1" 
      LET g_cnt = g_current_idx
   END IF
 
   #依照t0.pmaa001,t0.pmaa002,t0.pmaa003 Browser欄位定義(取代原本bs_sql功能)
   #考量到單身可能下條件, 所以此處需join單身所有table
   #DISTINCT是為了避免在join時出現重複的資料(如果不加DISTINCT則須在程式中過濾)
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件   
      LET g_sql = " SELECT DISTINCT t0.pmaastus,t0.pmaa001,t0.pmaa002,t0.pmaa003,t1.pmaal003 ",
                  " FROM pmaa_t t0",
                  "  ",
                  "  LEFT JOIN pmag_t ON pmagent = pmaaent AND pmaa001 = pmag001 ", "  ", 
                  #add-point:browser_fill段sql(pmag_t1) name="browser_fill.join.pmag_t1"
               " LEFT JOIN pmab_t ON pmaaent = pmabent AND pmabsite = 'ALL' AND pmaa001 = pmab001", #sakura add
                  #end add-point
                  "  LEFT JOIN pmax_t ON pmaxent = pmaaent AND pmaa001 = pmax001", "  ", 
                  #add-point:browser_fill段sql(pmax_t1) name="browser_fill.join.pmax_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmay_t ON pmayent = pmaaent AND pmaa001 = pmay001", "  ", 
                  #add-point:browser_fill段sql(pmay_t1) name="browser_fill.join.pmay_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmaz_t ON pmazent = pmaaent AND pmaa001 = pmaz001", "  ", 
                  #add-point:browser_fill段sql(pmaz_t1) name="browser_fill.join.pmaz_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmac_t ON pmacent = pmaaent AND pmaa001 = pmac001", "  ", 
                  #add-point:browser_fill段sql(pmac_t1) name="browser_fill.join.pmac_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmaf_t ON pmafent = pmaaent AND pmaa001 = pmaf001", "  ", 
                  #add-point:browser_fill段sql(pmaf_t1) name="browser_fill.join.pmaf_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmad_t ON pmadent = pmaaent AND pmaa001 = pmad001", "  ", 
                  #add-point:browser_fill段sql(pmad_t1) name="browser_fill.join.pmad_t1"
                  
                  #end add-point
 
                  "  LEFT JOIN pmae_t ON pmaeent = pmaaent AND pmaa001 = pmae001", "  ", 
                  #add-point:browser_fill段sql(pmae_t1) name="browser_fill.join.pmae_t1"
                  
                  #end add-point
 
 
 
                  " ", 
                  " ",                      
 
                  " ",                      
 
                  " ",                      
 
                  " ",                      
 
                  " ",                      
 
                  " ",                      
 
                  " ",                      
 
 
 
                                 " LEFT JOIN pmaal_t t1 ON t1.pmaalent="||g_enterprise||" AND t1.pmaal001=t0.pmaa001 AND t1.pmaal002='"||g_dlang||"' ",
 
                  " WHERE t0.pmaaent = " ||g_enterprise|| " AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("pmaa_t")
   ELSE
      #單身無輸入搜尋條件   
      LET g_sql = " SELECT DISTINCT t0.pmaastus,t0.pmaa001,t0.pmaa002,t0.pmaa003,t1.pmaal003 ",
                  " FROM pmaa_t t0",
                  "  ",
                                 " LEFT JOIN pmaal_t t1 ON t1.pmaalent="||g_enterprise||" AND t1.pmaal001=t0.pmaa001 AND t1.pmaal002='"||g_dlang||"' ",
 
                  " WHERE t0.pmaaent = " ||g_enterprise|| " AND ",l_wc, cl_sql_add_filter("pmaa_t")
   END IF
   #add-point:browser_fill,sql wc name="browser_fill.fill_sqlwc"
   
   #end add-point
   LET g_sql = g_sql, " ORDER BY pmaa001 ",g_order
 
   #add-point:browser_fill,before_prepare name="browser_fill.before_prepare"
#                     IF g_wc2 <> " 1=1" THEN
#      #單身有輸入搜尋條件                      
#      LET l_sub_sql = " SELECT UNIQUE pmaa001 ",
#                        " FROM pmaa_t ",
#                              " LEFT JOIN pmag_t ON pmagent = pmaaent AND pmaa001 = pmag001 ",
#                              " LEFT JOIN pmax_t ON pmaxent = pmaaent AND pmaa001 = pmax001", 
#                              " LEFT JOIN pmay_t ON pmayent = pmaaent AND pmaa001 = pmay001", 
#                              " LEFT JOIN pmaz_t ON pmazent = pmaaent AND pmaa001 = pmaz001", 
#                              " LEFT JOIN pmac_t ON pmacent = pmaaent AND pmaa001 = pmac001", 
#                              " LEFT JOIN pmaf_t ON pmafent = pmaaent AND pmaa001 = pmaf001", 
#                              " LEFT JOIN pmad_t ON pmadent = pmaaent AND pmaa001 = pmad001", 
#                              " LEFT JOIN oofb_t ON oofbent = pmaaent AND pmaa027 = oofb002", 
#                              " LEFT JOIN oofc_t ON oofcent = pmaaent AND pmaa027 = oofc002", 
#                              " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ", 
#                       " WHERE pmaaent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2
#   ELSE
#      #單身未輸入搜尋條件
#      LET l_sub_sql = " SELECT UNIQUE pmaa001 ",
#                        " FROM pmaa_t ", 
#                              " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
#                        "WHERE pmaaent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED
#   END IF
#   
#   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
#
#
#   IF g_wc2 <> " 1=1" AND NOT cl_null(g_wc2) THEN 
#      #依照pmaa001,pmaa002 Browser欄位定義(取代原本bs_sql功能)
#      LET l_sql_rank = "SELECT DISTINCT pmaastus,pmaa001,pmaa002,pmaa003,DENSE_RANK() OVER(ORDER BY pmaa001 ", 
#          g_order,") AS RANK ",
#                        " FROM pmaa_t ",
#                              " ",
#                              " LEFT JOIN pmag_t ON pmagent = pmaaent AND pmaa001 = pmag001 ",
#                              " LEFT JOIN pmax_t ON pmaxent = pmaaent AND pmaa001 = pmax001",
#                              " LEFT JOIN pmay_t ON pmayent = pmaaent AND pmaa001 = pmay001",
#                              " LEFT JOIN pmaz_t ON pmazent = pmaaent AND pmaa001 = pmaz001",
#                              " LEFT JOIN pmac_t ON pmacent = pmaaent AND pmaa001 = pmac001",
#                              " LEFT JOIN pmaf_t ON pmafent = pmaaent AND pmaa001 = pmaf001",
#                              " LEFT JOIN pmad_t ON pmadent = pmaaent AND pmaa001 = pmad001",
#                              " LEFT JOIN oofb_t ON oofbent = pmaaent AND pmaa027 = oofb002", 
#                              " LEFT JOIN oofc_t ON oofcent = pmaaent AND pmaa027 = oofc002", 
#                              " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
#                       " WHERE pmaaent = '" ||g_enterprise|| "' AND ",g_wc," AND ",g_wc2
#   ELSE
#      #單身無輸入資料
#      LET l_sql_rank = "SELECT DISTINCT pmaastus,pmaa001,pmaa002,pmaa003,DENSE_RANK() OVER(ORDER BY pmaa001 ", 
#          g_order,") AS RANK ",
#                       " FROM pmaa_t ",
#                            "  ",
#                            "  LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
#                       " WHERE pmaaent = '" ||g_enterprise|| "' AND ", g_wc
#   END IF
#   
#   #定義翻頁CURSOR
#   LET g_sql= "SELECT pmaastus,pmaa001,pmaa002,pmaa003 FROM (",l_sql_rank,") WHERE ", 
#
#              " RANK >= ",1," AND RANK<",1+g_max_browse,
#              " ORDER BY ",l_searchcol," ",g_order
   #end add-point
        
   #LET g_sql = cl_sql_add_tabid(g_sql,"pmaa_t") #WC重組
   LET g_sql = cl_sql_add_mask(g_sql) #遮蔽特定資料
   
   IF g_sql.getIndexOf(" 1=2",1) THEN
      DISPLAY "INFO: 1=2 jumped!"
   ELSE
      PREPARE browse_pre FROM g_sql
      DECLARE browse_cur CURSOR FOR browse_pre
      
      #add-point:browser_fill段open cursor name="browser_fill.open"
                  
      #end add-point
      
      FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_pmaa001,g_browser[g_cnt].b_pmaa002, 
          g_browser[g_cnt].b_pmaa003,g_browser[g_cnt].b_pmaa001_desc
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "Foreach:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
      
         #add-point:browser_fill段reference name="browser_fill.reference"
      #150312-00003#2 Add-S By Ken 150317 原browser的簡稱欄位是reference 改為FORMONLY再抓值
      CALL s_desc_get_trading_partner_abbr_desc(g_browser[g_cnt].b_pmaa001) 
        RETURNING g_browser[g_cnt].b_pmaa001_desc_desc
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa001_desc_desc
      select count(stje008) into g_browser[g_cnt].b_num from stje_t 
      where stjeent=g_enterprise  and stje007=g_browser[g_cnt].b_pmaa001  and stje005 in ('1','2','3','4','5')
      if cl_null(g_browser[g_cnt].b_num) then 
         let g_browser[g_cnt].b_num=0
      end if 
      #150312-00003#2 Add-E
         #end add-point
      
         #遮罩相關處理
         CALL apmm801_browser_mask()
      
               #應用 a24 樣板自動產生(Version:3)
      #browser顯示圖片
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/open.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/valid.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/void.png"
         
      END CASE
 
 
 
         LET g_cnt = g_cnt + 1
         IF g_cnt > g_max_browse THEN
            EXIT FOREACH
         END IF
         
      END FOREACH
      FREE browse_pre
   END IF
   
   #清空g_add_browse, 並指定指標位置
   IF NOT cl_null(g_add_browse) THEN
      LET g_add_browse = ""
      CALL g_curr_diag.setCurrentRow("s_browse",g_current_idx)
   END IF
   
   IF cl_null(g_browser[g_cnt].b_pmaa001) THEN
      CALL g_browser.deleteElement(g_cnt)
   END IF
   
   LET g_header_cnt  = g_browser.getLength()
   LET g_browser_cnt = g_browser.getLength()
   
   #筆數顯示
   IF g_browser_cnt > 0 THEN
      DISPLAY g_browser_idx TO FORMONLY.b_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.b_count #總筆數
      DISPLAY g_browser_idx TO FORMONLY.h_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.h_count #總筆數
      DISPLAY g_detail_idx  TO FORMONLY.idx     #單身當下筆數
      DISPLAY g_detail_cnt  TO FORMONLY.cnt     #單身總筆數
   ELSE
      DISPLAY '' TO FORMONLY.b_index #當下筆數
      DISPLAY '' TO FORMONLY.b_count #總筆數
      DISPLAY '' TO FORMONLY.h_index #當下筆數
      DISPLAY '' TO FORMONLY.h_count #總筆數
      DISPLAY '' TO FORMONLY.idx     #單身當下筆數
      DISPLAY '' TO FORMONLY.cnt     #單身總筆數
   END IF
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
 
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
                  
   
   #add-point:browser_fill段結束前 name="browser_fill.after"
                  
   #end add-point   
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.ui_headershow" >}
#+ 單頭資料重新顯示
PRIVATE FUNCTION apmm801_ui_headershow()
   #add-point:ui_headershow段define(客製用) name="ui_headershow.define_customerization"
   
   #end add-point  
   #add-point:ui_headershow段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="ui_headershow.define"
                  
   #end add-point      
   
   #add-point:Function前置處理  name="ui_headershow.pre_function"
 
   #end add-point
   
   LET g_pmaa_m.pmaa001 = g_browser[g_current_idx].b_pmaa001   
 
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
   CALL apmm801_pmaa_t_mask()
   CALL apmm801_show()
      
END FUNCTION
 
{</section>}
 
{<section id="apmm801.ui_detailshow" >}
#+ 單身資料重新顯示
PRIVATE FUNCTION apmm801_ui_detailshow()
   #add-point:ui_detailshow段define(客製用) name="ui_detailshow.define_customerization"
   
   #end add-point    
   #add-point:ui_detailshow段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="ui_detailshow.define"
                  
   #end add-point    
 
   #add-point:Function前置處理 name="ui_detailshow.before"
                  
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail2",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail5",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail6",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail7",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail9",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after name="ui_detailshow.after"
                  
   #end add-point    
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.ui_browser_refresh" >}
#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION apmm801_ui_browser_refresh()
   #add-point:ui_browser_refresh段define(客製用) name="ui_browser_refresh.define_customerization"
   
   #end add-point    
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="ui_browser_refresh.define"
                  
   #end add-point    
   
   #add-point:Function前置處理  name="ui_browser_refresh.pre_function"
   
   #end add-point
   
   LET g_browser_cnt = g_browser.getLength()
   LET g_header_cnt  = g_browser.getLength()
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_pmaa001 = g_pmaa_m.pmaa001 
 
         THEN
         CALL g_browser.deleteElement(l_i)
         EXIT FOR
      END IF
   END FOR
   LET g_browser_cnt = g_browser_cnt - 1
   LET g_header_cnt = g_header_cnt - 1
    
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
      CLEAR FORM
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
   
   #add-point:ui_browser_refresh段after name="ui_browser_refresh.after"
   
   #end add-point    
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.construct" >}
#+ QBE資料查詢
PRIVATE FUNCTION apmm801_construct()
   #add-point:cs段define(客製用) name="cs.define_customerization"
   
   #end add-point    
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   DEFINE la_wc       DYNAMIC ARRAY OF RECORD
          tableid     STRING,
          wc          STRING
          END RECORD
   DEFINE li_idx      LIKE type_t.num10
   #add-point:cs段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="cs.define"
                  
   #end add-point    
   
   #add-point:Function前置處理  name="cs.pre_function"
   
   #end add-point
    
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_pmaa_m.* TO NULL
   CALL g_pmag_d.clear()        
   CALL g_pmag2_d.clear() 
   CALL g_pmag3_d.clear() 
   CALL g_pmag4_d.clear() 
   CALL g_pmag5_d.clear() 
   CALL g_pmag6_d.clear() 
   CALL g_pmag7_d.clear() 
   CALL g_pmag9_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
   INITIALIZE g_wc2_table2 TO NULL
 
   INITIALIZE g_wc2_table3 TO NULL
 
   INITIALIZE g_wc2_table4 TO NULL
 
   INITIALIZE g_wc2_table5 TO NULL
 
   INITIALIZE g_wc2_table6 TO NULL
 
   INITIALIZE g_wc2_table7 TO NULL
 
   INITIALIZE g_wc2_table8 TO NULL
 
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前 name="cs.before_construct"
   CALL g_pmag8_d.clear()           
  #INITIALIZE g_wc2_table8 TO NULL    #160810-00008#1 160819 by lori mark
   INITIALIZE g_wc2_pmad TO NULL      #160810-00008#1 160819 by lori add
   
   INITIALIZE g_pmaa027_d TO NULL
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()
   #查询时生命周期下拉框
   CALL s_life_cycle_display('ALL','pmaa083','2') #生命类型  #Add By geza 150323
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON pmaa001,pmaa002,pmaa089,pmaal004,pmaal003,pmaal006,pmaal005,pmaa003, 
          pmaastus,pmaa004,pmaa005,pmaa006,pmaa026,pmaa200,pmaa201,pmaa202,pmaa017,pmaa016,pmaa018,pmaa019, 
          pmaa021,pmaa022,pmaa020,pmaa023,pmaa024,pmaa025,pmaa007,pmaa008,pmaa009,pmaa010,pmaa011,pmaa027, 
          pmaa230,pmaa231,pmaa231_desc,pmaa232,pmaa090,pmaa091,pmaa092,pmaa094,pmaa093,pmaa096,pmaa097, 
          pmaa241,pmaa242,pmaa243,pmaa244,pmaa245,pmaa245_desc,pmaa246,pmaa247,pmaa248,pmaa095,pmaa220, 
          pmaa221,pmaa221_desc,pmaa222,pmaa080,pmaa084,pmaa083,pmaa086,pmaa085,pmaa051,pmaa052,pmaa053, 
          pmaa054,pmaa055,pmaa056,pmaa057,pmaa058,pmaa074,pmaa059,pmaa075,pmaa047,pmaa036,pmaa037,pmaa038, 
          pmaa039,pmaa040,pmaa041,pmaa042,pmaa043,pmaa044,pmaa045,pmaa046,pmaa068,pmaa069,pmaa072,pmaa070, 
          pmaa071,pmaa073,pmaa204,pmaa205,pmaa206,pmab032,pmab057,pmab058,pmab053,pmab039,pmaa081,pmab033, 
          pmab034,pmab034_desc,pmab035,pmab056,pmab056_desc,pmab037,pmab055,pmab038,pmab038_desc,pmab040, 
          pmab041,pmab042,pmab043,pmab044,pmab045,pmab046,pmab047,pmab048,pmab049,l_pmab050,pmab051, 
          l_pmab052,pmab080,pmab082,pmab083,pmab084,pmab084_desc,pmab103,pmab104,pmab085,pmab106,pmab106_desc, 
          pmab087,pmab105,pmab088,pmab088_desc,pmab089,pmab107,pmab108,pmab090,pmab091,pmab092,pmab093, 
          pmab094,pmab095,pmab096,pmab097,pmab098,pmab099,l_pmab100,pmab101,l_pmab102,ooff013,pmaaownid, 
          pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,pmaamodid,pmaamoddt,pmaacnfid,pmaacnfdt,pmaa270,pmaa271, 
          pmaa272,day01,day02,day03,day04,day05,day06,day07,day08,day09,day10,day11,day12,day13,day14, 
          day15,day16,day17,day18,day19,day20,day21,day22,day23,day24,day25,day26,day27,day28,day29, 
          day30,day31,week01,week02,week03,week04,week05,week06,week07,pmaa274,pmaa275,pmaa276,pmaa281, 
          pmaa282,pmaa283,pmaa284,pmaa285,pmaa286,pmaa287,pmaa288,pmaa289,pmaa290,pmaa291,pmaa292,pmaa293, 
          pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.head.before_construct"
                                                                        
            #end add-point 
            
         #公用欄位開窗相關處理
         #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmaacrtdt>>----
         AFTER FIELD pmaacrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
 
         #----<<pmaamoddt>>----
         AFTER FIELD pmaamoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<pmaacnfdt>>----
         AFTER FIELD pmaacnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<pmaapstdt>>----
 
 
 
            
         #一般欄位開窗相關處理    
                  #Ctrlp:construct.c.pmaa001
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa001
            #add-point:ON ACTION controlp INFIELD pmaa001 name="construct.c.pmaa001"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            #CALL q_pmaa001()                          #呼叫開窗    #160908-00032#2 mark by rainy
            CALL q_pmaa001_4()                        #呼叫開窗    #160908-00032#2 by rainy 開窗改為 q_pmaa001_4()
            DISPLAY g_qryparam.return1 TO pmaa001  #顯示到畫面上

            NEXT FIELD pmaa001                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa001
            #add-point:BEFORE FIELD pmaa001 name="construct.b.pmaa001"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa001
            
            #add-point:AFTER FIELD pmaa001 name="construct.a.pmaa001"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa002
            #add-point:BEFORE FIELD pmaa002 name="construct.b.pmaa002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa002
            
            #add-point:AFTER FIELD pmaa002 name="construct.a.pmaa002"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa002
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa002
            #add-point:ON ACTION controlp INFIELD pmaa002 name="construct.c.pmaa002"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa089
            #add-point:BEFORE FIELD pmaa089 name="construct.b.pmaa089"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa089
            
            #add-point:AFTER FIELD pmaa089 name="construct.a.pmaa089"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa089
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa089
            #add-point:ON ACTION controlp INFIELD pmaa089 name="construct.c.pmaa089"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal004
            #add-point:BEFORE FIELD pmaal004 name="construct.b.pmaal004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal004
            
            #add-point:AFTER FIELD pmaal004 name="construct.a.pmaal004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaal004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal004
            #add-point:ON ACTION controlp INFIELD pmaal004 name="construct.c.pmaal004"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal003
            #add-point:BEFORE FIELD pmaal003 name="construct.b.pmaal003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal003
            
            #add-point:AFTER FIELD pmaal003 name="construct.a.pmaal003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaal003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal003
            #add-point:ON ACTION controlp INFIELD pmaal003 name="construct.c.pmaal003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal006
            #add-point:BEFORE FIELD pmaal006 name="construct.b.pmaal006"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal006
            
            #add-point:AFTER FIELD pmaal006 name="construct.a.pmaal006"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaal006
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal006
            #add-point:ON ACTION controlp INFIELD pmaal006 name="construct.c.pmaal006"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal005
            #add-point:BEFORE FIELD pmaal005 name="construct.b.pmaal005"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal005
            
            #add-point:AFTER FIELD pmaal005 name="construct.a.pmaal005"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaal005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal005
            #add-point:ON ACTION controlp INFIELD pmaal005 name="construct.c.pmaal005"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa003
            #add-point:BEFORE FIELD pmaa003 name="construct.b.pmaa003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa003
            
            #add-point:AFTER FIELD pmaa003 name="construct.a.pmaa003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa003
            #add-point:ON ACTION controlp INFIELD pmaa003 name="construct.c.pmaa003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaastus
            #add-point:BEFORE FIELD pmaastus name="construct.b.pmaastus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaastus
            
            #add-point:AFTER FIELD pmaastus name="construct.a.pmaastus"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaastus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaastus
            #add-point:ON ACTION controlp INFIELD pmaastus name="construct.c.pmaastus"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa004
            #add-point:BEFORE FIELD pmaa004 name="construct.b.pmaa004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa004
            
            #add-point:AFTER FIELD pmaa004 name="construct.a.pmaa004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa004
            #add-point:ON ACTION controlp INFIELD pmaa004 name="construct.c.pmaa004"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa005
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa005
            #add-point:ON ACTION controlp INFIELD pmaa005 name="construct.c.pmaa005"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE			
            CALL q_pmaa001_14()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa005  #顯示到畫面上
            NEXT FIELD pmaa005                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa005
            #add-point:BEFORE FIELD pmaa005 name="construct.b.pmaa005"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa005
            
            #add-point:AFTER FIELD pmaa005 name="construct.a.pmaa005"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa006
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa006
            #add-point:ON ACTION controlp INFIELD pmaa006 name="construct.c.pmaa006"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '261'
            CALL q_oocq002()                            #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa006  #顯示到畫面上

            NEXT FIELD pmaa006                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa006
            #add-point:BEFORE FIELD pmaa006 name="construct.b.pmaa006"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa006
            
            #add-point:AFTER FIELD pmaa006 name="construct.a.pmaa006"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa026
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa026
            #add-point:ON ACTION controlp INFIELD pmaa026 name="construct.c.pmaa026"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '250'
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa026  #顯示到畫面上
            NEXT FIELD pmaa026                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa026
            #add-point:BEFORE FIELD pmaa026 name="construct.b.pmaa026"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa026
            
            #add-point:AFTER FIELD pmaa026 name="construct.a.pmaa026"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa200
            #add-point:BEFORE FIELD pmaa200 name="construct.b.pmaa200"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa200
            
            #add-point:AFTER FIELD pmaa200 name="construct.a.pmaa200"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa200
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa200
            #add-point:ON ACTION controlp INFIELD pmaa200 name="construct.c.pmaa200"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa201
            #add-point:BEFORE FIELD pmaa201 name="construct.b.pmaa201"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa201
            
            #add-point:AFTER FIELD pmaa201 name="construct.a.pmaa201"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa201
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa201
            #add-point:ON ACTION controlp INFIELD pmaa201 name="construct.c.pmaa201"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa202
            #add-point:BEFORE FIELD pmaa202 name="construct.b.pmaa202"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa202
            
            #add-point:AFTER FIELD pmaa202 name="construct.a.pmaa202"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa202
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa202
            #add-point:ON ACTION controlp INFIELD pmaa202 name="construct.c.pmaa202"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa017
            #add-point:BEFORE FIELD pmaa017 name="construct.b.pmaa017"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa017
            
            #add-point:AFTER FIELD pmaa017 name="construct.a.pmaa017"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa017
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa017
            #add-point:ON ACTION controlp INFIELD pmaa017 name="construct.c.pmaa017"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa016
            #add-point:BEFORE FIELD pmaa016 name="construct.b.pmaa016"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa016
            
            #add-point:AFTER FIELD pmaa016 name="construct.a.pmaa016"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa016
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa016
            #add-point:ON ACTION controlp INFIELD pmaa016 name="construct.c.pmaa016"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa018
            #add-point:BEFORE FIELD pmaa018 name="construct.b.pmaa018"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa018
            
            #add-point:AFTER FIELD pmaa018 name="construct.a.pmaa018"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa018
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa018
            #add-point:ON ACTION controlp INFIELD pmaa018 name="construct.c.pmaa018"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa019
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa019
            #add-point:ON ACTION controlp INFIELD pmaa019 name="construct.c.pmaa019"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa019  #顯示到畫面上
            NEXT FIELD pmaa019                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa019
            #add-point:BEFORE FIELD pmaa019 name="construct.b.pmaa019"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa019
            
            #add-point:AFTER FIELD pmaa019 name="construct.a.pmaa019"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa021
            #add-point:BEFORE FIELD pmaa021 name="construct.b.pmaa021"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa021
            
            #add-point:AFTER FIELD pmaa021 name="construct.a.pmaa021"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa021
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa021
            #add-point:ON ACTION controlp INFIELD pmaa021 name="construct.c.pmaa021"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa022
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa022
            #add-point:ON ACTION controlp INFIELD pmaa022 name="construct.c.pmaa022"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa022  #顯示到畫面上
            NEXT FIELD pmaa022                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa022
            #add-point:BEFORE FIELD pmaa022 name="construct.b.pmaa022"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa022
            
            #add-point:AFTER FIELD pmaa022 name="construct.a.pmaa022"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa020
            #add-point:BEFORE FIELD pmaa020 name="construct.b.pmaa020"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa020
            
            #add-point:AFTER FIELD pmaa020 name="construct.a.pmaa020"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa020
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa020
            #add-point:ON ACTION controlp INFIELD pmaa020 name="construct.c.pmaa020"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa023
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa023
            #add-point:ON ACTION controlp INFIELD pmaa023 name="construct.c.pmaa023"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "254"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa023  #顯示到畫面上
            NEXT FIELD pmaa023                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa023
            #add-point:BEFORE FIELD pmaa023 name="construct.b.pmaa023"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa023
            
            #add-point:AFTER FIELD pmaa023 name="construct.a.pmaa023"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa024
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa024
            #add-point:ON ACTION controlp INFIELD pmaa024 name="construct.c.pmaa024"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "260"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa024  #顯示到畫面上
            NEXT FIELD pmaa024                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa024
            #add-point:BEFORE FIELD pmaa024 name="construct.b.pmaa024"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa024
            
            #add-point:AFTER FIELD pmaa024 name="construct.a.pmaa024"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa025
            #add-point:BEFORE FIELD pmaa025 name="construct.b.pmaa025"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa025
            
            #add-point:AFTER FIELD pmaa025 name="construct.a.pmaa025"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa025
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa025
            #add-point:ON ACTION controlp INFIELD pmaa025 name="construct.c.pmaa025"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa007
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa007
            #add-point:ON ACTION controlp INFIELD pmaa007 name="construct.c.pmaa007"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocg001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa007  #顯示到畫面上
            NEXT FIELD pmaa007                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa007
            #add-point:BEFORE FIELD pmaa007 name="construct.b.pmaa007"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa007
            
            #add-point:AFTER FIELD pmaa007 name="construct.a.pmaa007"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa008
            #add-point:BEFORE FIELD pmaa008 name="construct.b.pmaa008"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa008
            
            #add-point:AFTER FIELD pmaa008 name="construct.a.pmaa008"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa008
            #add-point:ON ACTION controlp INFIELD pmaa008 name="construct.c.pmaa008"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa009
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa009
            #add-point:ON ACTION controlp INFIELD pmaa009 name="construct.c.pmaa009"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '4'
            CALL q_ooal002_0()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa009  #顯示到畫面上
            NEXT FIELD pmaa009                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa009
            #add-point:BEFORE FIELD pmaa009 name="construct.b.pmaa009"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa009
            
            #add-point:AFTER FIELD pmaa009 name="construct.a.pmaa009"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa010
            #add-point:BEFORE FIELD pmaa010 name="construct.b.pmaa010"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa010
            
            #add-point:AFTER FIELD pmaa010 name="construct.a.pmaa010"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa010
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa010
            #add-point:ON ACTION controlp INFIELD pmaa010 name="construct.c.pmaa010"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa011
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa011
            #add-point:ON ACTION controlp INFIELD pmaa011 name="construct.c.pmaa011"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa011  #顯示到畫面上
            NEXT FIELD pmaa011                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa011
            #add-point:BEFORE FIELD pmaa011 name="construct.b.pmaa011"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa011
            
            #add-point:AFTER FIELD pmaa011 name="construct.a.pmaa011"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa027
            #add-point:BEFORE FIELD pmaa027 name="construct.b.pmaa027"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa027
            
            #add-point:AFTER FIELD pmaa027 name="construct.a.pmaa027"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa027
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa027
            #add-point:ON ACTION controlp INFIELD pmaa027 name="construct.c.pmaa027"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa230
            #add-point:BEFORE FIELD pmaa230 name="construct.b.pmaa230"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa230
            
            #add-point:AFTER FIELD pmaa230 name="construct.a.pmaa230"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa230
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa230
            #add-point:ON ACTION controlp INFIELD pmaa230 name="construct.c.pmaa230"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa231
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa231
            #add-point:ON ACTION controlp INFIELD pmaa231 name="construct.c.pmaa231"
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa231  #顯示到畫面上

            NEXT FIELD pmaa231                    #返回原欄位     
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa231
            #add-point:BEFORE FIELD pmaa231 name="construct.b.pmaa231"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa231
            
            #add-point:AFTER FIELD pmaa231 name="construct.a.pmaa231"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa231_desc
            #add-point:BEFORE FIELD pmaa231_desc name="construct.b.pmaa231_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa231_desc
            
            #add-point:AFTER FIELD pmaa231_desc name="construct.a.pmaa231_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa231_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa231_desc
            #add-point:ON ACTION controlp INFIELD pmaa231_desc name="construct.c.pmaa231_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa232
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa232
            #add-point:ON ACTION controlp INFIELD pmaa232 name="construct.c.pmaa232"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE			
			LET g_qryparam.arg1 = "2072" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa232  #顯示到畫面上
            NEXT FIELD pmaa232                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa232
            #add-point:BEFORE FIELD pmaa232 name="construct.b.pmaa232"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa232
            
            #add-point:AFTER FIELD pmaa232 name="construct.a.pmaa232"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa090
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa090
            #add-point:ON ACTION controlp INFIELD pmaa090 name="construct.c.pmaa090"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "281"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa090  #顯示到畫面上
            NEXT FIELD pmaa090                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa090
            #add-point:BEFORE FIELD pmaa090 name="construct.b.pmaa090"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa090
            
            #add-point:AFTER FIELD pmaa090 name="construct.a.pmaa090"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa091
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa091
            #add-point:ON ACTION controlp INFIELD pmaa091 name="construct.c.pmaa091"
            #應用 a08 樣板自動產生(Version:3)
            #開窗c段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_pmaa091_acc
            
            CALL q_oocq002()                       
            
            DISPLAY g_qryparam.return1 TO pmaa091  
            NEXT FIELD pmaa091 
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa091
            #add-point:BEFORE FIELD pmaa091 name="construct.b.pmaa091"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa091
            
            #add-point:AFTER FIELD pmaa091 name="construct.a.pmaa091"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa092
            #add-point:BEFORE FIELD pmaa092 name="construct.b.pmaa092"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa092
            
            #add-point:AFTER FIELD pmaa092 name="construct.a.pmaa092"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa092
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa092
            #add-point:ON ACTION controlp INFIELD pmaa092 name="construct.c.pmaa092"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa094
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa094
            #add-point:ON ACTION controlp INFIELD pmaa094 name="construct.c.pmaa094"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "286" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa094  #顯示到畫面上
            NEXT FIELD pmaa094                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa094
            #add-point:BEFORE FIELD pmaa094 name="construct.b.pmaa094"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa094
            
            #add-point:AFTER FIELD pmaa094 name="construct.a.pmaa094"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa093
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa093
            #add-point:ON ACTION controlp INFIELD pmaa093 name="construct.c.pmaa093"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "285" 
            CALL q_oocq002()                        #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa093  #顯示到畫面上
            NEXT FIELD pmaa093                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa093
            #add-point:BEFORE FIELD pmaa093 name="construct.b.pmaa093"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa093
            
            #add-point:AFTER FIELD pmaa093 name="construct.a.pmaa093"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa096
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa096
            #add-point:ON ACTION controlp INFIELD pmaa096 name="construct.c.pmaa096"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001_4()                      #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa096  #顯示到畫面上
            NEXT FIELD pmaa096                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa096
            #add-point:BEFORE FIELD pmaa096 name="construct.b.pmaa096"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa096
            
            #add-point:AFTER FIELD pmaa096 name="construct.a.pmaa096"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa097
            #add-point:BEFORE FIELD pmaa097 name="construct.b.pmaa097"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa097
            
            #add-point:AFTER FIELD pmaa097 name="construct.a.pmaa097"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa097
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa097
            #add-point:ON ACTION controlp INFIELD pmaa097 name="construct.c.pmaa097"
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            
            CALL q_ooeg001()         
            
            DISPLAY g_qryparam.return1 TO pmaa097 
            NEXT FIELD pmaa097            
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa241
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa241
            #add-point:ON ACTION controlp INFIELD pmaa241 name="construct.c.pmaa241"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "1"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa241  #顯示到畫面上
            NEXT FIELD pmaa241                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa241
            #add-point:BEFORE FIELD pmaa241 name="construct.b.pmaa241"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa241
            
            #add-point:AFTER FIELD pmaa241 name="construct.a.pmaa241"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa242
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa242
            #add-point:ON ACTION controlp INFIELD pmaa242 name="construct.c.pmaa242"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2" 
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa242  #顯示到畫面上
            NEXT FIELD pmaa242                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa242
            #add-point:BEFORE FIELD pmaa242 name="construct.b.pmaa242"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa242
            
            #add-point:AFTER FIELD pmaa242 name="construct.a.pmaa242"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa243
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa243
            #add-point:ON ACTION controlp INFIELD pmaa243 name="construct.c.pmaa243"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "3"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa243  #顯示到畫面上
            NEXT FIELD pmaa243                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa243
            #add-point:BEFORE FIELD pmaa243 name="construct.b.pmaa243"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa243
            
            #add-point:AFTER FIELD pmaa243 name="construct.a.pmaa243"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa244
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa244
            #add-point:ON ACTION controlp INFIELD pmaa244 name="construct.c.pmaa244"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "4"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa244  #顯示到畫面上
            NEXT FIELD pmaa244                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa244
            #add-point:BEFORE FIELD pmaa244 name="construct.b.pmaa244"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa244
            
            #add-point:AFTER FIELD pmaa244 name="construct.a.pmaa244"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa245
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa245
            #add-point:ON ACTION controlp INFIELD pmaa245 name="construct.c.pmaa245"
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "1" #ken---modify 由"2"改為"1"   150127-00003#2
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa245  #顯示到畫面上

            NEXT FIELD pmaa245                    #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa245
            #add-point:BEFORE FIELD pmaa245 name="construct.b.pmaa245"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa245
            
            #add-point:AFTER FIELD pmaa245 name="construct.a.pmaa245"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa245_desc
            #add-point:BEFORE FIELD pmaa245_desc name="construct.b.pmaa245_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa245_desc
            
            #add-point:AFTER FIELD pmaa245_desc name="construct.a.pmaa245_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa245_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa245_desc
            #add-point:ON ACTION controlp INFIELD pmaa245_desc name="construct.c.pmaa245_desc"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa246
            #add-point:BEFORE FIELD pmaa246 name="construct.b.pmaa246"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa246
            
            #add-point:AFTER FIELD pmaa246 name="construct.a.pmaa246"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa246
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa246
            #add-point:ON ACTION controlp INFIELD pmaa246 name="construct.c.pmaa246"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa247
            #add-point:BEFORE FIELD pmaa247 name="construct.b.pmaa247"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa247
            
            #add-point:AFTER FIELD pmaa247 name="construct.a.pmaa247"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa247
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa247
            #add-point:ON ACTION controlp INFIELD pmaa247 name="construct.c.pmaa247"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa248
            #add-point:BEFORE FIELD pmaa248 name="construct.b.pmaa248"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa248
            
            #add-point:AFTER FIELD pmaa248 name="construct.a.pmaa248"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa248
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa248
            #add-point:ON ACTION controlp INFIELD pmaa248 name="construct.c.pmaa248"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa095
            #add-point:BEFORE FIELD pmaa095 name="construct.b.pmaa095"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa095
            
            #add-point:AFTER FIELD pmaa095 name="construct.a.pmaa095"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa095
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa095
            #add-point:ON ACTION controlp INFIELD pmaa095 name="construct.c.pmaa095"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa095
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'c')   #150308-00001#4 150309 by lori add 'c'
            CALL q_ooef001_24()
            DISPLAY g_qryparam.return1 TO pmaa095          #顯示到畫面上
            NEXT FIELD pmaa095                             #返回原欄位  
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa220
            #add-point:BEFORE FIELD pmaa220 name="construct.b.pmaa220"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa220
            
            #add-point:AFTER FIELD pmaa220 name="construct.a.pmaa220"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa220
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa220
            #add-point:ON ACTION controlp INFIELD pmaa220 name="construct.c.pmaa220"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa221
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa221
            #add-point:ON ACTION controlp INFIELD pmaa221 name="construct.c.pmaa221"
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "2"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa221  #顯示到畫面上

            NEXT FIELD pmaa221                    #返回原欄位   
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa221
            #add-point:BEFORE FIELD pmaa221 name="construct.b.pmaa221"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa221
            
            #add-point:AFTER FIELD pmaa221 name="construct.a.pmaa221"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa221_desc
            #add-point:BEFORE FIELD pmaa221_desc name="construct.b.pmaa221_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa221_desc
            
            #add-point:AFTER FIELD pmaa221_desc name="construct.a.pmaa221_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa221_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa221_desc
            #add-point:ON ACTION controlp INFIELD pmaa221_desc name="construct.c.pmaa221_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa222
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa222
            #add-point:ON ACTION controlp INFIELD pmaa222 name="construct.c.pmaa222"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2072"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa222  #顯示到畫面上
            NEXT FIELD pmaa222                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa222
            #add-point:BEFORE FIELD pmaa222 name="construct.b.pmaa222"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa222
            
            #add-point:AFTER FIELD pmaa222 name="construct.a.pmaa222"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa080
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa080
            #add-point:ON ACTION controlp INFIELD pmaa080 name="construct.c.pmaa080"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '251'
            CALL q_oocq002()                        #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa080  #顯示到畫面上
            NEXT FIELD pmaa080                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa080
            #add-point:BEFORE FIELD pmaa080 name="construct.b.pmaa080"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa080
            
            #add-point:AFTER FIELD pmaa080 name="construct.a.pmaa080"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa084
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa084
            #add-point:ON ACTION controlp INFIELD pmaa084 name="construct.c.pmaa084"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "256" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa084  #顯示到畫面上
            NEXT FIELD pmaa084                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa084
            #add-point:BEFORE FIELD pmaa084 name="construct.b.pmaa084"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa084
            
            #add-point:AFTER FIELD pmaa084 name="construct.a.pmaa084"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa083
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa083
            #add-point:ON ACTION controlp INFIELD pmaa083 name="construct.c.pmaa083"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "255" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa083  #顯示到畫面上
            NEXT FIELD pmaa083                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa083
            #add-point:BEFORE FIELD pmaa083 name="construct.b.pmaa083"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa083
            
            #add-point:AFTER FIELD pmaa083 name="construct.a.pmaa083"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa086
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa086
            #add-point:ON ACTION controlp INFIELD pmaa086 name="construct.c.pmaa086"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001_4()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa086  #顯示到畫面上
            NEXT FIELD pmaa086                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa086
            #add-point:BEFORE FIELD pmaa086 name="construct.b.pmaa086"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa086
            
            #add-point:AFTER FIELD pmaa086 name="construct.a.pmaa086"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa085
            #add-point:BEFORE FIELD pmaa085 name="construct.b.pmaa085"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa085
            
            #add-point:AFTER FIELD pmaa085 name="construct.a.pmaa085"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa085
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa085
            #add-point:ON ACTION controlp INFIELD pmaa085 name="construct.c.pmaa085"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa085
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'c')   #150308-00001#4 150309 by lori add 'c'
            CALL q_ooef001_24()
            DISPLAY g_qryparam.return1 TO pmaa085          #顯示到畫面上
            NEXT FIELD pmaa085                             #返回原欄位  
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa051
            #add-point:BEFORE FIELD pmaa051 name="construct.b.pmaa051"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa051
            
            #add-point:AFTER FIELD pmaa051 name="construct.a.pmaa051"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa051
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa051
            #add-point:ON ACTION controlp INFIELD pmaa051 name="construct.c.pmaa051"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa052
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa052
            #add-point:ON ACTION controlp INFIELD pmaa052 name="construct.c.pmaa052"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            #CALL q_pmaa001()                       #呼叫開窗      #160908-00032#2 mark by rainy
            CALL q_pmaa001_4()                        #呼叫開窗    #160908-00032#2 by rainy 開窗改為 q_pmaa001_4()
            DISPLAY g_qryparam.return1 TO pmaa052  #顯示到畫面上
            NEXT FIELD pmaa052                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa052
            #add-point:BEFORE FIELD pmaa052 name="construct.b.pmaa052"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa052
            
            #add-point:AFTER FIELD pmaa052 name="construct.a.pmaa052"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa053
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa053
            #add-point:ON ACTION controlp INFIELD pmaa053 name="construct.c.pmaa053"
            #160512-00005#2 160515 by lori add---(S)
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   
            CALL q_xmaj001()        
            
            DISPLAY g_qryparam.return1 TO pmaa053 
            NEXT FIELD pmaa053                           
            #160512-00005#2 160515 by lori add---(E)                                                                         
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa053
            #add-point:BEFORE FIELD pmaa053 name="construct.b.pmaa053"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa053
            
            #add-point:AFTER FIELD pmaa053 name="construct.a.pmaa053"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa054
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa054
            #add-point:ON ACTION controlp INFIELD pmaa054 name="construct.c.pmaa054"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa054  #顯示到畫面上
            NEXT FIELD pmaa054                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa054
            #add-point:BEFORE FIELD pmaa054 name="construct.b.pmaa054"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa054
            
            #add-point:AFTER FIELD pmaa054 name="construct.a.pmaa054"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa055
            #add-point:BEFORE FIELD pmaa055 name="construct.b.pmaa055"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa055
            
            #add-point:AFTER FIELD pmaa055 name="construct.a.pmaa055"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa055
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa055
            #add-point:ON ACTION controlp INFIELD pmaa055 name="construct.c.pmaa055"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa056
            #add-point:BEFORE FIELD pmaa056 name="construct.b.pmaa056"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa056
            
            #add-point:AFTER FIELD pmaa056 name="construct.a.pmaa056"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa056
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa056
            #add-point:ON ACTION controlp INFIELD pmaa056 name="construct.c.pmaa056"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa057
            #add-point:BEFORE FIELD pmaa057 name="construct.b.pmaa057"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa057
            
            #add-point:AFTER FIELD pmaa057 name="construct.a.pmaa057"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa057
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa057
            #add-point:ON ACTION controlp INFIELD pmaa057 name="construct.c.pmaa057"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa058
            #add-point:BEFORE FIELD pmaa058 name="construct.b.pmaa058"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa058
            
            #add-point:AFTER FIELD pmaa058 name="construct.a.pmaa058"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa058
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa058
            #add-point:ON ACTION controlp INFIELD pmaa058 name="construct.c.pmaa058"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa074
            #add-point:BEFORE FIELD pmaa074 name="construct.b.pmaa074"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa074
            
            #add-point:AFTER FIELD pmaa074 name="construct.a.pmaa074"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa074
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa074
            #add-point:ON ACTION controlp INFIELD pmaa074 name="construct.c.pmaa074"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa059
            #add-point:BEFORE FIELD pmaa059 name="construct.b.pmaa059"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa059
            
            #add-point:AFTER FIELD pmaa059 name="construct.a.pmaa059"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa059
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa059
            #add-point:ON ACTION controlp INFIELD pmaa059 name="construct.c.pmaa059"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa075
            #add-point:BEFORE FIELD pmaa075 name="construct.b.pmaa075"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa075
            
            #add-point:AFTER FIELD pmaa075 name="construct.a.pmaa075"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa075
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa075
            #add-point:ON ACTION controlp INFIELD pmaa075 name="construct.c.pmaa075"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa047
            #add-point:BEFORE FIELD pmaa047 name="construct.b.pmaa047"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa047
            
            #add-point:AFTER FIELD pmaa047 name="construct.a.pmaa047"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa047
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa047
            #add-point:ON ACTION controlp INFIELD pmaa047 name="construct.c.pmaa047"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa036
            #add-point:BEFORE FIELD pmaa036 name="construct.b.pmaa036"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa036
            
            #add-point:AFTER FIELD pmaa036 name="construct.a.pmaa036"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa036
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa036
            #add-point:ON ACTION controlp INFIELD pmaa036 name="construct.c.pmaa036"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa037
            #add-point:BEFORE FIELD pmaa037 name="construct.b.pmaa037"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa037
            
            #add-point:AFTER FIELD pmaa037 name="construct.a.pmaa037"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa037
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa037
            #add-point:ON ACTION controlp INFIELD pmaa037 name="construct.c.pmaa037"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa038
            #add-point:BEFORE FIELD pmaa038 name="construct.b.pmaa038"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa038
            
            #add-point:AFTER FIELD pmaa038 name="construct.a.pmaa038"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa038
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa038
            #add-point:ON ACTION controlp INFIELD pmaa038 name="construct.c.pmaa038"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa039
            #add-point:BEFORE FIELD pmaa039 name="construct.b.pmaa039"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa039
            
            #add-point:AFTER FIELD pmaa039 name="construct.a.pmaa039"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa039
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa039
            #add-point:ON ACTION controlp INFIELD pmaa039 name="construct.c.pmaa039"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa040
            #add-point:BEFORE FIELD pmaa040 name="construct.b.pmaa040"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa040
            
            #add-point:AFTER FIELD pmaa040 name="construct.a.pmaa040"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa040
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa040
            #add-point:ON ACTION controlp INFIELD pmaa040 name="construct.c.pmaa040"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa041
            #add-point:BEFORE FIELD pmaa041 name="construct.b.pmaa041"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa041
            
            #add-point:AFTER FIELD pmaa041 name="construct.a.pmaa041"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa041
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa041
            #add-point:ON ACTION controlp INFIELD pmaa041 name="construct.c.pmaa041"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa042
            #add-point:BEFORE FIELD pmaa042 name="construct.b.pmaa042"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa042
            
            #add-point:AFTER FIELD pmaa042 name="construct.a.pmaa042"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa042
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa042
            #add-point:ON ACTION controlp INFIELD pmaa042 name="construct.c.pmaa042"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa043
            #add-point:BEFORE FIELD pmaa043 name="construct.b.pmaa043"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa043
            
            #add-point:AFTER FIELD pmaa043 name="construct.a.pmaa043"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa043
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa043
            #add-point:ON ACTION controlp INFIELD pmaa043 name="construct.c.pmaa043"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa044
            #add-point:BEFORE FIELD pmaa044 name="construct.b.pmaa044"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa044
            
            #add-point:AFTER FIELD pmaa044 name="construct.a.pmaa044"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa044
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa044
            #add-point:ON ACTION controlp INFIELD pmaa044 name="construct.c.pmaa044"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa045
            #add-point:BEFORE FIELD pmaa045 name="construct.b.pmaa045"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa045
            
            #add-point:AFTER FIELD pmaa045 name="construct.a.pmaa045"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa045
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa045
            #add-point:ON ACTION controlp INFIELD pmaa045 name="construct.c.pmaa045"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa046
            #add-point:BEFORE FIELD pmaa046 name="construct.b.pmaa046"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa046
            
            #add-point:AFTER FIELD pmaa046 name="construct.a.pmaa046"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa046
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa046
            #add-point:ON ACTION controlp INFIELD pmaa046 name="construct.c.pmaa046"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa068
            #add-point:BEFORE FIELD pmaa068 name="construct.b.pmaa068"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa068
            
            #add-point:AFTER FIELD pmaa068 name="construct.a.pmaa068"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa068
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa068
            #add-point:ON ACTION controlp INFIELD pmaa068 name="construct.c.pmaa068"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa069
            #add-point:BEFORE FIELD pmaa069 name="construct.b.pmaa069"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa069
            
            #add-point:AFTER FIELD pmaa069 name="construct.a.pmaa069"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa069
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa069
            #add-point:ON ACTION controlp INFIELD pmaa069 name="construct.c.pmaa069"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa072
            #add-point:BEFORE FIELD pmaa072 name="construct.b.pmaa072"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa072
            
            #add-point:AFTER FIELD pmaa072 name="construct.a.pmaa072"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa072
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa072
            #add-point:ON ACTION controlp INFIELD pmaa072 name="construct.c.pmaa072"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa070
            #add-point:BEFORE FIELD pmaa070 name="construct.b.pmaa070"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa070
            
            #add-point:AFTER FIELD pmaa070 name="construct.a.pmaa070"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa070
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa070
            #add-point:ON ACTION controlp INFIELD pmaa070 name="construct.c.pmaa070"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa071
            #add-point:BEFORE FIELD pmaa071 name="construct.b.pmaa071"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa071
            
            #add-point:AFTER FIELD pmaa071 name="construct.a.pmaa071"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa071
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa071
            #add-point:ON ACTION controlp INFIELD pmaa071 name="construct.c.pmaa071"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa073
            #add-point:BEFORE FIELD pmaa073 name="construct.b.pmaa073"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa073
            
            #add-point:AFTER FIELD pmaa073 name="construct.a.pmaa073"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa073
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa073
            #add-point:ON ACTION controlp INFIELD pmaa073 name="construct.c.pmaa073"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa204
            #add-point:BEFORE FIELD pmaa204 name="construct.b.pmaa204"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa204
            
            #add-point:AFTER FIELD pmaa204 name="construct.a.pmaa204"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa204
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa204
            #add-point:ON ACTION controlp INFIELD pmaa204 name="construct.c.pmaa204"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa205
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa205
            #add-point:ON ACTION controlp INFIELD pmaa205 name="construct.c.pmaa205"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '2031'
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa205  #顯示到畫面上
            NEXT FIELD pmaa205                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa205
            #add-point:BEFORE FIELD pmaa205 name="construct.b.pmaa205"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa205
            
            #add-point:AFTER FIELD pmaa205 name="construct.a.pmaa205"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa206
            #add-point:BEFORE FIELD pmaa206 name="construct.b.pmaa206"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa206
            
            #add-point:AFTER FIELD pmaa206 name="construct.a.pmaa206"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa206
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa206
            #add-point:ON ACTION controlp INFIELD pmaa206 name="construct.c.pmaa206"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab032
            #add-point:BEFORE FIELD pmab032 name="construct.b.pmab032"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab032
            
            #add-point:AFTER FIELD pmab032 name="construct.a.pmab032"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab032
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab032
            #add-point:ON ACTION controlp INFIELD pmab032 name="construct.c.pmab032"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab057
            #add-point:BEFORE FIELD pmab057 name="construct.b.pmab057"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab057
            
            #add-point:AFTER FIELD pmab057 name="construct.a.pmab057"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab057
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab057
            #add-point:ON ACTION controlp INFIELD pmab057 name="construct.c.pmab057"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab058
            #add-point:BEFORE FIELD pmab058 name="construct.b.pmab058"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab058
            
            #add-point:AFTER FIELD pmab058 name="construct.a.pmab058"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab058
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab058
            #add-point:ON ACTION controlp INFIELD pmab058 name="construct.c.pmab058"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab053
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab053
            #add-point:ON ACTION controlp INFIELD pmab053 name="construct.c.pmab053"
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab053  #顯示到畫面上
            NEXT FIELD pmab053                     #返回原欄位
    


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab053
            #add-point:BEFORE FIELD pmab053 name="construct.b.pmab053"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab053
            
            #add-point:AFTER FIELD pmab053 name="construct.a.pmab053"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab039
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab039
            #add-point:ON ACTION controlp INFIELD pmab039 name="construct.c.pmab039"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "264"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab039  #顯示到畫面上

            NEXT FIELD pmab039                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab039
            #add-point:BEFORE FIELD pmab039 name="construct.b.pmab039"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab039
            
            #add-point:AFTER FIELD pmab039 name="construct.a.pmab039"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa081
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa081
            #add-point:ON ACTION controlp INFIELD pmaa081 name="construct.c.pmaa081"
                                                                                    #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '253'
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa081  #顯示到畫面上
            NEXT FIELD pmaa081                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa081
            #add-point:BEFORE FIELD pmaa081 name="construct.b.pmaa081"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa081
            
            #add-point:AFTER FIELD pmaa081 name="construct.a.pmaa081"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab033
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab033
            #add-point:ON ACTION controlp INFIELD pmab033 name="construct.c.pmab033"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab033  #顯示到畫面上

            NEXT FIELD pmab033                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab033
            #add-point:BEFORE FIELD pmab033 name="construct.b.pmab033"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab033
            
            #add-point:AFTER FIELD pmab033 name="construct.a.pmab033"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab034
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab034
            #add-point:ON ACTION controlp INFIELD pmab034 name="construct.c.pmab034"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab034  #顯示到畫面上

            NEXT FIELD pmab034                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab034
            #add-point:BEFORE FIELD pmab034 name="construct.b.pmab034"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab034
            
            #add-point:AFTER FIELD pmab034 name="construct.a.pmab034"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab034_desc
            #add-point:BEFORE FIELD pmab034_desc name="construct.b.pmab034_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab034_desc
            
            #add-point:AFTER FIELD pmab034_desc name="construct.a.pmab034_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab034_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab034_desc
            #add-point:ON ACTION controlp INFIELD pmab034_desc name="construct.c.pmab034_desc"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab035
            #add-point:BEFORE FIELD pmab035 name="construct.b.pmab035"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab035
            
            #add-point:AFTER FIELD pmab035 name="construct.a.pmab035"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab035
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab035
            #add-point:ON ACTION controlp INFIELD pmab035 name="construct.c.pmab035"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab056
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab056
            #add-point:ON ACTION controlp INFIELD pmab056 name="construct.c.pmab056"
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_ooef019 #稅區
            LET g_qryparam.arg2 = "1"       #進銷項類型            
            CALL q_isac002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab056  #顯示到畫面上
            NEXT FIELD pmab056                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab056
            #add-point:BEFORE FIELD pmab056 name="construct.b.pmab056"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab056
            
            #add-point:AFTER FIELD pmab056 name="construct.a.pmab056"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab056_desc
            #add-point:BEFORE FIELD pmab056_desc name="construct.b.pmab056_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab056_desc
            
            #add-point:AFTER FIELD pmab056_desc name="construct.a.pmab056_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab056_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab056_desc
            #add-point:ON ACTION controlp INFIELD pmab056_desc name="construct.c.pmab056_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab037
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab037
            #add-point:ON ACTION controlp INFIELD pmab037 name="construct.c.pmab037"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooib002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab037  #顯示到畫面上

            NEXT FIELD pmab037                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab037
            #add-point:BEFORE FIELD pmab037 name="construct.b.pmab037"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab037
            
            #add-point:AFTER FIELD pmab037 name="construct.a.pmab037"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab055
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab055
            #add-point:ON ACTION controlp INFIELD pmab055 name="construct.c.pmab055"
            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.arg1 = '3211'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab055  #顯示到畫面上
            NEXT FIELD pmab055                     #返回原欄位
    


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab055
            #add-point:BEFORE FIELD pmab055 name="construct.b.pmab055"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab055
            
            #add-point:AFTER FIELD pmab055 name="construct.a.pmab055"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab038
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab038
            #add-point:ON ACTION controlp INFIELD pmab038 name="construct.c.pmab038"
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
		      LET g_qryparam.arg1 = "2"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab038  #顯示到畫面上

            NEXT FIELD pmab038                    #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab038
            #add-point:BEFORE FIELD pmab038 name="construct.b.pmab038"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab038
            
            #add-point:AFTER FIELD pmab038 name="construct.a.pmab038"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab038_desc
            #add-point:BEFORE FIELD pmab038_desc name="construct.b.pmab038_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab038_desc
            
            #add-point:AFTER FIELD pmab038_desc name="construct.a.pmab038_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab038_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab038_desc
            #add-point:ON ACTION controlp INFIELD pmab038_desc name="construct.c.pmab038_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab040
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab040
            #add-point:ON ACTION controlp INFIELD pmab040 name="construct.c.pmab040"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab040  #顯示到畫面上

            NEXT FIELD pmab040                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab040
            #add-point:BEFORE FIELD pmab040 name="construct.b.pmab040"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab040
            
            #add-point:AFTER FIELD pmab040 name="construct.a.pmab040"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab041
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab041
            #add-point:ON ACTION controlp INFIELD pmab041 name="construct.c.pmab041"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab041  #顯示到畫面上

            NEXT FIELD pmab041                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab041
            #add-point:BEFORE FIELD pmab041 name="construct.b.pmab041"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab041
            
            #add-point:AFTER FIELD pmab041 name="construct.a.pmab041"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab042
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab042
            #add-point:ON ACTION controlp INFIELD pmab042 name="construct.c.pmab042"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262" 
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab042  #顯示到畫面上

            NEXT FIELD pmab042                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab042
            #add-point:BEFORE FIELD pmab042 name="construct.b.pmab042"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab042
            
            #add-point:AFTER FIELD pmab042 name="construct.a.pmab042"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab043
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab043
            #add-point:ON ACTION controlp INFIELD pmab043 name="construct.c.pmab043"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262" 
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab043  #顯示到畫面上

            NEXT FIELD pmab043                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab043
            #add-point:BEFORE FIELD pmab043 name="construct.b.pmab043"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab043
            
            #add-point:AFTER FIELD pmab043 name="construct.a.pmab043"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab044
            #add-point:BEFORE FIELD pmab044 name="construct.b.pmab044"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab044
            
            #add-point:AFTER FIELD pmab044 name="construct.a.pmab044"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab044
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab044
            #add-point:ON ACTION controlp INFIELD pmab044 name="construct.c.pmab044"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab045
            #add-point:BEFORE FIELD pmab045 name="construct.b.pmab045"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab045
            
            #add-point:AFTER FIELD pmab045 name="construct.a.pmab045"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab045
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab045
            #add-point:ON ACTION controlp INFIELD pmab045 name="construct.c.pmab045"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab046
            #add-point:BEFORE FIELD pmab046 name="construct.b.pmab046"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab046
            
            #add-point:AFTER FIELD pmab046 name="construct.a.pmab046"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab046
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab046
            #add-point:ON ACTION controlp INFIELD pmab046 name="construct.c.pmab046"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab047
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab047
            #add-point:ON ACTION controlp INFIELD pmab047 name="construct.c.pmab047"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab047  #顯示到畫面上

            NEXT FIELD pmab047                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab047
            #add-point:BEFORE FIELD pmab047 name="construct.b.pmab047"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab047
            
            #add-point:AFTER FIELD pmab047 name="construct.a.pmab047"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab048
            #add-point:BEFORE FIELD pmab048 name="construct.b.pmab048"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab048
            
            #add-point:AFTER FIELD pmab048 name="construct.a.pmab048"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab048
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab048
            #add-point:ON ACTION controlp INFIELD pmab048 name="construct.c.pmab048"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab049
            #add-point:BEFORE FIELD pmab049 name="construct.b.pmab049"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab049
            
            #add-point:AFTER FIELD pmab049 name="construct.a.pmab049"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab049
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab049
            #add-point:ON ACTION controlp INFIELD pmab049 name="construct.c.pmab049"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab050
            #add-point:BEFORE FIELD l_pmab050 name="construct.b.l_pmab050"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab050
            
            #add-point:AFTER FIELD l_pmab050 name="construct.a.l_pmab050"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.l_pmab050
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab050
            #add-point:ON ACTION controlp INFIELD l_pmab050 name="construct.c.l_pmab050"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab051
            #add-point:BEFORE FIELD pmab051 name="construct.b.pmab051"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab051
            
            #add-point:AFTER FIELD pmab051 name="construct.a.pmab051"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab051
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab051
            #add-point:ON ACTION controlp INFIELD pmab051 name="construct.c.pmab051"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab052
            #add-point:BEFORE FIELD l_pmab052 name="construct.b.l_pmab052"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab052
            
            #add-point:AFTER FIELD l_pmab052 name="construct.a.l_pmab052"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.l_pmab052
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab052
            #add-point:ON ACTION controlp INFIELD l_pmab052 name="construct.c.l_pmab052"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab080
            #add-point:BEFORE FIELD pmab080 name="construct.b.pmab080"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab080
            
            #add-point:AFTER FIELD pmab080 name="construct.a.pmab080"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab080
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab080
            #add-point:ON ACTION controlp INFIELD pmab080 name="construct.c.pmab080"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab082
            #add-point:BEFORE FIELD pmab082 name="construct.b.pmab082"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab082
            
            #add-point:AFTER FIELD pmab082 name="construct.a.pmab082"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab082
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab082
            #add-point:ON ACTION controlp INFIELD pmab082 name="construct.c.pmab082"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab083
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab083
            #add-point:ON ACTION controlp INFIELD pmab083 name="construct.c.pmab083"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab083  #顯示到畫面上

            NEXT FIELD pmab083                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab083
            #add-point:BEFORE FIELD pmab083 name="construct.b.pmab083"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab083
            
            #add-point:AFTER FIELD pmab083 name="construct.a.pmab083"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab084
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab084
            #add-point:ON ACTION controlp INFIELD pmab084 name="construct.c.pmab084"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab084  #顯示到畫面上

            NEXT FIELD pmab084                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab084
            #add-point:BEFORE FIELD pmab084 name="construct.b.pmab084"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab084
            
            #add-point:AFTER FIELD pmab084 name="construct.a.pmab084"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab084_desc
            #add-point:BEFORE FIELD pmab084_desc name="construct.b.pmab084_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab084_desc
            
            #add-point:AFTER FIELD pmab084_desc name="construct.a.pmab084_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab084_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab084_desc
            #add-point:ON ACTION controlp INFIELD pmab084_desc name="construct.c.pmab084_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab103
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab103
            #add-point:ON ACTION controlp INFIELD pmab103 name="construct.c.pmab103"
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab103  #顯示到畫面上
            NEXT FIELD pmab103                     #返回原欄位
    


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab103
            #add-point:BEFORE FIELD pmab103 name="construct.b.pmab103"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab103
            
            #add-point:AFTER FIELD pmab103 name="construct.a.pmab103"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab104
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab104
            #add-point:ON ACTION controlp INFIELD pmab104 name="construct.c.pmab104"
            #應用 a08 樣板自動產生(Version:3)
            #開窗c段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            
            CALL q_xmah001()                       
            
            DISPLAY g_qryparam.return1 TO pmab104  
            NEXT FIELD pmab104                   
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab104
            #add-point:BEFORE FIELD pmab104 name="construct.b.pmab104"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab104
            
            #add-point:AFTER FIELD pmab104 name="construct.a.pmab104"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab085
            #add-point:BEFORE FIELD pmab085 name="construct.b.pmab085"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab085
            
            #add-point:AFTER FIELD pmab085 name="construct.a.pmab085"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab085
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab085
            #add-point:ON ACTION controlp INFIELD pmab085 name="construct.c.pmab085"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab106
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab106
            #add-point:ON ACTION controlp INFIELD pmab106 name="construct.c.pmab106"
            #此段落由子樣板a08產生
            #開窗c段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            
            CALL q_isac002_1()                    
            
            DISPLAY g_qryparam.return1 TO pmab106 
            NEXT FIELD pmab106    
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab106
            #add-point:BEFORE FIELD pmab106 name="construct.b.pmab106"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab106
            
            #add-point:AFTER FIELD pmab106 name="construct.a.pmab106"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab106_desc
            #add-point:BEFORE FIELD pmab106_desc name="construct.b.pmab106_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab106_desc
            
            #add-point:AFTER FIELD pmab106_desc name="construct.a.pmab106_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab106_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab106_desc
            #add-point:ON ACTION controlp INFIELD pmab106_desc name="construct.c.pmab106_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab087
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab087
            #add-point:ON ACTION controlp INFIELD pmab087 name="construct.c.pmab087"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooib002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab087  #顯示到畫面上

            NEXT FIELD pmab087                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab087
            #add-point:BEFORE FIELD pmab087 name="construct.b.pmab087"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab087
            
            #add-point:AFTER FIELD pmab087 name="construct.a.pmab087"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab105
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab105
            #add-point:ON ACTION controlp INFIELD pmab105 name="construct.c.pmab105"
            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "3111"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab105  #顯示到畫面上
            NEXT FIELD pmab105                     #返回原欄位
    


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab105
            #add-point:BEFORE FIELD pmab105 name="construct.b.pmab105"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab105
            
            #add-point:AFTER FIELD pmab105 name="construct.a.pmab105"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab088
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab088
            #add-point:ON ACTION controlp INFIELD pmab088 name="construct.c.pmab088"
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
		      LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab088  #顯示到畫面上
            NEXT FIELD pmab088                     #返回原欄位
    


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab088
            #add-point:BEFORE FIELD pmab088 name="construct.b.pmab088"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab088
            
            #add-point:AFTER FIELD pmab088 name="construct.a.pmab088"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab088_desc
            #add-point:BEFORE FIELD pmab088_desc name="construct.b.pmab088_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab088_desc
            
            #add-point:AFTER FIELD pmab088_desc name="construct.a.pmab088_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab088_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab088_desc
            #add-point:ON ACTION controlp INFIELD pmab088_desc name="construct.c.pmab088_desc"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab089
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab089
            #add-point:ON ACTION controlp INFIELD pmab089 name="construct.c.pmab089"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "295"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab089  #顯示到畫面上

            NEXT FIELD pmab089                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab089
            #add-point:BEFORE FIELD pmab089 name="construct.b.pmab089"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab089
            
            #add-point:AFTER FIELD pmab089 name="construct.a.pmab089"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab107
            #add-point:BEFORE FIELD pmab107 name="construct.b.pmab107"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab107
            
            #add-point:AFTER FIELD pmab107 name="construct.a.pmab107"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab107
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab107
            #add-point:ON ACTION controlp INFIELD pmab107 name="construct.c.pmab107"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab108
            #add-point:BEFORE FIELD pmab108 name="construct.b.pmab108"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab108
            
            #add-point:AFTER FIELD pmab108 name="construct.a.pmab108"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab108
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab108
            #add-point:ON ACTION controlp INFIELD pmab108 name="construct.c.pmab108"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab090
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab090
            #add-point:ON ACTION controlp INFIELD pmab090 name="construct.c.pmab090"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263" 
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab090  #顯示到畫面上

            NEXT FIELD pmab090                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab090
            #add-point:BEFORE FIELD pmab090 name="construct.b.pmab090"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab090
            
            #add-point:AFTER FIELD pmab090 name="construct.a.pmab090"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab091
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab091
            #add-point:ON ACTION controlp INFIELD pmab091 name="construct.c.pmab091"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262" 
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab091  #顯示到畫面上

            NEXT FIELD pmab091                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab091
            #add-point:BEFORE FIELD pmab091 name="construct.b.pmab091"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab091
            
            #add-point:AFTER FIELD pmab091 name="construct.a.pmab091"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab092
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab092
            #add-point:ON ACTION controlp INFIELD pmab092 name="construct.c.pmab092"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab092  #顯示到畫面上

            NEXT FIELD pmab092                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab092
            #add-point:BEFORE FIELD pmab092 name="construct.b.pmab092"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab092
            
            #add-point:AFTER FIELD pmab092 name="construct.a.pmab092"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab093
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab093
            #add-point:ON ACTION controlp INFIELD pmab093 name="construct.c.pmab093"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "262" 
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab093  #顯示到畫面上

            NEXT FIELD pmab093                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab093
            #add-point:BEFORE FIELD pmab093 name="construct.b.pmab093"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab093
            
            #add-point:AFTER FIELD pmab093 name="construct.a.pmab093"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab094
            #add-point:BEFORE FIELD pmab094 name="construct.b.pmab094"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab094
            
            #add-point:AFTER FIELD pmab094 name="construct.a.pmab094"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab094
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab094
            #add-point:ON ACTION controlp INFIELD pmab094 name="construct.c.pmab094"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab095
            #add-point:BEFORE FIELD pmab095 name="construct.b.pmab095"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab095
            
            #add-point:AFTER FIELD pmab095 name="construct.a.pmab095"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab095
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab095
            #add-point:ON ACTION controlp INFIELD pmab095 name="construct.c.pmab095"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab096
            #add-point:BEFORE FIELD pmab096 name="construct.b.pmab096"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab096
            
            #add-point:AFTER FIELD pmab096 name="construct.a.pmab096"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab096
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab096
            #add-point:ON ACTION controlp INFIELD pmab096 name="construct.c.pmab096"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmab097
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab097
            #add-point:ON ACTION controlp INFIELD pmab097 name="construct.c.pmab097"
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmab097  #顯示到畫面上

            NEXT FIELD pmab097                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab097
            #add-point:BEFORE FIELD pmab097 name="construct.b.pmab097"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab097
            
            #add-point:AFTER FIELD pmab097 name="construct.a.pmab097"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab098
            #add-point:BEFORE FIELD pmab098 name="construct.b.pmab098"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab098
            
            #add-point:AFTER FIELD pmab098 name="construct.a.pmab098"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab098
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab098
            #add-point:ON ACTION controlp INFIELD pmab098 name="construct.c.pmab098"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab099
            #add-point:BEFORE FIELD pmab099 name="construct.b.pmab099"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab099
            
            #add-point:AFTER FIELD pmab099 name="construct.a.pmab099"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab099
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab099
            #add-point:ON ACTION controlp INFIELD pmab099 name="construct.c.pmab099"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab100
            #add-point:BEFORE FIELD l_pmab100 name="construct.b.l_pmab100"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab100
            
            #add-point:AFTER FIELD l_pmab100 name="construct.a.l_pmab100"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.l_pmab100
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab100
            #add-point:ON ACTION controlp INFIELD l_pmab100 name="construct.c.l_pmab100"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab101
            #add-point:BEFORE FIELD pmab101 name="construct.b.pmab101"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab101
            
            #add-point:AFTER FIELD pmab101 name="construct.a.pmab101"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmab101
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab101
            #add-point:ON ACTION controlp INFIELD pmab101 name="construct.c.pmab101"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab102
            #add-point:BEFORE FIELD l_pmab102 name="construct.b.l_pmab102"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab102
            
            #add-point:AFTER FIELD l_pmab102 name="construct.a.l_pmab102"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.l_pmab102
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab102
            #add-point:ON ACTION controlp INFIELD l_pmab102 name="construct.c.l_pmab102"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013 name="construct.b.ooff013"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD ooff013
            
            #add-point:AFTER FIELD ooff013 name="construct.a.ooff013"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.ooff013
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013 name="construct.c.ooff013"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaaownid
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaaownid
            #add-point:ON ACTION controlp INFIELD pmaaownid name="construct.c.pmaaownid"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaownid  #顯示到畫面上

            NEXT FIELD pmaaownid                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaaownid
            #add-point:BEFORE FIELD pmaaownid name="construct.b.pmaaownid"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaaownid
            
            #add-point:AFTER FIELD pmaaownid name="construct.a.pmaaownid"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaaowndp
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaaowndp
            #add-point:ON ACTION controlp INFIELD pmaaowndp name="construct.c.pmaaowndp"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaowndp  #顯示到畫面上

            NEXT FIELD pmaaowndp                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaaowndp
            #add-point:BEFORE FIELD pmaaowndp name="construct.b.pmaaowndp"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaaowndp
            
            #add-point:AFTER FIELD pmaaowndp name="construct.a.pmaaowndp"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaacrtid
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaacrtid
            #add-point:ON ACTION controlp INFIELD pmaacrtid name="construct.c.pmaacrtid"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtid  #顯示到畫面上

            NEXT FIELD pmaacrtid                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaacrtid
            #add-point:BEFORE FIELD pmaacrtid name="construct.b.pmaacrtid"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaacrtid
            
            #add-point:AFTER FIELD pmaacrtid name="construct.a.pmaacrtid"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaacrtdp
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaacrtdp
            #add-point:ON ACTION controlp INFIELD pmaacrtdp name="construct.c.pmaacrtdp"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtdp  #顯示到畫面上

            NEXT FIELD pmaacrtdp                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaacrtdp
            #add-point:BEFORE FIELD pmaacrtdp name="construct.b.pmaacrtdp"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaacrtdp
            
            #add-point:AFTER FIELD pmaacrtdp name="construct.a.pmaacrtdp"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaacrtdt
            #add-point:BEFORE FIELD pmaacrtdt name="construct.b.pmaacrtdt"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaamodid
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaamodid
            #add-point:ON ACTION controlp INFIELD pmaamodid name="construct.c.pmaamodid"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaamodid  #顯示到畫面上

            NEXT FIELD pmaamodid                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaamodid
            #add-point:BEFORE FIELD pmaamodid name="construct.b.pmaamodid"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaamodid
            
            #add-point:AFTER FIELD pmaamodid name="construct.a.pmaamodid"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaamoddt
            #add-point:BEFORE FIELD pmaamoddt name="construct.b.pmaamoddt"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaacnfid
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaacnfid
            #add-point:ON ACTION controlp INFIELD pmaacnfid name="construct.c.pmaacnfid"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacnfid  #顯示到畫面上

            NEXT FIELD pmaacnfid                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaacnfid
            #add-point:BEFORE FIELD pmaacnfid name="construct.b.pmaacnfid"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaacnfid
            
            #add-point:AFTER FIELD pmaacnfid name="construct.a.pmaacnfid"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaacnfdt
            #add-point:BEFORE FIELD pmaacnfdt name="construct.b.pmaacnfdt"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa270
            #add-point:BEFORE FIELD pmaa270 name="construct.b.pmaa270"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa270
            
            #add-point:AFTER FIELD pmaa270 name="construct.a.pmaa270"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa270
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa270
            #add-point:ON ACTION controlp INFIELD pmaa270 name="construct.c.pmaa270"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa271
            #add-point:BEFORE FIELD pmaa271 name="construct.b.pmaa271"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa271
            
            #add-point:AFTER FIELD pmaa271 name="construct.a.pmaa271"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa271
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa271
            #add-point:ON ACTION controlp INFIELD pmaa271 name="construct.c.pmaa271"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa272
            #add-point:BEFORE FIELD pmaa272 name="construct.b.pmaa272"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa272
            
            #add-point:AFTER FIELD pmaa272 name="construct.a.pmaa272"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa272
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa272
            #add-point:ON ACTION controlp INFIELD pmaa272 name="construct.c.pmaa272"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day01
            #add-point:BEFORE FIELD day01 name="construct.b.day01"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day01
            
            #add-point:AFTER FIELD day01 name="construct.a.day01"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day01
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day01
            #add-point:ON ACTION controlp INFIELD day01 name="construct.c.day01"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day02
            #add-point:BEFORE FIELD day02 name="construct.b.day02"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day02
            
            #add-point:AFTER FIELD day02 name="construct.a.day02"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day02
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day02
            #add-point:ON ACTION controlp INFIELD day02 name="construct.c.day02"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day03
            #add-point:BEFORE FIELD day03 name="construct.b.day03"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day03
            
            #add-point:AFTER FIELD day03 name="construct.a.day03"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day03
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day03
            #add-point:ON ACTION controlp INFIELD day03 name="construct.c.day03"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day04
            #add-point:BEFORE FIELD day04 name="construct.b.day04"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day04
            
            #add-point:AFTER FIELD day04 name="construct.a.day04"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day04
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day04
            #add-point:ON ACTION controlp INFIELD day04 name="construct.c.day04"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day05
            #add-point:BEFORE FIELD day05 name="construct.b.day05"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day05
            
            #add-point:AFTER FIELD day05 name="construct.a.day05"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day05
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day05
            #add-point:ON ACTION controlp INFIELD day05 name="construct.c.day05"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day06
            #add-point:BEFORE FIELD day06 name="construct.b.day06"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day06
            
            #add-point:AFTER FIELD day06 name="construct.a.day06"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day06
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day06
            #add-point:ON ACTION controlp INFIELD day06 name="construct.c.day06"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day07
            #add-point:BEFORE FIELD day07 name="construct.b.day07"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day07
            
            #add-point:AFTER FIELD day07 name="construct.a.day07"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day07
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day07
            #add-point:ON ACTION controlp INFIELD day07 name="construct.c.day07"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day08
            #add-point:BEFORE FIELD day08 name="construct.b.day08"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day08
            
            #add-point:AFTER FIELD day08 name="construct.a.day08"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day08
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day08
            #add-point:ON ACTION controlp INFIELD day08 name="construct.c.day08"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day09
            #add-point:BEFORE FIELD day09 name="construct.b.day09"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day09
            
            #add-point:AFTER FIELD day09 name="construct.a.day09"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day09
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day09
            #add-point:ON ACTION controlp INFIELD day09 name="construct.c.day09"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day10
            #add-point:BEFORE FIELD day10 name="construct.b.day10"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day10
            
            #add-point:AFTER FIELD day10 name="construct.a.day10"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day10
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day10
            #add-point:ON ACTION controlp INFIELD day10 name="construct.c.day10"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day11
            #add-point:BEFORE FIELD day11 name="construct.b.day11"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day11
            
            #add-point:AFTER FIELD day11 name="construct.a.day11"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day11
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day11
            #add-point:ON ACTION controlp INFIELD day11 name="construct.c.day11"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day12
            #add-point:BEFORE FIELD day12 name="construct.b.day12"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day12
            
            #add-point:AFTER FIELD day12 name="construct.a.day12"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day12
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day12
            #add-point:ON ACTION controlp INFIELD day12 name="construct.c.day12"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day13
            #add-point:BEFORE FIELD day13 name="construct.b.day13"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day13
            
            #add-point:AFTER FIELD day13 name="construct.a.day13"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day13
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day13
            #add-point:ON ACTION controlp INFIELD day13 name="construct.c.day13"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day14
            #add-point:BEFORE FIELD day14 name="construct.b.day14"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day14
            
            #add-point:AFTER FIELD day14 name="construct.a.day14"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day14
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day14
            #add-point:ON ACTION controlp INFIELD day14 name="construct.c.day14"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day15
            #add-point:BEFORE FIELD day15 name="construct.b.day15"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day15
            
            #add-point:AFTER FIELD day15 name="construct.a.day15"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day15
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day15
            #add-point:ON ACTION controlp INFIELD day15 name="construct.c.day15"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day16
            #add-point:BEFORE FIELD day16 name="construct.b.day16"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day16
            
            #add-point:AFTER FIELD day16 name="construct.a.day16"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day16
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day16
            #add-point:ON ACTION controlp INFIELD day16 name="construct.c.day16"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day17
            #add-point:BEFORE FIELD day17 name="construct.b.day17"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day17
            
            #add-point:AFTER FIELD day17 name="construct.a.day17"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day17
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day17
            #add-point:ON ACTION controlp INFIELD day17 name="construct.c.day17"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day18
            #add-point:BEFORE FIELD day18 name="construct.b.day18"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day18
            
            #add-point:AFTER FIELD day18 name="construct.a.day18"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day18
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day18
            #add-point:ON ACTION controlp INFIELD day18 name="construct.c.day18"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day19
            #add-point:BEFORE FIELD day19 name="construct.b.day19"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day19
            
            #add-point:AFTER FIELD day19 name="construct.a.day19"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day19
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day19
            #add-point:ON ACTION controlp INFIELD day19 name="construct.c.day19"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day20
            #add-point:BEFORE FIELD day20 name="construct.b.day20"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day20
            
            #add-point:AFTER FIELD day20 name="construct.a.day20"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day20
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day20
            #add-point:ON ACTION controlp INFIELD day20 name="construct.c.day20"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day21
            #add-point:BEFORE FIELD day21 name="construct.b.day21"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day21
            
            #add-point:AFTER FIELD day21 name="construct.a.day21"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day21
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day21
            #add-point:ON ACTION controlp INFIELD day21 name="construct.c.day21"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day22
            #add-point:BEFORE FIELD day22 name="construct.b.day22"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day22
            
            #add-point:AFTER FIELD day22 name="construct.a.day22"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day22
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day22
            #add-point:ON ACTION controlp INFIELD day22 name="construct.c.day22"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day23
            #add-point:BEFORE FIELD day23 name="construct.b.day23"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day23
            
            #add-point:AFTER FIELD day23 name="construct.a.day23"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day23
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day23
            #add-point:ON ACTION controlp INFIELD day23 name="construct.c.day23"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day24
            #add-point:BEFORE FIELD day24 name="construct.b.day24"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day24
            
            #add-point:AFTER FIELD day24 name="construct.a.day24"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day24
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day24
            #add-point:ON ACTION controlp INFIELD day24 name="construct.c.day24"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day25
            #add-point:BEFORE FIELD day25 name="construct.b.day25"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day25
            
            #add-point:AFTER FIELD day25 name="construct.a.day25"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day25
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day25
            #add-point:ON ACTION controlp INFIELD day25 name="construct.c.day25"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day26
            #add-point:BEFORE FIELD day26 name="construct.b.day26"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day26
            
            #add-point:AFTER FIELD day26 name="construct.a.day26"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day26
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day26
            #add-point:ON ACTION controlp INFIELD day26 name="construct.c.day26"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day27
            #add-point:BEFORE FIELD day27 name="construct.b.day27"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day27
            
            #add-point:AFTER FIELD day27 name="construct.a.day27"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day27
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day27
            #add-point:ON ACTION controlp INFIELD day27 name="construct.c.day27"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day28
            #add-point:BEFORE FIELD day28 name="construct.b.day28"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day28
            
            #add-point:AFTER FIELD day28 name="construct.a.day28"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day28
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day28
            #add-point:ON ACTION controlp INFIELD day28 name="construct.c.day28"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day29
            #add-point:BEFORE FIELD day29 name="construct.b.day29"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day29
            
            #add-point:AFTER FIELD day29 name="construct.a.day29"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day29
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day29
            #add-point:ON ACTION controlp INFIELD day29 name="construct.c.day29"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day30
            #add-point:BEFORE FIELD day30 name="construct.b.day30"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day30
            
            #add-point:AFTER FIELD day30 name="construct.a.day30"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day30
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day30
            #add-point:ON ACTION controlp INFIELD day30 name="construct.c.day30"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day31
            #add-point:BEFORE FIELD day31 name="construct.b.day31"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day31
            
            #add-point:AFTER FIELD day31 name="construct.a.day31"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.day31
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day31
            #add-point:ON ACTION controlp INFIELD day31 name="construct.c.day31"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week01
            #add-point:BEFORE FIELD week01 name="construct.b.week01"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week01
            
            #add-point:AFTER FIELD week01 name="construct.a.week01"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week01
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week01
            #add-point:ON ACTION controlp INFIELD week01 name="construct.c.week01"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week02
            #add-point:BEFORE FIELD week02 name="construct.b.week02"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week02
            
            #add-point:AFTER FIELD week02 name="construct.a.week02"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week02
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week02
            #add-point:ON ACTION controlp INFIELD week02 name="construct.c.week02"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week03
            #add-point:BEFORE FIELD week03 name="construct.b.week03"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week03
            
            #add-point:AFTER FIELD week03 name="construct.a.week03"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week03
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week03
            #add-point:ON ACTION controlp INFIELD week03 name="construct.c.week03"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week04
            #add-point:BEFORE FIELD week04 name="construct.b.week04"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week04
            
            #add-point:AFTER FIELD week04 name="construct.a.week04"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week04
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week04
            #add-point:ON ACTION controlp INFIELD week04 name="construct.c.week04"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week05
            #add-point:BEFORE FIELD week05 name="construct.b.week05"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week05
            
            #add-point:AFTER FIELD week05 name="construct.a.week05"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week05
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week05
            #add-point:ON ACTION controlp INFIELD week05 name="construct.c.week05"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week06
            #add-point:BEFORE FIELD week06 name="construct.b.week06"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week06
            
            #add-point:AFTER FIELD week06 name="construct.a.week06"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week06
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week06
            #add-point:ON ACTION controlp INFIELD week06 name="construct.c.week06"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week07
            #add-point:BEFORE FIELD week07 name="construct.b.week07"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week07
            
            #add-point:AFTER FIELD week07 name="construct.a.week07"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.week07
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week07
            #add-point:ON ACTION controlp INFIELD week07 name="construct.c.week07"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa274
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa274
            #add-point:ON ACTION controlp INFIELD pmaa274 name="construct.c.pmaa274"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "274" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa274  #顯示到畫面上
            NEXT FIELD pmaa274                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa274
            #add-point:BEFORE FIELD pmaa274 name="construct.b.pmaa274"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa274
            
            #add-point:AFTER FIELD pmaa274 name="construct.a.pmaa274"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa275
            #add-point:BEFORE FIELD pmaa275 name="construct.b.pmaa275"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa275
            
            #add-point:AFTER FIELD pmaa275 name="construct.a.pmaa275"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa275
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa275
            #add-point:ON ACTION controlp INFIELD pmaa275 name="construct.c.pmaa275"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa276
            #add-point:BEFORE FIELD pmaa276 name="construct.b.pmaa276"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa276
            
            #add-point:AFTER FIELD pmaa276 name="construct.a.pmaa276"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa276
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa276
            #add-point:ON ACTION controlp INFIELD pmaa276 name="construct.c.pmaa276"
            
            #END add-point
 
 
         #Ctrlp:construct.c.pmaa281
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa281
            #add-point:ON ACTION controlp INFIELD pmaa281 name="construct.c.pmaa281"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2037" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa281  #顯示到畫面上
            NEXT FIELD pmaa281                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa281
            #add-point:BEFORE FIELD pmaa281 name="construct.b.pmaa281"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa281
            
            #add-point:AFTER FIELD pmaa281 name="construct.a.pmaa281"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa282
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa282
            #add-point:ON ACTION controlp INFIELD pmaa282 name="construct.c.pmaa282"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2038" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa282  #顯示到畫面上
            NEXT FIELD pmaa282                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa282
            #add-point:BEFORE FIELD pmaa282 name="construct.b.pmaa282"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa282
            
            #add-point:AFTER FIELD pmaa282 name="construct.a.pmaa282"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa283
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa283
            #add-point:ON ACTION controlp INFIELD pmaa283 name="construct.c.pmaa283"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2038" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa283  #顯示到畫面上
            NEXT FIELD pmaa283                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa283
            #add-point:BEFORE FIELD pmaa283 name="construct.b.pmaa283"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa283
            
            #add-point:AFTER FIELD pmaa283 name="construct.a.pmaa283"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa284
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa284
            #add-point:ON ACTION controlp INFIELD pmaa284 name="construct.c.pmaa284"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa284  #顯示到畫面上

            NEXT FIELD pmaa284                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa284
            #add-point:BEFORE FIELD pmaa284 name="construct.b.pmaa284"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa284
            
            #add-point:AFTER FIELD pmaa284 name="construct.a.pmaa284"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa285
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa285
            #add-point:ON ACTION controlp INFIELD pmaa285 name="construct.c.pmaa285"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2041"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa285  #顯示到畫面上
            NEXT FIELD pmaa285                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa285
            #add-point:BEFORE FIELD pmaa285 name="construct.b.pmaa285"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa285
            
            #add-point:AFTER FIELD pmaa285 name="construct.a.pmaa285"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa286
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa286
            #add-point:ON ACTION controlp INFIELD pmaa286 name="construct.c.pmaa286"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2042" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa286  #顯示到畫面上
            NEXT FIELD pmaa286                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa286
            #add-point:BEFORE FIELD pmaa286 name="construct.b.pmaa286"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa286
            
            #add-point:AFTER FIELD pmaa286 name="construct.a.pmaa286"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa287
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa287
            #add-point:ON ACTION controlp INFIELD pmaa287 name="construct.c.pmaa287"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2043" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa287  #顯示到畫面上
            NEXT FIELD pmaa287                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa287
            #add-point:BEFORE FIELD pmaa287 name="construct.b.pmaa287"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa287
            
            #add-point:AFTER FIELD pmaa287 name="construct.a.pmaa287"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa288
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa288
            #add-point:ON ACTION controlp INFIELD pmaa288 name="construct.c.pmaa288"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2044" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa288  #顯示到畫面上
            NEXT FIELD pmaa288                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa288
            #add-point:BEFORE FIELD pmaa288 name="construct.b.pmaa288"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa288
            
            #add-point:AFTER FIELD pmaa288 name="construct.a.pmaa288"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa289
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa289
            #add-point:ON ACTION controlp INFIELD pmaa289 name="construct.c.pmaa289"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2045" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa289  #顯示到畫面上
            NEXT FIELD pmaa289                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa289
            #add-point:BEFORE FIELD pmaa289 name="construct.b.pmaa289"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa289
            
            #add-point:AFTER FIELD pmaa289 name="construct.a.pmaa289"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa290
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa290
            #add-point:ON ACTION controlp INFIELD pmaa290 name="construct.c.pmaa290"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2046"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa290  #顯示到畫面上
            NEXT FIELD pmaa290                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa290
            #add-point:BEFORE FIELD pmaa290 name="construct.b.pmaa290"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa290
            
            #add-point:AFTER FIELD pmaa290 name="construct.a.pmaa290"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa291
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa291
            #add-point:ON ACTION controlp INFIELD pmaa291 name="construct.c.pmaa291"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2061" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa291  #顯示到畫面上
            NEXT FIELD pmaa291                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa291
            #add-point:BEFORE FIELD pmaa291 name="construct.b.pmaa291"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa291
            
            #add-point:AFTER FIELD pmaa291 name="construct.a.pmaa291"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa292
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa292
            #add-point:ON ACTION controlp INFIELD pmaa292 name="construct.c.pmaa292"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2062" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa292  #顯示到畫面上
            NEXT FIELD pmaa292                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa292
            #add-point:BEFORE FIELD pmaa292 name="construct.b.pmaa292"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa292
            
            #add-point:AFTER FIELD pmaa292 name="construct.a.pmaa292"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa293
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa293
            #add-point:ON ACTION controlp INFIELD pmaa293 name="construct.c.pmaa293"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2063"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa293  #顯示到畫面上
            NEXT FIELD pmaa293                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa293
            #add-point:BEFORE FIELD pmaa293 name="construct.b.pmaa293"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa293
            
            #add-point:AFTER FIELD pmaa293 name="construct.a.pmaa293"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa294
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa294
            #add-point:ON ACTION controlp INFIELD pmaa294 name="construct.c.pmaa294"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2064"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa294  #顯示到畫面上
            NEXT FIELD pmaa294                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa294
            #add-point:BEFORE FIELD pmaa294 name="construct.b.pmaa294"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa294
            
            #add-point:AFTER FIELD pmaa294 name="construct.a.pmaa294"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa295
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa295
            #add-point:ON ACTION controlp INFIELD pmaa295 name="construct.c.pmaa295"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2065" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa295  #顯示到畫面上
            NEXT FIELD pmaa295                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa295
            #add-point:BEFORE FIELD pmaa295 name="construct.b.pmaa295"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa295
            
            #add-point:AFTER FIELD pmaa295 name="construct.a.pmaa295"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa296
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa296
            #add-point:ON ACTION controlp INFIELD pmaa296 name="construct.c.pmaa296"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2066"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa296  #顯示到畫面上
            NEXT FIELD pmaa296                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa296
            #add-point:BEFORE FIELD pmaa296 name="construct.b.pmaa296"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa296
            
            #add-point:AFTER FIELD pmaa296 name="construct.a.pmaa296"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa297
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa297
            #add-point:ON ACTION controlp INFIELD pmaa297 name="construct.c.pmaa297"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2067"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa297  #顯示到畫面上
            NEXT FIELD pmaa297                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa297
            #add-point:BEFORE FIELD pmaa297 name="construct.b.pmaa297"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa297
            
            #add-point:AFTER FIELD pmaa297 name="construct.a.pmaa297"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa298
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa298
            #add-point:ON ACTION controlp INFIELD pmaa298 name="construct.c.pmaa298"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2068"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa298  #顯示到畫面上
            NEXT FIELD pmaa298                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa298
            #add-point:BEFORE FIELD pmaa298 name="construct.b.pmaa298"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa298
            
            #add-point:AFTER FIELD pmaa298 name="construct.a.pmaa298"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa299
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa299
            #add-point:ON ACTION controlp INFIELD pmaa299 name="construct.c.pmaa299"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2069"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa299  #顯示到畫面上
            NEXT FIELD pmaa299                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa299
            #add-point:BEFORE FIELD pmaa299 name="construct.b.pmaa299"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa299
            
            #add-point:AFTER FIELD pmaa299 name="construct.a.pmaa299"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.pmaa300
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa300
            #add-point:ON ACTION controlp INFIELD pmaa300 name="construct.c.pmaa300"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2070"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa300  #顯示到畫面上
            NEXT FIELD pmaa300                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa300
            #add-point:BEFORE FIELD pmaa300 name="construct.b.pmaa300"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa300
            
            #add-point:AFTER FIELD pmaa300 name="construct.a.pmaa300"
                                                                        
            #END add-point
            
 
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON pmag002,pmag003,pmag004,pmag007,pmag008,pmagstus
           FROM s_detail1[1].pmag002,s_detail1[1].pmag003,s_detail1[1].pmag004,s_detail1[1].pmag007, 
               s_detail1[1].pmag008,s_detail1[1].pmagstus
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理
       #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmagcrtdt>>----
 
         #----<<pmagmoddt>>----
         
         #----<<pmagcnfdt>>----
         
         #----<<pmagpstdt>>----
 
 
 
         
       #單身一般欄位開窗相關處理
                #Ctrlp:construct.c.page1.pmag002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag002
            #add-point:ON ACTION controlp INFIELD pmag002 name="construct.c.page1.pmag002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2036" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmag002  #顯示到畫面上
            NEXT FIELD pmag002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag002
            #add-point:BEFORE FIELD pmag002 name="construct.b.page1.pmag002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag002
            
            #add-point:AFTER FIELD pmag002 name="construct.a.page1.pmag002"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag003
            #add-point:BEFORE FIELD pmag003 name="construct.b.page1.pmag003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag003
            
            #add-point:AFTER FIELD pmag003 name="construct.a.page1.pmag003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.pmag003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag003
            #add-point:ON ACTION controlp INFIELD pmag003 name="construct.c.page1.pmag003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag004
            #add-point:BEFORE FIELD pmag004 name="construct.b.page1.pmag004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag004
            
            #add-point:AFTER FIELD pmag004 name="construct.a.page1.pmag004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.pmag004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag004
            #add-point:ON ACTION controlp INFIELD pmag004 name="construct.c.page1.pmag004"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag007
            #add-point:BEFORE FIELD pmag007 name="construct.b.page1.pmag007"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag007
            
            #add-point:AFTER FIELD pmag007 name="construct.a.page1.pmag007"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.pmag007
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag007
            #add-point:ON ACTION controlp INFIELD pmag007 name="construct.c.page1.pmag007"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag008
            #add-point:BEFORE FIELD pmag008 name="construct.b.page1.pmag008"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag008
            
            #add-point:AFTER FIELD pmag008 name="construct.a.page1.pmag008"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.pmag008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag008
            #add-point:ON ACTION controlp INFIELD pmag008 name="construct.c.page1.pmag008"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmagstus
            #add-point:BEFORE FIELD pmagstus name="construct.b.page1.pmagstus"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmagstus
            
            #add-point:AFTER FIELD pmagstus name="construct.a.page1.pmagstus"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.pmagstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmagstus
            #add-point:ON ACTION controlp INFIELD pmagstus name="construct.c.page1.pmagstus"
            
            #END add-point
 
 
   
       
      END CONSTRUCT
      
      CONSTRUCT g_wc2_table2 ON pmax002,pmax003,pmaxstus
           FROM s_detail2[1].pmax002,s_detail2[1].pmax003,s_detail2[1].pmaxstus
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body2.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 2)
       #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmaxcrtdt>>----
 
         #----<<pmaxmoddt>>----
         
         #----<<pmaxcnfdt>>----
         
         #----<<pmaxpstdt>>----
 
 
 
       
       #單身一般欄位開窗相關處理       
                #Ctrlp:construct.c.page2.pmax002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmax002
            #add-point:ON ACTION controlp INFIELD pmax002 name="construct.c.page2.pmax002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_rtax001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmax002  #顯示到畫面上
            NEXT FIELD pmax002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmax002
            #add-point:BEFORE FIELD pmax002 name="construct.b.page2.pmax002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmax002
            
            #add-point:AFTER FIELD pmax002 name="construct.a.page2.pmax002"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.pmax003
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmax003
            #add-point:ON ACTION controlp INFIELD pmax003 name="construct.c.page2.pmax003"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2002" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmax003  #顯示到畫面上
            NEXT FIELD pmax003                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmax003
            #add-point:BEFORE FIELD pmax003 name="construct.b.page2.pmax003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmax003
            
            #add-point:AFTER FIELD pmax003 name="construct.a.page2.pmax003"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaxstus
            #add-point:BEFORE FIELD pmaxstus name="construct.b.page2.pmaxstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaxstus
            
            #add-point:AFTER FIELD pmaxstus name="construct.a.page2.pmaxstus"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.pmaxstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaxstus
            #add-point:ON ACTION controlp INFIELD pmaxstus name="construct.c.page2.pmaxstus"
                                                                        
            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table3 ON pmay002,pmay003,pmay003_desc,pmay004,pmay005
           FROM s_detail3[1].pmay002,s_detail3[1].pmay003,s_detail3[1].pmay003_desc,s_detail3[1].pmay004, 
               s_detail3[1].pmay005
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body3.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 3)
       
       
       #單身一般欄位開窗相關處理       
                #Ctrlp:construct.c.page3.pmay002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay002
            #add-point:ON ACTION controlp INFIELD pmay002 name="construct.c.page3.pmay002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmay002  #顯示到畫面上

            NEXT FIELD pmay002                     #返回原欄位


            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay002
            #add-point:BEFORE FIELD pmay002 name="construct.b.page3.pmay002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay002
            
            #add-point:AFTER FIELD pmay002 name="construct.a.page3.pmay002"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.pmay003
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay003
            #add-point:ON ACTION controlp INFIELD pmay003 name="construct.c.page3.pmay003"
            #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "1" 
            CALL q_oojd001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmay003  #顯示到畫面上
            NEXT FIELD pmay003                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay003
            #add-point:BEFORE FIELD pmay003 name="construct.b.page3.pmay003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay003
            
            #add-point:AFTER FIELD pmay003 name="construct.a.page3.pmay003"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay003_desc
            #add-point:BEFORE FIELD pmay003_desc name="construct.b.page3.pmay003_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay003_desc
            
            #add-point:AFTER FIELD pmay003_desc name="construct.a.page3.pmay003_desc"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.pmay003_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay003_desc
            #add-point:ON ACTION controlp INFIELD pmay003_desc name="construct.c.page3.pmay003_desc"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay004
            #add-point:BEFORE FIELD pmay004 name="construct.b.page3.pmay004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay004
            
            #add-point:AFTER FIELD pmay004 name="construct.a.page3.pmay004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.pmay004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay004
            #add-point:ON ACTION controlp INFIELD pmay004 name="construct.c.page3.pmay004"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay005
            #add-point:BEFORE FIELD pmay005 name="construct.b.page3.pmay005"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay005
            
            #add-point:AFTER FIELD pmay005 name="construct.a.page3.pmay005"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.pmay005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay005
            #add-point:ON ACTION controlp INFIELD pmay005 name="construct.c.page3.pmay005"
                                                                        
            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table4 ON pmaz002,pmaz003
           FROM s_detail4[1].pmaz002,s_detail4[1].pmaz003
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body4.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 4)
       
       
       #單身一般欄位開窗相關處理       
                #Ctrlp:construct.c.page4.pmaz002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaz002
            #add-point:ON ACTION controlp INFIELD pmaz002 name="construct.c.page4.pmaz002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "2074" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaz002  #顯示到畫面上
            NEXT FIELD pmaz002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaz002
            #add-point:BEFORE FIELD pmaz002 name="construct.b.page4.pmaz002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaz002
            
            #add-point:AFTER FIELD pmaz002 name="construct.a.page4.pmaz002"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaz003
            #add-point:BEFORE FIELD pmaz003 name="construct.b.page4.pmaz003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaz003
            
            #add-point:AFTER FIELD pmaz003 name="construct.a.page4.pmaz003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.pmaz003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaz003
            #add-point:ON ACTION controlp INFIELD pmaz003 name="construct.c.page4.pmaz003"
                                                                        
            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table5 ON pmacstus,pmac003,pmac004,pmac002
           FROM s_detail5[1].pmacstus,s_detail5[1].pmac003,s_detail5[1].pmac004,s_detail5[1].pmac002
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body5.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 5)
       #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmaccrtdt>>----
 
         #----<<pmacmoddt>>----
         
         #----<<pmaccnfdt>>----
         
         #----<<pmacpstdt>>----
 
 
 
       
       #單身一般欄位開窗相關處理       
                #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmacstus
            #add-point:BEFORE FIELD pmacstus name="construct.b.page5.pmacstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmacstus
            
            #add-point:AFTER FIELD pmacstus name="construct.a.page5.pmacstus"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.pmacstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmacstus
            #add-point:ON ACTION controlp INFIELD pmacstus name="construct.c.page5.pmacstus"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac003
            #add-point:BEFORE FIELD pmac003 name="construct.b.page5.pmac003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac003
            
            #add-point:AFTER FIELD pmac003 name="construct.a.page5.pmac003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.pmac003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac003
            #add-point:ON ACTION controlp INFIELD pmac003 name="construct.c.page5.pmac003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac004
            #add-point:BEFORE FIELD pmac004 name="construct.b.page5.pmac004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac004
            
            #add-point:AFTER FIELD pmac004 name="construct.a.page5.pmac004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.pmac004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac004
            #add-point:ON ACTION controlp INFIELD pmac004 name="construct.c.page5.pmac004"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.page5.pmac002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac002
            #add-point:ON ACTION controlp INFIELD pmac002 name="construct.c.page5.pmac002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "('1','2','3')"
            CALL q_pmaa001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmac002  #顯示到畫面上
            NEXT FIELD pmac002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac002
            #add-point:BEFORE FIELD pmac002 name="construct.b.page5.pmac002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac002
            
            #add-point:AFTER FIELD pmac002 name="construct.a.page5.pmac002"
                                                                        
            #END add-point
            
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table6 ON pmafstus,pmaf010,pmaf002,pmaf003,pmaf004,pmaf011,pmaf008,pmaf009,pmaf005, 
          pmaf007,pmaf006
           FROM s_detail6[1].pmafstus,s_detail6[1].pmaf010,s_detail6[1].pmaf002,s_detail6[1].pmaf003, 
               s_detail6[1].pmaf004,s_detail6[1].pmaf011,s_detail6[1].pmaf008,s_detail6[1].pmaf009,s_detail6[1].pmaf005, 
               s_detail6[1].pmaf007,s_detail6[1].pmaf006
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body6.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 6)
       #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmafcrtdt>>----
 
         #----<<pmafmoddt>>----
         
         #----<<pmafcnfdt>>----
         
         #----<<pmafpstdt>>----
 
 
 
       
       #單身一般欄位開窗相關處理       
                #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmafstus
            #add-point:BEFORE FIELD pmafstus name="construct.b.page6.pmafstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmafstus
            
            #add-point:AFTER FIELD pmafstus name="construct.a.page6.pmafstus"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmafstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmafstus
            #add-point:ON ACTION controlp INFIELD pmafstus name="construct.c.page6.pmafstus"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf010
            #add-point:BEFORE FIELD pmaf010 name="construct.b.page6.pmaf010"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf010
            
            #add-point:AFTER FIELD pmaf010 name="construct.a.page6.pmaf010"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf010
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf010
            #add-point:ON ACTION controlp INFIELD pmaf010 name="construct.c.page6.pmaf010"
            
            #END add-point
 
 
         #Ctrlp:construct.c.page6.pmaf002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf002
            #add-point:ON ACTION controlp INFIELD pmaf002 name="construct.c.page6.pmaf002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_nmab001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaf002  #顯示到畫面上
            NEXT FIELD pmaf002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf002
            #add-point:BEFORE FIELD pmaf002 name="construct.b.page6.pmaf002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf002
            
            #add-point:AFTER FIELD pmaf002 name="construct.a.page6.pmaf002"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf003
            #add-point:BEFORE FIELD pmaf003 name="construct.b.page6.pmaf003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf003
            
            #add-point:AFTER FIELD pmaf003 name="construct.a.page6.pmaf003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf003
            #add-point:ON ACTION controlp INFIELD pmaf003 name="construct.c.page6.pmaf003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf004
            #add-point:BEFORE FIELD pmaf004 name="construct.b.page6.pmaf004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf004
            
            #add-point:AFTER FIELD pmaf004 name="construct.a.page6.pmaf004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf004
            #add-point:ON ACTION controlp INFIELD pmaf004 name="construct.c.page6.pmaf004"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf011
            #add-point:BEFORE FIELD pmaf011 name="construct.b.page6.pmaf011"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf011
            
            #add-point:AFTER FIELD pmaf011 name="construct.a.page6.pmaf011"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf011
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf011
            #add-point:ON ACTION controlp INFIELD pmaf011 name="construct.c.page6.pmaf011"
            #C160516-00014#17 add by liyan 160729--str--
            LET g_qryparam.state = 'c'
		    	LET g_qryparam.reqry = FALSE
            #給予arg
            CALL q_mhbe001_2()                                  #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmbf011       #顯示到畫面上
            NEXT FIELD pmaf011
            #C160516-00014#17 add by liyan 160729--END--
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf008
            #add-point:BEFORE FIELD pmaf008 name="construct.b.page6.pmaf008"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf008
            
            #add-point:AFTER FIELD pmaf008 name="construct.a.page6.pmaf008"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf008
            #add-point:ON ACTION controlp INFIELD pmaf008 name="construct.c.page6.pmaf008"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf009
            #add-point:BEFORE FIELD pmaf009 name="construct.b.page6.pmaf009"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf009
            
            #add-point:AFTER FIELD pmaf009 name="construct.a.page6.pmaf009"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf009
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf009
            #add-point:ON ACTION controlp INFIELD pmaf009 name="construct.c.page6.pmaf009"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf005
            #add-point:BEFORE FIELD pmaf005 name="construct.b.page6.pmaf005"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf005
            
            #add-point:AFTER FIELD pmaf005 name="construct.a.page6.pmaf005"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf005
            #add-point:ON ACTION controlp INFIELD pmaf005 name="construct.c.page6.pmaf005"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf007
            #add-point:BEFORE FIELD pmaf007 name="construct.b.page6.pmaf007"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf007
            
            #add-point:AFTER FIELD pmaf007 name="construct.a.page6.pmaf007"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf007
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf007
            #add-point:ON ACTION controlp INFIELD pmaf007 name="construct.c.page6.pmaf007"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf006
            #add-point:BEFORE FIELD pmaf006 name="construct.b.page6.pmaf006"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf006
            
            #add-point:AFTER FIELD pmaf006 name="construct.a.page6.pmaf006"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page6.pmaf006
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf006
            #add-point:ON ACTION controlp INFIELD pmaf006 name="construct.c.page6.pmaf006"
                                                                        
            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table7 ON pmad003,pmadstus,pmad002,pmad004
           FROM s_detail7[1].pmad003,s_detail7[1].pmadstus,s_detail7[1].pmad002,s_detail7[1].pmad004
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body7.before_construct"
                                                                        
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 7)
       #應用 a11 樣板自動產生(Version:3)
         #共用欄位查詢處理  
         ##----<<pmadcrtdt>>----
 
         #----<<pmadmoddt>>----
         
         #----<<pmadcnfdt>>----
         
         #----<<pmadpstdt>>----
 
 
 
       
       #單身一般欄位開窗相關處理       
                #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad003
            #add-point:BEFORE FIELD pmad003 name="construct.b.page7.pmad003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad003
            
            #add-point:AFTER FIELD pmad003 name="construct.a.page7.pmad003"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page7.pmad003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad003
            #add-point:ON ACTION controlp INFIELD pmad003 name="construct.c.page7.pmad003"
                                                                        
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmadstus
            #add-point:BEFORE FIELD pmadstus name="construct.b.page7.pmadstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmadstus
            
            #add-point:AFTER FIELD pmadstus name="construct.a.page7.pmadstus"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page7.pmadstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmadstus
            #add-point:ON ACTION controlp INFIELD pmadstus name="construct.c.page7.pmadstus"
                                                                        
            #END add-point
 
 
         #Ctrlp:construct.c.page7.pmad002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad002
            #add-point:ON ACTION controlp INFIELD pmad002 name="construct.c.page7.pmad002"
                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooib002_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmad002  #顯示到畫面上
            NEXT FIELD pmad002                     #返回原欄位
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad002
            #add-point:BEFORE FIELD pmad002 name="construct.b.page7.pmad002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad002
            
            #add-point:AFTER FIELD pmad002 name="construct.a.page7.pmad002"
                                                                        
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad004
            #add-point:BEFORE FIELD pmad004 name="construct.b.page7.pmad004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad004
            
            #add-point:AFTER FIELD pmad004 name="construct.a.page7.pmad004"
                                                                        
            #END add-point
            
 
 
         #Ctrlp:construct.c.page7.pmad004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad004
            #add-point:ON ACTION controlp INFIELD pmad004 name="construct.c.page7.pmad004"
                                                                        
            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table8 ON pmae002,oocq005,pmae003
           FROM s_detail9[1].pmae002,s_detail9[1].oocq005,s_detail9[1].pmae003
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct name="cs.body8.before_construct"
            
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 8)
       
       
       #單身一般欄位開窗相關處理       
                #Ctrlp:construct.c.page9.pmae002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmae002
            #add-point:ON ACTION controlp INFIELD pmae002 name="construct.c.page9.pmae002"
            #應用 a08 樣板自動產生(Version:3)
            #開窗c段            
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '235'
            
            CALL q_oocq002_1()                    
            
            DISPLAY g_qryparam.return1 TO pmae002 
            NEXT FIELD pmae002     
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmae002
            #add-point:BEFORE FIELD pmae002 name="construct.b.page9.pmae002"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmae002
            
            #add-point:AFTER FIELD pmae002 name="construct.a.page9.pmae002"
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD oocq005
            #add-point:BEFORE FIELD oocq005 name="construct.b.page9.oocq005"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD oocq005
            
            #add-point:AFTER FIELD oocq005 name="construct.a.page9.oocq005"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page9.oocq005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD oocq005
            #add-point:ON ACTION controlp INFIELD oocq005 name="construct.c.page9.oocq005"
            
            #END add-point
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmae003
            #add-point:BEFORE FIELD pmae003 name="construct.b.page9.pmae003"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmae003
            
            #add-point:AFTER FIELD pmae003 name="construct.a.page9.pmae003"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.page9.pmae003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmae003
            #add-point:ON ACTION controlp INFIELD pmae003 name="construct.c.page9.pmae003"
            
            #END add-point
 
 
   
       
      END CONSTRUCT
 
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令) name="cs.add_cs"
     #CONSTRUCT g_wc2_table8 ON pmad003,pmadstus,pmad002,pmad004   #160810-00008#1 160819 by lori mark
      CONSTRUCT g_wc2_pmad ON pmad003,pmadstus,pmad002,pmad004     #160810-00008#1 160819 by lori add
           FROM s_detail8[1].pmad003_1,s_detail8[1].pmadstus_1,s_detail8[1].pmad002_1, 
                s_detail8[1].pmad004_1
                      
         BEFORE CONSTRUCT

         ON ACTION controlp INFIELD pmad002_1
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooib002_2()                      #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmad002_1 #顯示到畫面上
            NEXT FIELD pmad002_1                    #返回原欄位       
 
      END CONSTRUCT
      
      SUBDIALOG aoo_aooi350_01.aooi350_01_construct
      SUBDIALOG aoo_aooi350_02.aooi350_02_construct  
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog name="cs.b_dialog"
                                                      
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
         IF NOT cl_null(ls_wc) THEN
            CALL util.JSON.parse(ls_wc, la_wc)
            INITIALIZE g_wc, g_wc2, g_wc2_table1, g_wc2_extend TO NULL
            INITIALIZE g_wc2_table2 TO NULL
 
            INITIALIZE g_wc2_table3 TO NULL
 
            INITIALIZE g_wc2_table4 TO NULL
 
            INITIALIZE g_wc2_table5 TO NULL
 
            INITIALIZE g_wc2_table6 TO NULL
 
            INITIALIZE g_wc2_table7 TO NULL
 
            INITIALIZE g_wc2_table8 TO NULL
 
 
            FOR li_idx = 1 TO la_wc.getLength()
               CASE
                  WHEN la_wc[li_idx].tableid = "pmaa_t" 
                     LET g_wc = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "pmag_t" 
                     LET g_wc2_table1 = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "pmax_t" 
                     LET g_wc2_table2 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmay_t" 
                     LET g_wc2_table3 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmaz_t" 
                     LET g_wc2_table4 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmac_t" 
                     LET g_wc2_table5 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmaf_t" 
                     LET g_wc2_table6 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmad_t" 
                     LET g_wc2_table7 = la_wc[li_idx].wc
 
                  WHEN la_wc[li_idx].tableid = "pmae_t" 
                     LET g_wc2_table8 = la_wc[li_idx].wc
 
 
               END CASE
            END FOR
         END IF
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
   IF g_wc2_table2 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
   END IF
 
   IF g_wc2_table3 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
   END IF
 
   IF g_wc2_table4 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
   END IF
 
   IF g_wc2_table5 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table5
   END IF
 
   IF g_wc2_table6 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table6
   END IF
 
   IF g_wc2_table7 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table7
   END IF
 
   IF g_wc2_table8 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table8
   END IF
 
 
 
 
   
   #add-point:cs段結束前 name="cs.after_construct"
   #160810-00008#1 160819 by lori mark---(S)
   #IF g_wc2_table8 <> " 1=1" THEN
   #   LET g_wc2 = g_wc2 ," AND ", g_wc2_table8
   #END IF
   #160810-00008#1 160819 by lori mark---(E)

   #160810-00008#1 160819 by lori mark---(S)
   IF g_wc2_pmad <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_pmad
   END IF
   #160810-00008#1 160819 by lori mark---(E)
   
   IF g_wc2_i35001 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_i35001
   END IF

   IF g_wc2_i35002 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_i35002
   END IF
   
#   IF cl_null(g_wc) THEN
#      CASE g_argv[1]
#         WHEN '1' 
#            LET g_wc = " pmaa002 != '2'"
#         WHEN '2' 
#            LET g_wc = " pmaa002 != '1' AND pmaa230 = '1' AND pmaa092 = '2'" 
#         WHEN '3'
#            LET g_wc = " pmaa002 != '1' AND pmaa230 = '1' AND pmaa092 = '1'" 
#      END CASE    
#   ELSE
#      CASE g_argv[1]
#         WHEN '1' 
#            LET g_wc = g_wc CLIPPED," AND pmaa002 != '2'"
#         WHEN '2'
#            LET g_wc = g_wc CLIPPED," AND pmaa002 != '1' AND pmaa230 = '1' AND pmaa092 = '2'"
#         WHEN '3'
#            LET g_wc = g_wc CLIPPED," AND pmaa002 != '1' AND pmaa230 = '1' AND pmaa092 = '1'"
#      END CASE  
#   END IF
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.filter" >}
#應用 a50 樣板自動產生(Version:8)
#+ filter過濾功能
PRIVATE FUNCTION apmm801_filter()
   #add-point:filter段define name="filter.define_customerization"
   
   #end add-point   
   #add-point:filter段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="filter.define"
                  
   #end add-point   
   
   #add-point:Function前置處理  name="filter.pre_function"
   
   #end add-point
   
   #切換畫面
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON pmaa001,pmaa002,pmaa003
                          FROM s_browse[1].b_pmaa001,s_browse[1].b_pmaa002,s_browse[1].b_pmaa003
 
         BEFORE CONSTRUCT
               DISPLAY apmm801_filter_parser('pmaa001') TO s_browse[1].b_pmaa001
            DISPLAY apmm801_filter_parser('pmaa002') TO s_browse[1].b_pmaa002
            DISPLAY apmm801_filter_parser('pmaa003') TO s_browse[1].b_pmaa003
      
         #add-point:filter段cs_ctrl name="filter.cs_ctrl"
         
         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter段add_cs name="filter.add_cs"
                                    
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog name="filter.b_dialog"
                                                      
         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL apmm801_filter_show('pmaa001')
   CALL apmm801_filter_show('pmaa002')
   CALL apmm801_filter_show('pmaa003')
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.filter_parser" >}
#+ filter過濾功能
PRIVATE FUNCTION apmm801_filter_parser(ps_field)
   #add-point:filter段define name="filter_parser.define_customerization"
   
   #end add-point    
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num10
   DEFINE li_tmp2    LIKE type_t.num10
   DEFINE ls_var     STRING
   #add-point:filter段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="filter_parser.define"
                  
   #end add-point    
   
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.filter_show" >}
#+ 顯示過濾條件
PRIVATE FUNCTION apmm801_filter_show(ps_field)
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = apmm801_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.query" >}
#+ 資料查詢QBE功能準備
PRIVATE FUNCTION apmm801_query()
   #add-point:query段define(客製用) name="query.define_customerization"
   
   #end add-point   
   DEFINE ls_wc STRING
   #add-point:query段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="query.define"
   DEFINE p_cmd     LIKE type_t.chr1
   #end add-point   
   
   #add-point:Function前置處理  name="query.pre_function"
   
   #end add-point
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_pmag_d.clear()
   CALL g_pmag2_d.clear()
   CALL g_pmag3_d.clear()
   CALL g_pmag4_d.clear()
   CALL g_pmag5_d.clear()
   CALL g_pmag6_d.clear()
   CALL g_pmag7_d.clear()
   CALL g_pmag9_d.clear()
 
   
   #add-point:query段other name="query.other"
   CALL g_pmag8_d.clear()   
   INITIALIZE g_pmaa027_d TO NULL
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()
   CALL apmm801_set_comp_visible(p_cmd)      #150616-00034#1 beckxie
   #end add-point   
   
   DISPLAY '' TO FORMONLY.idx
   DISPLAY '' TO FORMONLY.cnt
   DISPLAY '' TO FORMONLY.b_index
   DISPLAY '' TO FORMONLY.b_count
   DISPLAY '' TO FORMONLY.h_index
   DISPLAY '' TO FORMONLY.h_count
   
   CALL apmm801_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      #LET g_wc = ls_wc
      LET g_wc = " 1=2"
      CALL apmm801_browser_fill("")
      CALL apmm801_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_detail_idx_list[1] = 1
   LET g_detail_idx_list[2] = 1
   LET g_detail_idx_list[3] = 1
   LET g_detail_idx_list[4] = 1
   LET g_detail_idx_list[5] = 1
   LET g_detail_idx_list[6] = 1
   LET g_detail_idx_list[7] = 1
   LET g_detail_idx_list[8] = 1
 
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL apmm801_filter_show('pmaa001')
   CALL apmm801_filter_show('pmaa002')
   CALL apmm801_filter_show('pmaa003')
   CALL apmm801_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "-100" 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
   ELSE
      CALL apmm801_fetch("F") 
      #顯示單身筆數
      CALL apmm801_idx_chk()
   END IF
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.fetch" >}
#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION apmm801_fetch(p_flag)
   #add-point:fetch段define(客製用) name="fetch.define_customerization"
   
   #end add-point    
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="fetch.define"
   DEFINE p_cmd      LIKE type_t.chr1
   DEFINE l_success  LIKE type_t.num5 #sakura add                                  
   #end add-point    
   
   #add-point:Function前置處理  name="fetch.pre_function"
   
   #end add-point
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
 
   #清空第二階單身
 
   
   CALL cl_ap_performance_next_start()
   CASE p_flag
      WHEN 'F' 
         LET g_current_idx = 1
      WHEN 'L'  
         LET g_current_idx = g_browser.getLength()              
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE  
   END CASE 
 
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #設定browse 索引
   
   LET g_current_row = g_current_idx
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   IF g_detail_cnt > 0 THEN
      #若單身有資料時, idx至少為1
      IF g_detail_idx <= 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY '' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #當下筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
 
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #避免超出browser資料筆數上限
   IF g_current_idx > g_browser.getLength() THEN
      LET g_browser_idx = g_browser.getLength()
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_pmaa_m.pmaa001 = g_browser[g_current_idx].b_pmaa001
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
   #遮罩相關處理
   LET g_pmaa_m_mask_o.* =  g_pmaa_m.*
   CALL apmm801_pmaa_t_mask()
   LET g_pmaa_m_mask_n.* =  g_pmaa_m.*
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL apmm801_set_act_visible()   
   CALL apmm801_set_act_no_visible()
   
   #add-point:fetch段action控制 name="fetch.action_control"
   CALL apmm801_set_comp_visible(p_cmd)
   CALL apmm801_set_comp_no_visible(p_cmd)
   #ken_mark
   #IF cl_null(g_pmaa_m.pmaa001) THEN
   #   CALL cl_set_act_visible("modify_credit",FALSE)
   #ELSE
   #   CALL cl_set_act_visible("modify_credit",TRUE)
   #END IF
   #
   #IF g_pmaa_m.pmaastus = 'N' THEN
   #   CALL cl_set_act_visible("modify,delete,modify_detail,modify_credit,open_aooi350",TRUE)
   #ELSE
   #   CALL cl_set_act_visible("modify,delete,modify_detail,modify_credit,open_aooi350",FALSE)
   #END IF   
   #
   #IF cl_null(g_pmaa_m.pmaa027) THEN
   #   CALL cl_set_act_visible("open_aooi350",FALSE)      
   #END IF
  
   #end add-point  
   
   
   
   #add-point:fetch結束前 name="fetch.after"
                
   #end add-point
   
   #保存單頭舊值
   LET g_pmaa_m_t.* = g_pmaa_m.*
   LET g_pmaa_m_o.* = g_pmaa_m.*
   
   LET g_data_owner = g_pmaa_m.pmaaownid      
   LET g_data_dept  = g_pmaa_m.pmaaowndp
   
   #重新顯示   
   CALL apmm801_show()
 
   
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.insert" >}
#+ 資料新增
PRIVATE FUNCTION apmm801_insert()
   #add-point:insert段define(客製用) name="insert.define_customerization"
   
   #end add-point    
   #add-point:insert段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="insert.define"
   DEFINE l_success    LIKE type_t.num5      
   DEFINE l_insert       LIKE type_t.num5
   DEFINE p_cmd     LIKE type_t.chr1
   #end add-point    
   
   #add-point:Function前置處理  name="insert.pre_function"
   
   #end add-point
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_pmag_d.clear()   
   CALL g_pmag2_d.clear()  
   CALL g_pmag3_d.clear()  
   CALL g_pmag4_d.clear()  
   CALL g_pmag5_d.clear()  
   CALL g_pmag6_d.clear()  
   CALL g_pmag7_d.clear()  
   CALL g_pmag9_d.clear()  
 
 
   INITIALIZE g_pmaa_m.* TO NULL             #DEFAULT 設定
   
   LET g_pmaa001_t = NULL
 
   
   LET g_master_insert = FALSE
   
   #add-point:insert段before name="insert.before"
 
   #end add-point    
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmaa_m.pmaaownid = g_user
      LET g_pmaa_m.pmaaowndp = g_dept
      LET g_pmaa_m.pmaacrtid = g_user
      LET g_pmaa_m.pmaacrtdp = g_dept 
      LET g_pmaa_m.pmaacrtdt = cl_get_current()
      LET g_pmaa_m.pmaamodid = g_user
      LET g_pmaa_m.pmaamoddt = cl_get_current()
      LET g_pmaa_m.pmaastus = 'N'
 
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
            LET g_pmaa_m.pmaa002 = "3"
      LET g_pmaa_m.pmaastus = "N"
      LET g_pmaa_m.pmaa004 = "1"
      LET g_pmaa_m.pmaa202 = "N"
      LET g_pmaa_m.pmaa018 = "0"
      LET g_pmaa_m.pmaa021 = "0"
      LET g_pmaa_m.pmaa230 = "1"
      LET g_pmaa_m.pmaa092 = "1"
      LET g_pmaa_m.pmaa246 = "0"
      LET g_pmaa_m.pmaa248 = "N"
      LET g_pmaa_m.pmaa220 = "1"
      LET g_pmaa_m.pmaa051 = "1"
      LET g_pmaa_m.pmaa055 = "0"
      LET g_pmaa_m.pmaa074 = "0"
      LET g_pmaa_m.pmaa059 = "0"
      LET g_pmaa_m.pmaa047 = "N"
      LET g_pmaa_m.pmaa036 = "N"
      LET g_pmaa_m.pmaa068 = "Y"
      LET g_pmaa_m.pmaa069 = "Y"
      LET g_pmaa_m.pmaa072 = "Y"
      LET g_pmaa_m.pmaa070 = "Y"
      LET g_pmaa_m.pmaa071 = "Y"
      LET g_pmaa_m.pmaa204 = "1"
      LET g_pmaa_m.pmaa206 = "1"
      LET g_pmaa_m.pmab057 = "1"
      LET g_pmaa_m.pmab058 = "1"
      LET g_pmaa_m.pmab035 = "10"
      LET g_pmaa_m.pmab049 = "Y"
      LET g_pmaa_m.pmab051 = "Y"
      LET g_pmaa_m.pmab085 = "10"
      LET g_pmaa_m.pmab107 = "1"
      LET g_pmaa_m.pmab108 = "1"
      LET g_pmaa_m.pmab099 = "Y"
      LET g_pmaa_m.pmab101 = "Y"
      LET g_pmaa_m.pmaa270 = "1"
      LET g_pmaa_m.day01 = "N"
      LET g_pmaa_m.day02 = "N"
      LET g_pmaa_m.day03 = "N"
      LET g_pmaa_m.day04 = "N"
      LET g_pmaa_m.day05 = "N"
      LET g_pmaa_m.day06 = "N"
      LET g_pmaa_m.day07 = "N"
      LET g_pmaa_m.day08 = "N"
      LET g_pmaa_m.day09 = "N"
      LET g_pmaa_m.day10 = "N"
      LET g_pmaa_m.day11 = "N"
      LET g_pmaa_m.day12 = "N"
      LET g_pmaa_m.day13 = "N"
      LET g_pmaa_m.day14 = "N"
      LET g_pmaa_m.day15 = "N"
      LET g_pmaa_m.day16 = "N"
      LET g_pmaa_m.day17 = "N"
      LET g_pmaa_m.day18 = "N"
      LET g_pmaa_m.day19 = "N"
      LET g_pmaa_m.day20 = "N"
      LET g_pmaa_m.day21 = "N"
      LET g_pmaa_m.day22 = "N"
      LET g_pmaa_m.day23 = "N"
      LET g_pmaa_m.day24 = "N"
      LET g_pmaa_m.day25 = "N"
      LET g_pmaa_m.day26 = "N"
      LET g_pmaa_m.day27 = "N"
      LET g_pmaa_m.day28 = "N"
      LET g_pmaa_m.day29 = "N"
      LET g_pmaa_m.day30 = "N"
      LET g_pmaa_m.day31 = "N"
      LET g_pmaa_m.week01 = "N"
      LET g_pmaa_m.week02 = "N"
      LET g_pmaa_m.week03 = "N"
      LET g_pmaa_m.week04 = "N"
      LET g_pmaa_m.week05 = "N"
      LET g_pmaa_m.week06 = "N"
      LET g_pmaa_m.week07 = "N"
      LET g_pmaa_m.pmaa275 = "0"
      LET g_pmaa_m.pmaa276 = "0"
 
  
      #add-point:單頭預設值 name="insert.default"
      CALL g_pmag8_d.clear()          
      INITIALIZE g_pmaa027_d TO NULL
      CALL aooi350_01_clear_detail()
      CALL aooi350_02_clear_detail()
            
#      CASE g_argv[1]
#         WHEN '1'
#            LET g_pmaa_m.pmaa002 = '1'
#            LET g_pmaa_m.pmab032 = g_dlang
#         WHEN '2'         
#            LET g_pmaa_m.pmaa002 = '2'
#            LET g_pmaa_m.pmab082 = g_dlang
#            LET g_pmaa_m.pmaa092 = '2'
#         WHEN '3'
#            LET g_pmaa_m.pmaa002 = '2'
#            LET g_pmaa_m.pmab082 = g_dlang
#            LET g_pmaa_m.pmaa092 = '1'
#      END CASE
      LET g_pmaa_m.pmaa220 = "1"
      CALL s_aooi500_default(g_prog,'pmaaunit',g_site)
       RETURNING l_insert,g_pmaa_m.pmaa085
      IF NOT l_insert THEN
        RETURN
      END IF
      CALL apmm801_pmaa085_ref()
      
      CALL s_aooi500_default(g_prog,'pmaaunit',g_site)
       RETURNING l_insert,g_pmaa_m.pmaa095
      IF NOT l_insert THEN
        RETURN
      END IF
      CALL apmm801_pmaa095_ref()
      
      CALL apmm801_pmaa270_visible()
      CALL apmm801_set_comp_visible(p_cmd)      #150616-00034#2 beckxie
      CALL apmm801_set_comp_no_visible(p_cmd)   #150616-00034#2 beckxie
      LET g_pmaa_m_t.* = g_pmaa_m.*
      LET g_pmaa_m_o.* = g_pmaa_m.*
#      LET g_pmaa_m.pmaa083 = s_default_rtdb001(g_prog)  #生命周期栏位赋值
      LET g_pmaa_m.pmaa083 = s_life_cycle_default(g_prog,'2') #生命周期栏位赋值
      #end add-point 
      
      #保存單頭舊值(用於資料輸入錯誤還原預設值時使用)
      LET g_pmaa_m_t.* = g_pmaa_m.*
      LET g_pmaa_m_o.* = g_pmaa_m.*
      
      #顯示狀態(stus)圖片
            #應用 a21 樣板自動產生(Version:3)
	  #根據當下狀態碼顯示圖片
      CASE g_pmaa_m.pmaastus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")
         
      END CASE
 
 
 
    
      CALL apmm801_input("a")
      
      #add-point:單頭輸入後 name="insert.after_insert"
                                    
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code = 9001 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
      END IF
      
      IF NOT g_master_insert THEN
         DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
         DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
         INITIALIZE g_pmaa_m.* TO NULL
         INITIALIZE g_pmag_d TO NULL
         INITIALIZE g_pmag2_d TO NULL
         INITIALIZE g_pmag3_d TO NULL
         INITIALIZE g_pmag4_d TO NULL
         INITIALIZE g_pmag5_d TO NULL
         INITIALIZE g_pmag6_d TO NULL
         INITIALIZE g_pmag7_d TO NULL
         INITIALIZE g_pmag9_d TO NULL
 
         #add-point:取消新增後 name="insert.cancel"
         
         #end add-point 
         CALL apmm801_show()
         RETURN
      END IF
      
      LET INT_FLAG = 0
      #CALL g_pmag_d.clear()
      #CALL g_pmag2_d.clear()
      #CALL g_pmag3_d.clear()
      #CALL g_pmag4_d.clear()
      #CALL g_pmag5_d.clear()
      #CALL g_pmag6_d.clear()
      #CALL g_pmag7_d.clear()
      #CALL g_pmag9_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL apmm801_set_act_visible()   
   CALL apmm801_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_pmaa001_t = g_pmaa_m.pmaa001
 
   
   #組合新增資料的條件
   LET g_add_browse = " pmaaent = " ||g_enterprise|| " AND",
                      " pmaa001 = '", g_pmaa_m.pmaa001, "' "
 
                      
   #add-point:組合新增資料的條件後 name="insert.after.add_browse"
   
   #end add-point
      
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL apmm801_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   CLOSE apmm801_cl
   
   CALL apmm801_idx_chk()
   
   #撈取異動後的資料(主要是帶出reference)
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
   
   #遮罩相關處理
   LET g_pmaa_m_mask_o.* =  g_pmaa_m.*
   CALL apmm801_pmaa_t_mask()
   LET g_pmaa_m_mask_n.* =  g_pmaa_m.*
   
   #將資料顯示到畫面上
   DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
       g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
       g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc, 
       g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024,g_pmaa_m.pmaa024_desc, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa009_desc, 
       g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231, 
       g_pmaa_m.pmaa231_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc, 
       g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa094_desc, 
       g_pmaa_m.pmaa093,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097, 
       g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc, 
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa245, 
       g_pmaa_m.pmaa245_desc,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc, 
       g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa222,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080,g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083, 
       g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053,g_pmaa_m.pmaa053_desc, 
       g_pmaa_m.pmaa054,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa205_desc, 
       g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053,g_pmaa_m.pmab053_desc, 
       g_pmaa_m.pmab039,g_pmaa_m.pmab039_desc,g_pmaa_m.pmaa081,g_pmaa_m.pmaa081_desc,g_pmaa_m.pmab033, 
       g_pmaa_m.pmab033_desc,g_pmaa_m.pmab034,g_pmaa_m.pmab034_desc,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
       g_pmaa_m.pmab056_desc,g_pmaa_m.pmab037,g_pmaa_m.pmab037_desc,g_pmaa_m.pmab055,g_pmaa_m.pmab055_desc, 
       g_pmaa_m.pmab038,g_pmaa_m.pmab038_desc,g_pmaa_m.pmab040,g_pmaa_m.pmab040_desc,g_pmaa_m.pmab041, 
       g_pmaa_m.pmab041_desc,g_pmaa_m.pmab042,g_pmaa_m.pmab042_desc,g_pmaa_m.pmab043,g_pmaa_m.pmab043_desc, 
       g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab047_desc,g_pmaa_m.pmab048, 
       g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
       g_pmaa_m.pmab083,g_pmaa_m.pmab083_desc,g_pmaa_m.pmab084,g_pmaa_m.pmab084_desc,g_pmaa_m.pmab103, 
       g_pmaa_m.pmab103_desc,g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
       g_pmaa_m.pmab106_desc,g_pmaa_m.pmab087,g_pmaa_m.pmab087_desc,g_pmaa_m.pmab105,g_pmaa_m.pmab105_desc, 
       g_pmaa_m.pmab088,g_pmaa_m.pmab088_desc,g_pmaa_m.pmab089,g_pmaa_m.pmab089_desc,g_pmaa_m.pmab107, 
       g_pmaa_m.pmab108,g_pmaa_m.pmab090,g_pmaa_m.pmab090_desc,g_pmaa_m.pmab091,g_pmaa_m.pmab091_desc, 
       g_pmaa_m.pmab092,g_pmaa_m.pmab092_desc,g_pmaa_m.pmab093,g_pmaa_m.pmab093_desc,g_pmaa_m.pmab094, 
       g_pmaa_m.pmab095,g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab097_desc,g_pmaa_m.pmab098,g_pmaa_m.pmab099, 
       g_pmaa_m.l_pmab100,g_pmaa_m.pmab101,g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc, 
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt, 
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271, 
       g_pmaa_m.pmaa272,g_pmaa_m.day01,g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06, 
       g_pmaa_m.day07,g_pmaa_m.day08,g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13, 
       g_pmaa_m.day14,g_pmaa_m.day15,g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20, 
       g_pmaa_m.day21,g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27, 
       g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03, 
       g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa274_desc, 
       g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285, 
       g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290, 
       g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295, 
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300, 
       g_pmaa_m.pmaa300_desc
   
   #add-point:新增結束後 name="insert.after"
   
   #end add-point 
   
   LET g_data_owner = g_pmaa_m.pmaaownid      
   LET g_data_dept  = g_pmaa_m.pmaaowndp
   
   #功能已完成,通報訊息中心
   CALL apmm801_msgcentre_notify('insert')
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.modify" >}
#+ 資料修改
PRIVATE FUNCTION apmm801_modify()
   #add-point:modify段define(客製用) name="modify.define_customerization"
   
   #end add-point    
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   DEFINE l_wc2_table1          STRING
   DEFINE l_wc2_table2   STRING
 
   DEFINE l_wc2_table3   STRING
 
   DEFINE l_wc2_table4   STRING
 
   DEFINE l_wc2_table5   STRING
 
   DEFINE l_wc2_table6   STRING
 
   DEFINE l_wc2_table7   STRING
 
   DEFINE l_wc2_table8   STRING
 
 
 
   #add-point:modify段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="modify.define"
                  
   #end add-point    
   
   #add-point:Function前置處理  name="modify.pre_function"
   
   #end add-point
   
   #保存單頭舊值
   LET g_pmaa_m_t.* = g_pmaa_m.*
   LET g_pmaa_m_o.* = g_pmaa_m.*
   
   IF g_pmaa_m.pmaa001 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   ERROR ""
  
   LET g_pmaa001_t = g_pmaa_m.pmaa001
 
   CALL s_transaction_begin()
   
   OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
   IF SQLCA.SQLCODE THEN   #(ver:78)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
      LET g_errparam.popup = TRUE 
      CLOSE apmm801_cl
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
   #檢查是否允許此動作
   IF NOT apmm801_action_chk() THEN
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_pmaa_m_mask_o.* =  g_pmaa_m.*
   CALL apmm801_pmaa_t_mask()
   LET g_pmaa_m_mask_n.* =  g_pmaa_m.*
   
   
   
   #add-point:modify段show之前 name="modify.before_show"
   
   #end add-point  
   
   #LET l_wc2_table1 = g_wc2_table1
   #LET g_wc2_table1 = " 1=1"
   #LET l_wc2_table2 = g_wc2_table2
   #LET l_wc2_table2 = " 1=1"
 
   #LET l_wc2_table3 = g_wc2_table3
   #LET l_wc2_table3 = " 1=1"
 
   #LET l_wc2_table4 = g_wc2_table4
   #LET l_wc2_table4 = " 1=1"
 
   #LET l_wc2_table5 = g_wc2_table5
   #LET l_wc2_table5 = " 1=1"
 
   #LET l_wc2_table6 = g_wc2_table6
   #LET l_wc2_table6 = " 1=1"
 
   #LET l_wc2_table7 = g_wc2_table7
   #LET l_wc2_table7 = " 1=1"
 
   #LET l_wc2_table8 = g_wc2_table8
   #LET l_wc2_table8 = " 1=1"
 
 
 
   
   CALL apmm801_show()
   #add-point:modify段show之後 name="modify.after_show"
   
   #end add-point
   
   #LET g_wc2_table1 = l_wc2_table1
   #LET  g_wc2_table2 = l_wc2_table2 
 
   #LET  g_wc2_table3 = l_wc2_table3 
 
   #LET  g_wc2_table4 = l_wc2_table4 
 
   #LET  g_wc2_table5 = l_wc2_table5 
 
   #LET  g_wc2_table6 = l_wc2_table6 
 
   #LET  g_wc2_table7 = l_wc2_table7 
 
   #LET  g_wc2_table8 = l_wc2_table8 
 
 
 
    
   WHILE TRUE
      LET g_pmaa001_t = g_pmaa_m.pmaa001
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_pmaa_m.pmaamodid = g_user 
LET g_pmaa_m.pmaamoddt = cl_get_current()
LET g_pmaa_m.pmaamodid_desc = cl_get_username(g_pmaa_m.pmaamodid)
      
      #add-point:modify段修改前 name="modify.before_input"
                                    
      #end add-point
      
      #欄位更改
      LET g_loc = 'n'
      LET g_update = FALSE
      LET g_master_commit = "N"
      CALL apmm801_input("u")
      LET g_loc = 'n'
 
      #add-point:modify段修改後 name="modify.after_input"
                                    
      #end add-point
      
      IF g_update OR NOT INT_FLAG THEN
         #若有modid跟moddt則進行update
         UPDATE pmaa_t SET (pmaamodid,pmaamoddt) = (g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt)
          WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa001_t
 
      END IF
    
      IF INT_FLAG THEN
         CALL s_transaction_end('N','0')
         LET INT_FLAG = 0
         #若單頭無commit則還原
         IF g_master_commit = "N" THEN
            LET g_pmaa_m.* = g_pmaa_m_t.*
            CALL apmm801_show()
         END IF
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code = 9001 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN
      END IF 
                  
      #若單頭key欄位有變更
      IF g_pmaa_m.pmaa001 != g_pmaa_m_t.pmaa001
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前 name="modify.body.b_fk_update"
                                                      
         #end add-point
         
         #更新單身key值
         UPDATE pmag_t SET pmag001 = g_pmaa_m.pmaa001
 
          WHERE pmagent = g_enterprise AND pmag001 = g_pmaa_m_t.pmaa001
 
            
         #add-point:單身fk修改中 name="modify.body.m_fk_update"
                                                      
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmag_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後 name="modify.body.a_fk_update"
                                                      
         #end add-point
         
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update2"
                                                      
         #end add-point
         
         UPDATE pmax_t
            SET pmax001 = g_pmaa_m.pmaa001
 
          WHERE pmaxent = g_enterprise AND
                pmax001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update2"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmax_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update2"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update3"
                                                      
         #end add-point
         
         UPDATE pmay_t
            SET pmay001 = g_pmaa_m.pmaa001
 
          WHERE pmayent = g_enterprise AND
                pmay001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update3"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmay_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update3"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update4"
                                                      
         #end add-point
         
         UPDATE pmaz_t
            SET pmaz001 = g_pmaa_m.pmaa001
 
          WHERE pmazent = g_enterprise AND
                pmaz001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update4"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmaz_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update4"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update5"
                                                      
         #end add-point
         
         UPDATE pmac_t
            SET pmac001 = g_pmaa_m.pmaa001
 
          WHERE pmacent = g_enterprise AND
                pmac001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update5"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmac_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update5"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update6"
                                                      
         #end add-point
         
         UPDATE pmaf_t
            SET pmaf001 = g_pmaa_m.pmaa001
 
          WHERE pmafent = g_enterprise AND
                pmaf001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update6"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmaf_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update6"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update7"
                                                      
         #end add-point
         
         UPDATE pmad_t
            SET pmad001 = g_pmaa_m.pmaa001
 
          WHERE pmadent = g_enterprise AND
                pmad001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update7"
                                                      
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmad_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update7"
                                                      
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前 name="modify.body.b_fk_update8"
         
         #end add-point
         
         UPDATE pmae_t
            SET pmae001 = g_pmaa_m.pmaa001
 
          WHERE pmaeent = g_enterprise AND
                pmae001 = g_pmaa001_t
 
         #add-point:單身fk修改中 name="modify.body.m_fk_update8"
         
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "pmae_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後 name="modify.body.a_fk_update8"
         
         #end add-point
 
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
         
         
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL apmm801_set_act_visible()   
   CALL apmm801_set_act_no_visible()
 
   #組合新增資料的條件
   LET g_add_browse = " pmaaent = " ||g_enterprise|| " AND",
                      " pmaa001 = '", g_pmaa_m.pmaa001, "' "
 
   #填到對應位置
   CALL apmm801_browser_fill("")
 
   CLOSE apmm801_cl
   
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL apmm801_msgcentre_notify('modify')
 
END FUNCTION 
 
{</section>}
 
{<section id="apmm801.input" >}
#+ 資料輸入
PRIVATE FUNCTION apmm801_input(p_cmd)
   #add-point:input段define(客製用) name="input.define_customerization"
   
   #end add-point  
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num10                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num10                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num10
   DEFINE  l_i                   LIKE type_t.num10
   DEFINE  l_ac_t                LIKE type_t.num10
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num10
   DEFINE  li_reproduce_target   LIKE type_t.num10
   DEFINE  ls_keys               DYNAMIC ARRAY OF VARCHAR(500)
   #add-point:input段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="input.define"
                     DEFINE l_wc             STRING
   DEFINE l_msg            STRING  
   DEFINE l_flag           LIKE type_t.num5
   DEFINE l_success        LIKE type_t.num5
   DEFINE l_pmad002        LIKE pmad_t.pmad002   
   DEFINE l_pmaa002        LIKE pmaa_t.pmaa002
   DEFINE l_cmd_pmag       LIKE type_t.chr1
   DEFINE l_ooef019        LIKE ooef_t.ooef019
   DEFINE l_pmaa001        LIKE pmaa_t.pmaa001
   define l_str            string 
   DEFINE l_para_data      LIKE type_t.chr80
   DEFINE l_errno          LIKE type_t.chr10
   DEFINE l_msg2           LIKE type_t.chr50
   DEFINE l_count_chk      LIKE type_t.num5
   DEFINE l_ooef016  LIKE ooef_t.ooef016
   #end add-point  
   
   #add-point:Function前置處理  name="input.pre_function"
   
   #end add-point
   
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
       g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
       g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc, 
       g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024,g_pmaa_m.pmaa024_desc, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa009_desc, 
       g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231, 
       g_pmaa_m.pmaa231_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc, 
       g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa094_desc, 
       g_pmaa_m.pmaa093,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097, 
       g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc, 
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa245, 
       g_pmaa_m.pmaa245_desc,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc, 
       g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa222,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080,g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083, 
       g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053,g_pmaa_m.pmaa053_desc, 
       g_pmaa_m.pmaa054,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa205_desc, 
       g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053,g_pmaa_m.pmab053_desc, 
       g_pmaa_m.pmab039,g_pmaa_m.pmab039_desc,g_pmaa_m.pmaa081,g_pmaa_m.pmaa081_desc,g_pmaa_m.pmab033, 
       g_pmaa_m.pmab033_desc,g_pmaa_m.pmab034,g_pmaa_m.pmab034_desc,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
       g_pmaa_m.pmab056_desc,g_pmaa_m.pmab037,g_pmaa_m.pmab037_desc,g_pmaa_m.pmab055,g_pmaa_m.pmab055_desc, 
       g_pmaa_m.pmab038,g_pmaa_m.pmab038_desc,g_pmaa_m.pmab040,g_pmaa_m.pmab040_desc,g_pmaa_m.pmab041, 
       g_pmaa_m.pmab041_desc,g_pmaa_m.pmab042,g_pmaa_m.pmab042_desc,g_pmaa_m.pmab043,g_pmaa_m.pmab043_desc, 
       g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab047_desc,g_pmaa_m.pmab048, 
       g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
       g_pmaa_m.pmab083,g_pmaa_m.pmab083_desc,g_pmaa_m.pmab084,g_pmaa_m.pmab084_desc,g_pmaa_m.pmab103, 
       g_pmaa_m.pmab103_desc,g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
       g_pmaa_m.pmab106_desc,g_pmaa_m.pmab087,g_pmaa_m.pmab087_desc,g_pmaa_m.pmab105,g_pmaa_m.pmab105_desc, 
       g_pmaa_m.pmab088,g_pmaa_m.pmab088_desc,g_pmaa_m.pmab089,g_pmaa_m.pmab089_desc,g_pmaa_m.pmab107, 
       g_pmaa_m.pmab108,g_pmaa_m.pmab090,g_pmaa_m.pmab090_desc,g_pmaa_m.pmab091,g_pmaa_m.pmab091_desc, 
       g_pmaa_m.pmab092,g_pmaa_m.pmab092_desc,g_pmaa_m.pmab093,g_pmaa_m.pmab093_desc,g_pmaa_m.pmab094, 
       g_pmaa_m.pmab095,g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab097_desc,g_pmaa_m.pmab098,g_pmaa_m.pmab099, 
       g_pmaa_m.l_pmab100,g_pmaa_m.pmab101,g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc, 
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt, 
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271, 
       g_pmaa_m.pmaa272,g_pmaa_m.day01,g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06, 
       g_pmaa_m.day07,g_pmaa_m.day08,g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13, 
       g_pmaa_m.day14,g_pmaa_m.day15,g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20, 
       g_pmaa_m.day21,g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27, 
       g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03, 
       g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa274_desc, 
       g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285, 
       g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290, 
       g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295, 
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300, 
       g_pmaa_m.pmaa300_desc
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql name="input.define_sql"
                  
   #end add-point 
   LET g_forupd_sql = "SELECT pmag002,pmag003,pmag004,pmag007,pmag008,pmagstus FROM pmag_t WHERE pmagent=?  
       AND pmag001=? AND pmag002=? AND pmag003=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql"
                  
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl CURSOR FROM g_forupd_sql
   
   #add-point:input段define_sql name="input.define_sql2"
                  
   #end add-point    
   LET g_forupd_sql = "SELECT pmax002,pmax003,pmaxstus FROM pmax_t WHERE pmaxent=? AND pmax001=? AND  
       pmax002=? AND pmax003=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql2"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl2 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql3"
                  
   #end add-point    
   LET g_forupd_sql = "SELECT pmay002,pmay003,pmay004,pmay005 FROM pmay_t WHERE pmayent=? AND pmay001=?  
       AND pmay002=? AND pmay003=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql3"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl3 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql4"
                  
   #end add-point    
   LET g_forupd_sql = "SELECT pmaz002,pmaz003 FROM pmaz_t WHERE pmazent=? AND pmaz001=? AND pmaz002=?  
       FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql4"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl4 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql5"
                  
   #end add-point    
   LET g_forupd_sql = "SELECT pmacstus,pmac003,pmac004,pmac002 FROM pmac_t WHERE pmacent=? AND pmac001=?  
       AND pmac002=? AND pmac003=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql5"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl5 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql6"
 
   #end add-point    
   LET g_forupd_sql = "SELECT pmafstus,pmaf010,pmaf002,pmaf003,pmaf004,pmaf011,pmaf008,pmaf009,pmaf005, 
       pmaf007,pmaf006 FROM pmaf_t WHERE pmafent=? AND pmaf001=? AND pmaf002=? AND pmaf003=? FOR UPDATE" 
 
   #add-point:input段define_sql name="input.after_define_sql6"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl6 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql7"
                  
   #end add-point    
   LET g_forupd_sql = "SELECT pmad003,pmadstus,pmad002,pmad004 FROM pmad_t WHERE pmadent=? AND pmad001=?  
       AND pmad002=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql7"
                  
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl7 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql name="input.define_sql8"
   
   #end add-point    
   LET g_forupd_sql = "SELECT pmae002,pmae003 FROM pmae_t WHERE pmaeent=? AND pmae001=? AND pmae002=?  
       AND pmae003=? FOR UPDATE"
   #add-point:input段define_sql name="input.after_define_sql8"
   
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE apmm801_bcl8 CURSOR FROM g_forupd_sql
 
 
   
 
 
   #add-point:input段define_sql name="input.other_sql"
   LET g_forupd_sql = "SELECT pmad003,pmadstus,pmad002,'',pmad004 FROM pmad_t WHERE pmadent=?  
                          AND pmad001=? AND pmad002=? AND pmad003=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   DECLARE gapmm801_bcl8 CURSOR FROM g_forupd_sql   
   
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL apmm801_set_entry(p_cmd)
   #add-point:set_entry後 name="input.after_set_entry"
   CALL apmm801_set_no_required(p_cmd)
   CALL apmm801_set_required(p_cmd)
   #新增修改时生命周期下拉框
   CALL s_life_cycle_display(g_prog,'pmaa083','2') #生命类型  #Add By geza 150323
   #end add-point
   CALL apmm801_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
       g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
       g_pmaa_m.pmaa006,g_pmaa_m.pmaa026,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017, 
       g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020, 
       g_pmaa_m.pmaa023,g_pmaa_m.pmaa024,g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009, 
       g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232, 
       g_pmaa_m.pmaa090,g_pmaa_m.pmaa091,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096, 
       g_pmaa_m.pmaa097,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245, 
       g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221, 
       g_pmaa_m.pmaa222,g_pmaa_m.pmaa080,g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085, 
       g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056, 
       g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047, 
       g_pmaa_m.pmaa036,g_pmaa_m.pmaa037,g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041, 
       g_pmaa_m.pmaa042,g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068, 
       g_pmaa_m.pmaa069,g_pmaa_m.pmaa072,g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204, 
       g_pmaa_m.pmaa205,g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053, 
       g_pmaa_m.pmab039,g_pmaa_m.pmaa081,g_pmaa_m.pmab033,g_pmaa_m.pmab034,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
       g_pmaa_m.pmab037,g_pmaa_m.pmab055,g_pmaa_m.pmab038,g_pmaa_m.pmab040,g_pmaa_m.pmab041,g_pmaa_m.pmab042, 
       g_pmaa_m.pmab043,g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab048, 
       g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
       g_pmaa_m.pmab083,g_pmaa_m.pmab084,g_pmaa_m.pmab103,g_pmaa_m.pmab104,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
       g_pmaa_m.pmab087,g_pmaa_m.pmab105,g_pmaa_m.pmab088,g_pmaa_m.pmab089,g_pmaa_m.pmab107,g_pmaa_m.pmab108, 
       g_pmaa_m.pmab090,g_pmaa_m.pmab091,g_pmaa_m.pmab092,g_pmaa_m.pmab093,g_pmaa_m.pmab094,g_pmaa_m.pmab095, 
       g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab098,g_pmaa_m.pmab099,g_pmaa_m.l_pmab100,g_pmaa_m.pmab101, 
       g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.day01, 
       g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06,g_pmaa_m.day07,g_pmaa_m.day08, 
       g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13,g_pmaa_m.day14,g_pmaa_m.day15, 
       g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20,g_pmaa_m.day21,g_pmaa_m.day22, 
       g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27,g_pmaa_m.day28,g_pmaa_m.day29, 
       g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03,g_pmaa_m.week04, 
       g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300
   
   LET lb_reproduce = FALSE
   LET l_ac_t = 1
   
   #關閉被遮罩相關欄位輸入, 無法確定USER是否會需要輸入此欄位
   #因此先行關閉, 若有需要可於下方add-point中自行開啟
   CALL cl_mask_set_no_entry()
   
   #add-point:資料輸入前 name="input.before_input"
   LET l_cmd_pmag = p_cmd    
   LET g_detail_insert = l_allow_insert
   LET g_detail_delete = l_allow_delete
   #160512-00003#11
   CALL cl_set_comp_required('pmaa204',TRUE)
   CALL cl_set_comp_required('pmaa080',TRUE)
   LET g_pmaa_m.pmaa204=''
   LET g_pmaa_m.pmab032=g_dlang
   LET g_pmaa_m.pmab082=g_dlang
   
   
   
   SELECT ooef016 INTO l_ooef016 FROM ooef_t
    WHERE ooefent=g_enterprise
      AND ooef001=g_site
   LET g_pmaa_m.pmab083=l_ooef016
   LET g_pmaa_m.pmab033=l_ooef016
   CALL apmm801_pmab083_ref()
   CALL apmm801_pmab033_ref()
   LET g_pmaa_m.l_pmab050=1
   LET g_pmaa_m.l_pmab052=0
   LET g_pmaa_m.l_pmab100=1
   LET g_pmaa_m.l_pmab102=0
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
{</section>}
 
{<section id="apmm801.input.head" >}
      #單頭段
      INPUT BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
          g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
          g_pmaa_m.pmaa006,g_pmaa_m.pmaa026,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017, 
          g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020, 
          g_pmaa_m.pmaa023,g_pmaa_m.pmaa024,g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009, 
          g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232, 
          g_pmaa_m.pmaa090,g_pmaa_m.pmaa091,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096, 
          g_pmaa_m.pmaa097,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245, 
          g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221, 
          g_pmaa_m.pmaa222,g_pmaa_m.pmaa080,g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085, 
          g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056, 
          g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047, 
          g_pmaa_m.pmaa036,g_pmaa_m.pmaa037,g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041, 
          g_pmaa_m.pmaa042,g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068, 
          g_pmaa_m.pmaa069,g_pmaa_m.pmaa072,g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204, 
          g_pmaa_m.pmaa205,g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053, 
          g_pmaa_m.pmab039,g_pmaa_m.pmaa081,g_pmaa_m.pmab033,g_pmaa_m.pmab034,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
          g_pmaa_m.pmab037,g_pmaa_m.pmab055,g_pmaa_m.pmab038,g_pmaa_m.pmab040,g_pmaa_m.pmab041,g_pmaa_m.pmab042, 
          g_pmaa_m.pmab043,g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab048, 
          g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
          g_pmaa_m.pmab083,g_pmaa_m.pmab084,g_pmaa_m.pmab103,g_pmaa_m.pmab104,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
          g_pmaa_m.pmab087,g_pmaa_m.pmab105,g_pmaa_m.pmab088,g_pmaa_m.pmab089,g_pmaa_m.pmab107,g_pmaa_m.pmab108, 
          g_pmaa_m.pmab090,g_pmaa_m.pmab091,g_pmaa_m.pmab092,g_pmaa_m.pmab093,g_pmaa_m.pmab094,g_pmaa_m.pmab095, 
          g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab098,g_pmaa_m.pmab099,g_pmaa_m.l_pmab100,g_pmaa_m.pmab101, 
          g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.day01, 
          g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06,g_pmaa_m.day07, 
          g_pmaa_m.day08,g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13, 
          g_pmaa_m.day14,g_pmaa_m.day15,g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19, 
          g_pmaa_m.day20,g_pmaa_m.day21,g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25, 
          g_pmaa_m.day26,g_pmaa_m.day27,g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31, 
          g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03,g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06, 
          g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa282, 
          g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286,g_pmaa_m.pmaa287,g_pmaa_m.pmaa288, 
          g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294, 
          g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300  
 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION update_item
            LET g_action_choice="update_item"
            IF cl_auth_chk_act("update_item") THEN
               
               #add-point:ON ACTION update_item name="input.master_input.update_item"
            IF NOT cl_null(g_pmaa_m.pmaa001)  THEN
               CALL n_pmaal(g_pmaa_m.pmaa001)
               INITIALIZE g_ref_fields TO NULL
               LET g_ref_fields[1] = g_pmaa_m.pmaa001
               CALL ap_ref_array2(g_ref_fields," SELECT pmaal003,pmaal004,pmaal005,pmaal006 FROM pmaal_t WHERE pmaalent = '"||g_enterprise||"' AND pmaal001 = ? AND pmaal002 = '"||g_dlang||"'","") RETURNING g_rtn_fields    #160810-00008@1 160819 by lori add:pmaal006
               LET g_pmaa_m.pmaal003 = g_rtn_fields[1] 
               LET g_pmaa_m.pmaal004 = g_rtn_fields[2] 
               LET g_pmaa_m.pmaal005 = g_rtn_fields[3] 
               LET g_pmaa_m.pmaal006 = g_rtn_fields[4]    #160810-00008#1 160819 by lori add
               DISPLAY g_pmaa_m.pmaal003,g_pmaa_m.pmaal004,g_pmaa_m.pmaal005 TO pmaal003,pmaal004,pmaal005
               DISPLAY g_pmaa_m.pmaal006 TO pmaal006      #160810-00008#1 160819 by lori add
            END IF  
               #END add-point
            END IF
 
 
 
 
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            LET g_master_multi_table_t.pmaal001 = g_pmaa_m.pmaa001
LET g_master_multi_table_t.pmaal004 = g_pmaa_m.pmaal004
LET g_master_multi_table_t.pmaal003 = g_pmaa_m.pmaal003
LET g_master_multi_table_t.pmaal006 = g_pmaa_m.pmaal006
LET g_master_multi_table_t.pmaal005 = g_pmaa_m.pmaal005
 
            IF l_cmd_t = 'r' THEN
               LET g_master_multi_table_t.pmaal001 = ''
LET g_master_multi_table_t.pmaal004 = ''
LET g_master_multi_table_t.pmaal003 = ''
LET g_master_multi_table_t.pmaal006 = ''
LET g_master_multi_table_t.pmaal005 = ''
 
            END IF
            #因應離開單頭後已寫入資料庫, 若重新回到單頭則視為修改
            #因此需於此處開啟/關閉欄位
            CALL apmm801_set_entry(p_cmd)
            #add-point:資料輸入前 name="input.m.before_input"
            
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)

            CALL apmm801_set_comp_no_visible(p_cmd)   #160810-00008#1 160819 by lori
            CALL apmm801_set_comp_visible(p_cmd)      #160810-00008#1 160819 by lori 
            #end add-point
            CALL apmm801_set_no_entry(p_cmd)
    
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa001
            #add-point:BEFORE FIELD pmaa001 name="input.b.pmaa001"
            #add by yangxf 20150506 增加編碼功能 start
            IF cl_null(g_pmaa_m.pmaa001) THEN
               CALL s_aooi390_gen('2') RETURNING l_success,g_pmaa_m.pmaa001,l_oofg_return
               DISPLAY BY NAME g_pmaa_m.pmaa001
            END IF
            #add by yangxf 20150506 增加編碼功能 end                 
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa001
            
            #add-point:AFTER FIELD pmaa001 name="input.a.pmaa001"
            #編碼完回單頭不需校驗 20150626 add by beckxie---S
            IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t )) THEN 
            #編碼完回單頭不需校驗 20150626 add by beckxie---E
               #160810-00008#1 160829 by lori mark---(S)               
               #CALL apmm801_chk_pmaa001()
               #IF NOT cl_null(g_errno) THEN
               #   INITIALIZE g_errparam TO NULL
               #   LET g_errparam.code = g_errno
               #   LET g_errparam.extend = g_pmaa_m.pmaa001
               #   LET g_errparam.popup = TRUE
               #   CALL cl_err()
               #
               #   LET g_pmaa_m.pmaa001 = g_pmaa_m_o.pmaa001
               #   NEXT FIELD CURRENT
               #END IF
               #160810-00008#1 160829 by lori mark---(E)
               
               #160810-00008#1 160829 by lori add---(S)   
               IF NOT apmm801_chk_pmaa001() THEN
                  LET g_pmaa_m.pmaa001 = g_pmaa_m_o.pmaa001
                  NEXT FIELD CURRENT
               ELSE
                  IF g_master_insert THEN
                     EXIT DIALOG   
                  END IF
               END IF
               #160810-00008#1 160829 by lori add---(E)  
            END IF   #編碼完回單頭不需校驗 20150626 add by beckxie
            #add by yangxf 20150506 增加編碼功能 start
            IF NOT cl_null(g_pmaa_m.pmaa001) THEN 
               IF NOT s_aooi390_chk('2',g_pmaa_m.pmaa001) THEN
                  LET g_pmaa_m.pmaa001 = g_pmaa_m_t.pmaa001
                  DISPLAY BY NAME g_pmaa_m.pmaa001
                  NEXT FIELD CURRENT
               END IF
            END IF
            #add by yangxf 20150506 增加編碼功能 end    
            LET g_pmaa_m_o.pmaa001 = g_pmaa_m.pmaa001
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa001
            #add-point:ON CHANGE pmaa001 name="input.g.pmaa001"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa002
            #add-point:BEFORE FIELD pmaa002 name="input.b.pmaa002"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa002
            
            #add-point:AFTER FIELD pmaa002 name="input.a.pmaa002"
            #無開單修改by玟進 20151029 add by beckxie---S
            CALL apmm801_set_comp_visible(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            CALL apmm801_set_comp_no_visible(p_cmd)
            #無開單修改by玟進 20151029 add by beckxie---E
            
            CALL apmm801_set_comp_no_visible(p_cmd)   #160810-00008#1 160819 by lori            
            CALL apmm801_set_comp_visible(p_cmd)      #160810-00008#1 160819 by lori
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa002
            #add-point:ON CHANGE pmaa002 name="input.g.pmaa002"
            #無開單修改by玟進 20151029 add by beckxie---S
            CALL apmm801_set_comp_visible(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            CALL apmm801_set_comp_no_visible(p_cmd)
            #無開單修改by玟進 20151029 add by beckxie---E
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa089
            #add-point:BEFORE FIELD pmaa089 name="input.b.pmaa089"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa089
            
            #add-point:AFTER FIELD pmaa089 name="input.a.pmaa089"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa089
            #add-point:ON CHANGE pmaa089 name="input.g.pmaa089"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal004
            #add-point:BEFORE FIELD pmaal004 name="input.b.pmaal004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal004
            
            #add-point:AFTER FIELD pmaal004 name="input.a.pmaal004"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaal004
            #add-point:ON CHANGE pmaal004 name="input.g.pmaal004"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal003
            #add-point:BEFORE FIELD pmaal003 name="input.b.pmaal003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal003
            
            #add-point:AFTER FIELD pmaal003 name="input.a.pmaal003"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaal003
            #add-point:ON CHANGE pmaal003 name="input.g.pmaal003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal006
            #add-point:BEFORE FIELD pmaal006 name="input.b.pmaal006"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal006
            
            #add-point:AFTER FIELD pmaal006 name="input.a.pmaal006"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaal006
            #add-point:ON CHANGE pmaal006 name="input.g.pmaal006"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaal005
            #add-point:BEFORE FIELD pmaal005 name="input.b.pmaal005"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaal005
            
            #add-point:AFTER FIELD pmaal005 name="input.a.pmaal005"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaal005
            #add-point:ON CHANGE pmaal005 name="input.g.pmaal005"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa003
            #add-point:BEFORE FIELD pmaa003 name="input.b.pmaa003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa003
            
            #add-point:AFTER FIELD pmaa003 name="input.a.pmaa003"
            IF NOT cl_null(g_pmaa_m.pmaa003) THEN
               IF g_pmaa_m.pmaa003 != g_pmaa_m_o.pmaa003 OR g_pmaa_m_o.pmaa003 IS NULL THEN
                  CALL apmm801_chk_uni_business_no()
                  IF NOT cl_null(g_errno) THEN
                     IF NOT (g_errno = '1' OR g_errno = '2' OR g_errno = '3') THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = g_pmaa_m.pmaa003
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        LET g_pmaa_m.pmaa003 = g_pmaa_m_o.pmaa003
                        NEXT FIELD CURRENT
                     END IF
                  END IF

                  IF NOT cl_null(g_pmaa002_flag) THEN
                     CASE g_pmaa002_flag
                        WHEN '1'
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = "apm-00418"
                              LET g_errparam.extend = ""
                              LET g_errparam.popup = TRUE
                              CALL cl_err()

                              LET g_pmaa_m.pmaa003 = g_pmaa_m_o.pmaa003
                              NEXT FIELD CURRENT
                        WHEN '2'
                           IF cl_ask_confirm('apm-00419') THEN
                              #LET g_pmaa_m.pmaa002 = '3'
                              #LET g_pmaa_m.pmaa092 = '2'
                              #DISPLAY BY NAME g_pmaa_m.pmaa002,g_pmaa_m.pmaa092
                              SELECT pmaa001 INTO l_pmaa001
                                FROM pmaa_t
                               WHERE pmaaent = g_enterprise
                                 AND pmaa003 = g_pmaa_m.pmaa003
                                 
                              IF NOT cl_null(l_pmaa001) THEN   
                                 UPDATE pmaa_t
                                    SET pmaa002 = '3',
                                        pmaa092 = '2',
                                        pmaa230 = '1'                                    
                                  WHERE pmaaent = g_enterprise
                                    AND pmaa001 = l_pmaa001
                              
                                 LET g_wc = " pmaa001 = '",l_pmaa001,"'"
                              END IF
                              EXIT DIALOG
                              #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
                              CALL cl_notice()                        
                           ELSE
                              LET g_pmaa_m.pmaa003 = g_pmaa_m_o.pmaa003
                              NEXT FIELD CURRENT
                           END IF
                        WHEN '3'
                           IF cl_ask_confirm('apm-00419') THEN
                              #LET g_pmaa_m.pmaa002 = '3'
                              #LET g_pmaa_m.pmaa092 = '2'
                              #DISPLAY BY NAME g_pmaa_m.pmaa002,g_pmaa_m.pmaa092
                              SELECT pmaa001 INTO l_pmaa001
                                FROM pmaa_t
                               WHERE pmaaent = g_enterprise
                                 AND pmaa003 = g_pmaa_m.pmaa003
                              IF NOT cl_null(l_pmaa001) THEN   
                                 UPDATE pmaa_t
                                    SET pmaa002 = '3',
                                        pmaa092 = '1',
                                        pmaa230 = '1'                                      
                                  WHERE pmaaent = g_enterprise
                                    AND pmaa001 = l_pmaa001
                                  
                                 LET g_wc = " pmaa001 = '",l_pmaa001,"'"
                              END IF
                              EXIT DIALOG
                              #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
                              CALL cl_notice()                        
                           ELSE
                              LET g_pmaa_m.pmaa003 = g_pmaa_m_o.pmaa003
                              NEXT FIELD CURRENT
                           END IF
                     END CASE
                  END IF
               END IF
            END IF
            LET g_pmaa_m_o.pmaa003 = g_pmaa_m.pmaa003
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa003
            #add-point:ON CHANGE pmaa003 name="input.g.pmaa003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaastus
            #add-point:BEFORE FIELD pmaastus name="input.b.pmaastus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaastus
            
            #add-point:AFTER FIELD pmaastus name="input.a.pmaastus"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaastus
            #add-point:ON CHANGE pmaastus name="input.g.pmaastus"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa004
            #add-point:BEFORE FIELD pmaa004 name="input.b.pmaa004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa004
            
            #add-point:AFTER FIELD pmaa004 name="input.a.pmaa004"
                                                                                    IF g_pmaa_m.pmaa004 = '1' THEN
               LET g_pmaa_m.pmaa005 = g_pmaa_m.pmaa001
               CALL apmm801_pmaa005_ref()
            ELSE
               IF g_pmaa_m.pmaa004 = '3' THEN
                  IF g_pmaa_m.pmaa005 = g_pmaa_m.pmaa001 THEN
                     LET g_pmaa_m.pmaa005 = '' 
                     LET g_pmaa_m.pmaa005_desc = ' '                     
                     DISPLAY BY NAME g_pmaa_m.pmaa005_desc
                  END IF
               ELSE
                  LET g_pmaa_m.pmaa005 = ''
                  LET g_pmaa_m.pmaa005_desc = ' '
                  DISPLAY BY NAME g_pmaa_m.pmaa005_desc                  
               END IF               
            END IF
            
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa004
            #add-point:ON CHANGE pmaa004 name="input.g.pmaa004"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa005
            
            #add-point:AFTER FIELD pmaa005 name="input.a.pmaa005"
                                                                                    LET g_pmaa_m.pmaa005_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa005_desc
            IF NOT cl_null(g_pmaa_m.pmaa005) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa005 != g_pmaa_m_t.pmaa005 OR g_pmaa_m_t.pmaa005 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa005
                  IF NOT cl_chk_exist("v_pmaa001_11") THEN
                     LET g_pmaa_m.pmaa005 = g_pmaa_m_t.pmaa005
                     CALL apmm801_pmaa005_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa005_ref()              
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa005
            #add-point:BEFORE FIELD pmaa005 name="input.b.pmaa005"
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)                                                  
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa005
            #add-point:ON CHANGE pmaa005 name="input.g.pmaa005"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa006
            
            #add-point:AFTER FIELD pmaa006 name="input.a.pmaa006"
                                                                                    LET g_pmaa_m.pmaa006_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa006_desc
            IF NOT cl_null(g_pmaa_m.pmaa006) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa006 != g_pmaa_m_t.pmaa006 OR g_pmaa_m_t.pmaa006 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('261',g_pmaa_m.pmaa006) THEN
                     LET g_pmaa_m.pmaa006 = g_pmaa_m_t.pmaa006
                     CALL apmm801_pmaa006_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa006_ref()  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa006
            #add-point:BEFORE FIELD pmaa006 name="input.b.pmaa006"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa006
            #add-point:ON CHANGE pmaa006 name="input.g.pmaa006"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa026
            
            #add-point:AFTER FIELD pmaa026 name="input.a.pmaa026"
                                                                                    LET g_pmaa_m.pmaa026_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa026_desc
            IF NOT cl_null(g_pmaa_m.pmaa026) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa026 != g_pmaa_m_t.pmaa026 OR g_pmaa_m_t.pmaa026 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('250',g_pmaa_m.pmaa026) THEN
                     LET g_pmaa_m.pmaa026 = g_pmaa_m_t.pmaa026
                     CALL apmm801_pmaa026_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa026_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa026
            #add-point:BEFORE FIELD pmaa026 name="input.b.pmaa026"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa026
            #add-point:ON CHANGE pmaa026 name="input.g.pmaa026"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa200
            #add-point:BEFORE FIELD pmaa200 name="input.b.pmaa200"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa200
            
            #add-point:AFTER FIELD pmaa200 name="input.a.pmaa200"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa200
            #add-point:ON CHANGE pmaa200 name="input.g.pmaa200"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa201
            #add-point:BEFORE FIELD pmaa201 name="input.b.pmaa201"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa201
            
            #add-point:AFTER FIELD pmaa201 name="input.a.pmaa201"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa201
            #add-point:ON CHANGE pmaa201 name="input.g.pmaa201"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa202
            #add-point:BEFORE FIELD pmaa202 name="input.b.pmaa202"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa202
            
            #add-point:AFTER FIELD pmaa202 name="input.a.pmaa202"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa202
            #add-point:ON CHANGE pmaa202 name="input.g.pmaa202"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa017
            #add-point:BEFORE FIELD pmaa017 name="input.b.pmaa017"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa017
            
            #add-point:AFTER FIELD pmaa017 name="input.a.pmaa017"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa017
            #add-point:ON CHANGE pmaa017 name="input.g.pmaa017"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa016
            #add-point:BEFORE FIELD pmaa016 name="input.b.pmaa016"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa016
            
            #add-point:AFTER FIELD pmaa016 name="input.a.pmaa016"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa016
            #add-point:ON CHANGE pmaa016 name="input.g.pmaa016"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa018
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa018,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa018
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa018 name="input.a.pmaa018"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa018) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa018
            #add-point:BEFORE FIELD pmaa018 name="input.b.pmaa018"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa018
            #add-point:ON CHANGE pmaa018 name="input.g.pmaa018"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa019
            
            #add-point:AFTER FIELD pmaa019 name="input.a.pmaa019"
                                                                                    LET g_pmaa_m.pmaa019_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa019_desc
            IF NOT cl_null(g_pmaa_m.pmaa019) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa019 != g_pmaa_m_t.pmaa019 OR g_pmaa_m_t.pmaa019 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa019
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa019 = g_pmaa_m_t.pmaa019
                     CALL apmm801_pmaa019_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa019_ref()  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa019
            #add-point:BEFORE FIELD pmaa019 name="input.b.pmaa019"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa019
            #add-point:ON CHANGE pmaa019 name="input.g.pmaa019"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa021
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa021,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa021
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa021 name="input.a.pmaa021"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa021) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa021
            #add-point:BEFORE FIELD pmaa021 name="input.b.pmaa021"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa021
            #add-point:ON CHANGE pmaa021 name="input.g.pmaa021"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa022
            
            #add-point:AFTER FIELD pmaa022 name="input.a.pmaa022"
                                                                                    LET g_pmaa_m.pmaa022_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa022_desc
            IF NOT cl_null(g_pmaa_m.pmaa022) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa022 != g_pmaa_m_t.pmaa022 OR g_pmaa_m_t.pmaa022 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa022
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa022 = g_pmaa_m_t.pmaa022
                     CALL apmm801_pmaa022_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa022_ref()  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa022
            #add-point:BEFORE FIELD pmaa022 name="input.b.pmaa022"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa022
            #add-point:ON CHANGE pmaa022 name="input.g.pmaa022"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa020
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa020,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa020
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa020 name="input.a.pmaa020"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa020) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa020
            #add-point:BEFORE FIELD pmaa020 name="input.b.pmaa020"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa020
            #add-point:ON CHANGE pmaa020 name="input.g.pmaa020"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa023
            
            #add-point:AFTER FIELD pmaa023 name="input.a.pmaa023"
                                                                                    LET g_pmaa_m.pmaa023_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa023_desc
            IF NOT cl_null(g_pmaa_m.pmaa023) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa023 != g_pmaa_m_t.pmaa023 OR g_pmaa_m_t.pmaa023 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('254',g_pmaa_m.pmaa023) THEN
                     LET g_pmaa_m.pmaa023 = g_pmaa_m_t.pmaa023
                     CALL apmm801_pmaa023_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa023_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa023
            #add-point:BEFORE FIELD pmaa023 name="input.b.pmaa023"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa023
            #add-point:ON CHANGE pmaa023 name="input.g.pmaa023"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa024
            
            #add-point:AFTER FIELD pmaa024 name="input.a.pmaa024"
                                                                                    LET g_pmaa_m.pmaa024_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa024_desc
            IF NOT cl_null(g_pmaa_m.pmaa024) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa024 != g_pmaa_m_t.pmaa024 OR g_pmaa_m_t.pmaa024 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('260',g_pmaa_m.pmaa024) THEN
                     LET g_pmaa_m.pmaa024 = g_pmaa_m_t.pmaa024
                     CALL apmm801_pmaa024_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa024_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa024
            #add-point:BEFORE FIELD pmaa024 name="input.b.pmaa024"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa024
            #add-point:ON CHANGE pmaa024 name="input.g.pmaa024"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa025
            #add-point:BEFORE FIELD pmaa025 name="input.b.pmaa025"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa025
            
            #add-point:AFTER FIELD pmaa025 name="input.a.pmaa025"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa025
            #add-point:ON CHANGE pmaa025 name="input.g.pmaa025"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa007
            
            #add-point:AFTER FIELD pmaa007 name="input.a.pmaa007"
                                                                                    LET g_pmaa_m.pmaa007_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa007_desc
            IF NOT cl_null(g_pmaa_m.pmaa007) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa007 != g_pmaa_m_t.pmaa007 OR g_pmaa_m_t.pmaa007 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa007
                  IF NOT cl_chk_exist("v_oocg001") THEN
                     LET g_pmaa_m.pmaa007 = g_pmaa_m_t.pmaa007
                     CALL apmm801_pmaa007_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa007_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa007
            #add-point:BEFORE FIELD pmaa007 name="input.b.pmaa007"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa007
            #add-point:ON CHANGE pmaa007 name="input.g.pmaa007"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa008
            #add-point:BEFORE FIELD pmaa008 name="input.b.pmaa008"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa008
            
            #add-point:AFTER FIELD pmaa008 name="input.a.pmaa008"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa008
            #add-point:ON CHANGE pmaa008 name="input.g.pmaa008"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa009
            
            #add-point:AFTER FIELD pmaa009 name="input.a.pmaa009"
                                                                                    LET g_pmaa_m.pmaa009_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa009_desc
            IF NOT cl_null(g_pmaa_m.pmaa009) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa009 != g_pmaa_m_t.pmaa009 OR g_pmaa_m_t.pmaa009 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL                  
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa009
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00124:sub-01302|aooi074|",cl_get_progname("aooi074",g_lang,"2"),"|:EXEPROGaooi074"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooal002_4") THEN
                     LET g_pmaa_m.pmaa009 = g_pmaa_m_t.pmaa009
                     CALL apmm801_pmaa009_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa009_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa009
            #add-point:BEFORE FIELD pmaa009 name="input.b.pmaa009"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa009
            #add-point:ON CHANGE pmaa009 name="input.g.pmaa009"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa010
            #add-point:BEFORE FIELD pmaa010 name="input.b.pmaa010"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa010
            
            #add-point:AFTER FIELD pmaa010 name="input.a.pmaa010"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa010
            #add-point:ON CHANGE pmaa010 name="input.g.pmaa010"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa011
            
            #add-point:AFTER FIELD pmaa011 name="input.a.pmaa011"
                                                                                    LET g_pmaa_m.pmaa011_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa011_desc
            IF NOT cl_null(g_pmaa_m.pmaa011) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa011 != g_pmaa_m_t.pmaa011 OR g_pmaa_m_t.pmaa011 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa011
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa011 = g_pmaa_m_t.pmaa011
                     CALL apmm801_pmaa011_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa011_ref()  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa011
            #add-point:BEFORE FIELD pmaa011 name="input.b.pmaa011"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa011
            #add-point:ON CHANGE pmaa011 name="input.g.pmaa011"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa027
            #add-point:BEFORE FIELD pmaa027 name="input.b.pmaa027"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa027
            
            #add-point:AFTER FIELD pmaa027 name="input.a.pmaa027"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa027
            #add-point:ON CHANGE pmaa027 name="input.g.pmaa027"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa230
            #add-point:BEFORE FIELD pmaa230 name="input.b.pmaa230"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa230
            
            #add-point:AFTER FIELD pmaa230 name="input.a.pmaa230"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa230
            #add-point:ON CHANGE pmaa230 name="input.g.pmaa230"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa231
            
            #add-point:AFTER FIELD pmaa231 name="input.a.pmaa231"
            IF NOT cl_null(g_pmaa_m.pmaa231) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa231 != g_pmaa_m_t.pmaa231 OR g_pmaa_m_t.pmaa231 IS NULL )) THEN
                  #此段落由子樣板a19產生
                  #校驗代值
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa231 
                  LET g_chkparam.arg2 = '1'
                  
                  #ken---add---S
                  LET l_msg2 = ''
                  SELECT gzzal003 INTO l_msg2 FROM gzzal_t
                   WHERE gzzal001 = 'aooi180'
                     AND gzzal002 = g_lang
                  LET l_msg2 = l_msg2 CLIPPED,'aooi180'
                  LET g_chkparam.err_str[1] = "aoo-00298:aoo-00423|",l_msg2
                  LET g_chkparam.err_str[2] = "aoo-00299:aoo-00424|",l_msg2,"|",'銷售渠道'
                  #LET g_errparam.replace[1] = l_msg
                  #ken---add---E                  
                     
                  #呼叫檢查存在並帶值的library
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     #檢查失敗時後續處理
                     #LET g_pmaa_m.pmaa231 = g_pmaa_m_t.pmaa231   #160824-00007#62 20161014 mark by beckxie
                     LET g_pmaa_m.pmaa231 = g_pmaa_m_o.pmaa231   #160824-00007#62 20161014 add by beckxie
                     LET g_pmaa_m.pmab088 = g_pmaa_m_o.pmab088   #160824-00007#62 20161014 add by beckxie
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa231) RETURNING g_pmaa_m.pmaa231_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa231_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
            LET g_pmaa_m.pmab088 = g_pmaa_m.pmaa231   
            LET g_pmaa_m_o.* = g_pmaa_m.*   #160824-00007#62 20161014 add by beckxie
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa231) RETURNING g_pmaa_m.pmaa231_desc
            DISPLAY BY NAME g_pmaa_m.pmaa231_desc           
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa231
            #add-point:BEFORE FIELD pmaa231 name="input.b.pmaa231"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa231
            #add-point:ON CHANGE pmaa231 name="input.g.pmaa231"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa232
            
            #add-point:AFTER FIELD pmaa232 name="input.a.pmaa232"
                                                                                    LET g_pmaa_m.pmaa232_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa232_desc
            IF NOT cl_null(g_pmaa_m.pmaa232) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa232 != g_pmaa_m_t.pmaa232 OR g_pmaa_m_t.pmaa232 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2072',g_pmaa_m.pmaa232) THEN
                     LET g_pmaa_m.pmaa232 = g_pmaa_m_t.pmaa232
                     CALL apmm801_pmaa232_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa232_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa232
            #add-point:BEFORE FIELD pmaa232 name="input.b.pmaa232"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa232
            #add-point:ON CHANGE pmaa232 name="input.g.pmaa232"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa090
            
            #add-point:AFTER FIELD pmaa090 name="input.a.pmaa090"
                                                                                    LET g_pmaa_m.pmaa090_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa090_desc
            IF NOT cl_null(g_pmaa_m.pmaa090) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa090 != g_pmaa_m_t.pmaa090 OR g_pmaa_m_t.pmaa090 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('281',g_pmaa_m.pmaa090) THEN
                     LET g_pmaa_m.pmaa090 = g_pmaa_m_t.pmaa090
                     CALL apmm801_pmaa090_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa090_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa090
            #add-point:BEFORE FIELD pmaa090 name="input.b.pmaa090"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa090
            #add-point:ON CHANGE pmaa090 name="input.g.pmaa090"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa091
            
            #add-point:AFTER FIELD pmaa091 name="input.a.pmaa091"
            #160810-00008#1 160819 by lori add---(S)
            LET g_pmaa_m.pmaa091_desc = ''
            DISPLAY BY NAME g_pmaa_m.pmaa091_desc
            IF NOT cl_null(g_pmaa_m.pmaa091) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa091 != g_pmaa_m_t.pmaa091 OR cl_null(g_pmaa_m_t.pmaa091))) THEN 
                  IF NOT s_azzi650_chk_exist(g_pmaa091_acc,g_pmaa_m.pmaa091) THEN
                     LET g_pmaa_m.pmaa091 = g_pmaa_m_t.pmaa091
                     LET g_pmaa_m.pmaa091_desc = s_desc_get_acc_desc(g_pmaa091_acc,g_pmaa_m.pmaa091)
                     DISPLAY BY NAME g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            LET g_pmaa_m.pmaa091_desc = s_desc_get_acc_desc(g_pmaa091_acc,g_pmaa_m.pmaa091)
            DISPLAY BY NAME g_pmaa_m.pmaa091_desc             
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa091
            #add-point:BEFORE FIELD pmaa091 name="input.b.pmaa091"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa091
            #add-point:ON CHANGE pmaa091 name="input.g.pmaa091"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa092
            #add-point:BEFORE FIELD pmaa092 name="input.b.pmaa092"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa092
            
            #add-point:AFTER FIELD pmaa092 name="input.a.pmaa092"
            CALL apmm801_set_comp_visible(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            CALL apmm801_set_comp_no_visible(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa092
            #add-point:ON CHANGE pmaa092 name="input.g.pmaa092"
            CALL apmm801_set_comp_visible(p_cmd)
            CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            CALL apmm801_set_comp_no_visible(p_cmd)
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa094
            
            #add-point:AFTER FIELD pmaa094 name="input.a.pmaa094"
                                                                                    LET g_pmaa_m.pmaa094_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa094_desc
            IF NOT cl_null(g_pmaa_m.pmaa094) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa094 != g_pmaa_m_t.pmaa094 OR g_pmaa_m_t.pmaa094 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('286',g_pmaa_m.pmaa094) THEN
                     LET g_pmaa_m.pmaa094 = g_pmaa_m_t.pmaa094
                     CALL apmm801_pmaa094_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa094_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa094
            #add-point:BEFORE FIELD pmaa094 name="input.b.pmaa094"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa094
            #add-point:ON CHANGE pmaa094 name="input.g.pmaa094"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa093
            
            #add-point:AFTER FIELD pmaa093 name="input.a.pmaa093"
                                                                                    LET g_pmaa_m.pmaa093_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa093_desc
            IF NOT cl_null(g_pmaa_m.pmaa093) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa093 != g_pmaa_m_t.pmaa093 OR g_pmaa_m_t.pmaa093 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('285',g_pmaa_m.pmaa093) THEN
                     LET g_pmaa_m.pmaa093 = g_pmaa_m_t.pmaa093
                     CALL apmm801_pmaa093_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa093_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa093
            #add-point:BEFORE FIELD pmaa093 name="input.b.pmaa093"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa093
            #add-point:ON CHANGE pmaa093 name="input.g.pmaa093"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa096
            
            #add-point:AFTER FIELD pmaa096 name="input.a.pmaa096"
            LET g_pmaa_m.pmaa096_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa096_desc
            IF NOT cl_null(g_pmaa_m.pmaa096) THEN
              #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa096 != g_pmaa_m_t.pmaa096 OR g_pmaa_m_t.pmaa096 IS NULL )) THEN   #160810-00008#1 160819 by lori mark
               IF g_pmaa_m.pmaa096 <> g_pmaa_m_o.pmaa096 OR cl_null(g_pmaa_m_o.pmaa096) THEN   #160810-00008#1 160819 by lori add
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa096
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aim-00070:sub-01302|aooi130|",cl_get_progname("aooi130",g_lang,"2"),"|:EXEPROGaooi130"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooag001") THEN
                     LET g_pmaa_m.pmaa096 = g_pmaa_m_t.pmaa096
                     CALL apmm801_pmaa096_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  
                  #160810-00008#1 160819 by lori add---(S)
                  #帶出部門
                  LET l_success = ''
                  LET l_errno = ''
                  LET g_pmaa_m.pmaa097 = ''
                  LET g_pmaa_m.pmaa097_desc = ''
                  
                  CALL s_employee_get_dept(g_pmaa_m.pmaa096) RETURNING l_success,l_errno,g_pmaa_m.pmaa097,g_pmaa_m.pmaa097_desc
                  DISPLAY BY NAME g_pmaa_m.pmaa097,g_pmaa_m.pmaa097_desc
                  LET g_pmaa_m_o.pmaa097 = g_pmaa_m.pmaa097                   
                  #160810-00008#1 160819 by lori add---(E)
               END IF
            END IF
            CALL apmm801_pmaa096_ref()
            
            LET g_pmaa_m_o.pmaa096 = g_pmaa_m.pmaa096   #160810-00008#1 160819 by lori add
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa096
            #add-point:BEFORE FIELD pmaa096 name="input.b.pmaa096"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa096
            #add-point:ON CHANGE pmaa096 name="input.g.pmaa096"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa097
            
            #add-point:AFTER FIELD pmaa097 name="input.a.pmaa097"
            #160810-00008#1 160819 by lori add---(S)
            LET g_pmaa_m.pmaa097_desc = ''
            DISPLAY BY NAME g_pmaa_m.pmaa097_desc

            IF NOT cl_null(g_pmaa_m.pmaa097) THEN 
               IF g_pmaa_m.pmaa097 <> g_pmaa_m_o.pmaa097 OR cl_null(g_pmaa_m_o.pmaa097) THEN 
                  IF NOT s_department_chk(g_pmaa_m.pmaa097,g_today) THEN
                     LET g_pmaa_m.pmaa097 = g_pmaa_m_o.pmaa097

                     CALL s_desc_get_department_desc(g_pmaa_m.pmaa097) RETURNING g_pmaa_m.pmaa097_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa097_desc

                     NEXT FIELD CURRENT
                  END IF
               END IF               
            END IF

            CALL s_desc_get_department_desc(g_pmaa_m.pmaa097) RETURNING g_pmaa_m.pmaa097_desc
            DISPLAY BY NAME g_pmaa_m.pmaa097_desc
                     
            LET g_pmaa_m_o.pmaa097 = g_pmaa_m.pmaa097              
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa097
            #add-point:BEFORE FIELD pmaa097 name="input.b.pmaa097"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa097
            #add-point:ON CHANGE pmaa097 name="input.g.pmaa097"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa241
            
            #add-point:AFTER FIELD pmaa241 name="input.a.pmaa241"
            LET g_pmaa_m.pmaa241_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa241_desc
            IF NOT cl_null(g_pmaa_m.pmaa241) THEN
               IF g_pmaa_m.pmaa241 != g_pmaa_m_o.pmaa241 OR g_pmaa_m_o.pmaa241 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa241
                  LET g_chkparam.arg2 = '1'
                  LET g_chkparam.err_str[1] = "acr-00004|",'1'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa241 = g_pmaa_m_o.pmaa241
                     CALL apmm801_pmaa241_ref()
                     NEXT FIELD CURRENT
                  END IF
                  LET g_pmaa_m.pmaa242 = ''
                  LET g_pmaa_m.pmaa243 = ''
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa242_desc = ''
                  LET g_pmaa_m.pmaa243_desc = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            CALL apmm801_pmaa241_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa241
            #add-point:BEFORE FIELD pmaa241 name="input.b.pmaa241"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa241
            #add-point:ON CHANGE pmaa241 name="input.g.pmaa241"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa242
            
            #add-point:AFTER FIELD pmaa242 name="input.a.pmaa242"
            LET g_pmaa_m.pmaa242_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa242_desc
            IF NOT cl_null(g_pmaa_m.pmaa242) THEN
               IF g_pmaa_m.pmaa242 != g_pmaa_m_o.pmaa242 OR g_pmaa_m_o.pmaa242 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa242
                  LET g_chkparam.arg2 = '2'
                  LET g_chkparam.err_str[1] = "acr-00004|",'2'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa242 = g_pmaa_m_o.pmaa242
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa242_ref()
                     #CALL apmm801_pmaa241_ref()
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa241) THEN
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa241_ref()
                  END IF
                  LET g_pmaa_m.pmaa243 = ''
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa243_desc = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            CALL apmm801_pmaa242_ref()
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa242
            #add-point:BEFORE FIELD pmaa242 name="input.b.pmaa242"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa242
            #add-point:ON CHANGE pmaa242 name="input.g.pmaa242"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa243
            
            #add-point:AFTER FIELD pmaa243 name="input.a.pmaa243"
            LET g_pmaa_m.pmaa243_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa243_desc
            IF NOT cl_null(g_pmaa_m.pmaa243) THEN
               IF g_pmaa_m.pmaa243 != g_pmaa_m_o.pmaa243 OR g_pmaa_m_o.pmaa243 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa243
                  LET g_chkparam.arg2 = '3'
                  LET g_chkparam.err_str[1] = "acr-00004|",'3' 
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa243 = g_pmaa_m_o.pmaa243
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa243_ref()
                     #CALL apmm801_pmaa242_ref()
                     #CALL apmm801_pmaa241_ref()
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa242) THEN
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa242_ref()
                     CALL apmm801_pmaa241_ref()
                  END IF
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            CALL apmm801_pmaa243_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa243
            #add-point:BEFORE FIELD pmaa243 name="input.b.pmaa243"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa243
            #add-point:ON CHANGE pmaa243 name="input.g.pmaa243"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa244
            
            #add-point:AFTER FIELD pmaa244 name="input.a.pmaa244"
            LET g_pmaa_m.pmaa244_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa244_desc
            IF NOT cl_null(g_pmaa_m.pmaa244) THEN
               IF g_pmaa_m.pmaa244 != g_pmaa_m_o.pmaa244 OR g_pmaa_m_o.pmaa244 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa244
                  LET g_chkparam.arg2 = '4'
                  LET g_chkparam.err_str[1] = "acr-00004|",'4'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa244 = g_pmaa_m_o.pmaa244
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa244,'4') RETURNING g_pmaa_m.pmaa243
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     #CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa244_ref()
                     #CALL apmm801_pmaa243_ref()
                     #CALL apmm801_pmaa242_ref()
                     #CALL apmm801_pmaa241_ref()
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa243) THEN
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa244,'4') RETURNING g_pmaa_m.pmaa243
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     CALL s_apmm801_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     CALL apmm801_pmaa243_ref()
                     CALL apmm801_pmaa242_ref()
                     CALL apmm801_pmaa241_ref()
                  END IF
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            CALL apmm801_pmaa244_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa244
            #add-point:BEFORE FIELD pmaa244 name="input.b.pmaa244"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa244
            #add-point:ON CHANGE pmaa244 name="input.g.pmaa244"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa245
            
            #add-point:AFTER FIELD pmaa245 name="input.a.pmaa245"
            IF NOT cl_null(g_pmaa_m.pmaa245) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa245 != g_pmaa_m_t.pmaa245 OR g_pmaa_m_t.pmaa245 IS NULL )) THEN
                  #此段落由子樣板a19產生
                  #校驗代值
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa245 
                  LET g_chkparam.arg2 = '1'
                  
                  #ken---add---S
                  LET l_msg2 = ''
                  SELECT gzzal003 INTO l_msg2 FROM gzzal_t
                   WHERE gzzal001 = 'aooi180'
                     AND gzzal002 = g_lang
                  LET l_msg2 = l_msg2 CLIPPED,'aooi180'
                  LET g_chkparam.err_str[1] = "aoo-00298:aoo-00423|",l_msg2
                  LET g_chkparam.err_str[2] = "aoo-00299:aoo-00424|",l_msg2,"|",'銷售渠道'
                  #LET g_errparam.replace[1] = l_msg
                  #ken---add---E                   
                     
                  #呼叫檢查存在並帶值的library
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     #檢查失敗時後續處理
                     LET g_pmaa_m.pmaa245 = g_pmaa_m_t.pmaa245
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa245) RETURNING g_pmaa_m.pmaa245_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa245_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa245) RETURNING g_pmaa_m.pmaa245_desc
            DISPLAY BY NAME g_pmaa_m.pmaa245_desc 
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa245
            #add-point:BEFORE FIELD pmaa245 name="input.b.pmaa245"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa245
            #add-point:ON CHANGE pmaa245 name="input.g.pmaa245"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa246
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa246,"0","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa246
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa246 name="input.a.pmaa246"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa246) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa246
            #add-point:BEFORE FIELD pmaa246 name="input.b.pmaa246"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa246
            #add-point:ON CHANGE pmaa246 name="input.g.pmaa246"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa247
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa247,"0","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa247
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa247 name="input.a.pmaa247"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa247) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa247
            #add-point:BEFORE FIELD pmaa247 name="input.b.pmaa247"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa247
            #add-point:ON CHANGE pmaa247 name="input.g.pmaa247"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa248
            #add-point:BEFORE FIELD pmaa248 name="input.b.pmaa248"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa248
            
            #add-point:AFTER FIELD pmaa248 name="input.a.pmaa248"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa248
            #add-point:ON CHANGE pmaa248 name="input.g.pmaa248"
            #150302-00004#17 Add-S By Ken 150504
            IF g_pmaa_m.pmaa248 = 'Y' THEN
               IF NOT apmm801_pmaa248_chk(g_pmaa_m.pmaa001) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adb-00421"
                  LET g_errparam.popup  = TRUE
                  LET g_errparam.replace[1] = g_pmaa_m.pmaa001
                  CALL cl_err()
                  LET g_pmaa_m.pmaa248 = 'N'
               END IF
            END IF
            #150302-00004#17 Add-E
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa095
            
            #add-point:AFTER FIELD pmaa095 name="input.a.pmaa095"
            LET g_pmaa_m.pmaa095_desc = NULL
            DISPLAY BY NAME g_pmaa_m.pmaa095_desc
            IF NOT cl_null(g_pmaa_m.pmaa095) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa095 != g_pmaa_m_t.pmaa095 OR g_pmaa_m_t.pmaa095 IS null)) THEN
                  CALL s_aooi500_chk(g_prog,'pmaaunit',g_pmaa_m.pmaa095,g_site)
                   RETURNING l_success,l_errno
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.extend = g_pmaa_m.pmaa095
                     LET g_errparam.code   = l_errno
                     LET g_errparam.popup  = TRUE
                     CALL cl_err()
                     LET g_pmaa_m.pmaa095 = g_pmaa_m_t.pmaa095
                     CALL apmm801_pmaa095_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa095_ref() 
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa095
            #add-point:BEFORE FIELD pmaa095 name="input.b.pmaa095"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa095
            #add-point:ON CHANGE pmaa095 name="input.g.pmaa095"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa220
            #add-point:BEFORE FIELD pmaa220 name="input.b.pmaa220"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa220
            
            #add-point:AFTER FIELD pmaa220 name="input.a.pmaa220"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa220
            #add-point:ON CHANGE pmaa220 name="input.g.pmaa220"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa221
            
            #add-point:AFTER FIELD pmaa221 name="input.a.pmaa221"
            IF NOT cl_null(g_pmaa_m.pmaa221) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa221 != g_pmaa_m_t.pmaa221 OR g_pmaa_m_t.pmaa221 IS NULL )) THEN
                  #此段落由子樣板a19產生
                  #校驗代值
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa221 
                  LET g_chkparam.arg2 = '2'
                  
                  #ken---add---S
                  LET l_msg2 = ''
                  SELECT gzzal003 INTO l_msg2 FROM gzzal_t
                   WHERE gzzal001 = 'aooi181'
                     AND gzzal002 = g_lang
                  LET l_msg2 = l_msg2 CLIPPED,'aooi181'
                  LET g_chkparam.err_str[1] = "aoo-00298:aoo-00423|",l_msg2
                  LET g_chkparam.err_str[2] = "aoo-00299:aoo-00424|",l_msg2,"|",'採購渠道'
                  #LET g_errparam.replace[1] = l_msg
                  #ken---add---E
                  
                  #呼叫檢查存在並帶值的library
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     #檢查失敗時後續處理
                     #LET g_pmaa_m.pmaa221 = g_pmaa_m_t.pmaa221   #160824-00007#62 20161014 mark by beckxie
                     LET g_pmaa_m.pmaa221 = g_pmaa_m_o.pmaa221   #160824-00007#62 20161014 add by beckxie
                     LET g_pmaa_m.pmab038 = g_pmaa_m_o.pmab038   #160824-00007#62 20161014 add by beckxie
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221) RETURNING g_pmaa_m.pmaa221_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa221_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF 
            LET g_pmaa_m.pmab038 = g_pmaa_m.pmaa221
            LET g_pmaa_m_o.* = g_pmaa_m.*   #160824-00007#62 20161014 add by beckxie
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221) RETURNING g_pmaa_m.pmaa221_desc
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa221
            #add-point:BEFORE FIELD pmaa221 name="input.b.pmaa221"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa221
            #add-point:ON CHANGE pmaa221 name="input.g.pmaa221"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa222
            
            #add-point:AFTER FIELD pmaa222 name="input.a.pmaa222"
                                                                                    LET g_pmaa_m.pmaa222_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa222_desc
            IF NOT cl_null(g_pmaa_m.pmaa222) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa222 != g_pmaa_m_t.pmaa222 OR g_pmaa_m_t.pmaa222 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2072',g_pmaa_m.pmaa222) THEN
                     LET g_pmaa_m.pmaa222 = g_pmaa_m_t.pmaa222
                     CALL apmm801_pmaa222_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa222_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa222
            #add-point:BEFORE FIELD pmaa222 name="input.b.pmaa222"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa222
            #add-point:ON CHANGE pmaa222 name="input.g.pmaa222"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa080
            
            #add-point:AFTER FIELD pmaa080 name="input.a.pmaa080"
                                                                                    LET g_pmaa_m.pmaa080_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa080_desc
            IF NOT cl_null(g_pmaa_m.pmaa080) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa080 != g_pmaa_m_t.pmaa080 OR g_pmaa_m_t.pmaa080 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('251',g_pmaa_m.pmaa080) THEN
                     LET g_pmaa_m.pmaa080 = g_pmaa_m_t.pmaa080
                     CALL apmm801_pmaa080_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa080_ref()

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa080
            #add-point:BEFORE FIELD pmaa080 name="input.b.pmaa080"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa080
            #add-point:ON CHANGE pmaa080 name="input.g.pmaa080"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa084
            
            #add-point:AFTER FIELD pmaa084 name="input.a.pmaa084"
                                                                                    LET g_pmaa_m.pmaa084_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa084_desc
            IF NOT cl_null(g_pmaa_m.pmaa084) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa084 != g_pmaa_m_t.pmaa084 OR g_pmaa_m_t.pmaa084 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('256',g_pmaa_m.pmaa084) THEN
                     LET g_pmaa_m.pmaa084 = g_pmaa_m_t.pmaa084
                     CALL apmm801_pmaa084_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa084_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa084
            #add-point:BEFORE FIELD pmaa084 name="input.b.pmaa084"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa084
            #add-point:ON CHANGE pmaa084 name="input.g.pmaa084"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa083
            
            #add-point:AFTER FIELD pmaa083 name="input.a.pmaa083"
                                                                                    LET g_pmaa_m.pmaa083_desc = ' '
#            DISPLAY BY NAME g_pmaa_m.pmaa083_desc
#            IF NOT cl_null(g_pmaa_m.pmaa083) THEN
#               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa083 != g_pmaa_m_t.pmaa083 OR g_pmaa_m_t.pmaa083 IS NULL )) THEN
#                  IF NOT s_azzi650_chk_exist('255',g_pmaa_m.pmaa083) THEN
#                     LET g_pmaa_m.pmaa083 = g_pmaa_m_t.pmaa083
#                     CALL apmm801_pmaa083_ref()
#                     NEXT FIELD CURRENT
#                  END IF
#               END IF
#            END IF
#            CALL apmm801_pmaa083_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa083
            #add-point:BEFORE FIELD pmaa083 name="input.b.pmaa083"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa083
            #add-point:ON CHANGE pmaa083 name="input.g.pmaa083"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa086
            
            #add-point:AFTER FIELD pmaa086 name="input.a.pmaa086"
                                                                                    LET g_pmaa_m.pmaa086_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa086_desc
            IF NOT cl_null(g_pmaa_m.pmaa086) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa086 != g_pmaa_m_t.pmaa086 OR g_pmaa_m_t.pmaa086 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa086
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aim-00070:sub-01302|aooi130|",cl_get_progname("aooi130",g_lang,"2"),"|:EXEPROGaooi130"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooag001") THEN
                     LET g_pmaa_m.pmaa086 = g_pmaa_m_t.pmaa086
                     CALL apmm801_pmaa086_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa086_ref()  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa086
            #add-point:BEFORE FIELD pmaa086 name="input.b.pmaa086"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa086
            #add-point:ON CHANGE pmaa086 name="input.g.pmaa086"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa085
            
            #add-point:AFTER FIELD pmaa085 name="input.a.pmaa085"
            LET g_pmaa_m.pmaa085_desc = NULL
            DISPLAY BY NAME g_pmaa_m.pmaa085_desc
            IF NOT cl_null(g_pmaa_m.pmaa085) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa085 != g_pmaa_m_t.pmaa085 OR g_pmaa_m_t.pmaa085 IS null)) THEN
                  CALL s_aooi500_chk(g_prog,'pmaaunit',g_pmaa_m.pmaa085,g_site)
                   RETURNING l_success,l_errno
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.extend = g_pmaa_m.pmaa085
                     LET g_errparam.code   = l_errno
                     LET g_errparam.popup  = TRUE
                     CALL cl_err()
                     LET g_pmaa_m.pmaa085 = g_pmaa_m_t.pmaa085
                     CALL apmm801_pmaa085_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa085_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa085
            #add-point:BEFORE FIELD pmaa085 name="input.b.pmaa085"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa085
            #add-point:ON CHANGE pmaa085 name="input.g.pmaa085"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa051
            #add-point:BEFORE FIELD pmaa051 name="input.b.pmaa051"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa051
            
            #add-point:AFTER FIELD pmaa051 name="input.a.pmaa051"
                                                                                    CALL apmm801_set_no_required(p_cmd)
            CALL apmm801_set_required(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa051
            #add-point:ON CHANGE pmaa051 name="input.g.pmaa051"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa052
            
            #add-point:AFTER FIELD pmaa052 name="input.a.pmaa052"
                                                                                    LET g_pmaa_m.pmaa052_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa052_desc
            IF NOT cl_null(g_pmaa_m.pmaa052) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa052 != g_pmaa_m_t.pmaa052 OR g_pmaa_m_t.pmaa052 IS NULL )) THEN
                  IF g_pmaa_m.pmaa052 != g_pmaa_m.pmaa001 OR g_pmaa_m.pmaa001 IS NULL THEN
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = g_pmaa_m.pmaa052
                     #160318-00025#24  by 07900 --add-str
                     LET g_errshow = TRUE #是否開窗                   
                     LET g_chkparam.err_str[1] ="apm-00044:sub-01302|apmm100|",cl_get_progname("apmm100",g_lang,"2"),"|:EXEPROGapm100"
                     #160318-00025#24  by 07900 --add-end
                     IF NOT cl_chk_exist("v_pmaa001_2") THEN
                        LET g_pmaa_m.pmaa052 = g_pmaa_m_t.pmaa052
                        CALL apmm801_pmaa052_ref()
                        NEXT FIELD CURRENT                  
                     END IF
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa052_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa052
            #add-point:BEFORE FIELD pmaa052 name="input.b.pmaa052"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa052
            #add-point:ON CHANGE pmaa052 name="input.g.pmaa052"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa053
            
            #add-point:AFTER FIELD pmaa053 name="input.a.pmaa053"
                                                                       
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa053
            #add-point:BEFORE FIELD pmaa053 name="input.b.pmaa053"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa053
            #add-point:ON CHANGE pmaa053 name="input.g.pmaa053"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa054
            
            #add-point:AFTER FIELD pmaa054 name="input.a.pmaa054"
                                                                                    LET g_pmaa_m.pmaa054_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa054_desc
            IF NOT cl_null(g_pmaa_m.pmaa054) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa054 != g_pmaa_m_t.pmaa054 OR g_pmaa_m_t.pmaa054 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa054
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa054 = g_pmaa_m_t.pmaa054
                     CALL apmm801_pmaa054_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa054_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa054
            #add-point:BEFORE FIELD pmaa054 name="input.b.pmaa054"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa054
            #add-point:ON CHANGE pmaa054 name="input.g.pmaa054"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa055
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa055,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa055
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa055 name="input.a.pmaa055"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa055) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa055
            #add-point:BEFORE FIELD pmaa055 name="input.b.pmaa055"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa055
            #add-point:ON CHANGE pmaa055 name="input.g.pmaa055"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa056
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa056,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa056
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa056 name="input.a.pmaa056"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa056) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa056
            #add-point:BEFORE FIELD pmaa056 name="input.b.pmaa056"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa056
            #add-point:ON CHANGE pmaa056 name="input.g.pmaa056"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa057
            #add-point:BEFORE FIELD pmaa057 name="input.b.pmaa057"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa057
            
            #add-point:AFTER FIELD pmaa057 name="input.a.pmaa057"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa057
            #add-point:ON CHANGE pmaa057 name="input.g.pmaa057"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa058
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa058,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa058
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa058 name="input.a.pmaa058"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa058) THEN 
            END IF 
            
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa058
            #add-point:BEFORE FIELD pmaa058 name="input.b.pmaa058"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa058
            #add-point:ON CHANGE pmaa058 name="input.g.pmaa058"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa074
            #add-point:BEFORE FIELD pmaa074 name="input.b.pmaa074"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa074
            
            #add-point:AFTER FIELD pmaa074 name="input.a.pmaa074"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa074
            #add-point:ON CHANGE pmaa074 name="input.g.pmaa074"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa059
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa059,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa059
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa059 name="input.a.pmaa059"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa059) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa059
            #add-point:BEFORE FIELD pmaa059 name="input.b.pmaa059"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa059
            #add-point:ON CHANGE pmaa059 name="input.g.pmaa059"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa075
            #add-point:BEFORE FIELD pmaa075 name="input.b.pmaa075"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa075
            
            #add-point:AFTER FIELD pmaa075 name="input.a.pmaa075"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa075
            #add-point:ON CHANGE pmaa075 name="input.g.pmaa075"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa047
            #add-point:BEFORE FIELD pmaa047 name="input.b.pmaa047"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa047
            
            #add-point:AFTER FIELD pmaa047 name="input.a.pmaa047"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa047
            #add-point:ON CHANGE pmaa047 name="input.g.pmaa047"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa036
            #add-point:BEFORE FIELD pmaa036 name="input.b.pmaa036"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa036
            
            #add-point:AFTER FIELD pmaa036 name="input.a.pmaa036"
                                                                                    IF g_pmaa_m.pmaa036 = 'Y' THEN
               LET g_pmaa_m.pmaa037 = g_pmaa_m_t.pmaa037 
               LET g_pmaa_m.pmaa038 = g_pmaa_m_t.pmaa038 
               LET g_pmaa_m.pmaa039 = g_pmaa_m_t.pmaa039 
               LET g_pmaa_m.pmaa040 = g_pmaa_m_t.pmaa040 
               LET g_pmaa_m.pmaa041 = g_pmaa_m_t.pmaa041  
               LET g_pmaa_m.pmaa042 = g_pmaa_m_t.pmaa042  
               LET g_pmaa_m.pmaa043 = g_pmaa_m_t.pmaa043  
               LET g_pmaa_m.pmaa044 = g_pmaa_m_t.pmaa044  
               LET g_pmaa_m.pmaa045 = g_pmaa_m_t.pmaa045  
               LET g_pmaa_m.pmaa046 = g_pmaa_m_t.pmaa046
               IF cl_null(g_pmaa_m.pmaa037) THEN
                  LET g_pmaa_m.pmaa037 = '1'
               END IF               
            ELSE
               LET g_pmaa_m.pmaa037 = ''
               LET g_pmaa_m.pmaa038 = ''
               LET g_pmaa_m.pmaa039 = ''
               LET g_pmaa_m.pmaa040 = ''
               LET g_pmaa_m.pmaa041 = ''
               LET g_pmaa_m.pmaa042 = ''
               LET g_pmaa_m.pmaa043 = ''
               LET g_pmaa_m.pmaa044 = ''
               LET g_pmaa_m.pmaa045 = ''
               LET g_pmaa_m.pmaa046 = ''
            END IF  
            
            DISPLAY BY NAME g_pmaa_m.pmaa037, g_pmaa_m.pmaa038, g_pmaa_m.pmaa039, g_pmaa_m.pmaa040, 
                            g_pmaa_m.pmaa041, g_pmaa_m.pmaa042, g_pmaa_m.pmaa043, g_pmaa_m.pmaa044, 
                            g_pmaa_m.pmaa045, g_pmaa_m.pmaa046     
                            
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa036
            #add-point:ON CHANGE pmaa036 name="input.g.pmaa036"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa037
            #add-point:BEFORE FIELD pmaa037 name="input.b.pmaa037"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa037
            
            #add-point:AFTER FIELD pmaa037 name="input.a.pmaa037"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa037
            #add-point:ON CHANGE pmaa037 name="input.g.pmaa037"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa038
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa038,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa038
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa038 name="input.a.pmaa038"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa038) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa038
            #add-point:BEFORE FIELD pmaa038 name="input.b.pmaa038"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa038
            #add-point:ON CHANGE pmaa038 name="input.g.pmaa038"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa039
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa039,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa039
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa039 name="input.a.pmaa039"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa039) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa039
            #add-point:BEFORE FIELD pmaa039 name="input.b.pmaa039"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa039
            #add-point:ON CHANGE pmaa039 name="input.g.pmaa039"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa040
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa040,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa040
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa040 name="input.a.pmaa040"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa040) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa040
            #add-point:BEFORE FIELD pmaa040 name="input.b.pmaa040"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa040
            #add-point:ON CHANGE pmaa040 name="input.g.pmaa040"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa041
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa041,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa041
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa041 name="input.a.pmaa041"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa041) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa041
            #add-point:BEFORE FIELD pmaa041 name="input.b.pmaa041"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa041
            #add-point:ON CHANGE pmaa041 name="input.g.pmaa041"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa042
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa042,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa042
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa042 name="input.a.pmaa042"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa042) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa042
            #add-point:BEFORE FIELD pmaa042 name="input.b.pmaa042"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa042
            #add-point:ON CHANGE pmaa042 name="input.g.pmaa042"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa043
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa043,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa043
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa043 name="input.a.pmaa043"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa043) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa043
            #add-point:BEFORE FIELD pmaa043 name="input.b.pmaa043"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa043
            #add-point:ON CHANGE pmaa043 name="input.g.pmaa043"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa044
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa044,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa044
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa044 name="input.a.pmaa044"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa044) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa044
            #add-point:BEFORE FIELD pmaa044 name="input.b.pmaa044"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa044
            #add-point:ON CHANGE pmaa044 name="input.g.pmaa044"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa045
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa045,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa045
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa045 name="input.a.pmaa045"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa045) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa045
            #add-point:BEFORE FIELD pmaa045 name="input.b.pmaa045"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa045
            #add-point:ON CHANGE pmaa045 name="input.g.pmaa045"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa046
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa046,"1.000","1","31.000","1","azz-00087",1) THEN
               NEXT FIELD pmaa046
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa046 name="input.a.pmaa046"
                                                                                    IF NOT cl_null(g_pmaa_m.pmaa046) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa046
            #add-point:BEFORE FIELD pmaa046 name="input.b.pmaa046"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa046
            #add-point:ON CHANGE pmaa046 name="input.g.pmaa046"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa068
            #add-point:BEFORE FIELD pmaa068 name="input.b.pmaa068"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa068
            
            #add-point:AFTER FIELD pmaa068 name="input.a.pmaa068"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa068
            #add-point:ON CHANGE pmaa068 name="input.g.pmaa068"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa069
            #add-point:BEFORE FIELD pmaa069 name="input.b.pmaa069"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa069
            
            #add-point:AFTER FIELD pmaa069 name="input.a.pmaa069"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa069
            #add-point:ON CHANGE pmaa069 name="input.g.pmaa069"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa072
            #add-point:BEFORE FIELD pmaa072 name="input.b.pmaa072"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa072
            
            #add-point:AFTER FIELD pmaa072 name="input.a.pmaa072"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa072
            #add-point:ON CHANGE pmaa072 name="input.g.pmaa072"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa070
            #add-point:BEFORE FIELD pmaa070 name="input.b.pmaa070"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa070
            
            #add-point:AFTER FIELD pmaa070 name="input.a.pmaa070"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa070
            #add-point:ON CHANGE pmaa070 name="input.g.pmaa070"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa071
            #add-point:BEFORE FIELD pmaa071 name="input.b.pmaa071"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa071
            
            #add-point:AFTER FIELD pmaa071 name="input.a.pmaa071"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa071
            #add-point:ON CHANGE pmaa071 name="input.g.pmaa071"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa073
            #add-point:BEFORE FIELD pmaa073 name="input.b.pmaa073"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa073
            
            #add-point:AFTER FIELD pmaa073 name="input.a.pmaa073"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa073
            #add-point:ON CHANGE pmaa073 name="input.g.pmaa073"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa204
            #add-point:BEFORE FIELD pmaa204 name="input.b.pmaa204"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa204
            
            #add-point:AFTER FIELD pmaa204 name="input.a.pmaa204"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa204
            #add-point:ON CHANGE pmaa204 name="input.g.pmaa204"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa205
            
            #add-point:AFTER FIELD pmaa205 name="input.a.pmaa205"
                                                                                    LET g_pmaa_m.pmaa205_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa205_desc
            IF NOT cl_null(g_pmaa_m.pmaa205) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa205 != g_pmaa_m_t.pmaa205 OR g_pmaa_m_t.pmaa205 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2031',g_pmaa_m.pmaa205) THEN
                     LET g_pmaa_m.pmaa205 = g_pmaa_m_t.pmaa205
                     CALL apmm801_pmaa205_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa205_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa205
            #add-point:BEFORE FIELD pmaa205 name="input.b.pmaa205"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa205
            #add-point:ON CHANGE pmaa205 name="input.g.pmaa205"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa206
            #add-point:BEFORE FIELD pmaa206 name="input.b.pmaa206"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa206
            
            #add-point:AFTER FIELD pmaa206 name="input.a.pmaa206"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa206
            #add-point:ON CHANGE pmaa206 name="input.g.pmaa206"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab032
            #add-point:BEFORE FIELD pmab032 name="input.b.pmab032"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab032
            
            #add-point:AFTER FIELD pmab032 name="input.a.pmab032"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab032
            #add-point:ON CHANGE pmab032 name="input.g.pmab032"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab057
            #add-point:BEFORE FIELD pmab057 name="input.b.pmab057"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab057
            
            #add-point:AFTER FIELD pmab057 name="input.a.pmab057"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab057
            #add-point:ON CHANGE pmab057 name="input.g.pmab057"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab058
            #add-point:BEFORE FIELD pmab058 name="input.b.pmab058"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab058
            
            #add-point:AFTER FIELD pmab058 name="input.a.pmab058"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab058) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab058 != g_pmaa_m_t.pmab058 OR g_pmaa_m_t.pmab058 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab108) THEN
                     LET g_pmaa_m.pmab108 = g_pmaa_m.pmab058
                                          
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab058
            #add-point:ON CHANGE pmab058 name="input.g.pmab058"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab053
            
            #add-point:AFTER FIELD pmab053 name="input.a.pmab053"
            LET g_pmaa_m.pmab053_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab053_desc
            IF NOT cl_null(g_pmaa_m.pmab053) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab053 != g_pmaa_m_t.pmab053 OR g_pmaa_m_t.pmab053 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('238',g_pmaa_m.pmab053) THEN
                     LET g_pmaa_m.pmab053 = g_pmaa_m_t.pmab053
                     CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab053) RETURNING g_pmaa_m.pmab053_desc
                     DISPLAY BY NAME g_pmaa_m.pmab053_desc
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab103) THEN
                     LET g_pmaa_m.pmab103 = g_pmaa_m.pmab053
                     CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab103) RETURNING g_pmaa_m.pmab103_desc
                     DISPLAY BY NAME g_pmaa_m.pmab103_desc                    
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab053) RETURNING g_pmaa_m.pmab053_desc
            DISPLAY BY NAME g_pmaa_m.pmab053_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab053
            #add-point:BEFORE FIELD pmab053 name="input.b.pmab053"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab053
            #add-point:ON CHANGE pmab053 name="input.g.pmab053"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab039
            
            #add-point:AFTER FIELD pmab039 name="input.a.pmab039"
            LET g_pmaa_m.pmab039_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab039_desc
            IF NOT cl_null(g_pmaa_m.pmab039) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab039 != g_pmaa_m_t.pmab039 OR g_pmaa_m_t.pmab039 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('264',g_pmaa_m.pmab039) THEN
                     LET g_pmaa_m.pmab039 = g_pmaa_m_t.pmab039
                     CALL apmm801_pmab039_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmab039_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab039
            #add-point:BEFORE FIELD pmab039 name="input.b.pmab039"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab039
            #add-point:ON CHANGE pmab039 name="input.g.pmab039"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa081
            
            #add-point:AFTER FIELD pmaa081 name="input.a.pmaa081"
            LET g_pmaa_m.pmaa081_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa081_desc
            IF NOT cl_null(g_pmaa_m.pmaa081) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa081 != g_pmaa_m_t.pmaa081 OR g_pmaa_m_t.pmaa081 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('253',g_pmaa_m.pmaa081) THEN
                     LET g_pmaa_m.pmaa081 = g_pmaa_m_t.pmaa081
                     CALL apmm801_pmaa081_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa081_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa081
            #add-point:BEFORE FIELD pmaa081 name="input.b.pmaa081"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa081
            #add-point:ON CHANGE pmaa081 name="input.g.pmaa081"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab033
            
            #add-point:AFTER FIELD pmab033 name="input.a.pmab033"
            LET g_pmaa_m.pmab033_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab033_desc
            IF NOT cl_null(g_pmaa_m.pmab033) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab033 != g_pmaa_m_t.pmab033 OR g_pmaa_m_t.pmab033 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmab033
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmab033 = g_pmaa_m_t.pmab033
                     CALL apmm801_pmab033_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmab033_ref()

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab033
            #add-point:BEFORE FIELD pmab033 name="input.b.pmab033"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab033
            #add-point:ON CHANGE pmab033 name="input.g.pmab033"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab034
            
            #add-point:AFTER FIELD pmab034 name="input.a.pmab034"
            LET g_pmaa_m.pmab034_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab034_desc
            IF NOT cl_null(g_pmaa_m.pmab034) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab034 != g_pmaa_m_t.pmab034 OR g_pmaa_m_t.pmab034 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmab034
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00223:sub-01302|aooi610|",cl_get_progname("aooi610",g_lang,"2"),"|:EXEPROGaooi610"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_oodb002") THEN
                     LET g_pmaa_m.pmab034 = g_pmaa_m_t.pmab034
                     CALL apmm801_pmab034_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab084) THEN
                     LET g_pmaa_m.pmab084 = g_pmaa_m.pmab034
                     CALL apmm801_pmab084_ref()                     
                  END IF
               END IF
            END IF
 
            CALL apmm801_pmab034_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab034
            #add-point:BEFORE FIELD pmab034 name="input.b.pmab034"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab034
            #add-point:ON CHANGE pmab034 name="input.g.pmab034"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab035
            #add-point:BEFORE FIELD pmab035 name="input.b.pmab035"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab035
            
            #add-point:AFTER FIELD pmab035 name="input.a.pmab035"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab035) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab035 != g_pmaa_m_t.pmab035 OR g_pmaa_m_t.pmab035 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab085) THEN
                     LET g_pmaa_m.pmab085 = g_pmaa_m.pmab035
                                          
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab035
            #add-point:ON CHANGE pmab035 name="input.g.pmab035"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab056
            
            #add-point:AFTER FIELD pmab056 name="input.a.pmab056"
            LET g_pmaa_m.pmab056_desc = ''
            DISPLAY BY NAME g_pmaa_m.pmab056_desc
            IF NOT cl_null(g_pmaa_m.pmab056) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab056 != g_pmaa_m_t.pmab056 OR g_pmaa_m_t.pmab056 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_ooef019
                  LET g_chkparam.arg2 = g_pmaa_m.pmab056
                  IF NOT cl_chk_exist("v_isac002_1") THEN
                     LET g_pmaa_m.pmab056 = g_pmaa_m_t.pmab056
                     CALL s_desc_get_invoice_type_desc1(g_site,g_pmaa_m.pmab056) RETURNING g_pmaa_m.pmab056_desc
                     DISPLAY BY NAME g_pmaa_m.pmab056_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_invoice_type_desc1(g_site,g_pmaa_m.pmab056) RETURNING g_pmaa_m.pmab056_desc
            DISPLAY BY NAME g_pmaa_m.pmab056_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab056
            #add-point:BEFORE FIELD pmab056 name="input.b.pmab056"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab056
            #add-point:ON CHANGE pmab056 name="input.g.pmab056"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab037
            
            #add-point:AFTER FIELD pmab037 name="input.a.pmab037"
            LET g_pmaa_m.pmab037_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab037_desc
            IF NOT cl_null(g_pmaa_m.pmab037) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab037 != g_pmaa_m_t.pmab037 OR g_pmaa_m_t.pmab037 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmab037
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="apm-00186:sub-01302|aooi716|",cl_get_progname("aooi716",g_lang,"2"),"|:EXEPROGaooi716"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooib002") THEN
                     LET g_pmaa_m.pmab037 = g_pmaa_m_t.pmab037
                     CALL apmm801_pmab037_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmab037_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab037
            #add-point:BEFORE FIELD pmab037 name="input.b.pmab037"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab037
            #add-point:ON CHANGE pmab037 name="input.g.pmab037"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab055
            
            #add-point:AFTER FIELD pmab055 name="input.a.pmab055"
              
            IF  NOT cl_null(g_pmaa_m.pmab055) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmab055 != g_pmaa_m_t.pmab055 OR cl_null(g_pmaa_m_t.pmab055))) THEN 
                  IF NOT ap_chk_isExist(g_pmaa_m.pmab055,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '3211' AND oocq002 = ? ","sub-01303","aapi010") THEN  #apm-00179 #160318-00005#35  By 07900 --mod
                     LET g_pmaa_m.pmab055 = g_pmaa_m_t.pmab055
                     CALL apmm801_pmab055_ref() 
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT ap_chk_isExist(g_pmaa_m.pmab055,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '3211' AND oocq002 = ? AND oocqstus = 'Y' ","sub-01302","aapi010") THEN  #apm-00180 #160318-00005#35  By 07900 --mod
                     LET g_pmaa_m.pmab055 = g_pmaa_m_t.pmab055
                     CALL apmm801_pmab055_ref() 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
           
            CALL apmm801_pmab055_ref() 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab055
            #add-point:BEFORE FIELD pmab055 name="input.b.pmab055"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab055
            #add-point:ON CHANGE pmab055 name="input.g.pmab055"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab038
            
            #add-point:AFTER FIELD pmab038 name="input.a.pmab038"
            IF NOT cl_null(g_pmaa_m.pmab038) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab038 != g_pmaa_m_t.pmab038 OR g_pmaa_m_t.pmab038 IS NULL )) THEN
                  #此段落由子樣板a19產生
                  #校驗代值
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmaa_m.pmab038 
                  LET g_chkparam.arg2 = '2'
                     
                  #呼叫檢查存在並帶值的library
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     #檢查失敗時後續處理
                     LET g_pmaa_m.pmab038 = g_pmaa_m_t.pmab038
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab038) RETURNING g_pmaa_m.pmab038_desc
                     DISPLAY BY NAME g_pmaa_m.pmab038_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab038) RETURNING g_pmaa_m.pmab038_desc
            DISPLAY BY NAME g_pmaa_m.pmab038_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab038
            #add-point:BEFORE FIELD pmab038 name="input.b.pmab038"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab038
            #add-point:ON CHANGE pmab038 name="input.g.pmab038"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab040
            
            #add-point:AFTER FIELD pmab040 name="input.a.pmab040"
            LET g_pmaa_m.pmab040_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab040_desc
            IF NOT cl_null(g_pmaa_m.pmab040) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab040 != g_pmaa_m_t.pmab040 OR g_pmaa_m_t.pmab040 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('263',g_pmaa_m.pmab040) THEN
                     LET g_pmaa_m.pmab040 = g_pmaa_m_t.pmab040
                     CALL apmm801_pmab040_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab090) THEN
                     LET g_pmaa_m.pmab090 = g_pmaa_m.pmab040
                     CALL apmm801_pmab090_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab040_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab040
            #add-point:BEFORE FIELD pmab040 name="input.b.pmab040"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab040
            #add-point:ON CHANGE pmab040 name="input.g.pmab040"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab041
            
            #add-point:AFTER FIELD pmab041 name="input.a.pmab041"
            LET g_pmaa_m.pmab041_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab041_desc
            IF NOT cl_null(g_pmaa_m.pmab041) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab041 != g_pmaa_m_t.pmab041 OR g_pmaa_m_t.pmab041 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab041) THEN
                     LET g_pmaa_m.pmab041 = g_pmaa_m_t.pmab041
                     CALL apmm801_pmab041_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab091) THEN
                     LET g_pmaa_m.pmab091 = g_pmaa_m.pmab041
                     CALL apmm801_pmab091_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab041_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab041
            #add-point:BEFORE FIELD pmab041 name="input.b.pmab041"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab041
            #add-point:ON CHANGE pmab041 name="input.g.pmab041"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab042
            
            #add-point:AFTER FIELD pmab042 name="input.a.pmab042"
            LET g_pmaa_m.pmab042_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab042_desc
            IF NOT cl_null(g_pmaa_m.pmab042) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab042 != g_pmaa_m_t.pmab042 OR g_pmaa_m_t.pmab042 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab042) THEN
                     LET g_pmaa_m.pmab042 = g_pmaa_m_t.pmab042
                     CALL apmm801_pmab042_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab092) THEN
                     LET g_pmaa_m.pmab092 = g_pmaa_m.pmab042
                     CALL apmm801_pmab092_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab042_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab042
            #add-point:BEFORE FIELD pmab042 name="input.b.pmab042"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab042
            #add-point:ON CHANGE pmab042 name="input.g.pmab042"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab043
            
            #add-point:AFTER FIELD pmab043 name="input.a.pmab043"
            LET g_pmaa_m.pmab043_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab043_desc
            IF NOT cl_null(g_pmaa_m.pmab043) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab043 != g_pmaa_m_t.pmab043 OR g_pmaa_m_t.pmab043 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab043) THEN
                     LET g_pmaa_m.pmab043 = g_pmaa_m_t.pmab043
                     CALL apmm801_pmab043_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab093) THEN
                     LET g_pmaa_m.pmab093 = g_pmaa_m.pmab043
                     CALL apmm801_pmab093_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab043_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab043
            #add-point:BEFORE FIELD pmab043 name="input.b.pmab043"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab043
            #add-point:ON CHANGE pmab043 name="input.g.pmab043"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab044
            #add-point:BEFORE FIELD pmab044 name="input.b.pmab044"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab044
            
            #add-point:AFTER FIELD pmab044 name="input.a.pmab044"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab044) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab044 != g_pmaa_m_t.pmab044 OR g_pmaa_m_t.pmab044 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab094) THEN
                     LET g_pmaa_m.pmab094 = g_pmaa_m.pmab044
                                          
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab044
            #add-point:ON CHANGE pmab044 name="input.g.pmab044"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab045
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmab045,"0","1","100","1","azz-00087",1) THEN
               NEXT FIELD pmab045
            END IF 
 
 
 
            #add-point:AFTER FIELD pmab045 name="input.a.pmab045"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab045) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab045 != g_pmaa_m_t.pmab045 OR g_pmaa_m_t.pmab045 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab095) THEN
                     LET g_pmaa_m.pmab095 = g_pmaa_m.pmab045
                                          
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab045
            #add-point:BEFORE FIELD pmab045 name="input.b.pmab045"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab045
            #add-point:ON CHANGE pmab045 name="input.g.pmab045"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab046
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmab046,"0","1","100","1","azz-00087",1) THEN
               NEXT FIELD pmab046
            END IF 
 
 
 
            #add-point:AFTER FIELD pmab046 name="input.a.pmab046"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab046) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab046 != g_pmaa_m_t.pmab046 OR g_pmaa_m_t.pmab046 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab096) THEN
                     LET g_pmaa_m.pmab096 = g_pmaa_m.pmab046 
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab046
            #add-point:BEFORE FIELD pmab046 name="input.b.pmab046"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab046
            #add-point:ON CHANGE pmab046 name="input.g.pmab046"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab047
            
            #add-point:AFTER FIELD pmab047 name="input.a.pmab047"
            LET g_pmaa_m.pmab047_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab047_desc
            IF NOT cl_null(g_pmaa_m.pmab047) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab047 != g_pmaa_m_t.pmab047 OR g_pmaa_m_t.pmab047 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmab047
                  IF NOT cl_chk_exist("v_pmaa001_1") THEN
                     LET g_pmaa_m.pmab047 = g_pmaa_m_t.pmab047
                     CALL apmm801_pmab047_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab097) THEN
                     LET g_pmaa_m.pmab097 = g_pmaa_m.pmab047
                     CALL apmm801_pmab097_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab047_ref()

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab047
            #add-point:BEFORE FIELD pmab047 name="input.b.pmab047"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab047
            #add-point:ON CHANGE pmab047 name="input.g.pmab047"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab048
            #add-point:BEFORE FIELD pmab048 name="input.b.pmab048"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab048
            
            #add-point:AFTER FIELD pmab048 name="input.a.pmab048"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab048) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab048 != g_pmaa_m_t.pmab048 OR g_pmaa_m_t.pmab048 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab098) THEN
                     LET g_pmaa_m.pmab098 = g_pmaa_m.pmab048
                                        
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab048
            #add-point:ON CHANGE pmab048 name="input.g.pmab048"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab049
            #add-point:BEFORE FIELD pmab049 name="input.b.pmab049"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab049
            
            #add-point:AFTER FIELD pmab049 name="input.a.pmab049"
 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab049
            #add-point:ON CHANGE pmab049 name="input.g.pmab049"
            IF g_pmaa_m.pmab049 = 'Y' THEN
               LET g_pmaa_m.l_pmab050 = g_pmaa_m_t.l_pmab050
            ELSE
               LET g_pmaa_m.l_pmab050 = ''               
            END IF
            DISPLAY BY NAME g_pmaa_m.l_pmab050
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab050
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.l_pmab050,"0","1","9999","1","azz-00087",1) THEN
               NEXT FIELD l_pmab050
            END IF 
 
 
 
            #add-point:AFTER FIELD l_pmab050 name="input.a.l_pmab050"
            IF NOT cl_null(g_pmaa_m.l_pmab050) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab050
            #add-point:BEFORE FIELD l_pmab050 name="input.b.l_pmab050"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE l_pmab050
            #add-point:ON CHANGE l_pmab050 name="input.g.l_pmab050"
 
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab051
            #add-point:BEFORE FIELD pmab051 name="input.b.pmab051"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab051
            
            #add-point:AFTER FIELD pmab051 name="input.a.pmab051"
 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab051
            #add-point:ON CHANGE pmab051 name="input.g.pmab051"
            IF g_pmaa_m.pmab051 = 'Y' THEN
               LET g_pmaa_m.l_pmab052 = g_pmaa_m_t.l_pmab052
            ELSE
               LET g_pmaa_m.l_pmab052 = ''               
            END IF
            DISPLAY BY NAME g_pmaa_m.l_pmab052
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab052
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.l_pmab052,"0","1","9999","1","azz-00087",1) THEN
               NEXT FIELD l_pmab052
            END IF 
 
 
 
            #add-point:AFTER FIELD l_pmab052 name="input.a.l_pmab052"
            IF NOT cl_null(g_pmaa_m.l_pmab052) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab052
            #add-point:BEFORE FIELD l_pmab052 name="input.b.l_pmab052"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE l_pmab052
            #add-point:ON CHANGE l_pmab052 name="input.g.l_pmab052"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab080
            #add-point:BEFORE FIELD pmab080 name="input.b.pmab080"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab080
            
            #add-point:AFTER FIELD pmab080 name="input.a.pmab080"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab080
            #add-point:ON CHANGE pmab080 name="input.g.pmab080"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab082
            #add-point:BEFORE FIELD pmab082 name="input.b.pmab082"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab082
            
            #add-point:AFTER FIELD pmab082 name="input.a.pmab082"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab082) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab082 != g_pmaa_m_t.pmab082 OR g_pmaa_m_t.pmab082 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab032) THEN
                     LET g_pmaa_m.pmab032 = g_pmaa_m.pmab082 
                     
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab082
            #add-point:ON CHANGE pmab082 name="input.g.pmab082"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab083
            
            #add-point:AFTER FIELD pmab083 name="input.a.pmab083"
            LET g_pmaa_m.pmab083_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab083_desc
            IF NOT cl_null(g_pmaa_m.pmab083) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab083 != g_pmaa_m_t.pmab083 OR g_pmaa_m_t.pmab083 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmab083
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmab083 = g_pmaa_m_t.pmab083
                     CALL apmm801_pmab083_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmab083_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab083
            #add-point:BEFORE FIELD pmab083 name="input.b.pmab083"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab083
            #add-point:ON CHANGE pmab083 name="input.g.pmab083"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab084
            
            #add-point:AFTER FIELD pmab084 name="input.a.pmab084"
            LET g_pmaa_m.pmab084_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab084_desc
            IF NOT cl_null(g_pmaa_m.pmab084) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab084 != g_pmaa_m_t.pmab084 OR g_pmaa_m_t.pmab084 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmab084
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="aoo-00223:sub-01302|aooi610|",cl_get_progname("aooi610",g_lang,"2"),"|:EXEPROGaooi610"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_oodb002") THEN
                     LET g_pmaa_m.pmab084 = g_pmaa_m_t.pmab084
                     CALL apmm801_pmab084_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab034) THEN
                     LET g_pmaa_m.pmab034 = g_pmaa_m.pmab084
                     CALL apmm801_pmab034_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab084_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab084
            #add-point:BEFORE FIELD pmab084 name="input.b.pmab084"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab084
            #add-point:ON CHANGE pmab084 name="input.g.pmab084"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab103
            
            #add-point:AFTER FIELD pmab103 name="input.a.pmab103"
            LET g_pmaa_m.pmab103_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab103_desc
            IF NOT cl_null(g_pmaa_m.pmab103) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab103 != g_pmaa_m_t.pmab103 OR g_pmaa_m_t.pmab103 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('238',g_pmaa_m.pmab103) THEN
                     LET g_pmaa_m.pmab103 = g_pmaa_m_t.pmab103
                     CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab103) RETURNING g_pmaa_m.pmab103_desc
                     DISPLAY BY NAME g_pmaa_m.pmab103_desc
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab053) THEN
                     LET g_pmaa_m.pmab053 = g_pmaa_m.pmab103 
                     CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab053) RETURNING g_pmaa_m.pmab053_desc
                     DISPLAY BY NAME g_pmaa_m.pmab053_desc
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab103) RETURNING g_pmaa_m.pmab103_desc
            DISPLAY BY NAME g_pmaa_m.pmab103_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab103
            #add-point:BEFORE FIELD pmab103 name="input.b.pmab103"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab103
            #add-point:ON CHANGE pmab103 name="input.g.pmab103"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab104
            
            #add-point:AFTER FIELD pmab104 name="input.a.pmab104"
            #160810-00008#1 160819 by lori add---(S)
            LET g_pmaa_m.pmab104_desc = ''
            DISPLAY BY NAME g_pmaa_m.pmab104_desc
            
            IF NOT cl_null(g_pmaa_m.pmab104) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab104 != g_pmaa_m_t.pmab104 OR g_pmaa_m_t.pmab104 IS NULL)) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmab104
                  LET g_chkparam.err_str[1] = "axm-00026:sub-01302|axmi130|",cl_get_progname("axmi130",g_lang,"2"),"|:EXEPROGaxmi130"
                  IF NOT cl_chk_exist("v_xmah001") THEN
                     LET g_pmaa_m.pmab104 = g_pmaa_m_t.pmab104
                     LET g_pmaa_m.pmab104_desc = apmm801_pmab104_ref(g_pmaa_m.pmab104)
                     DISPLAY BY NAME g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF   
            END IF

            LET g_pmaa_m.pmab104_desc = apmm801_pmab104_ref(g_pmaa_m.pmab104)
            DISPLAY BY NAME g_pmaa_m.pmab104_desc            
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab104
            #add-point:BEFORE FIELD pmab104 name="input.b.pmab104"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab104
            #add-point:ON CHANGE pmab104 name="input.g.pmab104"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab085
            #add-point:BEFORE FIELD pmab085 name="input.b.pmab085"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab085
            
            #add-point:AFTER FIELD pmab085 name="input.a.pmab085"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab085) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab085 != g_pmaa_m_t.pmab085 OR g_pmaa_m_t.pmab085 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab035) THEN
                     LET g_pmaa_m.pmab035 = g_pmaa_m.pmab085 
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab085
            #add-point:ON CHANGE pmab085 name="input.g.pmab085"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab106
            
            #add-point:AFTER FIELD pmab106 name="input.a.pmab106"
            #160810-00008#1 160819 by lori add---(S)
            LET g_pmaa_m.pmab106_desc = ''
            DISPLAY BY NAME g_pmaa_m.pmab106_desc
            IF NOT cl_null(g_pmaa_m.pmab106) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab106 != g_pmaa_m_t.pmab106 OR g_pmaa_m_t.pmab106 IS NULL)) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_ooef019
                  LET g_chkparam.arg2 = g_pmaa_m.pmab106
                  #IF NOT cl_chk_exist("v_isac002_1") THEN
                  IF NOT cl_chk_exist("v_isac002") THEN
                     LET g_pmaa_m.pmab106 = g_pmaa_m_t.pmab106
                     LET g_pmaa_m.pmab106_desc = apmm801_pmab106_ref(g_pmaa_m.pmab106)
                     DISPLAY BY NAME g_pmaa_m.pmab106,g_pmaa_m.pmab106_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF 
            
            LET g_pmaa_m.pmab106_desc = apmm801_pmab106_ref(g_pmaa_m.pmab106)
            DISPLAY BY NAME g_pmaa_m.pmab106_desc              
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab106
            #add-point:BEFORE FIELD pmab106 name="input.b.pmab106"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab106
            #add-point:ON CHANGE pmab106 name="input.g.pmab106"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab087
            
            #add-point:AFTER FIELD pmab087 name="input.a.pmab087"
            LET g_pmaa_m.pmab087_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab087_desc
            IF NOT cl_null(g_pmaa_m.pmab087) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab087 != g_pmaa_m_t.pmab087 OR g_pmaa_m_t.pmab087 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmab087
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="apm-00184:sub-01302|aooi714|",cl_get_progname("aooi714",g_lang,"2"),"|:EXEPROGaooi714"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooib002_1") THEN
                     LET g_pmaa_m.pmab087 = g_pmaa_m_t.pmab087
                     CALL apmm801_pmab087_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmab087_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab087
            #add-point:BEFORE FIELD pmab087 name="input.b.pmab087"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab087
            #add-point:ON CHANGE pmab087 name="input.g.pmab087"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab105
            
            #add-point:AFTER FIELD pmab105 name="input.a.pmab105"
            CALL apmm801_pmab105_ref()
            
            IF  NOT cl_null(g_pmaa_m.pmab105) THEN 
              IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmab105 != g_pmaa_m_t.pmab105 OR cl_null(g_pmaa_m_t.pmab105))) THEN 
                  IF NOT ap_chk_isExist(g_pmaa_m.pmab105,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '3111' AND oocq002 = ? ","sub-01303","axri010") THEN  #apm-00181 #160318-00005#35  By 07900 --mod
                     LET g_pmaa_m.pmab105 = g_pmaa_m_t.pmab105
                     CALL apmm801_pmab105_ref()
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT ap_chk_isExist(g_pmaa_m.pmab105,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '3111' AND oocq002 = ? AND oocqstus = 'Y' ","sub-01302","axri010" ) THEN  #apm-00182 #160318-00005#35  By 07900 --mod
                     LET g_pmaa_m.pmab105 = g_pmaa_m_t.pmab105
                     CALL apmm801_pmab105_ref()
                     NEXT FIELD CURRENT
                  END IF
              END IF
            END IF
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab105
            #add-point:BEFORE FIELD pmab105 name="input.b.pmab105"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab105
            #add-point:ON CHANGE pmab105 name="input.g.pmab105"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab088
            
            #add-point:AFTER FIELD pmab088 name="input.a.pmab088"
            IF NOT cl_null(g_pmaa_m.pmab088) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab088 != g_pmaa_m_t.pmab088 OR g_pmaa_m_t.pmab088 IS NULL )) THEN
                  #此段落由子樣板a19產生
                  #校驗代值
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmaa_m.pmab088
                  LET g_chkparam.arg2 = '1'
                     
                  #呼叫檢查存在並帶值的library
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     #檢查失敗時後續處理
                     LET g_pmaa_m.pmab088 = g_pmaa_m_t.pmab088
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab088) RETURNING g_pmaa_m.pmab088_desc
                     DISPLAY BY NAME g_pmaa_m.pmab088_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab088) RETURNING g_pmaa_m.pmab088_desc
            DISPLAY BY NAME g_pmaa_m.pmab088_desc

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab088
            #add-point:BEFORE FIELD pmab088 name="input.b.pmab088"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab088
            #add-point:ON CHANGE pmab088 name="input.g.pmab088"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab089
            
            #add-point:AFTER FIELD pmab089 name="input.a.pmab089"
             LET g_pmaa_m.pmab089_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab089_desc
            IF NOT cl_null(g_pmaa_m.pmab089) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab089 != g_pmaa_m_t.pmab089 OR g_pmaa_m_t.pmab089 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('295',g_pmaa_m.pmab089) THEN
                     LET g_pmaa_m.pmab089 = g_pmaa_m_t.pmab089
                     CALL apmm801_pmab089_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmab089_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab089
            #add-point:BEFORE FIELD pmab089 name="input.b.pmab089"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab089
            #add-point:ON CHANGE pmab089 name="input.g.pmab089"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab107
            #add-point:BEFORE FIELD pmab107 name="input.b.pmab107"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab107
            
            #add-point:AFTER FIELD pmab107 name="input.a.pmab107"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab107
            #add-point:ON CHANGE pmab107 name="input.g.pmab107"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab108
            #add-point:BEFORE FIELD pmab108 name="input.b.pmab108"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab108
            
            #add-point:AFTER FIELD pmab108 name="input.a.pmab108"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab108) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab108 != g_pmaa_m_t.pmab108 OR g_pmaa_m_t.pmab108 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab058) THEN
                     LET g_pmaa_m.pmab058 = g_pmaa_m.pmab108 
                     
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab108
            #add-point:ON CHANGE pmab108 name="input.g.pmab108"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab090
            
            #add-point:AFTER FIELD pmab090 name="input.a.pmab090"
            LET g_pmaa_m.pmab090_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab090_desc
            IF NOT cl_null(g_pmaa_m.pmab090) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab090 != g_pmaa_m_t.pmab090 OR g_pmaa_m_t.pmab090 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('263',g_pmaa_m.pmab090) THEN
                     LET g_pmaa_m.pmab090 = g_pmaa_m_t.pmab090
                     CALL apmm801_pmab090_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab040) THEN
                     LET g_pmaa_m.pmab040 = g_pmaa_m.pmab090
                     CALL apmm801_pmab040_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab090_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab090
            #add-point:BEFORE FIELD pmab090 name="input.b.pmab090"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab090
            #add-point:ON CHANGE pmab090 name="input.g.pmab090"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab091
            
            #add-point:AFTER FIELD pmab091 name="input.a.pmab091"
            LET g_pmaa_m.pmab091_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab091_desc
            IF NOT cl_null(g_pmaa_m.pmab091) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab091 != g_pmaa_m_t.pmab091 OR g_pmaa_m_t.pmab091 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab091) THEN
                     LET g_pmaa_m.pmab091 = g_pmaa_m_t.pmab091
                     CALL apmm801_pmab091_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab041) THEN
                     LET g_pmaa_m.pmab041 = g_pmaa_m.pmab091
                     CALL apmm801_pmab041_ref()                     
                  END IF
               END IF
            END IF
            CALL apmm801_pmab091_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab091
            #add-point:BEFORE FIELD pmab091 name="input.b.pmab091"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab091
            #add-point:ON CHANGE pmab091 name="input.g.pmab091"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab092
            
            #add-point:AFTER FIELD pmab092 name="input.a.pmab092"
            LET g_pmaa_m.pmab092_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab092_desc
            IF NOT cl_null(g_pmaa_m.pmab092) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab092 != g_pmaa_m_t.pmab092 OR g_pmaa_m_t.pmab092 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab092) THEN
                     LET g_pmaa_m.pmab092 = g_pmaa_m_t.pmab092
                     CALL apmm801_pmab092_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab042) THEN
                     LET g_pmaa_m.pmab042 = g_pmaa_m.pmab092 
                     CALL apmm801_pmab042_ref()
                  END IF
               END IF
            END IF
            CALL apmm801_pmab092_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab092
            #add-point:BEFORE FIELD pmab092 name="input.b.pmab092"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab092
            #add-point:ON CHANGE pmab092 name="input.g.pmab092"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab093
            
            #add-point:AFTER FIELD pmab093 name="input.a.pmab093"
            LET g_pmaa_m.pmab093_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab093_desc
            IF NOT cl_null(g_pmaa_m.pmab093) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab093 != g_pmaa_m_t.pmab093 OR g_pmaa_m_t.pmab093 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('262',g_pmaa_m.pmab093) THEN
                     LET g_pmaa_m.pmab093 = g_pmaa_m_t.pmab093
                     CALL apmm801_pmab093_ref()
                     NEXT FIELD CURRENT
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab043) THEN
                     LET g_pmaa_m.pmab043 = g_pmaa_m.pmab093 
                     CALL apmm801_pmab043_ref()
                  END IF
               END IF
            END IF
            CALL apmm801_pmab093_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab093
            #add-point:BEFORE FIELD pmab093 name="input.b.pmab093"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab093
            #add-point:ON CHANGE pmab093 name="input.g.pmab093"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab094
            #add-point:BEFORE FIELD pmab094 name="input.b.pmab094"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab094
            
            #add-point:AFTER FIELD pmab094 name="input.a.pmab094"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab094) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab094 != g_pmaa_m_t.pmab094 OR g_pmaa_m_t.pmab094 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab044) THEN
                     LET g_pmaa_m.pmab044 = g_pmaa_m.pmab094 
                     
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab094
            #add-point:ON CHANGE pmab094 name="input.g.pmab094"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab095
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmab095,"0","1","100","1","azz-00087",1) THEN
               NEXT FIELD pmab095
            END IF 
 
 
 
            #add-point:AFTER FIELD pmab095 name="input.a.pmab095"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab095) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab095 != g_pmaa_m_t.pmab095 OR g_pmaa_m_t.pmab095 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab045) THEN
                     LET g_pmaa_m.pmab045 = g_pmaa_m.pmab095 
                   
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab095
            #add-point:BEFORE FIELD pmab095 name="input.b.pmab095"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab095
            #add-point:ON CHANGE pmab095 name="input.g.pmab095"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab096
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmab096,"0","1","100","1","azz-00087",1) THEN
               NEXT FIELD pmab096
            END IF 
 
 
 
            #add-point:AFTER FIELD pmab096 name="input.a.pmab096"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab096) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab096 != g_pmaa_m_t.pmab096 OR g_pmaa_m_t.pmab096 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab046) THEN
                     LET g_pmaa_m.pmab046 = g_pmaa_m.pmab096 
                     
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab096
            #add-point:BEFORE FIELD pmab096 name="input.b.pmab096"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab096
            #add-point:ON CHANGE pmab096 name="input.g.pmab096"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab097
            
            #add-point:AFTER FIELD pmab097 name="input.a.pmab097"
            LET g_pmaa_m.pmab097_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmab097_desc
            IF NOT cl_null(g_pmaa_m.pmab097) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab097 != g_pmaa_m_t.pmab097 OR g_pmaa_m_t.pmab097 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmab097
                  IF NOT cl_chk_exist("v_pmaa001_1") THEN
                     LET g_pmaa_m.pmab097 = g_pmaa_m_t.pmab097
                     CALL apmm801_pmab097_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  #160512-00003#11
                  IF cl_null(g_pmaa_m.pmab047) THEN
                     LET g_pmaa_m.pmab047 = g_pmaa_m.pmab097 
                     CALL apmm801_pmab047_ref()
                  END IF
               END IF
            END IF
            CALL apmm801_pmab097_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab097
            #add-point:BEFORE FIELD pmab097 name="input.b.pmab097"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab097
            #add-point:ON CHANGE pmab097 name="input.g.pmab097"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab098
            #add-point:BEFORE FIELD pmab098 name="input.b.pmab098"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab098
            
            #add-point:AFTER FIELD pmab098 name="input.a.pmab098"
            #160512-00003#11
            IF NOT cl_null(g_pmaa_m.pmab098) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmab098 != g_pmaa_m_t.pmab098 OR g_pmaa_m_t.pmab098 IS NULL )) THEN
                  IF cl_null(g_pmaa_m.pmab048) THEN
                     LET g_pmaa_m.pmab048 = g_pmaa_m.pmab098 
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab098
            #add-point:ON CHANGE pmab098 name="input.g.pmab098"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab099
            #add-point:BEFORE FIELD pmab099 name="input.b.pmab099"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab099
            
            #add-point:AFTER FIELD pmab099 name="input.a.pmab099"
 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab099
            #add-point:ON CHANGE pmab099 name="input.g.pmab099"
            IF g_pmaa_m.pmab099 = 'Y' THEN
               LET g_pmaa_m.l_pmab100 = g_pmaa_m_t.l_pmab100
            ELSE
               LET g_pmaa_m.l_pmab100 = ''               
            END IF
            DISPLAY BY NAME g_pmaa_m.l_pmab100
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab100
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.l_pmab100,"0","1","9999","1","azz-00087",1) THEN
               NEXT FIELD l_pmab100
            END IF 
 
 
 
            #add-point:AFTER FIELD l_pmab100 name="input.a.l_pmab100"
            IF NOT cl_null(g_pmaa_m.l_pmab100) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab100
            #add-point:BEFORE FIELD l_pmab100 name="input.b.l_pmab100"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE l_pmab100
            #add-point:ON CHANGE l_pmab100 name="input.g.l_pmab100"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmab101
            #add-point:BEFORE FIELD pmab101 name="input.b.pmab101"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmab101
            
            #add-point:AFTER FIELD pmab101 name="input.a.pmab101"
 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmab101
            #add-point:ON CHANGE pmab101 name="input.g.pmab101"
            IF g_pmaa_m.pmab101 = 'Y' THEN
               LET g_pmaa_m.l_pmab102 = g_pmaa_m_t.l_pmab102
            ELSE
               LET g_pmaa_m.l_pmab102 = ''               
            END IF
            DISPLAY BY NAME g_pmaa_m.l_pmab102
            CALL apmm801_set_entry(p_cmd)
            CALL apmm801_set_no_entry(p_cmd)
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD l_pmab102
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.l_pmab102,"0","1","9999","1","azz-00087",1) THEN
               NEXT FIELD l_pmab102
            END IF 
 
 
 
            #add-point:AFTER FIELD l_pmab102 name="input.a.l_pmab102"
            IF NOT cl_null(g_pmaa_m.l_pmab102) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD l_pmab102
            #add-point:BEFORE FIELD l_pmab102 name="input.b.l_pmab102"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE l_pmab102
            #add-point:ON CHANGE l_pmab102 name="input.g.l_pmab102"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013 name="input.b.ooff013"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD ooff013
            
            #add-point:AFTER FIELD ooff013 name="input.a.ooff013"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE ooff013
            #add-point:ON CHANGE ooff013 name="input.g.ooff013"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa270
            #add-point:BEFORE FIELD pmaa270 name="input.b.pmaa270"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa270
            
            #add-point:AFTER FIELD pmaa270 name="input.a.pmaa270"
                                                                                    
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa270
            #add-point:ON CHANGE pmaa270 name="input.g.pmaa270"
            CALL apmm801_pmaa270_visible()
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa271
            #add-point:BEFORE FIELD pmaa271 name="input.b.pmaa271"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa271
            
            #add-point:AFTER FIELD pmaa271 name="input.a.pmaa271"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa271
            #add-point:ON CHANGE pmaa271 name="input.g.pmaa271"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa272
            #add-point:BEFORE FIELD pmaa272 name="input.b.pmaa272"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa272
            
            #add-point:AFTER FIELD pmaa272 name="input.a.pmaa272"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa272
            #add-point:ON CHANGE pmaa272 name="input.g.pmaa272"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day01
            #add-point:BEFORE FIELD day01 name="input.b.day01"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day01
            
            #add-point:AFTER FIELD day01 name="input.a.day01"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day01
            #add-point:ON CHANGE day01 name="input.g.day01"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day02
            #add-point:BEFORE FIELD day02 name="input.b.day02"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day02
            
            #add-point:AFTER FIELD day02 name="input.a.day02"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day02
            #add-point:ON CHANGE day02 name="input.g.day02"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day03
            #add-point:BEFORE FIELD day03 name="input.b.day03"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day03
            
            #add-point:AFTER FIELD day03 name="input.a.day03"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day03
            #add-point:ON CHANGE day03 name="input.g.day03"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day04
            #add-point:BEFORE FIELD day04 name="input.b.day04"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day04
            
            #add-point:AFTER FIELD day04 name="input.a.day04"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day04
            #add-point:ON CHANGE day04 name="input.g.day04"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day05
            #add-point:BEFORE FIELD day05 name="input.b.day05"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day05
            
            #add-point:AFTER FIELD day05 name="input.a.day05"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day05
            #add-point:ON CHANGE day05 name="input.g.day05"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day06
            #add-point:BEFORE FIELD day06 name="input.b.day06"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day06
            
            #add-point:AFTER FIELD day06 name="input.a.day06"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day06
            #add-point:ON CHANGE day06 name="input.g.day06"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day07
            #add-point:BEFORE FIELD day07 name="input.b.day07"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day07
            
            #add-point:AFTER FIELD day07 name="input.a.day07"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day07
            #add-point:ON CHANGE day07 name="input.g.day07"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day08
            #add-point:BEFORE FIELD day08 name="input.b.day08"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day08
            
            #add-point:AFTER FIELD day08 name="input.a.day08"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day08
            #add-point:ON CHANGE day08 name="input.g.day08"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day09
            #add-point:BEFORE FIELD day09 name="input.b.day09"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day09
            
            #add-point:AFTER FIELD day09 name="input.a.day09"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day09
            #add-point:ON CHANGE day09 name="input.g.day09"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day10
            #add-point:BEFORE FIELD day10 name="input.b.day10"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day10
            
            #add-point:AFTER FIELD day10 name="input.a.day10"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day10
            #add-point:ON CHANGE day10 name="input.g.day10"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day11
            #add-point:BEFORE FIELD day11 name="input.b.day11"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day11
            
            #add-point:AFTER FIELD day11 name="input.a.day11"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day11
            #add-point:ON CHANGE day11 name="input.g.day11"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day12
            #add-point:BEFORE FIELD day12 name="input.b.day12"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day12
            
            #add-point:AFTER FIELD day12 name="input.a.day12"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day12
            #add-point:ON CHANGE day12 name="input.g.day12"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day13
            #add-point:BEFORE FIELD day13 name="input.b.day13"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day13
            
            #add-point:AFTER FIELD day13 name="input.a.day13"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day13
            #add-point:ON CHANGE day13 name="input.g.day13"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day14
            #add-point:BEFORE FIELD day14 name="input.b.day14"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day14
            
            #add-point:AFTER FIELD day14 name="input.a.day14"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day14
            #add-point:ON CHANGE day14 name="input.g.day14"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day15
            #add-point:BEFORE FIELD day15 name="input.b.day15"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day15
            
            #add-point:AFTER FIELD day15 name="input.a.day15"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day15
            #add-point:ON CHANGE day15 name="input.g.day15"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day16
            #add-point:BEFORE FIELD day16 name="input.b.day16"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day16
            
            #add-point:AFTER FIELD day16 name="input.a.day16"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day16
            #add-point:ON CHANGE day16 name="input.g.day16"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day17
            #add-point:BEFORE FIELD day17 name="input.b.day17"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day17
            
            #add-point:AFTER FIELD day17 name="input.a.day17"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day17
            #add-point:ON CHANGE day17 name="input.g.day17"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day18
            #add-point:BEFORE FIELD day18 name="input.b.day18"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day18
            
            #add-point:AFTER FIELD day18 name="input.a.day18"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day18
            #add-point:ON CHANGE day18 name="input.g.day18"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day19
            #add-point:BEFORE FIELD day19 name="input.b.day19"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day19
            
            #add-point:AFTER FIELD day19 name="input.a.day19"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day19
            #add-point:ON CHANGE day19 name="input.g.day19"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day20
            #add-point:BEFORE FIELD day20 name="input.b.day20"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day20
            
            #add-point:AFTER FIELD day20 name="input.a.day20"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day20
            #add-point:ON CHANGE day20 name="input.g.day20"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day21
            #add-point:BEFORE FIELD day21 name="input.b.day21"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day21
            
            #add-point:AFTER FIELD day21 name="input.a.day21"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day21
            #add-point:ON CHANGE day21 name="input.g.day21"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day22
            #add-point:BEFORE FIELD day22 name="input.b.day22"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day22
            
            #add-point:AFTER FIELD day22 name="input.a.day22"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day22
            #add-point:ON CHANGE day22 name="input.g.day22"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day23
            #add-point:BEFORE FIELD day23 name="input.b.day23"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day23
            
            #add-point:AFTER FIELD day23 name="input.a.day23"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day23
            #add-point:ON CHANGE day23 name="input.g.day23"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day24
            #add-point:BEFORE FIELD day24 name="input.b.day24"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day24
            
            #add-point:AFTER FIELD day24 name="input.a.day24"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day24
            #add-point:ON CHANGE day24 name="input.g.day24"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day25
            #add-point:BEFORE FIELD day25 name="input.b.day25"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day25
            
            #add-point:AFTER FIELD day25 name="input.a.day25"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day25
            #add-point:ON CHANGE day25 name="input.g.day25"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day26
            #add-point:BEFORE FIELD day26 name="input.b.day26"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day26
            
            #add-point:AFTER FIELD day26 name="input.a.day26"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day26
            #add-point:ON CHANGE day26 name="input.g.day26"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day27
            #add-point:BEFORE FIELD day27 name="input.b.day27"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day27
            
            #add-point:AFTER FIELD day27 name="input.a.day27"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day27
            #add-point:ON CHANGE day27 name="input.g.day27"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day28
            #add-point:BEFORE FIELD day28 name="input.b.day28"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day28
            
            #add-point:AFTER FIELD day28 name="input.a.day28"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day28
            #add-point:ON CHANGE day28 name="input.g.day28"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day29
            #add-point:BEFORE FIELD day29 name="input.b.day29"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day29
            
            #add-point:AFTER FIELD day29 name="input.a.day29"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day29
            #add-point:ON CHANGE day29 name="input.g.day29"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day30
            #add-point:BEFORE FIELD day30 name="input.b.day30"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day30
            
            #add-point:AFTER FIELD day30 name="input.a.day30"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day30
            #add-point:ON CHANGE day30 name="input.g.day30"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD day31
            #add-point:BEFORE FIELD day31 name="input.b.day31"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD day31
            
            #add-point:AFTER FIELD day31 name="input.a.day31"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE day31
            #add-point:ON CHANGE day31 name="input.g.day31"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week01
            #add-point:BEFORE FIELD week01 name="input.b.week01"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week01
            
            #add-point:AFTER FIELD week01 name="input.a.week01"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week01
            #add-point:ON CHANGE week01 name="input.g.week01"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week02
            #add-point:BEFORE FIELD week02 name="input.b.week02"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week02
            
            #add-point:AFTER FIELD week02 name="input.a.week02"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week02
            #add-point:ON CHANGE week02 name="input.g.week02"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week03
            #add-point:BEFORE FIELD week03 name="input.b.week03"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week03
            
            #add-point:AFTER FIELD week03 name="input.a.week03"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week03
            #add-point:ON CHANGE week03 name="input.g.week03"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week04
            #add-point:BEFORE FIELD week04 name="input.b.week04"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week04
            
            #add-point:AFTER FIELD week04 name="input.a.week04"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week04
            #add-point:ON CHANGE week04 name="input.g.week04"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week05
            #add-point:BEFORE FIELD week05 name="input.b.week05"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week05
            
            #add-point:AFTER FIELD week05 name="input.a.week05"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week05
            #add-point:ON CHANGE week05 name="input.g.week05"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week06
            #add-point:BEFORE FIELD week06 name="input.b.week06"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week06
            
            #add-point:AFTER FIELD week06 name="input.a.week06"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week06
            #add-point:ON CHANGE week06 name="input.g.week06"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD week07
            #add-point:BEFORE FIELD week07 name="input.b.week07"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD week07
            
            #add-point:AFTER FIELD week07 name="input.a.week07"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE week07
            #add-point:ON CHANGE week07 name="input.g.week07"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa274
            
            #add-point:AFTER FIELD pmaa274 name="input.a.pmaa274"
                                                                                    LET g_pmaa_m.pmaa274_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa274_desc
            IF NOT cl_null(g_pmaa_m.pmaa274) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa274 != g_pmaa_m_t.pmaa274 OR g_pmaa_m_t.pmaa274 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('274',g_pmaa_m.pmaa274) THEN
                     LET g_pmaa_m.pmaa274 = g_pmaa_m_t.pmaa274
                     CALL apmm801_pmaa274_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa274_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa274
            #add-point:BEFORE FIELD pmaa274 name="input.b.pmaa274"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa274
            #add-point:ON CHANGE pmaa274 name="input.g.pmaa274"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa275
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa275,"0","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa275
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa275 name="input.a.pmaa275"
            IF NOT cl_null(g_pmaa_m.pmaa275) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa275
            #add-point:BEFORE FIELD pmaa275 name="input.b.pmaa275"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa275
            #add-point:ON CHANGE pmaa275 name="input.g.pmaa275"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa276
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmaa_m.pmaa276,"0","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa276
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaa276 name="input.a.pmaa276"
            IF NOT cl_null(g_pmaa_m.pmaa276) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa276
            #add-point:BEFORE FIELD pmaa276 name="input.b.pmaa276"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa276
            #add-point:ON CHANGE pmaa276 name="input.g.pmaa276"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa281
            
            #add-point:AFTER FIELD pmaa281 name="input.a.pmaa281"
             
            LET g_pmaa_m.pmaa281_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa281_desc
            IF NOT cl_null(g_pmaa_m.pmaa281) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa281 != g_pmaa_m_t.pmaa281 OR g_pmaa_m_t.pmaa281 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2037',g_pmaa_m.pmaa281) THEN
                     LET g_pmaa_m.pmaa281 = g_pmaa_m_t.pmaa281
                     CALL apmm801_pmaa281_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa281_ref()                                                    
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa281
            #add-point:BEFORE FIELD pmaa281 name="input.b.pmaa281"
 
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa281
            #add-point:ON CHANGE pmaa281 name="input.g.pmaa281"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa282
            
            #add-point:AFTER FIELD pmaa282 name="input.a.pmaa282"
                                                                                    LET g_pmaa_m.pmaa282_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa282_desc
            IF NOT cl_null(g_pmaa_m.pmaa282) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa282 != g_pmaa_m_t.pmaa282 OR g_pmaa_m_t.pmaa282 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2038',g_pmaa_m.pmaa282) THEN
                     LET g_pmaa_m.pmaa282 = g_pmaa_m_t.pmaa282
                     CALL apmm801_pmaa282_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa282_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa282
            #add-point:BEFORE FIELD pmaa282 name="input.b.pmaa282"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa282
            #add-point:ON CHANGE pmaa282 name="input.g.pmaa282"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa283
            
            #add-point:AFTER FIELD pmaa283 name="input.a.pmaa283"
                                                                                    LET g_pmaa_m.pmaa283_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa283_desc
            IF NOT cl_null(g_pmaa_m.pmaa283) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa283 != g_pmaa_m_t.pmaa283 OR g_pmaa_m_t.pmaa283 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2039',g_pmaa_m.pmaa283) THEN
                     LET g_pmaa_m.pmaa283 = g_pmaa_m_t.pmaa283
                     CALL apmm801_pmaa283_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa283_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa283
            #add-point:BEFORE FIELD pmaa283 name="input.b.pmaa283"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa283
            #add-point:ON CHANGE pmaa283 name="input.g.pmaa283"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa284
            
            #add-point:AFTER FIELD pmaa284 name="input.a.pmaa284"
                                                                                    LET g_pmaa_m.pmaa284_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa284_desc
            IF NOT cl_null(g_pmaa_m.pmaa284) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa284 != g_pmaa_m_t.pmaa284 OR g_pmaa_m_t.pmaa284 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2040',g_pmaa_m.pmaa284) THEN
                     LET g_pmaa_m.pmaa284 = g_pmaa_m_t.pmaa284
                     CALL apmm801_pmaa284_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa284_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa284
            #add-point:BEFORE FIELD pmaa284 name="input.b.pmaa284"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa284
            #add-point:ON CHANGE pmaa284 name="input.g.pmaa284"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa285
            
            #add-point:AFTER FIELD pmaa285 name="input.a.pmaa285"
            LET g_pmaa_m.pmaa285_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa285_desc
            IF NOT cl_null(g_pmaa_m.pmaa285) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa285 != g_pmaa_m_t.pmaa285 OR g_pmaa_m_t.pmaa285 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2041',g_pmaa_m.pmaa285) THEN
                     LET g_pmaa_m.pmaa285 = g_pmaa_m_t.pmaa285
                     CALL apmm801_pmaa285_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa285_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa285
            #add-point:BEFORE FIELD pmaa285 name="input.b.pmaa285"
 
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa285
            #add-point:ON CHANGE pmaa285 name="input.g.pmaa285"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa286
            
            #add-point:AFTER FIELD pmaa286 name="input.a.pmaa286"
                                                                                    LET g_pmaa_m.pmaa286_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa286_desc
            IF NOT cl_null(g_pmaa_m.pmaa286) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa286 != g_pmaa_m_t.pmaa286 OR g_pmaa_m_t.pmaa286 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2042',g_pmaa_m.pmaa286) THEN
                     LET g_pmaa_m.pmaa286 = g_pmaa_m_t.pmaa286
                     CALL apmm801_pmaa286_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa286_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa286
            #add-point:BEFORE FIELD pmaa286 name="input.b.pmaa286"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa286
            #add-point:ON CHANGE pmaa286 name="input.g.pmaa286"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa287
            
            #add-point:AFTER FIELD pmaa287 name="input.a.pmaa287"
                                                                                    LET g_pmaa_m.pmaa287_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa287_desc
            IF NOT cl_null(g_pmaa_m.pmaa287) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa287 != g_pmaa_m_t.pmaa287 OR g_pmaa_m_t.pmaa287 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2043',g_pmaa_m.pmaa287) THEN
                     LET g_pmaa_m.pmaa287 = g_pmaa_m_t.pmaa287
                     CALL apmm801_pmaa287_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa287_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa287
            #add-point:BEFORE FIELD pmaa287 name="input.b.pmaa287"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa287
            #add-point:ON CHANGE pmaa287 name="input.g.pmaa287"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa288
            
            #add-point:AFTER FIELD pmaa288 name="input.a.pmaa288"
                                                                                    LET g_pmaa_m.pmaa288_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa288_desc
            IF NOT cl_null(g_pmaa_m.pmaa288) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa288 != g_pmaa_m_t.pmaa288 OR g_pmaa_m_t.pmaa288 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2044',g_pmaa_m.pmaa288) THEN
                     LET g_pmaa_m.pmaa288 = g_pmaa_m_t.pmaa288
                     CALL apmm801_pmaa288_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa288_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa288
            #add-point:BEFORE FIELD pmaa288 name="input.b.pmaa288"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa288
            #add-point:ON CHANGE pmaa288 name="input.g.pmaa288"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa289
            
            #add-point:AFTER FIELD pmaa289 name="input.a.pmaa289"
                                                                                    LET g_pmaa_m.pmaa289_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa289_desc
            IF NOT cl_null(g_pmaa_m.pmaa289) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa289 != g_pmaa_m_t.pmaa289 OR g_pmaa_m_t.pmaa289 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2045',g_pmaa_m.pmaa289) THEN
                     LET g_pmaa_m.pmaa289 = g_pmaa_m_t.pmaa289
                     CALL apmm801_pmaa289_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa289_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa289
            #add-point:BEFORE FIELD pmaa289 name="input.b.pmaa289"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa289
            #add-point:ON CHANGE pmaa289 name="input.g.pmaa289"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa290
            
            #add-point:AFTER FIELD pmaa290 name="input.a.pmaa290"
                                                                                    LET g_pmaa_m.pmaa290_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa290_desc
            IF NOT cl_null(g_pmaa_m.pmaa290) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa290 != g_pmaa_m_t.pmaa290 OR g_pmaa_m_t.pmaa290 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2046',g_pmaa_m.pmaa290) THEN
                     LET g_pmaa_m.pmaa290 = g_pmaa_m_t.pmaa290
                     CALL apmm801_pmaa290_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa290_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa290
            #add-point:BEFORE FIELD pmaa290 name="input.b.pmaa290"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa290
            #add-point:ON CHANGE pmaa290 name="input.g.pmaa290"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa291
            
            #add-point:AFTER FIELD pmaa291 name="input.a.pmaa291"
                                                                                    LET g_pmaa_m.pmaa291_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa291_desc
            IF NOT cl_null(g_pmaa_m.pmaa291) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa291 != g_pmaa_m_t.pmaa291 OR g_pmaa_m_t.pmaa291 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2061',g_pmaa_m.pmaa291) THEN
                     LET g_pmaa_m.pmaa291 = g_pmaa_m_t.pmaa291
                     CALL apmm801_pmaa291_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa291_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa291
            #add-point:BEFORE FIELD pmaa291 name="input.b.pmaa291"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa291
            #add-point:ON CHANGE pmaa291 name="input.g.pmaa291"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa292
            
            #add-point:AFTER FIELD pmaa292 name="input.a.pmaa292"
                                                                                    LET g_pmaa_m.pmaa292_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa292_desc
            IF NOT cl_null(g_pmaa_m.pmaa292) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa292 != g_pmaa_m_t.pmaa292 OR g_pmaa_m_t.pmaa292 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2062',g_pmaa_m.pmaa292) THEN
                     LET g_pmaa_m.pmaa292 = g_pmaa_m_t.pmaa292
                     CALL apmm801_pmaa292_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa292_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa292
            #add-point:BEFORE FIELD pmaa292 name="input.b.pmaa292"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa292
            #add-point:ON CHANGE pmaa292 name="input.g.pmaa292"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa293
            
            #add-point:AFTER FIELD pmaa293 name="input.a.pmaa293"
                                                                                    LET g_pmaa_m.pmaa293_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa293_desc
            IF NOT cl_null(g_pmaa_m.pmaa293) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa293 != g_pmaa_m_t.pmaa293 OR g_pmaa_m_t.pmaa293 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2063',g_pmaa_m.pmaa293) THEN
                     LET g_pmaa_m.pmaa293 = g_pmaa_m_t.pmaa293
                     CALL apmm801_pmaa293_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa293_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa293
            #add-point:BEFORE FIELD pmaa293 name="input.b.pmaa293"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa293
            #add-point:ON CHANGE pmaa293 name="input.g.pmaa293"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa294
            
            #add-point:AFTER FIELD pmaa294 name="input.a.pmaa294"
                                                                                    LET g_pmaa_m.pmaa294_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa294_desc
            IF NOT cl_null(g_pmaa_m.pmaa294) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa294 != g_pmaa_m_t.pmaa294 OR g_pmaa_m_t.pmaa294 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2064',g_pmaa_m.pmaa294) THEN
                     LET g_pmaa_m.pmaa294 = g_pmaa_m_t.pmaa294
                     CALL apmm801_pmaa294_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa294_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa294
            #add-point:BEFORE FIELD pmaa294 name="input.b.pmaa294"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa294
            #add-point:ON CHANGE pmaa294 name="input.g.pmaa294"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa295
            
            #add-point:AFTER FIELD pmaa295 name="input.a.pmaa295"
                                                                                    LET g_pmaa_m.pmaa295_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa295_desc
            IF NOT cl_null(g_pmaa_m.pmaa295) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa295 != g_pmaa_m_t.pmaa295 OR g_pmaa_m_t.pmaa295 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2065',g_pmaa_m.pmaa295) THEN
                     LET g_pmaa_m.pmaa295 = g_pmaa_m_t.pmaa295
                     CALL apmm801_pmaa295_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa295_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa295
            #add-point:BEFORE FIELD pmaa295 name="input.b.pmaa295"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa295
            #add-point:ON CHANGE pmaa295 name="input.g.pmaa295"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa296
            
            #add-point:AFTER FIELD pmaa296 name="input.a.pmaa296"
                                                                                    LET g_pmaa_m.pmaa296_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa296_desc
            IF NOT cl_null(g_pmaa_m.pmaa296) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa296 != g_pmaa_m_t.pmaa296 OR g_pmaa_m_t.pmaa296 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2066',g_pmaa_m.pmaa296) THEN
                     LET g_pmaa_m.pmaa296 = g_pmaa_m_t.pmaa296
                     CALL apmm801_pmaa296_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa296_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa296
            #add-point:BEFORE FIELD pmaa296 name="input.b.pmaa296"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa296
            #add-point:ON CHANGE pmaa296 name="input.g.pmaa296"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa297
            
            #add-point:AFTER FIELD pmaa297 name="input.a.pmaa297"
                                                                                    LET g_pmaa_m.pmaa297_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa297_desc
            IF NOT cl_null(g_pmaa_m.pmaa297) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa297 != g_pmaa_m_t.pmaa297 OR g_pmaa_m_t.pmaa297 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2067',g_pmaa_m.pmaa297) THEN
                     LET g_pmaa_m.pmaa297 = g_pmaa_m_t.pmaa297
                     CALL apmm801_pmaa297_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa297_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa297
            #add-point:BEFORE FIELD pmaa297 name="input.b.pmaa297"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa297
            #add-point:ON CHANGE pmaa297 name="input.g.pmaa297"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa298
            
            #add-point:AFTER FIELD pmaa298 name="input.a.pmaa298"
                                                                                    LET g_pmaa_m.pmaa298_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa298_desc
            IF NOT cl_null(g_pmaa_m.pmaa298) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa298 != g_pmaa_m_t.pmaa298 OR g_pmaa_m_t.pmaa298 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2068',g_pmaa_m.pmaa298) THEN
                     LET g_pmaa_m.pmaa298 = g_pmaa_m_t.pmaa298
                     CALL apmm801_pmaa298_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa298_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa298
            #add-point:BEFORE FIELD pmaa298 name="input.b.pmaa298"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa298
            #add-point:ON CHANGE pmaa298 name="input.g.pmaa298"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa299
            
            #add-point:AFTER FIELD pmaa299 name="input.a.pmaa299"
                                                                                    LET g_pmaa_m.pmaa299_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa299_desc
            IF NOT cl_null(g_pmaa_m.pmaa299) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa299 != g_pmaa_m_t.pmaa299 OR g_pmaa_m_t.pmaa299 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2069',g_pmaa_m.pmaa299) THEN
                     LET g_pmaa_m.pmaa299 = g_pmaa_m_t.pmaa299
                     CALL apmm801_pmaa299_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa299_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa299
            #add-point:BEFORE FIELD pmaa299 name="input.b.pmaa299"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa299
            #add-point:ON CHANGE pmaa299 name="input.g.pmaa299"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaa300
            
            #add-point:AFTER FIELD pmaa300 name="input.a.pmaa300"
                                                                                    LET g_pmaa_m.pmaa300_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa300_desc
            IF NOT cl_null(g_pmaa_m.pmaa300) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa300 != g_pmaa_m_t.pmaa300 OR g_pmaa_m_t.pmaa300 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2070',g_pmaa_m.pmaa300) THEN
                     LET g_pmaa_m.pmaa300 = g_pmaa_m_t.pmaa300
                     CALL apmm801_pmaa300_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaa300_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaa300
            #add-point:BEFORE FIELD pmaa300 name="input.b.pmaa300"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaa300
            #add-point:ON CHANGE pmaa300 name="input.g.pmaa300"
                                                                        
            #END add-point 
 
 
 #欄位檢查
                  #Ctrlp:input.c.pmaa001
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa001
            #add-point:ON ACTION controlp INFIELD pmaa001 name="input.c.pmaa001"
 
            #END add-point
 
 
         #Ctrlp:input.c.pmaa002
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa002
            #add-point:ON ACTION controlp INFIELD pmaa002 name="input.c.pmaa002"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa089
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa089
            #add-point:ON ACTION controlp INFIELD pmaa089 name="input.c.pmaa089"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaal004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal004
            #add-point:ON ACTION controlp INFIELD pmaal004 name="input.c.pmaal004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaal003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal003
            #add-point:ON ACTION controlp INFIELD pmaal003 name="input.c.pmaal003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaal006
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal006
            #add-point:ON ACTION controlp INFIELD pmaal006 name="input.c.pmaal006"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaal005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaal005
            #add-point:ON ACTION controlp INFIELD pmaal005 name="input.c.pmaal005"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa003
            #add-point:ON ACTION controlp INFIELD pmaa003 name="input.c.pmaa003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaastus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaastus
            #add-point:ON ACTION controlp INFIELD pmaastus name="input.c.pmaastus"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa004
            #add-point:ON ACTION controlp INFIELD pmaa004 name="input.c.pmaa004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa005
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa005
            #add-point:ON ACTION controlp INFIELD pmaa005 name="input.c.pmaa005"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa005        #給予default值
            LET g_qryparam.arg1 = '1'
            CALL q_pmaa001_14()                                #呼叫開窗
            LET g_pmaa_m.pmaa005 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa005 TO pmaa005               #顯示到畫面上
            CALL apmm801_pmaa005_ref()
            NEXT FIELD pmaa005                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa006
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa006
            #add-point:ON ACTION controlp INFIELD pmaa006 name="input.c.pmaa006"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa006     #給予default值
            LET g_qryparam.arg1 = '261'
            CALL q_oocq002()                             #呼叫開窗
            LET g_pmaa_m.pmaa006 = g_qryparam.return1      #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa006 TO pmaa006            #顯示到畫面上
            CALL apmm801_pmaa006_ref()
            NEXT FIELD pmaa006                             #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa026
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa026
            #add-point:ON ACTION controlp INFIELD pmaa026 name="input.c.pmaa026"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa026      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "250"
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa026 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa026 TO pmaa026             #顯示到畫面上
            CALL apmm801_pmaa026_ref()
            NEXT FIELD pmaa026                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa200
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa200
            #add-point:ON ACTION controlp INFIELD pmaa200 name="input.c.pmaa200"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa201
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa201
            #add-point:ON ACTION controlp INFIELD pmaa201 name="input.c.pmaa201"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa202
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa202
            #add-point:ON ACTION controlp INFIELD pmaa202 name="input.c.pmaa202"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa017
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa017
            #add-point:ON ACTION controlp INFIELD pmaa017 name="input.c.pmaa017"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa016
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa016
            #add-point:ON ACTION controlp INFIELD pmaa016 name="input.c.pmaa016"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa018
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa018
            #add-point:ON ACTION controlp INFIELD pmaa018 name="input.c.pmaa018"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa019
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa019
            #add-point:ON ACTION controlp INFIELD pmaa019 name="input.c.pmaa019"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa019        #給予default值
            #給予arg
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                                #呼叫開窗
            LET g_pmaa_m.pmaa019 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa019 TO pmaa019               #顯示到畫面上
            CALL apmm801_pmaa019_ref()
            NEXT FIELD pmaa019                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa021
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa021
            #add-point:ON ACTION controlp INFIELD pmaa021 name="input.c.pmaa021"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa022
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa022
            #add-point:ON ACTION controlp INFIELD pmaa022 name="input.c.pmaa022"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa022      #給予default值
            #給予arg
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                              #呼叫開窗
            LET g_pmaa_m.pmaa022 = g_qryparam.return1       #將開窗取得的值回傳到變數 
            DISPLAY g_pmaa_m.pmaa022 TO pmaa022             #顯示到畫面上
            CALL apmm801_pmaa022_ref() 
            NEXT FIELD pmaa022                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa020
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa020
            #add-point:ON ACTION controlp INFIELD pmaa020 name="input.c.pmaa020"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa023
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa023
            #add-point:ON ACTION controlp INFIELD pmaa023 name="input.c.pmaa023"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa023      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "254"
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa023 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa023 TO pmaa023             #顯示到畫面上
            CALL apmm801_pmaa023_ref()
            NEXT FIELD pmaa023                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa024
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa024
            #add-point:ON ACTION controlp INFIELD pmaa024 name="input.c.pmaa024"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa024      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "260"
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa024 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa024 TO pmaa024             #顯示到畫面上            
            CALL apmm801_pmaa024_ref()
            NEXT FIELD pmaa024                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa025
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa025
            #add-point:ON ACTION controlp INFIELD pmaa025 name="input.c.pmaa025"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa007
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa007
            #add-point:ON ACTION controlp INFIELD pmaa007 name="input.c.pmaa007"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa007      #給予default值
            #給予arg
            CALL q_oocg001()                                #呼叫開窗
            LET g_pmaa_m.pmaa007 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa007 TO pmaa007             #顯示到畫面上
            CALL apmm801_pmaa007_ref()
            NEXT FIELD pmaa007                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa008
            #add-point:ON ACTION controlp INFIELD pmaa008 name="input.c.pmaa008"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa009
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa009
            #add-point:ON ACTION controlp INFIELD pmaa009 name="input.c.pmaa009"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa009        #給予default值
            #給予arg
            LET g_qryparam.arg1 = '4'
            CALL q_ooal002_0()                                #呼叫開窗
            LET g_pmaa_m.pmaa009 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa009 TO pmaa009               #顯示到畫面上
            CALL apmm801_pmaa009_ref()
            NEXT FIELD pmaa009                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa010
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa010
            #add-point:ON ACTION controlp INFIELD pmaa010 name="input.c.pmaa010"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa011
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa011
            #add-point:ON ACTION controlp INFIELD pmaa011 name="input.c.pmaa011"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa011        #給予default值
            #給予arg
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                                #呼叫開窗
            LET g_pmaa_m.pmaa011 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa011 TO pmaa011               #顯示到畫面上
            CALL apmm801_pmaa011_ref()
            NEXT FIELD pmaa011                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa027
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa027
            #add-point:ON ACTION controlp INFIELD pmaa027 name="input.c.pmaa027"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa230
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa230
            #add-point:ON ACTION controlp INFIELD pmaa230 name="input.c.pmaa230"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa231
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa231
            #add-point:ON ACTION controlp INFIELD pmaa231 name="input.c.pmaa231"
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa231             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa231 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa231 TO pmaa231              #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa231) RETURNING g_pmaa_m.pmaa231_desc
            DISPLAY BY NAME g_pmaa_m.pmaa231_desc
            NEXT FIELD pmaa231                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa232
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa232
            #add-point:ON ACTION controlp INFIELD pmaa232 name="input.c.pmaa232"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa232      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2072" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa232 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa232 TO pmaa232             #顯示到畫面上
            CALL apmm801_pmaa232_ref()
            NEXT FIELD pmaa232                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa090
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa090
            #add-point:ON ACTION controlp INFIELD pmaa090 name="input.c.pmaa090"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa090      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "281" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa090 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa090 TO pmaa090             #顯示到畫面上
            CALL apmm801_pmaa090_ref()
            NEXT FIELD pmaa090                              #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmaa091
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa091
            #add-point:ON ACTION controlp INFIELD pmaa091 name="input.c.pmaa091"
            #應用 a07 樣板自動產生(Version:3)   
            #開窗i段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE 
            LET g_qryparam.default1 = g_pmaa_m.pmaa091 
            LET g_qryparam.arg1 = g_pmaa091_acc
 
            CALL q_oocq002()                            
 
            LET g_pmaa_m.pmaa091 = g_qryparam.return1              
            LET g_pmaa_m.pmaa091_desc = s_desc_get_acc_desc(g_pmaa091_acc,g_pmaa_m.pmaa091)
            DISPLAY g_pmaa_m.pmaa091 TO pmaa091 
            DISPLAY g_pmaa_m.pmaa091_desc TO pmaa091_desc 
            
            NEXT FIELD pmaa091            
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #Ctrlp:input.c.pmaa092
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa092
            #add-point:ON ACTION controlp INFIELD pmaa092 name="input.c.pmaa092"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa094
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa094
            #add-point:ON ACTION controlp INFIELD pmaa094 name="input.c.pmaa094"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa094      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "286" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa094 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa094 TO pmaa094             #顯示到畫面上
             CALL apmm801_pmaa094_ref()
            NEXT FIELD pmaa094                              #返回原欄位 

            #END add-point
 
 
         #Ctrlp:input.c.pmaa093
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa093
            #add-point:ON ACTION controlp INFIELD pmaa093 name="input.c.pmaa093"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa093      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "285" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa093 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa093 TO pmaa093             #顯示到畫面上
            CALL apmm801_pmaa093_ref()
            NEXT FIELD pmaa093                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa096
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa096
            #add-point:ON ACTION controlp INFIELD pmaa096 name="input.c.pmaa096"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa096     #給予default值
            #給予arg
            CALL q_ooag001_4()                             #呼叫開窗
            LET g_pmaa_m.pmaa096 = g_qryparam.return1      #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa096 TO pmaa096            #顯示到畫面上
            CALL apmm801_pmaa096_ref()
            NEXT FIELD pmaa096                             #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa097
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa097
            #add-point:ON ACTION controlp INFIELD pmaa097 name="input.c.pmaa097"
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa097
            LET g_qryparam.arg1 = g_today
            
            CALL q_ooeg001()                            
            
            LET g_pmaa_m.pmaa097 = g_qryparam.return1              
            LET g_pmaa_m.pmaa097_desc = s_desc_get_department_desc(g_pmaa_m.pmaa097) 
            
            DISPLAY g_pmaa_m.pmaa097 TO pmaa097    
            DISPLAY g_pmaa_m.pmaa097_desc TO pmaa097_desc
            
            NEXT FIELD pmaa097            
            #160810-00008#1 160819 by lori add---(E)            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa241
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa241
            #add-point:ON ACTION controlp INFIELD pmaa241 name="input.c.pmaa241"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa241      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "1" 
            CALL q_dbaa001_1()                                #呼叫開窗
            LET g_pmaa_m.pmaa241 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa241 TO pmaa241             #顯示到畫面上
            CALL apmm801_pmaa241_ref()
            NEXT FIELD pmaa241                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa242
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa242
            #add-point:ON ACTION controlp INFIELD pmaa242 name="input.c.pmaa242"
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa242      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa241) THEN
               LET g_qryparam.arg1 = "2"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa241
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "2"
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa242 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa242 TO pmaa242             #顯示到畫面上
            CALL apmm801_pmaa242_ref()
            NEXT FIELD pmaa242                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa243
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa243
            #add-point:ON ACTION controlp INFIELD pmaa243 name="input.c.pmaa243"
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa243      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa242) THEN
               LET g_qryparam.arg1 = "3"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa242
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "3" 
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa243 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa243 TO pmaa243             #顯示到畫面上
            CALL apmm801_pmaa243_ref()
            NEXT FIELD pmaa243                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa244
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa244
            #add-point:ON ACTION controlp INFIELD pmaa244 name="input.c.pmaa244"
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa244      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa243) THEN
               LET g_qryparam.arg1 = "4"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa243
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "4" 
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa244 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa244 TO pmaa244             #顯示到畫面上
            CALL apmm801_pmaa244_ref()
            NEXT FIELD pmaa244                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa245
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa245
            #add-point:ON ACTION controlp INFIELD pmaa245 name="input.c.pmaa245"
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa245             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #ken---modify 由"2"改為"1"   150127-00003#2
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa245 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa245 TO pmaa245              #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa245) RETURNING g_pmaa_m.pmaa245_desc
            DISPLAY BY NAME g_pmaa_m.pmaa245_desc
            NEXT FIELD pmaa245                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa246
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa246
            #add-point:ON ACTION controlp INFIELD pmaa246 name="input.c.pmaa246"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa247
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa247
            #add-point:ON ACTION controlp INFIELD pmaa247 name="input.c.pmaa247"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa248
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa248
            #add-point:ON ACTION controlp INFIELD pmaa248 name="input.c.pmaa248"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa095
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa095
            #add-point:ON ACTION controlp INFIELD pmaa095 name="input.c.pmaa095"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa095
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'i')   #150308-00001#4 150309 by lori add 'i'
            CALL q_ooef001_24()
            LET g_pmaa_m.pmaa095 = g_qryparam.return1           #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa095 TO pmaa095                 #顯示到畫面上
            CALL apmm801_pmaa095_ref()
            NEXT FIELD pmaa095                                  #返回原欄位  
            #END add-point
 
 
         #Ctrlp:input.c.pmaa220
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa220
            #add-point:ON ACTION controlp INFIELD pmaa220 name="input.c.pmaa220"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa221
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa221
            #add-point:ON ACTION controlp INFIELD pmaa221 name="input.c.pmaa221"
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa221             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa221 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa221 TO pmaa221              #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221) RETURNING g_pmaa_m.pmaa221_desc
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            NEXT FIELD pmaa221                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa222
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa222
            #add-point:ON ACTION controlp INFIELD pmaa222 name="input.c.pmaa222"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa222      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2072" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa222 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa222 TO pmaa222             #顯示到畫面上
            CALL apmm801_pmaa222_ref()
            NEXT FIELD pmaa222                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa080
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa080
            #add-point:ON ACTION controlp INFIELD pmaa080 name="input.c.pmaa080"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa080      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "251" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa080 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa080 TO pmaa080             #顯示到畫面上
            CALL apmm801_pmaa080_ref()
            NEXT FIELD pmaa080                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa084
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa084
            #add-point:ON ACTION controlp INFIELD pmaa084 name="input.c.pmaa084"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa084      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "256" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa084 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa084 TO pmaa084             #顯示到畫面上
            CALL apmm801_pmaa084_ref()
            NEXT FIELD pmaa084                              #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmaa083
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa083
            #add-point:ON ACTION controlp INFIELD pmaa083 name="input.c.pmaa083"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa083  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "255" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa083 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa083 TO pmaa083         #顯示到畫面上
            CALL apmm801_pmaa083_ref()
            NEXT FIELD pmaa083                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa086
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa086
            #add-point:ON ACTION controlp INFIELD pmaa086 name="input.c.pmaa086"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa086         #給予default值
            #給予arg
            CALL q_ooag001_4()                                 #呼叫開窗
            LET g_pmaa_m.pmaa086 = g_qryparam.return1          #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa086 TO pmaa086                #顯示到畫面上
            CALL apmm801_pmaa086_ref()
            NEXT FIELD pmaa086                                 #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa085
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa085
            #add-point:ON ACTION controlp INFIELD pmaa085 name="input.c.pmaa085"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa085
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'i')   #150308-00001#4 150309 by lori add 'i'
            CALL q_ooef001_24()
            LET g_pmaa_m.pmaa085 = g_qryparam.return1           #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa085 TO pmaa085                 #顯示到畫面上
            CALL apmm801_pmaa085_ref()
            NEXT FIELD pmaa085                                  #返回原欄位  
            #END add-point
 
 
         #Ctrlp:input.c.pmaa051
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa051
            #add-point:ON ACTION controlp INFIELD pmaa051 name="input.c.pmaa051"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa052
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa052
            #add-point:ON ACTION controlp INFIELD pmaa052 name="input.c.pmaa052"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa052      #給予default值
            #給予arg
            #CALL q_pmaa001()                               #呼叫開窗  #160908-00032#2 mark by rainy
            CALL q_pmaa001_4()                              #呼叫開窗    #160908-00032#2 by rainy 開窗改為 q_pmaa001_4()
            LET g_pmaa_m.pmaa052 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa052 TO pmaa052             #顯示到畫面上
            CALL apmm801_pmaa052_ref()
            NEXT FIELD pmaa052                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa053
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa053
            #add-point:ON ACTION controlp INFIELD pmaa053 name="input.c.pmaa053"
                                                                       
            #END add-point
 
 
         #Ctrlp:input.c.pmaa054
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa054
            #add-point:ON ACTION controlp INFIELD pmaa054 name="input.c.pmaa054"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa054      #給予default值
            #給予arg
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                              #呼叫開窗
            LET g_pmaa_m.pmaa054 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa054 TO pmaa054             #顯示到畫面上
            CALL apmm801_pmaa054_ref()
            NEXT FIELD pmaa054                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa055
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa055
            #add-point:ON ACTION controlp INFIELD pmaa055 name="input.c.pmaa055"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa056
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa056
            #add-point:ON ACTION controlp INFIELD pmaa056 name="input.c.pmaa056"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa057
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa057
            #add-point:ON ACTION controlp INFIELD pmaa057 name="input.c.pmaa057"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa058
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa058
            #add-point:ON ACTION controlp INFIELD pmaa058 name="input.c.pmaa058"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa074
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa074
            #add-point:ON ACTION controlp INFIELD pmaa074 name="input.c.pmaa074"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa059
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa059
            #add-point:ON ACTION controlp INFIELD pmaa059 name="input.c.pmaa059"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa075
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa075
            #add-point:ON ACTION controlp INFIELD pmaa075 name="input.c.pmaa075"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa047
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa047
            #add-point:ON ACTION controlp INFIELD pmaa047 name="input.c.pmaa047"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa036
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa036
            #add-point:ON ACTION controlp INFIELD pmaa036 name="input.c.pmaa036"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa037
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa037
            #add-point:ON ACTION controlp INFIELD pmaa037 name="input.c.pmaa037"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa038
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa038
            #add-point:ON ACTION controlp INFIELD pmaa038 name="input.c.pmaa038"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa039
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa039
            #add-point:ON ACTION controlp INFIELD pmaa039 name="input.c.pmaa039"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa040
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa040
            #add-point:ON ACTION controlp INFIELD pmaa040 name="input.c.pmaa040"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa041
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa041
            #add-point:ON ACTION controlp INFIELD pmaa041 name="input.c.pmaa041"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa042
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa042
            #add-point:ON ACTION controlp INFIELD pmaa042 name="input.c.pmaa042"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa043
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa043
            #add-point:ON ACTION controlp INFIELD pmaa043 name="input.c.pmaa043"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa044
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa044
            #add-point:ON ACTION controlp INFIELD pmaa044 name="input.c.pmaa044"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa045
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa045
            #add-point:ON ACTION controlp INFIELD pmaa045 name="input.c.pmaa045"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa046
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa046
            #add-point:ON ACTION controlp INFIELD pmaa046 name="input.c.pmaa046"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa068
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa068
            #add-point:ON ACTION controlp INFIELD pmaa068 name="input.c.pmaa068"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa069
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa069
            #add-point:ON ACTION controlp INFIELD pmaa069 name="input.c.pmaa069"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa072
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa072
            #add-point:ON ACTION controlp INFIELD pmaa072 name="input.c.pmaa072"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa070
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa070
            #add-point:ON ACTION controlp INFIELD pmaa070 name="input.c.pmaa070"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa071
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa071
            #add-point:ON ACTION controlp INFIELD pmaa071 name="input.c.pmaa071"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa073
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa073
            #add-point:ON ACTION controlp INFIELD pmaa073 name="input.c.pmaa073"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa204
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa204
            #add-point:ON ACTION controlp INFIELD pmaa204 name="input.c.pmaa204"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa205
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa205
            #add-point:ON ACTION controlp INFIELD pmaa205 name="input.c.pmaa205"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa205      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2031" #
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa205 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa205 TO pmaa205             #顯示到畫面上
            CALL apmm801_pmaa205_ref()
            NEXT FIELD pmaa205                              #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa206
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa206
            #add-point:ON ACTION controlp INFIELD pmaa206 name="input.c.pmaa206"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmab032
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab032
            #add-point:ON ACTION controlp INFIELD pmab032 name="input.c.pmab032"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab057
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab057
            #add-point:ON ACTION controlp INFIELD pmab057 name="input.c.pmab057"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab058
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab058
            #add-point:ON ACTION controlp INFIELD pmab058 name="input.c.pmab058"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab053
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab053
            #add-point:ON ACTION controlp INFIELD pmab053 name="input.c.pmab053"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab053             #給予default值
            LET g_qryparam.default2 = "" #g_pmaa_m.oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = '238'

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab053 = g_qryparam.return1              
            DISPLAY g_pmaa_m.pmab053 TO pmab053              
            CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab053) RETURNING g_pmaa_m.pmab053_desc
            DISPLAY BY NAME g_pmaa_m.pmab053_desc
            NEXT FIELD pmab053                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab039
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab039
            #add-point:ON ACTION controlp INFIELD pmab039 name="input.c.pmab039"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab039             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "264"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab039 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab039 TO pmab039              #顯示到畫面上
            CALL apmm801_pmab039_ref()
            NEXT FIELD pmab039                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmaa081
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa081
            #add-point:ON ACTION controlp INFIELD pmaa081 name="input.c.pmaa081"
                                                                                    #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa081      #給予default值
            LET g_qryparam.arg1 = "253"
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmaa081 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa081 TO pmaa081             #顯示到畫面上
            CALL apmm801_pmaa081_ref()
            NEXT FIELD pmaa081                             #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmab033
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab033
            #add-point:ON ACTION controlp INFIELD pmab033 name="input.c.pmab033"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmab033 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab033 TO pmab033              #顯示到畫面上
            CALL apmm801_pmab033_ref()
            NEXT FIELD pmab033                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab034
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab034
            #add-point:ON ACTION controlp INFIELD pmab034 name="input.c.pmab034"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab034             #給予default值

            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_pmaa_m.pmab034 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab034 TO pmab034              #顯示到畫面上
            CALL apmm801_pmab034_ref()
            NEXT FIELD pmab034                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab035
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab035
            #add-point:ON ACTION controlp INFIELD pmab035 name="input.c.pmab035"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab056
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab056
            #add-point:ON ACTION controlp INFIELD pmab056 name="input.c.pmab056"
            #此段落由子樣板a07產生            
            #開窗i段            
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmab056
            LET g_qryparam.arg1 = g_ooef019
            LET g_qryparam.arg2 = "1"
            CALL q_isac002_2()
            LET g_pmaa_m.pmab056 = g_qryparam.return1
            DISPLAY g_pmaa_m.pmab056 TO pmab056
            CALL s_desc_get_invoice_type_desc1(g_site,g_pmaa_m.pmab056) RETURNING g_pmaa_m.pmab056_desc
            DISPLAY BY NAME g_pmaa_m.pmab056_desc
            NEXT FIELD pmab056
            #END add-point
 
 
         #Ctrlp:input.c.pmab037
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab037
            #add-point:ON ACTION controlp INFIELD pmab037 name="input.c.pmab037"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab037             #給予default值

            #給予arg

            CALL q_ooib002_1()                                #呼叫開窗

            LET g_pmaa_m.pmab037 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab037 TO pmab037              #顯示到畫面上
            CALL apmm801_pmab037_ref()
            NEXT FIELD pmab037                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab055
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab055
            #add-point:ON ACTION controlp INFIELD pmab055 name="input.c.pmab055"
            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab055      #給予default
            #給予arg
            LET g_qryparam.arg1 = "3211" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_pmaa_m.pmab055 = g_qryparam.return1              
            #LET g_pmaa_m.oocql004 = g_qryparam.return2 
            DISPLAY g_pmaa_m.pmab055 TO pmab055             #顯示到畫面上
            #DISPLAY g_pmaa_m.oocql004 TO oocql004 #說明
            CALL apmm801_pmab055_ref()   
            NEXT FIELD pmab055                              #返回原欄位
           
            #END add-point
 
 
         #Ctrlp:input.c.pmab038
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab038
            #add-point:ON ACTION controlp INFIELD pmab038 name="input.c.pmab038"
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab038             #給予default值

            #給予arg
		      LET g_qryparam.arg1 = "2"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmab038 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab038 TO pmab038              #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab038) RETURNING g_pmaa_m.pmab038_desc
            DISPLAY BY NAME g_pmaa_m.pmab038_desc
            NEXT FIELD pmab038                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmab040
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab040
            #add-point:ON ACTION controlp INFIELD pmab040 name="input.c.pmab040"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab040             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab040 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab040 TO pmab040              #顯示到畫面上
            CALL apmm801_pmab040_ref()
            NEXT FIELD pmab040                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab041
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab041
            #add-point:ON ACTION controlp INFIELD pmab041 name="input.c.pmab041"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab041             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab041 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab041 TO pmab041              #顯示到畫面上
            CALL apmm801_pmab041_ref()
            NEXT FIELD pmab041                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab042
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab042
            #add-point:ON ACTION controlp INFIELD pmab042 name="input.c.pmab042"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab042             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab042 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab042 TO pmab042              #顯示到畫面上
            CALL apmm801_pmab042_ref()
            NEXT FIELD pmab042                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab043
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab043
            #add-point:ON ACTION controlp INFIELD pmab043 name="input.c.pmab043"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab043             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab043 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab043 TO pmab043              #顯示到畫面上
            CALL apmm801_pmab043_ref()
            NEXT FIELD pmab043                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab044
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab044
            #add-point:ON ACTION controlp INFIELD pmab044 name="input.c.pmab044"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab045
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab045
            #add-point:ON ACTION controlp INFIELD pmab045 name="input.c.pmab045"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab046
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab046
            #add-point:ON ACTION controlp INFIELD pmab046 name="input.c.pmab046"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab047
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab047
            #add-point:ON ACTION controlp INFIELD pmab047 name="input.c.pmab047"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab047             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_pmaa_m.pmab047 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab047 TO pmab047              #顯示到畫面上
            CALL apmm801_pmab047_ref()
            NEXT FIELD pmab047                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab048
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab048
            #add-point:ON ACTION controlp INFIELD pmab048 name="input.c.pmab048"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab049
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab049
            #add-point:ON ACTION controlp INFIELD pmab049 name="input.c.pmab049"
            
            #END add-point
 
 
         #Ctrlp:input.c.l_pmab050
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab050
            #add-point:ON ACTION controlp INFIELD l_pmab050 name="input.c.l_pmab050"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab051
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab051
            #add-point:ON ACTION controlp INFIELD pmab051 name="input.c.pmab051"
            
            #END add-point
 
 
         #Ctrlp:input.c.l_pmab052
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab052
            #add-point:ON ACTION controlp INFIELD l_pmab052 name="input.c.l_pmab052"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab080
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab080
            #add-point:ON ACTION controlp INFIELD pmab080 name="input.c.pmab080"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab082
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab082
            #add-point:ON ACTION controlp INFIELD pmab082 name="input.c.pmab082"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab083
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab083
            #add-point:ON ACTION controlp INFIELD pmab083 name="input.c.pmab083"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab083             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmab083 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab083 TO pmab083              #顯示到畫面上
            CALL apmm801_pmab083_ref()
            NEXT FIELD pmab083                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab084
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab084
            #add-point:ON ACTION controlp INFIELD pmab084 name="input.c.pmab084"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab084             #給予default值

            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_pmaa_m.pmab084 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab084 TO pmab084              #顯示到畫面上
            CALL apmm801_pmab084_ref()
            NEXT FIELD pmab084                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab103
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab103
            #add-point:ON ACTION controlp INFIELD pmab103 name="input.c.pmab103"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab103             #給予default值
            LET g_qryparam.default2 = "" #g_pmaa_m.oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab103 = g_qryparam.return1              
            DISPLAY g_pmaa_m.pmab103 TO pmab103              
            CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab103) RETURNING g_pmaa_m.pmab103_desc
            DISPLAY BY NAME g_pmaa_m.pmab103_desc
            NEXT FIELD pmab103                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab104
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab104
            #add-point:ON ACTION controlp INFIELD pmab104 name="input.c.pmab104"
            #應用 a07 樣板自動產生(Version:3)   
            #開窗i段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE 
            LET g_qryparam.default1 = g_pmaa_m.pmab104 
            
            CALL q_xmah001()                            
 
            LET g_pmaa_m.pmab104 = g_qryparam.return1
            DISPLAY g_pmaa_m.pmab104 TO pmab104   

            LET g_pmaa_m.pmab104_desc = apmm801_pmab104_ref(g_pmaa_m.pmab104)
            DISPLAY g_pmaa_m.pmab104_desc TO pmab104_desc
            
            NEXT FIELD pmab104             
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #Ctrlp:input.c.pmab085
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab085
            #add-point:ON ACTION controlp INFIELD pmab085 name="input.c.pmab085"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab106
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab106
            #add-point:ON ACTION controlp INFIELD pmab106 name="input.c.pmab106"
            #此段落由子樣板a07產生            
            #開窗i段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmab106         
            LET g_qryparam.arg1 = g_ooef019
            LET g_qryparam.arg2 = "2"
            
            CALL q_isac002_1() 

            LET g_pmaa_m.pmab106 = g_qryparam.return1  
            DISPLAY g_pmaa_m.pmab106 TO pmab106       
            
            LET g_pmaa_m.pmab106_desc = apmm801_pmab106_ref(g_pmaa_m.pmab106)
            DISPLAY g_pmaa_m.pmab106_desc TO pmab106_desc
            
            NEXT FIELD pmab106             
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #Ctrlp:input.c.pmab087
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab087
            #add-point:ON ACTION controlp INFIELD pmab087 name="input.c.pmab087"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab087             #給予default值

            #給予arg

            CALL q_ooib002_2()                                #呼叫開窗

            LET g_pmaa_m.pmab087 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab087 TO pmab087              #顯示到畫面上
            CALL apmm801_pmab087_ref()
            NEXT FIELD pmab087                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab105
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab105
            #add-point:ON ACTION controlp INFIELD pmab105 name="input.c.pmab105"
            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab105             #給予default值
            #給予arg
            LET g_qryparam.arg1 = "3111" #s
            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab105 = g_qryparam.return1              
            #LET g_pmaa_m.oocql004 = g_qryparam.return2 
            DISPLAY g_pmaa_m.pmab105 TO pmab105    #顯示到畫面上    
            CALL apmm801_pmab105_ref()            
            #DISPLAY g_pmaa_m.oocql004 TO oocql004 #說明
            NEXT FIELD pmab105                     #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab088
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab088
            #add-point:ON ACTION controlp INFIELD pmab088 name="input.c.pmab088"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab088             #給予default值

            #給予arg
		      LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmab088 = g_qryparam.return1              

            DISPLAY g_pmaa_m.pmab088 TO pmab088              #
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab088) RETURNING g_pmaa_m.pmab088_desc
            DISPLAY BY NAME g_pmaa_m.pmab088_desc
            NEXT FIELD pmab088                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab089
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab089
            #add-point:ON ACTION controlp INFIELD pmab089 name="input.c.pmab089"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab089             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "295" 

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab089 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab089 TO pmab089              #顯示到畫面上
            CALL apmm801_pmab089_ref()
            NEXT FIELD pmab089                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab107
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab107
            #add-point:ON ACTION controlp INFIELD pmab107 name="input.c.pmab107"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab108
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab108
            #add-point:ON ACTION controlp INFIELD pmab108 name="input.c.pmab108"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab090
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab090
            #add-point:ON ACTION controlp INFIELD pmab090 name="input.c.pmab090"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab090             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab090 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab090 TO pmab090              #顯示到畫面上
            CALL apmm801_pmab090_ref()
            NEXT FIELD pmab090                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab091
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab091
            #add-point:ON ACTION controlp INFIELD pmab091 name="input.c.pmab091"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab091             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab091 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab091 TO pmab091              #顯示到畫面上
            CALL apmm801_pmab091_ref()
            NEXT FIELD pmab091                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab092
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab092
            #add-point:ON ACTION controlp INFIELD pmab092 name="input.c.pmab092"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab092             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab092 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab092 TO pmab092              #顯示到畫面上
            CALL apmm801_pmab092_ref()
            NEXT FIELD pmab092                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab093
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab093
            #add-point:ON ACTION controlp INFIELD pmab093 name="input.c.pmab093"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab093             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "262"

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmab093 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab093 TO pmab093              #顯示到畫面上
            CALL apmm801_pmab093_ref()
            NEXT FIELD pmab093                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab094
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab094
            #add-point:ON ACTION controlp INFIELD pmab094 name="input.c.pmab094"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab095
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab095
            #add-point:ON ACTION controlp INFIELD pmab095 name="input.c.pmab095"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab096
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab096
            #add-point:ON ACTION controlp INFIELD pmab096 name="input.c.pmab096"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab097
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab097
            #add-point:ON ACTION controlp INFIELD pmab097 name="input.c.pmab097"
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmab097             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_pmaa_m.pmab097 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmab097 TO pmab097              #顯示到畫面上
            CALL apmm801_pmab097_ref()
            NEXT FIELD pmab097                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.pmab098
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab098
            #add-point:ON ACTION controlp INFIELD pmab098 name="input.c.pmab098"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab099
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab099
            #add-point:ON ACTION controlp INFIELD pmab099 name="input.c.pmab099"
            
            #END add-point
 
 
         #Ctrlp:input.c.l_pmab100
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab100
            #add-point:ON ACTION controlp INFIELD l_pmab100 name="input.c.l_pmab100"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmab101
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmab101
            #add-point:ON ACTION controlp INFIELD pmab101 name="input.c.pmab101"
            
            #END add-point
 
 
         #Ctrlp:input.c.l_pmab102
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD l_pmab102
            #add-point:ON ACTION controlp INFIELD l_pmab102 name="input.c.l_pmab102"
            
            #END add-point
 
 
         #Ctrlp:input.c.ooff013
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013 name="input.c.ooff013"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa270
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa270
            #add-point:ON ACTION controlp INFIELD pmaa270 name="input.c.pmaa270"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa271
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa271
            #add-point:ON ACTION controlp INFIELD pmaa271 name="input.c.pmaa271"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa272
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa272
            #add-point:ON ACTION controlp INFIELD pmaa272 name="input.c.pmaa272"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day01
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day01
            #add-point:ON ACTION controlp INFIELD day01 name="input.c.day01"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day02
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day02
            #add-point:ON ACTION controlp INFIELD day02 name="input.c.day02"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day03
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day03
            #add-point:ON ACTION controlp INFIELD day03 name="input.c.day03"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day04
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day04
            #add-point:ON ACTION controlp INFIELD day04 name="input.c.day04"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day05
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day05
            #add-point:ON ACTION controlp INFIELD day05 name="input.c.day05"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day06
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day06
            #add-point:ON ACTION controlp INFIELD day06 name="input.c.day06"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day07
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day07
            #add-point:ON ACTION controlp INFIELD day07 name="input.c.day07"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day08
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day08
            #add-point:ON ACTION controlp INFIELD day08 name="input.c.day08"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day09
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day09
            #add-point:ON ACTION controlp INFIELD day09 name="input.c.day09"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day10
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day10
            #add-point:ON ACTION controlp INFIELD day10 name="input.c.day10"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day11
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day11
            #add-point:ON ACTION controlp INFIELD day11 name="input.c.day11"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day12
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day12
            #add-point:ON ACTION controlp INFIELD day12 name="input.c.day12"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day13
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day13
            #add-point:ON ACTION controlp INFIELD day13 name="input.c.day13"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day14
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day14
            #add-point:ON ACTION controlp INFIELD day14 name="input.c.day14"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day15
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day15
            #add-point:ON ACTION controlp INFIELD day15 name="input.c.day15"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day16
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day16
            #add-point:ON ACTION controlp INFIELD day16 name="input.c.day16"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day17
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day17
            #add-point:ON ACTION controlp INFIELD day17 name="input.c.day17"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day18
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day18
            #add-point:ON ACTION controlp INFIELD day18 name="input.c.day18"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day19
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day19
            #add-point:ON ACTION controlp INFIELD day19 name="input.c.day19"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day20
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day20
            #add-point:ON ACTION controlp INFIELD day20 name="input.c.day20"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day21
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day21
            #add-point:ON ACTION controlp INFIELD day21 name="input.c.day21"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day22
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day22
            #add-point:ON ACTION controlp INFIELD day22 name="input.c.day22"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day23
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day23
            #add-point:ON ACTION controlp INFIELD day23 name="input.c.day23"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day24
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day24
            #add-point:ON ACTION controlp INFIELD day24 name="input.c.day24"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day25
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day25
            #add-point:ON ACTION controlp INFIELD day25 name="input.c.day25"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day26
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day26
            #add-point:ON ACTION controlp INFIELD day26 name="input.c.day26"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day27
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day27
            #add-point:ON ACTION controlp INFIELD day27 name="input.c.day27"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day28
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day28
            #add-point:ON ACTION controlp INFIELD day28 name="input.c.day28"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day29
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day29
            #add-point:ON ACTION controlp INFIELD day29 name="input.c.day29"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day30
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day30
            #add-point:ON ACTION controlp INFIELD day30 name="input.c.day30"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.day31
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD day31
            #add-point:ON ACTION controlp INFIELD day31 name="input.c.day31"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week01
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week01
            #add-point:ON ACTION controlp INFIELD week01 name="input.c.week01"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week02
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week02
            #add-point:ON ACTION controlp INFIELD week02 name="input.c.week02"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week03
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week03
            #add-point:ON ACTION controlp INFIELD week03 name="input.c.week03"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week04
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week04
            #add-point:ON ACTION controlp INFIELD week04 name="input.c.week04"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week05
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week05
            #add-point:ON ACTION controlp INFIELD week05 name="input.c.week05"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week06
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week06
            #add-point:ON ACTION controlp INFIELD week06 name="input.c.week06"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.week07
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD week07
            #add-point:ON ACTION controlp INFIELD week07 name="input.c.week07"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.pmaa274
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa274
            #add-point:ON ACTION controlp INFIELD pmaa274 name="input.c.pmaa274"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa274  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "274" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa274 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa274 TO pmaa274         #顯示到畫面上
            CALL apmm801_pmaa274_ref()
            NEXT FIELD pmaa274                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa275
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa275
            #add-point:ON ACTION controlp INFIELD pmaa275 name="input.c.pmaa275"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa276
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa276
            #add-point:ON ACTION controlp INFIELD pmaa276 name="input.c.pmaa276"
            
            #END add-point
 
 
         #Ctrlp:input.c.pmaa281
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa281
            #add-point:ON ACTION controlp INFIELD pmaa281 name="input.c.pmaa281"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa281  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2037" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa281 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa281 TO pmaa281         #顯示到畫面上
            CALL apmm801_pmaa281_ref()
            NEXT FIELD pmaa281                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa282
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa282
            #add-point:ON ACTION controlp INFIELD pmaa282 name="input.c.pmaa282"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa282  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2038" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa282 = g_qryparam.return1   #將開窗取得的值回傳到變數            
            DISPLAY g_pmaa_m.pmaa282 TO pmaa282         #顯示到畫面上
            CALL apmm801_pmaa282_ref()
            NEXT FIELD pmaa282                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa283
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa283
            #add-point:ON ACTION controlp INFIELD pmaa283 name="input.c.pmaa283"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa283  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2039" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa283 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa283 TO pmaa283         #顯示到畫面上
            CALL apmm801_pmaa283_ref()
            NEXT FIELD pmaa283                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa284
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa284
            #add-point:ON ACTION controlp INFIELD pmaa284 name="input.c.pmaa284"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa284  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2040" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa284 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa284 TO pmaa284         #顯示到畫面上
            CALL apmm801_pmaa284_ref()
            NEXT FIELD pmaa284                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa285
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa285
            #add-point:ON ACTION controlp INFIELD pmaa285 name="input.c.pmaa285"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa285  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2041" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa285 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa285 TO pmaa285         #顯示到畫面上
            CALL apmm801_pmaa285_ref()
            NEXT FIELD pmaa285                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa286
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa286
            #add-point:ON ACTION controlp INFIELD pmaa286 name="input.c.pmaa286"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa286  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2042" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa286 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa286 TO pmaa286         #顯示到畫面上
            CALL apmm801_pmaa286_ref()
            NEXT FIELD pmaa286                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa287
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa287
            #add-point:ON ACTION controlp INFIELD pmaa287 name="input.c.pmaa287"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa287  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2043" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa287 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa287 TO pmaa287         #顯示到畫面上
            CALL apmm801_pmaa287_ref()
            NEXT FIELD pmaa287                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa288
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa288
            #add-point:ON ACTION controlp INFIELD pmaa288 name="input.c.pmaa288"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa288  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2044" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa288 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa288 TO pmaa288         #顯示到畫面上
            CALL apmm801_pmaa288_ref()
            NEXT FIELD pmaa288                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa289
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa289
            #add-point:ON ACTION controlp INFIELD pmaa289 name="input.c.pmaa289"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa289  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2045" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa289 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa289 TO pmaa289         #顯示到畫面上
            CALL apmm801_pmaa289_ref()
            NEXT FIELD pmaa289                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa290
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa290
            #add-point:ON ACTION controlp INFIELD pmaa290 name="input.c.pmaa290"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa290  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2046" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa290 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa290 TO pmaa290         #顯示到畫面上
            CALL apmm801_pmaa290_ref()
            NEXT FIELD pmaa290                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa291
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa291
            #add-point:ON ACTION controlp INFIELD pmaa291 name="input.c.pmaa291"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa291  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2061" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa291 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa291 TO pmaa291         #顯示到畫面上
            CALL apmm801_pmaa291_ref()
            NEXT FIELD pmaa291                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa292
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa292
            #add-point:ON ACTION controlp INFIELD pmaa292 name="input.c.pmaa292"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa292  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2062" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa292 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa292 TO pmaa292         #顯示到畫面上
            CALL apmm801_pmaa292_ref()
            NEXT FIELD pmaa292                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa293
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa293
            #add-point:ON ACTION controlp INFIELD pmaa293 name="input.c.pmaa293"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa293  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2063" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa293 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa293 TO pmaa293         #顯示到畫面上
            CALL apmm801_pmaa293_ref()
            NEXT FIELD pmaa293                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa294
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa294
            #add-point:ON ACTION controlp INFIELD pmaa294 name="input.c.pmaa294"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa294  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2064" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa294 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa294 TO pmaa294         #顯示到畫面上
            CALL apmm801_pmaa294_ref()
            NEXT FIELD pmaa294                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa295
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa295
            #add-point:ON ACTION controlp INFIELD pmaa295 name="input.c.pmaa295"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa295  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2065" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa295 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa295 TO pmaa295         #顯示到畫面上
            CALL apmm801_pmaa295_ref()
            NEXT FIELD pmaa295                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa296
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa296
            #add-point:ON ACTION controlp INFIELD pmaa296 name="input.c.pmaa296"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa296  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2066" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa296 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa296 TO pmaa296         #顯示到畫面上
            CALL apmm801_pmaa296_ref()
            NEXT FIELD pmaa296                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa297
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa297
            #add-point:ON ACTION controlp INFIELD pmaa297 name="input.c.pmaa297"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa297  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2067" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa297 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa297 TO pmaa297         #顯示到畫面上
            CALL apmm801_pmaa297_ref()    
            NEXT FIELD pmaa297                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa298
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa298
            #add-point:ON ACTION controlp INFIELD pmaa298 name="input.c.pmaa298"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa298  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2068" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa298 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa298 TO pmaa298         #顯示到畫面上
            CALL apmm801_pmaa298_ref()
            NEXT FIELD pmaa298                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa299
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa299
            #add-point:ON ACTION controlp INFIELD pmaa299 name="input.c.pmaa299"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa299  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2069" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa299 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa299 TO pmaa299         #顯示到畫面上
            CALL apmm801_pmaa299_ref()
            NEXT FIELD pmaa299                          #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.pmaa300
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaa300
            #add-point:ON ACTION controlp INFIELD pmaa300 name="input.c.pmaa300"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa300  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2070" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_pmaa_m.pmaa300 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa300 TO pmaa300         #顯示到畫面上
            CALL apmm801_pmaa300_ref()
            NEXT FIELD pmaa300                          #返回原欄位
            #END add-point
 
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            #CALL cl_err_collect_show()      #錯誤訊息統整顯示
            #CALL cl_showmsg()
            DISPLAY BY NAME g_pmaa_m.pmaa001
                        
            #add-point:單頭INPUT後 name="input.head.after_input"
            
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前 name="input.head.b_insert"
               #geza 20150601 add ---------------------(S)
               ##mark by geza 20160627 #160604-00009#108(S)
               #LET l_str = g_pmaa_m.pmaa001               
               #if l_str.getIndexOf('&',1)>0 then
               #  CALL s_aooi390_gen('2') RETURNING l_success,l_pmaa001,l_oofg_return
               #  if l_success then 
               #     let g_pmaa_m.pmaa001=l_pmaa001
               #   end if 
               #end if
               ##mark by geza 20160627 #160604-00009#108(E) 
               
               #add by geza 20160627 #160604-00009#108(S) 
               LET l_str = g_pmaa_m.pmaa001 
               #有设置自动编号的话就重新取值
               LET l_cnt = 0
               SELECT COUNT(distinct oofg001) INTO l_cnt
                 FROM oofg_t
                WHERE oofgent = g_enterprise
                  AND oofg002 = '2'
                  AND oofgstus = 'Y'
               IF l_cnt > 0 THEN
                  IF l_str.getIndexOf('&',1)>0 OR l_str IS NULL THEN
                    CALL s_aooi390_gen('2') RETURNING l_success,l_pmaa001,l_oofg_return
                    IF l_success then 
                      LET g_pmaa_m.pmaa001=l_pmaa001
                    END IF 
                  END IF 
               END IF
               #add by geza 20160627 #160604-00009#108(E)    
               
               CALL s_aooi390_get_auto_no('2',g_pmaa_m.pmaa001) RETURNING l_success,g_pmaa_m.pmaa001
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF

               #如果新的編碼與舊的不一樣 應該做更新 
               IF g_pmaa_m_o.pmaa001 != g_pmaa_m.pmaa001 AND NOT cl_null(g_pmaa_m_o.pmaa001) THEN
                  LET l_count_chk = 0
                  SELECT COUNT(*) INTO l_count_chk
                    FROM pmaal_t
                   WHERE pmaalent = g_enterprise
                     AND pmaal001 = g_pmaa_m_o.pmaa001
                     
                  IF l_count_chk > 0 THEN
                     UPDATE pmaal_t SET pmaal001 = g_pmaa_m.pmaa001
                      WHERE pmaalent = g_enterprise
                        AND pmaal001 = g_pmaa_m_o.pmaa001
                     IF SQLCA.sqlcode THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.extend = 'upd pmaal_t'
                        LET g_errparam.code   = SQLCA.sqlcode
                        LET g_errparam.popup  = TRUE
                        CALL cl_err()

                        CALL s_transaction_end('N','0')
                        NEXT FIELD CURRENT
                     END IF
                  END IF 
                  
                  #150612-00018#3 150615 add BY beckxie---S
                  IF g_pmaa_m.pmaa004 = '1' THEN
                     LET g_pmaa_m.pmaa005=g_pmaa_m.pmaa001
                  END IF 
                  #150612-00018#3 150615 add BY beckxie---E
                  
               END IF
               #geza 20150601 add ---------------------(E) 
               
               #add by geza 20160627 #160604-00009#108(S)
               IF g_pmaa_m.pmaa004 = '1' THEN
                  LET g_pmaa_m.pmaa005=g_pmaa_m.pmaa001
               END IF 
               IF g_pmaa_m.pmaa001 IS NULL OR g_pmaa_m.pmaa001 = ' '  THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ''
                  LET g_errparam.code   = 'apm-00221'
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
                   
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF                
               #add by geza 20160627 #160604-00009#108(E)   
               
               CALL s_aooi390_oofi_upd('2',g_pmaa_m.pmaa001) RETURNING l_success  #add by yangxf 20150506增加編碼功能
               CALL apmm801_combine_pmaa270()
               IF cl_null(g_pmaa_m.pmaa027) THEN
                  CALL s_aooi350_ins_oofa('3',g_pmaa_m.pmaa001,'') RETURNING l_success,g_pmaa_m.pmaa027
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "oofa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     NEXT FIELD pmaa001
                  ELSE
                     LET g_pmaa027_d = g_pmaa_m.pmaa027 
                  END IF
               END IF               
               #end add-point
               
               INSERT INTO pmaa_t (pmaaent,pmaa001,pmaa002,pmaa089,pmaa003,pmaastus,pmaa004,pmaa005, 
                   pmaa006,pmaa026,pmaa200,pmaa201,pmaa202,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022, 
                   pmaa020,pmaa023,pmaa024,pmaa025,pmaa007,pmaa008,pmaa009,pmaa010,pmaa011,pmaa027,pmaa230, 
                   pmaa231,pmaa232,pmaa090,pmaa091,pmaa092,pmaa094,pmaa093,pmaa096,pmaa097,pmaa241,pmaa242, 
                   pmaa243,pmaa244,pmaa245,pmaa246,pmaa247,pmaa248,pmaa095,pmaa220,pmaa221,pmaa222,pmaa080, 
                   pmaa084,pmaa083,pmaa086,pmaa085,pmaa051,pmaa052,pmaa053,pmaa054,pmaa055,pmaa056,pmaa057, 
                   pmaa058,pmaa074,pmaa059,pmaa075,pmaa047,pmaa036,pmaa037,pmaa038,pmaa039,pmaa040,pmaa041, 
                   pmaa042,pmaa043,pmaa044,pmaa045,pmaa046,pmaa068,pmaa069,pmaa072,pmaa070,pmaa071,pmaa073, 
                   pmaa204,pmaa205,pmaa206,pmaa081,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt, 
                   pmaamodid,pmaamoddt,pmaacnfid,pmaacnfdt,pmaa270,pmaa271,pmaa272,pmaa274,pmaa275,pmaa276, 
                   pmaa281,pmaa282,pmaa283,pmaa284,pmaa285,pmaa286,pmaa287,pmaa288,pmaa289,pmaa290,pmaa291, 
                   pmaa292,pmaa293,pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300)
               VALUES (g_enterprise,g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaa003, 
                   g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
                   g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016, 
                   g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020, 
                   g_pmaa_m.pmaa023,g_pmaa_m.pmaa024,g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008, 
                   g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230, 
                   g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091,g_pmaa_m.pmaa092, 
                   g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
                   g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246, 
                   g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221, 
                   g_pmaa_m.pmaa222,g_pmaa_m.pmaa080,g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086, 
                   g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054, 
                   g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa074, 
                   g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
                   g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042, 
                   g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068, 
                   g_pmaa_m.pmaa069,g_pmaa_m.pmaa072,g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073, 
                   g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206,g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid, 
                   g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid, 
                   g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271, 
                   g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281, 
                   g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
                   g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291, 
                   g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296, 
                   g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300) 
               IF SQLCA.SQLCODE THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "g_pmaa_m:",SQLERRMESSAGE 
                  LET g_errparam.code = SQLCA.SQLCODE 
                  LET g_errparam.popup = TRUE 
                  CALL s_transaction_end('N','0')
                  CALL cl_err()
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭新增中 name="input.head.m_insert"
             
               INSERT INTO pmab_t (pmabent,   pmabsite,  pmabstus,
                                   pmab001,   pmab032,   pmab033,   pmab034,   pmab035,
                                   pmab056,                                                #sakura add
                                   pmab037,   pmab055,                                     #150616-00047#1  15/06/18 s983961---add(pmab055)
                                   pmab038,   pmab039,   pmab040,   pmab041,   
                                   pmab042,   pmab043,   pmab044,   pmab045,   pmab046,
                                   pmab047,   pmab048,   pmab049,   pmab050,   pmab051,
                                   pmab052,   pmab083,   pmab084,   pmab085,   pmab087,
                                   pmab105,                                                #150616-00047#1  15/06/18 s983961---add
                                   pmab088,   pmab089,   pmab090,   pmab091,   pmab092,
                                   pmab093,   pmab094,   pmab095,   pmab096,   pmab097,
                                   pmab098,   pmab099,   pmab100,   pmab101,   pmab102,
                                   pmab082,   pmab057,   pmab058,   pmab107,   pmab108,
                                   pmabownid, pmabowndp, pmabcrtid, pmabcrtdp, pmabcrtdt,
                                   pmabmodid, pmabmoddt, pmabcnfid, pmabcnfdt,
                                   pmab053,   pmab103,   
                                   pmab002,   pmab003,   pmab004,   pmab005,   pmab006,   #160512-00005#2 160515 by lori add
                                   pmab007,   pmab008,   pmab009,   pmab010,  #pmab011,   #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark:pmab011
                                  #pmab012,   pmab013,   pmab014,   pmab015,   pmab016)   #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark  
                                   pmab080,   pmab104,   pmab106)                         #160810-00008#1 160819 by lori add
               VALUES (g_enterprise,      'ALL', g_pmaa_m.pmaastus,
                       g_pmaa_m.pmaa001,   g_pmaa_m.pmab032,   g_pmaa_m.pmab033,   g_pmaa_m.pmab034,   g_pmaa_m.pmab035,
                       g_pmaa_m.pmab056,                                                                                    #sakura add
                       g_pmaa_m.pmab037,   g_pmaa_m.pmab055,                                                                #150616-00047#1  15/06/18 s983961---add(g_pmaa_m.pmab055)
                       g_pmaa_m.pmab038,   g_pmaa_m.pmab039,   g_pmaa_m.pmab040,   g_pmaa_m.pmab041,
                       g_pmaa_m.pmab042,   g_pmaa_m.pmab043,   g_pmaa_m.pmab044,   g_pmaa_m.pmab045,   g_pmaa_m.pmab046,
                       g_pmaa_m.pmab047,   g_pmaa_m.pmab048,   g_pmaa_m.pmab049,   g_pmaa_m.l_pmab050, g_pmaa_m.pmab051,
                       g_pmaa_m.l_pmab052, g_pmaa_m.pmab083,   g_pmaa_m.pmab084,   g_pmaa_m.pmab085,   g_pmaa_m.pmab087,
                       g_pmaa_m.pmab105,                                                                                    #150616-00047#1  15/06/18 s983961---add    
                       g_pmaa_m.pmab088,   g_pmaa_m.pmab089,   g_pmaa_m.pmab090,   g_pmaa_m.pmab091,   g_pmaa_m.pmab092,
                       g_pmaa_m.pmab093,   g_pmaa_m.pmab094,   g_pmaa_m.pmab095,   g_pmaa_m.pmab096,   g_pmaa_m.pmab097,
                       g_pmaa_m.pmab098,   g_pmaa_m.pmab099,   g_pmaa_m.l_pmab100, g_pmaa_m.pmab101,   g_pmaa_m.l_pmab102,
                       g_pmaa_m.pmab082,   g_pmaa_m.pmab057,   g_pmaa_m.pmab058,   g_pmaa_m.pmab107,   g_pmaa_m.pmab108,
                       g_pmaa_m.pmaaownid, g_pmaa_m.pmaaowndp, g_pmaa_m.pmaacrtid, g_pmaa_m.pmaacrtdp, g_pmaa_m.pmaacrtdt,
                       g_pmaa_m.pmaamodid, g_pmaa_m.pmaamoddt, g_pmaa_m.pmaacnfid, g_pmaa_m.pmaacnfdt,
                       g_pmaa_m.pmab053,   g_pmaa_m.pmab103,
                       g_pmaa_m.pmaa051,   g_pmaa_m.pmaa052,   g_pmaa_m.pmaa053,   g_pmaa_m.pmaa054,   g_pmaa_m.pmaa055,    #160512-00005#2 160515 by lori add
                       g_pmaa_m.pmaa056,   g_pmaa_m.pmaa057,   g_pmaa_m.pmaa058,   g_pmaa_m.pmaa059,  #g_pmaa_m.pmaa060,    #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark:pmaa060
                      #g_pmaa_m.pmaa061,   g_pmaa_m.pmaa062,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa065)    #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark        
                       g_pmaa_m.pmab080,   g_pmaa_m.pmab104,   g_pmaa_m.pmab106)                                            #160810-00008#1 160819 by lori add        
              IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "ins pmab_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #更新ooff_t 備註
               IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                  IF NOT cl_null(g_pmaa_m.ooff013) THEN
                     LET l_success = ''
                     CALL s_aooi360_gen('2',g_pmaa_m.pmaa001,'','','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = "ooff_t"
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        CONTINUE DIALOG
                     END IF
                  ELSE
                     CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = "ooff_t"
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        CONTINUE DIALOG
                     END IF
                  END IF
               END IF
               #150519-00031#1 20150609 add by beckxie ---S
               INSERT INTO pmac_t (pmacent, pmac001,pmac002,pmac003,pmac004,pmacstus)
               VALUES (g_enterprise,g_pmaa_m.pmaa001,g_pmaa_m.pmaa001,"1","Y","Y")
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "ins pmbc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               INSERT INTO pmac_t (pmacent, pmac001,pmac002,pmac003,pmac004,pmacstus)
               VALUES (g_enterprise,g_pmaa_m.pmaa001,g_pmaa_m.pmaa001,"2","Y","Y")
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "ins pmbc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               INSERT INTO pmac_t (pmacent, pmac001,pmac002,pmac003,pmac004,pmacstus)
               VALUES (g_enterprise,g_pmaa_m.pmaa001,g_pmaa_m.pmaa001,"3","Y","Y")
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "ins pmbc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               #150519-00031#1 20150609 add by beckxie ---E 
               
               CALL apmm801_refresh_main_pmad()
               IF NOT cl_null(g_errno) THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               ELSE
                  CALL apmm801_b_fill()
               END IF
               
               #end add-point
               
               
                        INITIALIZE l_var_keys TO NULL 
         INITIALIZE l_field_keys TO NULL 
         INITIALIZE l_vars TO NULL 
         INITIALIZE l_fields TO NULL 
         IF g_pmaa_m.pmaa001 = g_master_multi_table_t.pmaal001 AND
         g_pmaa_m.pmaal004 = g_master_multi_table_t.pmaal004 AND 
         g_pmaa_m.pmaal003 = g_master_multi_table_t.pmaal003 AND 
         g_pmaa_m.pmaal006 = g_master_multi_table_t.pmaal006 AND 
         g_pmaa_m.pmaal005 = g_master_multi_table_t.pmaal005  THEN
         ELSE 
            LET l_var_keys[01] = g_enterprise
            LET l_field_keys[01] = 'pmaalent'
            LET l_var_keys_bak[01] = g_enterprise
            LET l_var_keys[02] = g_pmaa_m.pmaa001
            LET l_field_keys[02] = 'pmaal001'
            LET l_var_keys_bak[02] = g_master_multi_table_t.pmaal001
            LET l_var_keys[03] = g_dlang
            LET l_field_keys[03] = 'pmaal002'
            LET l_var_keys_bak[03] = g_dlang
            LET l_vars[01] = g_pmaa_m.pmaal004
            LET l_fields[01] = 'pmaal004'
            LET l_vars[02] = g_pmaa_m.pmaal003
            LET l_fields[02] = 'pmaal003'
            LET l_vars[03] = g_pmaa_m.pmaal006
            LET l_fields[03] = 'pmaal006'
            LET l_vars[04] = g_pmaa_m.pmaal005
            LET l_fields[04] = 'pmaal005'
            CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'pmaal_t')
         END IF 
 
               
               #add-point:單頭新增後 name="input.head.a_insert"
               LET g_pmaa001_t = g_pmaa_m.pmaa001
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL apmm801_detail_reproduce()
                  #因應特定程式需求, 重新刷新單身資料
                  CALL apmm801_b_fill()
                  CALL apmm801_b_fill2('0')
               END IF
               
               #add-point:單頭新增後 name="input.head.a_insert2"
               
               #end add-point
               
               LET g_master_insert = TRUE
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前 name="input.head.b_update"
               CALL apmm801_combine_pmaa270()
               
               IF cl_null(g_pmaa_m.pmaa027) THEN
                  CALL s_aooi350_ins_oofa('3',g_pmaa_m.pmaa001,'') RETURNING l_success,g_pmaa_m.pmaa027
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "oofa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
               END IF
               #end add-point
               
               #將遮罩欄位還原
               CALL apmm801_pmaa_t_mask_restore('restore_mask_o')
               
               UPDATE pmaa_t SET (pmaa001,pmaa002,pmaa089,pmaa003,pmaastus,pmaa004,pmaa005,pmaa006,pmaa026, 
                   pmaa200,pmaa201,pmaa202,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022,pmaa020,pmaa023, 
                   pmaa024,pmaa025,pmaa007,pmaa008,pmaa009,pmaa010,pmaa011,pmaa027,pmaa230,pmaa231,pmaa232, 
                   pmaa090,pmaa091,pmaa092,pmaa094,pmaa093,pmaa096,pmaa097,pmaa241,pmaa242,pmaa243,pmaa244, 
                   pmaa245,pmaa246,pmaa247,pmaa248,pmaa095,pmaa220,pmaa221,pmaa222,pmaa080,pmaa084,pmaa083, 
                   pmaa086,pmaa085,pmaa051,pmaa052,pmaa053,pmaa054,pmaa055,pmaa056,pmaa057,pmaa058,pmaa074, 
                   pmaa059,pmaa075,pmaa047,pmaa036,pmaa037,pmaa038,pmaa039,pmaa040,pmaa041,pmaa042,pmaa043, 
                   pmaa044,pmaa045,pmaa046,pmaa068,pmaa069,pmaa072,pmaa070,pmaa071,pmaa073,pmaa204,pmaa205, 
                   pmaa206,pmaa081,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,pmaamodid,pmaamoddt, 
                   pmaacnfid,pmaacnfdt,pmaa270,pmaa271,pmaa272,pmaa274,pmaa275,pmaa276,pmaa281,pmaa282, 
                   pmaa283,pmaa284,pmaa285,pmaa286,pmaa287,pmaa288,pmaa289,pmaa290,pmaa291,pmaa292,pmaa293, 
                   pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300) = (g_pmaa_m.pmaa001,g_pmaa_m.pmaa002, 
                   g_pmaa_m.pmaa089,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
                   g_pmaa_m.pmaa006,g_pmaa_m.pmaa026,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202, 
                   g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021, 
                   g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024,g_pmaa_m.pmaa025, 
                   g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
                   g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090, 
                   g_pmaa_m.pmaa091,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096, 
                   g_pmaa_m.pmaa097,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244, 
                   g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095, 
                   g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080,g_pmaa_m.pmaa084, 
                   g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
                   g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057, 
                   g_pmaa_m.pmaa058,g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047, 
                   g_pmaa_m.pmaa036,g_pmaa_m.pmaa037,g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040, 
                   g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045, 
                   g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072,g_pmaa_m.pmaa070, 
                   g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
                   g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
                   g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
                   g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275, 
                   g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284, 
                   g_pmaa_m.pmaa285,g_pmaa_m.pmaa286,g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289, 
                   g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294, 
                   g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299, 
                   g_pmaa_m.pmaa300)
                WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa001_t
 
               IF SQLCA.SQLCODE THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "pmaa_t:",SQLERRMESSAGE 
                  LET g_errparam.code = SQLCA.SQLCODE 
                  LET g_errparam.popup = TRUE 
                  CALL s_transaction_end('N','0')
                  CALL cl_err()
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭修改中 name="input.head.m_update"
               LET l_cnt = 0
               SELECT COUNT(*) INTO l_cnt FROM pmab_t
                WHERE pmabent = g_enterprise AND pmab001 = g_pmaa001_t AND pmabsite = 'ALL'
                               
               IF l_cnt > 0 THEN
                  UPDATE pmab_t SET ( pmabstus,  pmab001,   pmab032,   pmab033,   pmab034, 
                                      pmab035,   pmab056,                                       #sakura add:pmab056
                                      pmab037,   pmab055,                                       #150616-00047#1  15/06/18 s983961---add(pmab055)
                                      pmab038,   pmab039,   pmab040,   pmab041,                  
                                      pmab042,   pmab043,   pmab044,   pmab045,   pmab046,       
                                      pmab047,   pmab048,   pmab049,   pmab050,   pmab051,       
                                      pmab052,   pmab083,   pmab084,   pmab085,   pmab087,       
                                      pmab105,                                                  #150616-00047#1  15/06/18 s983961---add
                                      pmab088,   pmab089,   pmab090,   pmab091,   pmab092,       
                                      pmab093,   pmab094,   pmab095,   pmab096,   pmab097,       
                                      pmab098,   pmab099,   pmab100,   pmab101,   pmab102,       
                                      pmab082,   pmab057,   pmab058,   pmab107,   pmab108,       
                                      pmabownid, pmabowndp, pmabcrtid, pmabcrtdp, pmabcrtdt,     
                                      pmabmodid, pmabmoddt, pmabcnfid, pmabcnfdt,                
                                      pmab053,   pmab103,                                        
                                      pmab002,   pmab003,   pmab004,   pmab005,   pmab006,      #160512-00005#2 160515 by lori add
                                      pmab007,   pmab008,   pmab009,   pmab010,  #pmab011,      #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark:pmab011
                                     #pmab012,   pmab013,   pmab014,   pmab015,   pmab016)      #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark 
                                      pmab080,   pmab104,   pmab106)                            #160810-00008#1 160819 by lori add
                       = (g_pmaa_m.pmaastus,  g_pmaa_m.pmaa001,   g_pmaa_m.pmab032,   g_pmaa_m.pmab033,   g_pmaa_m.pmab034, g_pmaa_m.pmab035,
                          g_pmaa_m.pmab056,                                                                                      #sakura add
                          g_pmaa_m.pmab037,   g_pmaa_m.pmab055,                                                                  #150616-00047#1  15/06/18 s983961---add(g_pmaa_m.pmab055) 
                          g_pmaa_m.pmab038,   g_pmaa_m.pmab039,   g_pmaa_m.pmab040,   g_pmaa_m.pmab041,   
                          g_pmaa_m.pmab042,   g_pmaa_m.pmab043,   g_pmaa_m.pmab044,   g_pmaa_m.pmab045,   g_pmaa_m.pmab046,
                          g_pmaa_m.pmab047,   g_pmaa_m.pmab048,   g_pmaa_m.pmab049,   g_pmaa_m.l_pmab050, g_pmaa_m.pmab051,
                          g_pmaa_m.l_pmab052, g_pmaa_m.pmab083,   g_pmaa_m.pmab084,   g_pmaa_m.pmab085,   g_pmaa_m.pmab087,
                          g_pmaa_m.pmab105,                                                                                      #150616-00047#1  15/06/18 s983961---add 
                          g_pmaa_m.pmab088,   g_pmaa_m.pmab089,   g_pmaa_m.pmab090,   g_pmaa_m.pmab091,   g_pmaa_m.pmab092,
                          g_pmaa_m.pmab093,   g_pmaa_m.pmab094,   g_pmaa_m.pmab095,   g_pmaa_m.pmab096,   g_pmaa_m.pmab097,
                          g_pmaa_m.pmab098,   g_pmaa_m.pmab099,   g_pmaa_m.l_pmab100, g_pmaa_m.pmab101,   g_pmaa_m.l_pmab102,
                          g_pmaa_m.pmab082,   g_pmaa_m.pmab057,   g_pmaa_m.pmab058,   g_pmaa_m.pmab107,   g_pmaa_m.pmab108,
                          g_pmaa_m.pmaaownid, g_pmaa_m.pmaaowndp, g_pmaa_m.pmaacrtid, g_pmaa_m.pmaacrtdp, g_pmaa_m.pmaacrtdt,
                          g_pmaa_m.pmaamodid, g_pmaa_m.pmaamoddt, g_pmaa_m.pmaacnfid, g_pmaa_m.pmaacnfdt,
                          g_pmaa_m.pmab053,   g_pmaa_m.pmab103,
                          g_pmaa_m.pmaa051,   g_pmaa_m.pmaa052,   g_pmaa_m.pmaa053,   g_pmaa_m.pmaa054,   g_pmaa_m.pmaa055,    #160512-00005#2 160515 by lori add
                          g_pmaa_m.pmaa056,   g_pmaa_m.pmaa057,   g_pmaa_m.pmaa058,   g_pmaa_m.pmaa059,  #g_pmaa_m.pmaa060,    #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark:pmaa060
                         #g_pmaa_m.pmaa061,   g_pmaa_m.pmaa062,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa065)    #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark
                          g_pmaa_m.pmab080,   g_pmaa_m.pmab104,   g_pmaa_m.pmab106)                                            #160810-00008#1 160819 by lori add
                    WHERE pmabent = g_enterprise 
                      AND pmab001 = g_pmaa001_t
                      AND pmabsite = 'ALL'
   
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "upd pmab_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
               ELSE                 
                  INSERT INTO pmab_t (pmabent,   pmabsite,  pmabstus,
                                      pmab001,   pmab032,   pmab033,   pmab034,   pmab035,
                                      pmab056,                                                #sakura add
                                      pmab037,   pmab055,                                     #150616-00047#1  15/06/18 s983961---add(pmab055)
                                      pmab038,   pmab039,   pmab040,   pmab041,   
                                      pmab042,   pmab043,   pmab044,   pmab045,   pmab046,
                                      pmab047,   pmab048,   pmab049,   pmab050,   pmab051,
                                      pmab052,   pmab083,   pmab084,   pmab085,   pmab087,
                                      pmab105,                                                #150616-00047#1  15/06/18 s983961---add
                                      pmab088,   pmab089,   pmab090,   pmab091,   pmab092,
                                      pmab093,   pmab094,   pmab095,   pmab096,   pmab097,
                                      pmab098,   pmab099,   pmab100,   pmab101,   pmab102,
                                      pmab082,   pmab057,   pmab058,   pmab107,   pmab108,
                                      pmabownid, pmabowndp, pmabcrtid, pmabcrtdp, pmabcrtdt,
                                      pmabmodid, pmabmoddt, pmabcnfid, pmabcnfdt,
                                      pmab053,   pmab103,   
                                      pmab002,   pmab003,   pmab004,   pmab005,   pmab006,   #160512-00005#2 160515 by lori add
                                      pmab007,   pmab008,   pmab009,   pmab010,  #pmab011,   #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark:pmab011
                                     #pmab012,   pmab013,   pmab014,   pmab015,   pmab016)   #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark 
                                      pmab080,   pmab104,   pmab106)                         #160810-00008#1 160819 by lori add
                  VALUES (g_enterprise,       'ALL',              g_pmaa_m.pmaastus,
                          g_pmaa_m.pmaa001,   g_pmaa_m.pmab032,   g_pmaa_m.pmab033,   g_pmaa_m.pmab034,   g_pmaa_m.pmab035,
                          g_pmaa_m.pmab056,                                                                                     #sakura add
                          g_pmaa_m.pmab037,   g_pmaa_m.pmab055,                                                                 #150616-00047#1  15/06/18 s983961---add(g_pmaa_m.pmab055)
                          g_pmaa_m.pmab038,   g_pmaa_m.pmab039,   g_pmaa_m.pmab040,   g_pmaa_m.pmab041,
                          g_pmaa_m.pmab042,   g_pmaa_m.pmab043,   g_pmaa_m.pmab044,   g_pmaa_m.pmab045,   g_pmaa_m.pmab046,
                          g_pmaa_m.pmab047,   g_pmaa_m.pmab048,   g_pmaa_m.pmab049,   g_pmaa_m.l_pmab050, g_pmaa_m.pmab051,
                          g_pmaa_m.l_pmab052, g_pmaa_m.pmab083,   g_pmaa_m.pmab084,   g_pmaa_m.pmab085,   g_pmaa_m.pmab087,
                          g_pmaa_m.pmab105,                                                                                     #150616-00047#1  15/06/18 s983961---add
                          g_pmaa_m.pmab088,   g_pmaa_m.pmab089,   g_pmaa_m.pmab090,   g_pmaa_m.pmab091,   g_pmaa_m.pmab092,
                          g_pmaa_m.pmab093,   g_pmaa_m.pmab094,   g_pmaa_m.pmab095,   g_pmaa_m.pmab096,   g_pmaa_m.pmab097,
                          g_pmaa_m.pmab098,   g_pmaa_m.pmab099,   g_pmaa_m.l_pmab100, g_pmaa_m.pmab101,   g_pmaa_m.l_pmab102,
                          g_pmaa_m.pmab082,   g_pmaa_m.pmab057,   g_pmaa_m.pmab058,   g_pmaa_m.pmab107,   g_pmaa_m.pmab108,
                          g_pmaa_m.pmaaownid, g_pmaa_m.pmaaowndp, g_pmaa_m.pmaacrtid, g_pmaa_m.pmaacrtdp, g_pmaa_m.pmaacrtdt,
                          g_pmaa_m.pmaamodid, g_pmaa_m.pmaamoddt, g_pmaa_m.pmaacnfid, g_pmaa_m.pmaacnfdt,
                          g_pmaa_m.pmab053,   g_pmaa_m.pmab103,
                          g_pmaa_m.pmaa051,   g_pmaa_m.pmaa052,   g_pmaa_m.pmaa053,   g_pmaa_m.pmaa054,   g_pmaa_m.pmaa055,     #160512-00005#2 160515 by lori add
                          g_pmaa_m.pmaa056,   g_pmaa_m.pmaa057,   g_pmaa_m.pmaa058,   g_pmaa_m.pmaa059,  #g_pmaa_m.pmaa060,     #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by mark:pmaa060
                         #g_pmaa_m.pmaa061,   g_pmaa_m.pmaa062,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa063,   g_pmaa_m.pmaa065)     #160512-00005#2 160515 by lori add   #160810-00008#1 160819 by lori mark  
                          g_pmaa_m.pmab080,   g_pmaa_m.pmab104,   g_pmaa_m.pmab106)                                             #160810-00008#1 160819 by lori add
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "ins pmab_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
               END IF
               
               #更新ooff_t 備註
               IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                  IF NOT cl_null(g_pmaa_m.ooff013) THEN
                     LET l_success = ''
                     CALL s_aooi360_gen('2',g_pmaa_m.pmaa001,'','','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = "ooff_t"
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        CALL s_transaction_end('N','0')
                        CONTINUE DIALOG
                     END IF
                  ELSE
                     CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = "ooff_t"
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        CALL s_transaction_end('N','0')
                        CONTINUE DIALOG
                     END IF
                  END IF
               END IF  

               CALL apmm801_refresh_main_pmad()
               IF NOT cl_null(g_errno) THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               ELSE
                  CALL apmm801_b_fill()
               END IF
               #end add-point
               
               
                        INITIALIZE l_var_keys TO NULL 
         INITIALIZE l_field_keys TO NULL 
         INITIALIZE l_vars TO NULL 
         INITIALIZE l_fields TO NULL 
         IF g_pmaa_m.pmaa001 = g_master_multi_table_t.pmaal001 AND
         g_pmaa_m.pmaal004 = g_master_multi_table_t.pmaal004 AND 
         g_pmaa_m.pmaal003 = g_master_multi_table_t.pmaal003 AND 
         g_pmaa_m.pmaal006 = g_master_multi_table_t.pmaal006 AND 
         g_pmaa_m.pmaal005 = g_master_multi_table_t.pmaal005  THEN
         ELSE 
            LET l_var_keys[01] = g_enterprise
            LET l_field_keys[01] = 'pmaalent'
            LET l_var_keys_bak[01] = g_enterprise
            LET l_var_keys[02] = g_pmaa_m.pmaa001
            LET l_field_keys[02] = 'pmaal001'
            LET l_var_keys_bak[02] = g_master_multi_table_t.pmaal001
            LET l_var_keys[03] = g_dlang
            LET l_field_keys[03] = 'pmaal002'
            LET l_var_keys_bak[03] = g_dlang
            LET l_vars[01] = g_pmaa_m.pmaal004
            LET l_fields[01] = 'pmaal004'
            LET l_vars[02] = g_pmaa_m.pmaal003
            LET l_fields[02] = 'pmaal003'
            LET l_vars[03] = g_pmaa_m.pmaal006
            LET l_fields[03] = 'pmaal006'
            LET l_vars[04] = g_pmaa_m.pmaal005
            LET l_fields[04] = 'pmaal005'
            CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'pmaal_t')
         END IF 
 
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmaa_t_mask_restore('restore_mask_n')
               
               #修改歷程記錄(單頭修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後 name="input.head.a_update"
               IF NOT cl_null(g_pmaa_m.pmaa027) THEN
                  LET g_pmaa027_d = g_pmaa_m.pmaa027
                  CALL aooi350_01_b_fill(g_pmaa027_d)
                  CALL aooi350_02_b_fill(g_pmaa027_d)
               END IF                                                                       
               #end add-point
            END IF
            
            LET g_master_commit = "Y"
            LET g_pmaa001_t = g_pmaa_m.pmaa001
 
            
      END INPUT
   
 
{</section>}
 
{<section id="apmm801.input.body" >}
   
      #Page1 預設值產生於此處
      INPUT ARRAY g_pmag_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                  INSERT ROW = l_allow_insert, 
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'1',"))
            END IF
            LET g_loc = 'm'
            LET g_rec_b = g_pmag_d.getLength()
            #add-point:資料輸入前 name="input.d.before_input"
#mask by zn 
#            IF l_cmd_pmag <> 'a' THEN
#               CALL cl_get_para(g_enterprise,"",'E-CIR-0016') RETURNING l_para_data 
#               IF l_para_data = 'Y' THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = 'apm-00408'
#                  LET g_errparam.extend = ''
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#                  
#                  NEXT FIELD pmaa001
#               END IF
#            END IF                             
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2 name="input.body.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_detail_idx_list[1] = l_ac
            LET g_current_page = 1
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag_d[l_ac].pmag002 IS NOT NULL
               AND g_pmag_d[l_ac].pmag003 IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_pmag_d_t.* = g_pmag_d[l_ac].*  #BACKUP
               LET g_pmag_d_o.* = g_pmag_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmag_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl INTO g_pmag_d[l_ac].pmag002,g_pmag_d[l_ac].pmag003,g_pmag_d[l_ac].pmag004, 
                      g_pmag_d[l_ac].pmag007,g_pmag_d[l_ac].pmag008,g_pmag_d[l_ac].pmagstus
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_pmag_d_t.pmag002,":",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag_d_mask_o[l_ac].* =  g_pmag_d[l_ac].*
                  CALL apmm801_pmag_t_mask()
                  LET g_pmag_d_mask_n[l_ac].* =  g_pmag_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
        
         BEFORE INSERT  
            
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag_d[l_ac].* TO NULL 
            INITIALIZE g_pmag_d_t.* TO NULL 
            INITIALIZE g_pmag_d_o.* TO NULL 
            #公用欄位給值(單身)
            #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmag_d[l_ac].pmagstus = 'N'
 
 
 
            #自定義預設值
                  LET g_pmag_d[l_ac].pmagstus = "Y"
 
            #add-point:modify段before備份 name="input.body.insert.before_bak"
            
            #end add-point
            LET g_pmag_d_t.* = g_pmag_d[l_ac].*     #新輸入資料
            LET g_pmag_d_o.* = g_pmag_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag_d[li_reproduce_target].* = g_pmag_d[li_reproduce].*
 
               LET g_pmag_d[li_reproduce_target].pmag002 = NULL
               LET g_pmag_d[li_reproduce_target].pmag003 = NULL
 
            END IF
            
 
            #add-point:modify段before insert name="input.body.before_insert"
                                                                        
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增 name="input.body.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmag_t 
             WHERE pmagent = g_enterprise AND pmag001 = g_pmaa_m.pmaa001
 
               AND pmag002 = g_pmag_d[l_ac].pmag002
               AND pmag003 = g_pmag_d[l_ac].pmag003
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前 name="input.body.b_insert"
                                                                                          
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag_d[g_detail_idx].pmag002
               LET gs_keys[3] = g_pmag_d[g_detail_idx].pmag003
               CALL apmm801_insert_b('pmag_t',gs_keys,"'1'")
                           
               #add-point:單身新增後 name="input.body.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert name="input.body.a_insert2"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身刪除後(=d) name="input.body.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前 name="input.body.b_delete"
                                                                                          
               #end add-point 
               
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
 
               LET gs_keys[gs_keys.getLength()+1] = g_pmag_d_t.pmag002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag_d_t.pmag003
 
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmag_t',gs_keys,"'1'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmag_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身刪除中 name="input.body.m_delete"
                                                                                          
               #end add-point 
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
            
               LET g_rec_b = g_rec_b-1
               #add-point:單身刪除後 name="input.body.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body.after_delete"
                                                                        
               #end add-point
            END IF
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag002
            
            #add-point:AFTER FIELD pmag002 name="input.a.page1.pmag002"
                                                                                    #此段落由子樣板a05產生
            LET g_pmag_d[l_ac].pmag002_desc = ' '
            IF g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag_d[l_ac].pmag002 IS NOT NULL AND g_pmag_d[l_ac].pmag003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag_d[l_ac].pmag002 != g_pmag_d_t.pmag002 OR g_pmag_d[l_ac].pmag003 != g_pmag_d_t.pmag003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmag_t WHERE "||"pmagent = '" ||g_enterprise|| "' AND "||"pmag001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmag002 = '"||g_pmag_d[g_detail_idx].pmag002 ||"' AND "|| "pmag003 = '"||g_pmag_d[g_detail_idx].pmag003 ||"'",'std-00004',0) THEN 
                     LET g_pmag_d[l_ac].pmag002 = g_pmag_d_t.pmag002
                     CALL apmm801_pmag002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag_d[l_ac].pmag002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag_d[l_ac].pmag002 != g_pmag_d_t.pmag002 OR g_pmag_d_t.pmag002 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2036',g_pmag_d[l_ac].pmag002) THEN
                     LET g_pmag_d[l_ac].pmag002 = g_pmag_d_t.pmag002
                     CALL apmm801_pmag002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmag002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag002
            #add-point:BEFORE FIELD pmag002 name="input.b.page1.pmag002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmag002
            #add-point:ON CHANGE pmag002 name="input.g.page1.pmag002"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag003
            #add-point:BEFORE FIELD pmag003 name="input.b.page1.pmag003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag003
            
            #add-point:AFTER FIELD pmag003 name="input.a.page1.pmag003"
                                                                                    #此段落由子樣板a05產生
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag_d[l_ac].pmag002 IS NOT NULL AND g_pmag_d[l_ac].pmag003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag_d[l_ac].pmag002 != g_pmag_d_t.pmag002 OR g_pmag_d[l_ac].pmag003 != g_pmag_d_t.pmag003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmag_t WHERE "||"pmagent = '" ||g_enterprise|| "' AND "||"pmag001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmag002 = '"||g_pmag_d[l_ac].pmag002 ||"' AND "|| "pmag003 = '"||g_pmag_d[l_ac].pmag003 ||"'",'std-00004',0) THEN 
                     LET g_pmag_d[l_ac].pmag003 = g_pmag_d_t.pmag003 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmag003
            #add-point:ON CHANGE pmag003 name="input.g.page1.pmag003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag004
            #add-point:BEFORE FIELD pmag004 name="input.b.page1.pmag004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag004
            
            #add-point:AFTER FIELD pmag004 name="input.a.page1.pmag004"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmag004
            #add-point:ON CHANGE pmag004 name="input.g.page1.pmag004"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag007
            #add-point:BEFORE FIELD pmag007 name="input.b.page1.pmag007"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag007
            
            #add-point:AFTER FIELD pmag007 name="input.a.page1.pmag007"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmag007
            #add-point:ON CHANGE pmag007 name="input.g.page1.pmag007"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmag008
            #add-point:BEFORE FIELD pmag008 name="input.b.page1.pmag008"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmag008
            
            #add-point:AFTER FIELD pmag008 name="input.a.page1.pmag008"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmag008
            #add-point:ON CHANGE pmag008 name="input.g.page1.pmag008"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmagstus
            #add-point:BEFORE FIELD pmagstus name="input.b.page1.pmagstus"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmagstus
            
            #add-point:AFTER FIELD pmagstus name="input.a.page1.pmagstus"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmagstus
            #add-point:ON CHANGE pmagstus name="input.g.page1.pmagstus"
            
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page1.pmag002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag002
            #add-point:ON ACTION controlp INFIELD pmag002 name="input.c.page1.pmag002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag_d[l_ac].pmag002 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2036"  
            CALL q_oocq002()                                 #呼叫開窗
            LET g_pmag_d[l_ac].pmag002 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag_d[l_ac].pmag002 TO pmag002        #顯示到畫面上
            CALL apmm801_pmag002_ref()
            NEXT FIELD pmag002                               #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page1.pmag003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag003
            #add-point:ON ACTION controlp INFIELD pmag003 name="input.c.page1.pmag003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page1.pmag004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag004
            #add-point:ON ACTION controlp INFIELD pmag004 name="input.c.page1.pmag004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page1.pmag007
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag007
            #add-point:ON ACTION controlp INFIELD pmag007 name="input.c.page1.pmag007"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1.pmag008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmag008
            #add-point:ON ACTION controlp INFIELD pmag008 name="input.c.page1.pmag008"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1.pmagstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmagstus
            #add-point:ON ACTION controlp INFIELD pmagstus name="input.c.page1.pmagstus"
            
            #END add-point
 
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag_d[l_ac].* = g_pmag_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_pmag_d[l_ac].pmag002 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag_d[l_ac].* = g_pmag_d_t.*
            ELSE
            
               #add-point:單身修改前 name="input.body.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
      
               #將遮罩欄位還原
               CALL apmm801_pmag_t_mask_restore('restore_mask_o')
      
               UPDATE pmag_t SET (pmag001,pmag002,pmag003,pmag004,pmag007,pmag008,pmagstus) = (g_pmaa_m.pmaa001, 
                   g_pmag_d[l_ac].pmag002,g_pmag_d[l_ac].pmag003,g_pmag_d[l_ac].pmag004,g_pmag_d[l_ac].pmag007, 
                   g_pmag_d[l_ac].pmag008,g_pmag_d[l_ac].pmagstus)
                WHERE pmagent = g_enterprise AND pmag001 = g_pmaa_m.pmaa001 
 
                  AND pmag002 = g_pmag_d_t.pmag002 #項次   
                  AND pmag003 = g_pmag_d_t.pmag003  
 
                  
               #add-point:單身修改中 name="input.body.m_update"
                                                                                          
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag_d[l_ac].* = g_pmag_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmag_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag_d[l_ac].* = g_pmag_d_t.*  
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()                   
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag_d[g_detail_idx].pmag002
               LET gs_keys_bak[2] = g_pmag_d_t.pmag002
               LET gs_keys[3] = g_pmag_d[g_detail_idx].pmag003
               LET gs_keys_bak[3] = g_pmag_d_t.pmag003
               CALL apmm801_update_b('pmag_t',gs_keys,gs_keys_bak,"'1'")
               END CASE
 
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmag_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT(g_pmag_d[g_detail_idx].pmag002 = g_pmag_d_t.pmag002 
                  AND g_pmag_d[g_detail_idx].pmag003 = g_pmag_d_t.pmag003 
 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
 
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag_d_t.pmag002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag_d_t.pmag003
 
                  CALL apmm801_key_update_b(gs_keys,'pmag_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後 name="input.body.a_update"
                                                                                          
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row name="input.body.after_row"
                                                                        
            #end add-point
            CALL apmm801_unlock_b("pmag_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2 name="input.body.after_row2"
            
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input  name="input.body.after_input"
                                                                        
            #end add-point 
    
         ON ACTION controlo    
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag_d[li_reproduce_target].* = g_pmag_d[li_reproduce].*
 
               LET g_pmag_d[li_reproduce_target].pmag002 = NULL
               LET g_pmag_d[li_reproduce_target].pmag003 = NULL
 
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag_d.getLength()+1
            END IF
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_pmag2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_2)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body2.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag2_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'2',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag2_d.getLength()
            #add-point:資料輸入前 name="input.body2.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag2_d[l_ac].* TO NULL 
            INITIALIZE g_pmag2_d_t.* TO NULL 
            INITIALIZE g_pmag2_d_o.* TO NULL 
            #公用欄位給值(單身2)
            #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmag2_d[l_ac].pmaxstus = 'N'
 
 
 
            #自定義預設值(單身2)
                  LET g_pmag2_d[l_ac].pmaxstus = "Y"
 
            #add-point:modify段before備份 name="input.body2.insert.before_bak"
            
            #end add-point
            LET g_pmag2_d_t.* = g_pmag2_d[l_ac].*     #新輸入資料
            LET g_pmag2_d_o.* = g_pmag2_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body2.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag2_d[li_reproduce_target].* = g_pmag2_d[li_reproduce].*
 
               LET g_pmag2_d[li_reproduce_target].pmax002 = NULL
               LET g_pmag2_d[li_reproduce_target].pmax003 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body2.before_insert"
                                                                        
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body2.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[2] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 2
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag2_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag2_d[l_ac].pmax002 IS NOT NULL
               AND g_pmag2_d[l_ac].pmax003 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag2_d_t.* = g_pmag2_d[l_ac].*  #BACKUP
               LET g_pmag2_d_o.* = g_pmag2_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body2.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmax_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl2 INTO g_pmag2_d[l_ac].pmax002,g_pmag2_d[l_ac].pmax003,g_pmag2_d[l_ac].pmaxstus 
 
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag2_d_mask_o[l_ac].* =  g_pmag2_d[l_ac].*
                  CALL apmm801_pmax_t_mask()
                  LET g_pmag2_d_mask_n[l_ac].* =  g_pmag2_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body2.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body2.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body2.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身2刪除前 name="input.body2.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag2_d_t.pmax002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag2_d_t.pmax003
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmax_t',gs_keys,"'2'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmax_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身2刪除中 name="input.body2.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身2刪除後 name="input.body2.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body2.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag2_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身2新增前 name="input.body2.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmax_t 
             WHERE pmaxent = g_enterprise AND pmax001 = g_pmaa_m.pmaa001
               AND pmax002 = g_pmag2_d[l_ac].pmax002
               AND pmax003 = g_pmag2_d[l_ac].pmax003
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身2新增前 name="input.body2.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag2_d[g_detail_idx].pmax002
               LET gs_keys[3] = g_pmag2_d[g_detail_idx].pmax003
               CALL apmm801_insert_b('pmax_t',gs_keys,"'2'")
                           
               #add-point:單身新增後2 name="input.body2.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body2.after_insert"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag2_d[l_ac].* = g_pmag2_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl2
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag2_d[l_ac].* = g_pmag2_d_t.*
            ELSE
               #add-point:單身page2修改前 name="input.body2.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身2)
               
               #將遮罩欄位還原
               CALL apmm801_pmax_t_mask_restore('restore_mask_o')
                              
               UPDATE pmax_t SET (pmax001,pmax002,pmax003,pmaxstus) = (g_pmaa_m.pmaa001,g_pmag2_d[l_ac].pmax002, 
                   g_pmag2_d[l_ac].pmax003,g_pmag2_d[l_ac].pmaxstus) #自訂欄位頁簽
                WHERE pmaxent = g_enterprise AND pmax001 = g_pmaa_m.pmaa001
                  AND pmax002 = g_pmag2_d_t.pmax002 #項次 
                  AND pmax003 = g_pmag2_d_t.pmax003
                  
               #add-point:單身page2修改中 name="input.body2.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag2_d[l_ac].* = g_pmag2_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmax_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag2_d[l_ac].* = g_pmag2_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag2_d[g_detail_idx].pmax002
               LET gs_keys_bak[2] = g_pmag2_d_t.pmax002
               LET gs_keys[3] = g_pmag2_d[g_detail_idx].pmax003
               LET gs_keys_bak[3] = g_pmag2_d_t.pmax003
               CALL apmm801_update_b('pmax_t',gs_keys,gs_keys_bak,"'2'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmax_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag2_d[g_detail_idx].pmax002 = g_pmag2_d_t.pmax002 
                  AND g_pmag2_d[g_detail_idx].pmax003 = g_pmag2_d_t.pmax003 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag2_d_t.pmax002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag2_d_t.pmax003
                  CALL apmm801_key_update_b(gs_keys,'pmax_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag2_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag2_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page2修改後 name="input.body2.a_update"
                                                                                          
               #end add-point
            END IF
         
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmax002
            
            #add-point:AFTER FIELD pmax002 name="input.a.page2.pmax002"
                                                                                    #此段落由子樣板a05產生
            LET g_pmag2_d[l_ac].pmax002_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag2_d[l_ac].pmax002 IS NOT NULL AND g_pmag2_d[l_ac].pmax003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag2_d[l_ac].pmax002 != g_pmag2_d_t.pmax002 OR g_pmag2_d[l_ac].pmax003 != g_pmag2_d_t.pmax003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmax_t WHERE "||"pmaxent = '" ||g_enterprise|| "' AND "||"pmax001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmax002 = '"||g_pmag2_d[l_ac].pmax002 ||"' AND "|| "pmax003 = '"||g_pmag2_d[l_ac].pmax003 ||"'",'std-00004',0) THEN 
                     LET g_pmag2_d[l_ac].pmax002 = g_pmag2_d_t.pmax002
                     CALL apmm801_pmax002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
           
            IF NOT cl_null(g_pmag2_d[l_ac].pmax002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag2_d[l_ac].pmax002 != g_pmag2_d_t.pmax002 OR g_pmag2_d_t.pmax002 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmag2_d[l_ac].pmax002
                  IF NOT cl_chk_exist("v_rtax001_1") THEN
                     LET g_pmag2_d[l_ac].pmax002 = g_pmag2_d_t.pmax002
                     CALL apmm801_pmax002_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmax002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmax002
            #add-point:BEFORE FIELD pmax002 name="input.b.page2.pmax002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmax002
            #add-point:ON CHANGE pmax002 name="input.g.page2.pmax002"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmax003
            
            #add-point:AFTER FIELD pmax003 name="input.a.page2.pmax003"
                                                                                    #此段落由子樣板a05產生
            LET g_pmag2_d[l_ac].pmax003_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag2_d[l_ac].pmax002 IS NOT NULL AND g_pmag2_d[l_ac].pmax003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag2_d[l_ac].pmax002 != g_pmag2_d_t.pmax002 OR g_pmag2_d[l_ac].pmax003 != g_pmag2_d_t.pmax003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmax_t WHERE "||"pmaxent = '" ||g_enterprise|| "' AND "||"pmax001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmax002 = '"||g_pmag2_d[l_ac].pmax002 ||"' AND "|| "pmax003 = '"||g_pmag2_d[l_ac].pmax003 ||"'",'std-00004',0) THEN 
                     LET g_pmag2_d[l_ac].pmax003 = g_pmag2_d_t.pmax003
                     CALL apmm801_pmax003_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            IF NOT cl_null(g_pmag2_d[l_ac].pmax003) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag2_d[l_ac].pmax003 != g_pmag2_d_t.pmax003 OR g_pmag2_d_t.pmax003 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2002',g_pmag2_d[l_ac].pmax003) THEN
                     LET g_pmag2_d[l_ac].pmax003 = g_pmag2_d_t.pmax003
                     CALL apmm801_pmax003_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmax003_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmax003
            #add-point:BEFORE FIELD pmax003 name="input.b.page2.pmax003"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmax003
            #add-point:ON CHANGE pmax003 name="input.g.page2.pmax003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaxstus
            #add-point:BEFORE FIELD pmaxstus name="input.b.page2.pmaxstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaxstus
            
            #add-point:AFTER FIELD pmaxstus name="input.a.page2.pmaxstus"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaxstus
            #add-point:ON CHANGE pmaxstus name="input.g.page2.pmaxstus"
                                                                        
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page2.pmax002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmax002
            #add-point:ON ACTION controlp INFIELD pmax002 name="input.c.page2.pmax002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag2_d[l_ac].pmax002  #給予default值
            #給予arg
            CALL q_rtax001()                                   #呼叫開窗
            LET g_pmag2_d[l_ac].pmax002 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmag2_d[l_ac].pmax002 TO pmax002         #顯示到畫面上
            CALL apmm801_pmax002_ref()
            NEXT FIELD pmax002                                 #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page2.pmax003
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmax003
            #add-point:ON ACTION controlp INFIELD pmax003 name="input.c.page2.pmax003"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag2_d[l_ac].pmax003 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2002" 
            CALL q_oocq002()                                  #呼叫開窗
            LET g_pmag2_d[l_ac].pmax003 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag2_d[l_ac].pmax003 TO pmax003        #顯示到畫面上
            CALL apmm801_pmax003_ref()
            NEXT FIELD pmax003                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page2.pmaxstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaxstus
            #add-point:ON ACTION controlp INFIELD pmaxstus name="input.c.page2.pmaxstus"
                                                                        
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page2 after_row name="input.body2.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag2_d[l_ac].* = g_pmag2_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl2
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmax_t","'2'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page2 after_row2 name="input.body2.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body2.after_input"
                                                                        
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag2_d[li_reproduce_target].* = g_pmag2_d[li_reproduce].*
 
               LET g_pmag2_d[li_reproduce_target].pmax002 = NULL
               LET g_pmag2_d[li_reproduce_target].pmax003 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag2_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag2_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body3.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag3_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'3',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag3_d.getLength()
            #add-point:資料輸入前 name="input.body3.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag3_d[l_ac].* TO NULL 
            INITIALIZE g_pmag3_d_t.* TO NULL 
            INITIALIZE g_pmag3_d_o.* TO NULL 
            #公用欄位給值(單身3)
            
            #自定義預設值(單身3)
            
            #add-point:modify段before備份 name="input.body3.insert.before_bak"
            
            #end add-point
            LET g_pmag3_d_t.* = g_pmag3_d[l_ac].*     #新輸入資料
            LET g_pmag3_d_o.* = g_pmag3_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body3.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag3_d[li_reproduce_target].* = g_pmag3_d[li_reproduce].*
 
               LET g_pmag3_d[li_reproduce_target].pmay002 = NULL
               LET g_pmag3_d[li_reproduce_target].pmay003 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body3.before_insert"
                                                                        
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body3.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[3] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 3
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag3_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag3_d[l_ac].pmay002 IS NOT NULL
               AND g_pmag3_d[l_ac].pmay003 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag3_d_t.* = g_pmag3_d[l_ac].*  #BACKUP
               LET g_pmag3_d_o.* = g_pmag3_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body3.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmay_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl3 INTO g_pmag3_d[l_ac].pmay002,g_pmag3_d[l_ac].pmay003,g_pmag3_d[l_ac].pmay004, 
                      g_pmag3_d[l_ac].pmay005
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag3_d_mask_o[l_ac].* =  g_pmag3_d[l_ac].*
                  CALL apmm801_pmay_t_mask()
                  LET g_pmag3_d_mask_n[l_ac].* =  g_pmag3_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body3.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body3.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body3.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前 name="input.body3.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag3_d_t.pmay002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag3_d_t.pmay003
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmay_t',gs_keys,"'3'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmay_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身3刪除中 name="input.body3.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身3刪除後 name="input.body3.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body3.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag3_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身3新增前 name="input.body3.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmay_t 
             WHERE pmayent = g_enterprise AND pmay001 = g_pmaa_m.pmaa001
               AND pmay002 = g_pmag3_d[l_ac].pmay002
               AND pmay003 = g_pmag3_d[l_ac].pmay003
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前 name="input.body3.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag3_d[g_detail_idx].pmay002
               LET gs_keys[3] = g_pmag3_d[g_detail_idx].pmay003
               CALL apmm801_insert_b('pmay_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3 name="input.body3.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body3.after_insert"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag3_d[l_ac].* = g_pmag3_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl3
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag3_d[l_ac].* = g_pmag3_d_t.*
            ELSE
               #add-point:單身page3修改前 name="input.body3.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               #將遮罩欄位還原
               CALL apmm801_pmay_t_mask_restore('restore_mask_o')
                              
               UPDATE pmay_t SET (pmay001,pmay002,pmay003,pmay004,pmay005) = (g_pmaa_m.pmaa001,g_pmag3_d[l_ac].pmay002, 
                   g_pmag3_d[l_ac].pmay003,g_pmag3_d[l_ac].pmay004,g_pmag3_d[l_ac].pmay005) #自訂欄位頁簽 
 
                WHERE pmayent = g_enterprise AND pmay001 = g_pmaa_m.pmaa001
                  AND pmay002 = g_pmag3_d_t.pmay002 #項次 
                  AND pmay003 = g_pmag3_d_t.pmay003
                  
               #add-point:單身page3修改中 name="input.body3.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag3_d[l_ac].* = g_pmag3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmay_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag3_d[l_ac].* = g_pmag3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag3_d[g_detail_idx].pmay002
               LET gs_keys_bak[2] = g_pmag3_d_t.pmay002
               LET gs_keys[3] = g_pmag3_d[g_detail_idx].pmay003
               LET gs_keys_bak[3] = g_pmag3_d_t.pmay003
               CALL apmm801_update_b('pmay_t',gs_keys,gs_keys_bak,"'3'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmay_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag3_d[g_detail_idx].pmay002 = g_pmag3_d_t.pmay002 
                  AND g_pmag3_d[g_detail_idx].pmay003 = g_pmag3_d_t.pmay003 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag3_d_t.pmay002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag3_d_t.pmay003
                  CALL apmm801_key_update_b(gs_keys,'pmay_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag3_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag3_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page3修改後 name="input.body3.a_update"
                                                                                          
               #end add-point
            END IF
         
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay002
            
            #add-point:AFTER FIELD pmay002 name="input.a.page3.pmay002"
                                                                                    #此段落由子樣板a05產生
            LET g_pmag3_d[l_ac].pmay002_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag3_d[l_ac].pmay002 IS NOT NULL AND g_pmag3_d[l_ac].pmay003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag3_d[l_ac].pmay002 != g_pmag3_d_t.pmay002 OR g_pmag3_d[l_ac].pmay003 != g_pmag3_d_t.pmay003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmay_t WHERE "||"pmayent = '" ||g_enterprise|| "' AND "||"pmay001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmay002 = '"||g_pmag3_d[l_ac].pmay002 ||"' AND "|| "pmay003 = '"||g_pmag3_d[l_ac].pmay003 ||"'",'std-00004',0) THEN 
                     LET g_pmag3_d[l_ac].pmay002 = g_pmag3_d_t.pmay002
                     CALL apmm801_pmay002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
           
            IF NOT cl_null(g_pmag3_d[l_ac].pmay002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag3_d[l_ac].pmay002 != g_pmag3_d_t.pmay002 OR g_pmag3_d_t.pmay002 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2073',g_pmag3_d[l_ac].pmay002) THEN
                     LET g_pmag3_d[l_ac].pmay002 = g_pmag3_d_t.pmay002
                     CALL apmm801_pmay002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmay002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay002
            #add-point:BEFORE FIELD pmay002 name="input.b.page3.pmay002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmay002
            #add-point:ON CHANGE pmay002 name="input.g.page3.pmay002"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay003
            
            #add-point:AFTER FIELD pmay003 name="input.a.page3.pmay003"
            LET g_pmag3_d[l_ac].pmay003_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag3_d[l_ac].pmay002 IS NOT NULL AND g_pmag3_d[l_ac].pmay003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag3_d[l_ac].pmay002 != g_pmag3_d_t.pmay002 OR g_pmag3_d[l_ac].pmay003 != g_pmag3_d_t.pmay003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmay_t WHERE "||"pmayent = '" ||g_enterprise|| "' AND "||"pmay001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmay002 = '"||g_pmag3_d[l_ac].pmay002 ||"' AND "|| "pmay003 = '"||g_pmag3_d[l_ac].pmay003 ||"'",'std-00004',0) THEN 
                     LET g_pmag3_d[l_ac].pmay003 = g_pmag3_d_t.pmay003
                     CALL s_desc_get_oojdl003_desc(g_pmag3_d[l_ac].pmay003) RETURNING g_pmag3_d[l_ac].pmay003_desc
                     DISPLAY BY NAME g_pmag3_d[l_ac].pmay003_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag3_d[l_ac].pmay003) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag3_d[l_ac].pmay003 != g_pmag3_d_t.pmay003 OR g_pmag3_d_t.pmay003 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmag3_d[l_ac].pmay003
                  LET g_chkparam.arg2 = '1'
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     LET g_pmag3_d[l_ac].pmay003 = g_pmag3_d_t.pmay003
                     CALL s_desc_get_oojdl003_desc(g_pmag3_d[l_ac].pmay003) RETURNING g_pmag3_d[l_ac].pmay003_desc
                     DISPLAY BY NAME g_pmag3_d[l_ac].pmay003_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_oojdl003_desc(g_pmag3_d[l_ac].pmay003) RETURNING g_pmag3_d[l_ac].pmay003_desc
            DISPLAY BY NAME g_pmag3_d[l_ac].pmay003_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay003
            #add-point:BEFORE FIELD pmay003 name="input.b.page3.pmay003"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmay003
            #add-point:ON CHANGE pmay003 name="input.g.page3.pmay003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay003_desc
            #add-point:BEFORE FIELD pmay003_desc name="input.b.page3.pmay003_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay003_desc
            
            #add-point:AFTER FIELD pmay003_desc name="input.a.page3.pmay003_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmay003_desc
            #add-point:ON CHANGE pmay003_desc name="input.g.page3.pmay003_desc"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay004
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmag3_d[l_ac].pmay004,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmay004
            END IF 
 
 
 
            #add-point:AFTER FIELD pmay004 name="input.a.page3.pmay004"
                                                                                    IF NOT cl_null(g_pmag3_d[l_ac].pmay004) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay004
            #add-point:BEFORE FIELD pmay004 name="input.b.page3.pmay004"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmay004
            #add-point:ON CHANGE pmay004 name="input.g.page3.pmay004"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmay005
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmag3_d[l_ac].pmay005,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmay005
            END IF 
 
 
 
            #add-point:AFTER FIELD pmay005 name="input.a.page3.pmay005"
                                                                                    IF NOT cl_null(g_pmag3_d[l_ac].pmay005) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmay005
            #add-point:BEFORE FIELD pmay005 name="input.b.page3.pmay005"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmay005
            #add-point:ON CHANGE pmay005 name="input.g.page3.pmay005"
                                                                        
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page3.pmay002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay002
            #add-point:ON ACTION controlp INFIELD pmay002 name="input.c.page3.pmay002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag3_d[l_ac].pmay002  #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2073" 
            CALL q_oocq002()                                   #呼叫開窗
            LET g_pmag3_d[l_ac].pmay002 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmag3_d[l_ac].pmay002 TO pmay002         #顯示到畫面上
            CALL apmm801_pmay002_ref()
            NEXT FIELD pmay002                                 #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page3.pmay003
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay003
            #add-point:ON ACTION controlp INFIELD pmay003 name="input.c.page3.pmay003"
            #此段落由子樣板a07產生            
            #開窗i段
		      INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag3_d[l_ac].pmay003 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "1" 
            CALL q_oojd001_1()                                  #呼叫開窗
            LET g_pmag3_d[l_ac].pmay003 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag3_d[l_ac].pmay003 TO pmay003        #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmag3_d[l_ac].pmay003) RETURNING g_pmag3_d[l_ac].pmay003_desc
            DISPLAY BY NAME g_pmag3_d[l_ac].pmay003_desc
            NEXT FIELD pmay003                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page3.pmay003_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay003_desc
            #add-point:ON ACTION controlp INFIELD pmay003_desc name="input.c.page3.pmay003_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page3.pmay004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay004
            #add-point:ON ACTION controlp INFIELD pmay004 name="input.c.page3.pmay004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page3.pmay005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmay005
            #add-point:ON ACTION controlp INFIELD pmay005 name="input.c.page3.pmay005"
                                                                        
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page3 after_row name="input.body3.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag3_d[l_ac].* = g_pmag3_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl3
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmay_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page3 after_row2 name="input.body3.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body3.after_input"
                                                                        
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag3_d[li_reproduce_target].* = g_pmag3_d[li_reproduce].*
 
               LET g_pmag3_d[li_reproduce_target].pmay002 = NULL
               LET g_pmag3_d[li_reproduce_target].pmay003 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag3_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag3_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_4)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body4.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag4_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'4',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag4_d.getLength()
            #add-point:資料輸入前 name="input.body4.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag4_d[l_ac].* TO NULL 
            INITIALIZE g_pmag4_d_t.* TO NULL 
            INITIALIZE g_pmag4_d_o.* TO NULL 
            #公用欄位給值(單身4)
            
            #自定義預設值(單身4)
            
            #add-point:modify段before備份 name="input.body4.insert.before_bak"
            
            #end add-point
            LET g_pmag4_d_t.* = g_pmag4_d[l_ac].*     #新輸入資料
            LET g_pmag4_d_o.* = g_pmag4_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body4.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag4_d[li_reproduce_target].* = g_pmag4_d[li_reproduce].*
 
               LET g_pmag4_d[li_reproduce_target].pmaz002 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body4.before_insert"
                                                                        
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body4.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[4] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 4
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag4_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag4_d[l_ac].pmaz002 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag4_d_t.* = g_pmag4_d[l_ac].*  #BACKUP
               LET g_pmag4_d_o.* = g_pmag4_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body4.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmaz_t","'4'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl4 INTO g_pmag4_d[l_ac].pmaz002,g_pmag4_d[l_ac].pmaz003
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag4_d_mask_o[l_ac].* =  g_pmag4_d[l_ac].*
                  CALL apmm801_pmaz_t_mask()
                  LET g_pmag4_d_mask_n[l_ac].* =  g_pmag4_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body4.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body4.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body4.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身4刪除前 name="input.body4.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag4_d_t.pmaz002
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmaz_t',gs_keys,"'4'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmaz_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身4刪除中 name="input.body4.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身4刪除後 name="input.body4.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body4.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag4_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身4新增前 name="input.body4.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmaz_t 
             WHERE pmazent = g_enterprise AND pmaz001 = g_pmaa_m.pmaa001
               AND pmaz002 = g_pmag4_d[l_ac].pmaz002
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身4新增前 name="input.body4.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag4_d[g_detail_idx].pmaz002
               CALL apmm801_insert_b('pmaz_t',gs_keys,"'4'")
                           
               #add-point:單身新增後4 name="input.body4.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body4.after_insert"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag4_d[l_ac].* = g_pmag4_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl4
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag4_d[l_ac].* = g_pmag4_d_t.*
            ELSE
               #add-point:單身page4修改前 name="input.body4.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身4)
               
               
               #將遮罩欄位還原
               CALL apmm801_pmaz_t_mask_restore('restore_mask_o')
                              
               UPDATE pmaz_t SET (pmaz001,pmaz002,pmaz003) = (g_pmaa_m.pmaa001,g_pmag4_d[l_ac].pmaz002, 
                   g_pmag4_d[l_ac].pmaz003) #自訂欄位頁簽
                WHERE pmazent = g_enterprise AND pmaz001 = g_pmaa_m.pmaa001
                  AND pmaz002 = g_pmag4_d_t.pmaz002 #項次 
                  
               #add-point:單身page4修改中 name="input.body4.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag4_d[l_ac].* = g_pmag4_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmaz_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag4_d[l_ac].* = g_pmag4_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag4_d[g_detail_idx].pmaz002
               LET gs_keys_bak[2] = g_pmag4_d_t.pmaz002
               CALL apmm801_update_b('pmaz_t',gs_keys,gs_keys_bak,"'4'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmaz_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag4_d[g_detail_idx].pmaz002 = g_pmag4_d_t.pmaz002 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag4_d_t.pmaz002
                  CALL apmm801_key_update_b(gs_keys,'pmaz_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag4_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag4_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page4修改後 name="input.body4.a_update"
                                                                                          
               #end add-point
            END IF
         
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaz002
            
            #add-point:AFTER FIELD pmaz002 name="input.a.page4.pmaz002"
                                                                                    LET g_pmag4_d[l_ac].pmaz002_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag4_d[l_ac].pmaz002 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag4_d[l_ac].pmaz002 != g_pmag4_d_t.pmaz002)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmaz_t WHERE "||"pmazent = '" ||g_enterprise|| "' AND "||"pmaz001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmaz002 = '"||g_pmag4_d[l_ac].pmaz002 ||"'",'std-00004',0) THEN 
                     LET g_pmag4_d[l_ac].pmaz002 = g_pmag4_d_t.pmaz002 
                     CALL apmm801_pmaz002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
           
            IF NOT cl_null(g_pmag4_d[l_ac].pmaz002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag4_d[l_ac].pmaz002 != g_pmag4_d_t.pmaz002 OR g_pmag4_d_t.pmaz002 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('2074',g_pmag4_d[l_ac].pmaz002) THEN
                     LET g_pmag4_d[l_ac].pmaz002 = g_pmag4_d_t.pmaz002
                     CALL apmm801_pmaz002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL apmm801_pmaz002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaz002
            #add-point:BEFORE FIELD pmaz002 name="input.b.page4.pmaz002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaz002
            #add-point:ON CHANGE pmaz002 name="input.g.page4.pmaz002"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaz003
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_pmag4_d[l_ac].pmaz003,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaz003
            END IF 
 
 
 
            #add-point:AFTER FIELD pmaz003 name="input.a.page4.pmaz003"
                                                                                    IF NOT cl_null(g_pmag4_d[l_ac].pmaz003) THEN 
            END IF 

            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaz003
            #add-point:BEFORE FIELD pmaz003 name="input.b.page4.pmaz003"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaz003
            #add-point:ON CHANGE pmaz003 name="input.g.page4.pmaz003"
                                                                        
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page4.pmaz002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaz002
            #add-point:ON ACTION controlp INFIELD pmaz002 name="input.c.page4.pmaz002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag4_d[l_ac].pmaz002 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "2074" 
            CALL q_oocq002()                                  #呼叫開窗
            LET g_pmag4_d[l_ac].pmaz002 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag4_d[l_ac].pmaz002 TO pmaz002        #顯示到畫面上
            CALL apmm801_pmaz002_ref()
            NEXT FIELD pmaz002                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page4.pmaz003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaz003
            #add-point:ON ACTION controlp INFIELD pmaz003 name="input.c.page4.pmaz003"
                                                                        
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page4 after_row name="input.body4.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag4_d[l_ac].* = g_pmag4_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl4
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmaz_t","'4'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page4 after_row2 name="input.body4.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body4.after_input"
                                                                        
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag4_d[li_reproduce_target].* = g_pmag4_d[li_reproduce].*
 
               LET g_pmag4_d[li_reproduce_target].pmaz002 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag4_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag4_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag5_d FROM s_detail5.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_5)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body5.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag5_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'5',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag5_d.getLength()
            #add-point:資料輸入前 name="input.body5.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag5_d[l_ac].* TO NULL 
            INITIALIZE g_pmag5_d_t.* TO NULL 
            INITIALIZE g_pmag5_d_o.* TO NULL 
            #公用欄位給值(單身5)
            #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmag5_d[l_ac].pmacstus = 'N'
 
 
 
            #自定義預設值(單身5)
                  LET g_pmag5_d[l_ac].pmacstus = "Y"
      LET g_pmag5_d[l_ac].pmac003 = "1"
      LET g_pmag5_d[l_ac].pmac004 = "N"
 
            #add-point:modify段before備份 name="input.body5.insert.before_bak"
 
            #end add-point
            LET g_pmag5_d_t.* = g_pmag5_d[l_ac].*     #新輸入資料
            LET g_pmag5_d_o.* = g_pmag5_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body5.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag5_d[li_reproduce_target].* = g_pmag5_d[li_reproduce].*
 
               LET g_pmag5_d[li_reproduce_target].pmac002 = NULL
               LET g_pmag5_d[li_reproduce_target].pmac003 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body5.before_insert"
                                                                        
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body5.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[5] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 5
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag5_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag5_d[l_ac].pmac002 IS NOT NULL
               AND g_pmag5_d[l_ac].pmac003 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag5_d_t.* = g_pmag5_d[l_ac].*  #BACKUP
               LET g_pmag5_d_o.* = g_pmag5_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body5.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmac_t","'5'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl5 INTO g_pmag5_d[l_ac].pmacstus,g_pmag5_d[l_ac].pmac003,g_pmag5_d[l_ac].pmac004, 
                      g_pmag5_d[l_ac].pmac002
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag5_d_mask_o[l_ac].* =  g_pmag5_d[l_ac].*
                  CALL apmm801_pmac_t_mask()
                  LET g_pmag5_d_mask_n[l_ac].* =  g_pmag5_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body5.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body5.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body5.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身5刪除前 name="input.body5.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag5_d_t.pmac002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag5_d_t.pmac003
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmac_t',gs_keys,"'5'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmac_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身5刪除中 name="input.body5.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身5刪除後 name="input.body5.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body5.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag5_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身5新增前 name="input.body5.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmac_t 
             WHERE pmacent = g_enterprise AND pmac001 = g_pmaa_m.pmaa001
               AND pmac002 = g_pmag5_d[l_ac].pmac002
               AND pmac003 = g_pmag5_d[l_ac].pmac003
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身5新增前 name="input.body5.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag5_d[g_detail_idx].pmac002
               LET gs_keys[3] = g_pmag5_d[g_detail_idx].pmac003
               CALL apmm801_insert_b('pmac_t',gs_keys,"'5'")
                           
               #add-point:單身新增後5 name="input.body5.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body5.after_insert"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag5_d[l_ac].* = g_pmag5_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl5
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag5_d[l_ac].* = g_pmag5_d_t.*
            ELSE
               #add-point:單身page5修改前 name="input.body5.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身5)
               
               #將遮罩欄位還原
               CALL apmm801_pmac_t_mask_restore('restore_mask_o')
                              
               UPDATE pmac_t SET (pmac001,pmacstus,pmac003,pmac004,pmac002) = (g_pmaa_m.pmaa001,g_pmag5_d[l_ac].pmacstus, 
                   g_pmag5_d[l_ac].pmac003,g_pmag5_d[l_ac].pmac004,g_pmag5_d[l_ac].pmac002) #自訂欄位頁簽 
 
                WHERE pmacent = g_enterprise AND pmac001 = g_pmaa_m.pmaa001
                  AND pmac002 = g_pmag5_d_t.pmac002 #項次 
                  AND pmac003 = g_pmag5_d_t.pmac003
                  
               #add-point:單身page5修改中 name="input.body5.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag5_d[l_ac].* = g_pmag5_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmac_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag5_d[l_ac].* = g_pmag5_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag5_d[g_detail_idx].pmac002
               LET gs_keys_bak[2] = g_pmag5_d_t.pmac002
               LET gs_keys[3] = g_pmag5_d[g_detail_idx].pmac003
               LET gs_keys_bak[3] = g_pmag5_d_t.pmac003
               CALL apmm801_update_b('pmac_t',gs_keys,gs_keys_bak,"'5'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmac_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag5_d[g_detail_idx].pmac002 = g_pmag5_d_t.pmac002 
                  AND g_pmag5_d[g_detail_idx].pmac003 = g_pmag5_d_t.pmac003 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag5_d_t.pmac002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag5_d_t.pmac003
                  CALL apmm801_key_update_b(gs_keys,'pmac_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag5_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag5_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page5修改後 name="input.body5.a_update"
                                                                                          
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmacstus
            #add-point:BEFORE FIELD pmacstus name="input.b.page5.pmacstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmacstus
            
            #add-point:AFTER FIELD pmacstus name="input.a.page5.pmacstus"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmacstus
            #add-point:ON CHANGE pmacstus name="input.g.page5.pmacstus"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac003
            #add-point:BEFORE FIELD pmac003 name="input.b.page5.pmac003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac003
            
            #add-point:AFTER FIELD pmac003 name="input.a.page5.pmac003"
                                                                                    IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag5_d[l_ac].pmac002 IS NOT NULL AND g_pmag5_d[l_ac].pmac003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag5_d[l_ac].pmac002 != g_pmag5_d_t.pmac002 OR g_pmag5_d[l_ac].pmac003 != g_pmag5_d_t.pmac003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmac_t WHERE "||"pmacent = '" ||g_enterprise|| "' AND "||"pmac001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmac002 = '"||g_pmag5_d[l_ac].pmac002 ||"' AND "|| "pmac003 = '"||g_pmag5_d[l_ac].pmac003 ||"'",'std-00004',0) THEN 
                     LET g_pmag5_d[l_ac].pmac002 = g_pmag5_d_t.pmac002
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmac003
            #add-point:ON CHANGE pmac003 name="input.g.page5.pmac003"
                                                                                    IF g_pmag5_d[l_ac].pmac004 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmag5_d_t.pmac002) THEN
                  SELECT COUNT(*) INTO l_cnt FROM pmac_t
                   WHERE pmac001 = g_pmaa_m.pmaa001
                     AND pmacent = g_enterprise
                     AND pmac004 = 'Y'
                     AND pmac003 = g_pmag5_d[l_ac].pmac003
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmac_t
                   WHERE pmac001 = g_pmaa_m.pmaa001
                     AND pmacent = g_enterprise
                     AND pmac003 = g_pmag5_d[l_ac].pmac003
                     AND pmac004 = 'Y'
                     AND pmac002 != g_pmag5_d_t.pmac002
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00306'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag5_d[l_ac].pmac003 = g_pmag5_d_t.pmac003
                  NEXT FIELD CURRENT
               END IF
            END IF
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac004
            #add-point:BEFORE FIELD pmac004 name="input.b.page5.pmac004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac004
            
            #add-point:AFTER FIELD pmac004 name="input.a.page5.pmac004"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmac004
            #add-point:ON CHANGE pmac004 name="input.g.page5.pmac004"
                                                                                    IF g_pmag5_d[l_ac].pmac004 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmag5_d_t.pmac002) THEN
                  SELECT COUNT(*) INTO l_cnt FROM pmac_t
                   WHERE pmac001 = g_pmaa_m.pmaa001
                     AND pmacent = g_enterprise
                     AND pmac004 = 'Y'
                     AND pmac003 = g_pmag5_d[l_ac].pmac003
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmac_t
                   WHERE pmac001 = g_pmaa_m.pmaa001
                     AND pmacent = g_enterprise
                     AND pmac003 = g_pmag5_d[l_ac].pmac003
                     AND pmac004 = 'Y'
                     AND pmac002 != g_pmag5_d_t.pmac002
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00306'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag5_d[l_ac].pmac004 = g_pmag5_d_t.pmac004
                  NEXT FIELD CURRENT
               END IF
            END IF
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmac002
            
            #add-point:AFTER FIELD pmac002 name="input.a.page5.pmac002"
                                                                                    #此段落由子樣板a05產生
            LET g_pmag5_d[l_ac].pmac002_desc = ' '
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag5_d[l_ac].pmac002 IS NOT NULL AND g_pmag5_d[l_ac].pmac003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag5_d[l_ac].pmac002 != g_pmag5_d_t.pmac002 OR g_pmag5_d[l_ac].pmac003 != g_pmag5_d_t.pmac003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmac_t WHERE "||"pmacent = '" ||g_enterprise|| "' AND "||"pmac001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmac002 = '"||g_pmag5_d[l_ac].pmac002 ||"' AND "|| "pmac003 = '"||g_pmag5_d[l_ac].pmac003 ||"'",'std-00004',0) THEN 
                     LET g_pmag5_d[l_ac].pmac003 = g_pmag5_d_t.pmac003
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag5_d[l_ac].pmac002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag5_d[l_ac].pmac002 != g_pmag5_d_t.pmac002 OR g_pmag5_d_t.pmac002 IS NULL )) THEN
                  IF g_pmag5_d[l_ac].pmac002 <> g_pmaa_m.pmaa001 THEN   #ken 需求單號：141224-00013 項次：8
                     INITIALIZE g_chkparam.* TO NULL
                     #ken---add---s 需求單號：141224-00013 項次：8
#                     CASE g_argv[1]
#                        WHEN '1' 
#                           LET l_msg = cl_getmsg('apm-00761',g_dlang)
#                           LET g_chkparam.err_str[1]="apm-00028:apm-00759|",l_msg
#                           LET g_chkparam.err_str[2]="apm-00044:apm-00760|",l_msg
#                        WHEN '2' 
#                           LET l_msg = cl_getmsg('apm-00762',g_dlang)
#                           LET g_chkparam.err_str[1]="apm-00028:apm-00759|",l_msg
#                           LET g_chkparam.err_str[2]="apm-00044:apm-00760|",l_msg
#                        WHEN '3'
#                           LET l_msg = cl_getmsg('apm-00763',g_dlang)
#                           LET g_chkparam.err_str[1]="apm-00028:apm-00759|",l_msg
#                           LET g_chkparam.err_str[2]="apm-00044:apm-00760|",l_msg
#                     END CASE       
                     #ken---add---e   
                     LET g_chkparam.arg1 = g_pmag5_d[l_ac].pmac002
                     #160318-00025#24  by 07900 --add-str
                     LET g_errshow = TRUE #是否開窗                   
                     LET g_chkparam.err_str[1] ="apm-00044:sub-01302|apmm100|",cl_get_progname("apmm100",g_lang,"2"),"|:EXEPROGapm100"
                     #160318-00025#24  by 07900 --add-end
                     IF NOT cl_chk_exist("v_pmaa001_2") THEN
                        LET g_pmag5_d[l_ac].pmac002 = g_pmag5_d_t.pmac002
                        CALL apmm801_pmac002_ref()
                        NEXT FIELD CURRENT                  
                     END IF
                  END IF  
               END IF
            END IF
            CALL apmm801_pmac002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmac002
            #add-point:BEFORE FIELD pmac002 name="input.b.page5.pmac002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmac002
            #add-point:ON CHANGE pmac002 name="input.g.page5.pmac002"
                                                                        
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page5.pmacstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmacstus
            #add-point:ON ACTION controlp INFIELD pmacstus name="input.c.page5.pmacstus"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page5.pmac003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac003
            #add-point:ON ACTION controlp INFIELD pmac003 name="input.c.page5.pmac003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page5.pmac004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac004
            #add-point:ON ACTION controlp INFIELD pmac004 name="input.c.page5.pmac004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page5.pmac002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmac002
            #add-point:ON ACTION controlp INFIELD pmac002 name="input.c.page5.pmac002"
                                                                                    #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag5_d[l_ac].pmac002 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "('1','2','3')"
            CALL q_pmaa001_1()                                #呼叫開窗
            LET g_pmag5_d[l_ac].pmac002 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag5_d[l_ac].pmac002 TO pmac002        #顯示到畫面上
            CALL apmm801_pmac002_ref()
            NEXT FIELD pmac002                                #返回原欄位
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page5 after_row name="input.body5.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag5_d[l_ac].* = g_pmag5_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl5
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmac_t","'5'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page5 after_row2 name="input.body5.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body5.after_input"
                                                                        
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag5_d[li_reproduce_target].* = g_pmag5_d[li_reproduce].*
 
               LET g_pmag5_d[li_reproduce_target].pmac002 = NULL
               LET g_pmag5_d[li_reproduce_target].pmac003 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag5_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag5_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag6_d FROM s_detail6.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_6)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body6.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag6_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'6',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag6_d.getLength()
            #add-point:資料輸入前 name="input.body6.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag6_d[l_ac].* TO NULL 
            INITIALIZE g_pmag6_d_t.* TO NULL 
            INITIALIZE g_pmag6_d_o.* TO NULL 
            #公用欄位給值(單身6)
            #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmag6_d[l_ac].pmafstus = 'N'
 
 
 
            #自定義預設值(單身6)
                  LET g_pmag6_d[l_ac].pmafstus = "Y"
      LET g_pmag6_d[l_ac].pmaf008 = "N"
      LET g_pmag6_d[l_ac].pmaf009 = "N"
 
            #add-point:modify段before備份 name="input.body6.insert.before_bak"
            
            #end add-point
            LET g_pmag6_d_t.* = g_pmag6_d[l_ac].*     #新輸入資料
            LET g_pmag6_d_o.* = g_pmag6_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body6.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag6_d[li_reproduce_target].* = g_pmag6_d[li_reproduce].*
 
               LET g_pmag6_d[li_reproduce_target].pmaf002 = NULL
               LET g_pmag6_d[li_reproduce_target].pmaf003 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body6.before_insert"
                                                                                    LET g_pmag6_d_t.* = g_pmag6_d[l_ac].*
            LET g_pmag6_d_o.* = g_pmag6_d[l_ac].*
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body6.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[6] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 6
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag6_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag6_d[l_ac].pmaf002 IS NOT NULL
               AND g_pmag6_d[l_ac].pmaf003 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag6_d_t.* = g_pmag6_d[l_ac].*  #BACKUP
               LET g_pmag6_d_o.* = g_pmag6_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body6.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmaf_t","'6'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl6 INTO g_pmag6_d[l_ac].pmafstus,g_pmag6_d[l_ac].pmaf010,g_pmag6_d[l_ac].pmaf002, 
                      g_pmag6_d[l_ac].pmaf003,g_pmag6_d[l_ac].pmaf004,g_pmag6_d[l_ac].pmaf011,g_pmag6_d[l_ac].pmaf008, 
                      g_pmag6_d[l_ac].pmaf009,g_pmag6_d[l_ac].pmaf005,g_pmag6_d[l_ac].pmaf007,g_pmag6_d[l_ac].pmaf006 
 
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag6_d_mask_o[l_ac].* =  g_pmag6_d[l_ac].*
                  CALL apmm801_pmaf_t_mask()
                  LET g_pmag6_d_mask_n[l_ac].* =  g_pmag6_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body6.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body6.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body6.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身6刪除前 name="input.body6.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag6_d_t.pmaf002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag6_d_t.pmaf003
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmaf_t',gs_keys,"'6'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmaf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身6刪除中 name="input.body6.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身6刪除後 name="input.body6.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body6.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag6_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身6新增前 name="input.body6.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmaf_t 
             WHERE pmafent = g_enterprise AND pmaf001 = g_pmaa_m.pmaa001
               AND pmaf002 = g_pmag6_d[l_ac].pmaf002
               AND pmaf003 = g_pmag6_d[l_ac].pmaf003
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身6新增前 name="input.body6.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag6_d[g_detail_idx].pmaf002
               LET gs_keys[3] = g_pmag6_d[g_detail_idx].pmaf003
               CALL apmm801_insert_b('pmaf_t',gs_keys,"'6'")
                           
               #add-point:單身新增後6 name="input.body6.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body6.after_insert"
                                                                                          
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag6_d[l_ac].* = g_pmag6_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl6
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag6_d[l_ac].* = g_pmag6_d_t.*
            ELSE
               #add-point:單身page6修改前 name="input.body6.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身6)
               
               #將遮罩欄位還原
               CALL apmm801_pmaf_t_mask_restore('restore_mask_o')
                              
               UPDATE pmaf_t SET (pmaf001,pmafstus,pmaf010,pmaf002,pmaf003,pmaf004,pmaf011,pmaf008,pmaf009, 
                   pmaf005,pmaf007,pmaf006) = (g_pmaa_m.pmaa001,g_pmag6_d[l_ac].pmafstus,g_pmag6_d[l_ac].pmaf010, 
                   g_pmag6_d[l_ac].pmaf002,g_pmag6_d[l_ac].pmaf003,g_pmag6_d[l_ac].pmaf004,g_pmag6_d[l_ac].pmaf011, 
                   g_pmag6_d[l_ac].pmaf008,g_pmag6_d[l_ac].pmaf009,g_pmag6_d[l_ac].pmaf005,g_pmag6_d[l_ac].pmaf007, 
                   g_pmag6_d[l_ac].pmaf006) #自訂欄位頁簽
                WHERE pmafent = g_enterprise AND pmaf001 = g_pmaa_m.pmaa001
                  AND pmaf002 = g_pmag6_d_t.pmaf002 #項次 
                  AND pmaf003 = g_pmag6_d_t.pmaf003
                  
               #add-point:單身page6修改中 name="input.body6.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag6_d[l_ac].* = g_pmag6_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmaf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag6_d[l_ac].* = g_pmag6_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag6_d[g_detail_idx].pmaf002
               LET gs_keys_bak[2] = g_pmag6_d_t.pmaf002
               LET gs_keys[3] = g_pmag6_d[g_detail_idx].pmaf003
               LET gs_keys_bak[3] = g_pmag6_d_t.pmaf003
               CALL apmm801_update_b('pmaf_t',gs_keys,gs_keys_bak,"'6'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmaf_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag6_d[g_detail_idx].pmaf002 = g_pmag6_d_t.pmaf002 
                  AND g_pmag6_d[g_detail_idx].pmaf003 = g_pmag6_d_t.pmaf003 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag6_d_t.pmaf002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag6_d_t.pmaf003
                  CALL apmm801_key_update_b(gs_keys,'pmaf_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag6_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag6_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page6修改後 name="input.body6.a_update"
                                                                                          
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmafstus
            #add-point:BEFORE FIELD pmafstus name="input.b.page6.pmafstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmafstus
            
            #add-point:AFTER FIELD pmafstus name="input.a.page6.pmafstus"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmafstus
            #add-point:ON CHANGE pmafstus name="input.g.page6.pmafstus"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf010
            #add-point:BEFORE FIELD pmaf010 name="input.b.page6.pmaf010"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf010
            
            #add-point:AFTER FIELD pmaf010 name="input.a.page6.pmaf010"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf010
            #add-point:ON CHANGE pmaf010 name="input.g.page6.pmaf010"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf002
            
            #add-point:AFTER FIELD pmaf002 name="input.a.page6.pmaf002"
                                                                                    LET g_pmag6_d[l_ac].pmaf002_desc = ' '
            #此段落由子樣板a05產生
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag6_d[l_ac].pmaf002 IS NOT NULL AND g_pmag6_d[l_ac].pmaf003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag6_d[l_ac].pmaf002 != g_pmag6_d_t.pmaf002 OR g_pmag6_d[l_ac].pmaf003 != g_pmag6_d_t.pmaf003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmaf_t WHERE "||"pmafent = '" ||g_enterprise|| "' AND "||"pmaf001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmaf002 = '"||g_pmag6_d[l_ac].pmaf002 ||"' AND "|| "pmaf003 = '"||g_pmag6_d[l_ac].pmaf003 ||"'",'std-00004',0) THEN 
                     LET g_pmag6_d[l_ac].pmaf002 = g_pmag6_d_t.pmaf002
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag6_d[l_ac].pmaf002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag6_d[l_ac].pmaf002 != g_pmag6_d_o.pmaf002 OR g_pmag6_d_o.pmaf002 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmag6_d[l_ac].pmaf002
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="anm-00012:sub-01302|anmi100|",cl_get_progname("anmi100",g_lang,"2"),"|:EXEPROGanmi100"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_nmab001") THEN
                     LET g_pmag6_d[l_ac].pmaf002 = g_pmag6_d_o.pmaf002
                     CALL apmm801_pmaf002_ref()
                     NEXT FIELD CURRENT                  
                  END IF
                  LET g_pmag6_d[l_ac].pmaf005 = ''
                  LET g_pmag6_d[l_ac].pmaf007 = ''
                  SELECT nmab003,nmab009 INTO g_pmag6_d[l_ac].pmaf005,g_pmag6_d[l_ac].pmaf007
                    FROM nmab_t
                   WHERE nmabent = g_enterprise
                     AND nmab001 = g_pmag6_d[l_ac].pmaf002
               END IF
            END IF
            LET g_pmag6_d_o.pmaf002 = g_pmag6_d[l_ac].pmaf002
            CALL apmm801_pmaf002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf002
            #add-point:BEFORE FIELD pmaf002 name="input.b.page6.pmaf002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf002
            #add-point:ON CHANGE pmaf002 name="input.g.page6.pmaf002"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf003
            #add-point:BEFORE FIELD pmaf003 name="input.b.page6.pmaf003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf003
            
            #add-point:AFTER FIELD pmaf003 name="input.a.page6.pmaf003"
                                                                                    #此段落由子樣板a05產生
            #此段落由子樣板a05產生
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag6_d[l_ac].pmaf002 IS NOT NULL AND g_pmag6_d[l_ac].pmaf003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag6_d[l_ac].pmaf002 != g_pmag6_d_t.pmaf002 OR g_pmag6_d[l_ac].pmaf003 != g_pmag6_d_t.pmaf003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmaf_t WHERE "||"pmafent = '" ||g_enterprise|| "' AND "||"pmaf001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmaf002 = '"||g_pmag6_d[l_ac].pmaf002 ||"' AND "|| "pmaf003 = '"||g_pmag6_d[l_ac].pmaf003 ||"'",'std-00004',0) THEN 
                     LET g_pmag6_d[l_ac].pmaf003 = g_pmag6_d_t.pmaf003
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf003
            #add-point:ON CHANGE pmaf003 name="input.g.page6.pmaf003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf004
            #add-point:BEFORE FIELD pmaf004 name="input.b.page6.pmaf004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf004
            
            #add-point:AFTER FIELD pmaf004 name="input.a.page6.pmaf004"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf004
            #add-point:ON CHANGE pmaf004 name="input.g.page6.pmaf004"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf011
            
            #add-point:AFTER FIELD pmaf011 name="input.a.page6.pmaf011"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmag6_d[l_ac].pmaf011
            CALL ap_ref_array2(g_ref_fields,"SELECT mhbel003 FROM mhbel_t WHERE mhbelent='"||g_enterprise||"' AND mhbel001=? AND mhbel002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_pmag6_d[l_ac].pmaf011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmag6_d[l_ac].pmaf011_desc


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf011
            #add-point:BEFORE FIELD pmaf011 name="input.b.page6.pmaf011"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf011
            #add-point:ON CHANGE pmaf011 name="input.g.page6.pmaf011"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf008
            #add-point:BEFORE FIELD pmaf008 name="input.b.page6.pmaf008"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf008
            
            #add-point:AFTER FIELD pmaf008 name="input.a.page6.pmaf008"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf008
            #add-point:ON CHANGE pmaf008 name="input.g.page6.pmaf008"
                                                                                    IF g_pmag6_d[l_ac].pmaf008 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmag6_d_t.pmaf002) AND cl_null(g_pmag6_d_t.pmaf003) THEN
                  SELECT COUNT(*) INTO l_cnt FROM pmaf_t
                   WHERE pmaf001 = g_pmaa_m.pmaa001
                     AND pmafent = g_enterprise
                     AND pmaf008 = 'Y'
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmaf_t
                   WHERE pmaf001 = g_pmaa_m.pmaa001
                     AND pmafent = g_enterprise
                     AND pmaf008 = 'Y'
                     AND pmaf002 != g_pmag6_d_t.pmaf002
                     AND pmaf003 != g_pmag6_d_t.pmaf003
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00307'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag6_d[l_ac].pmaf008 = g_pmag6_d_t.pmaf008
                  NEXT FIELD CURRENT
               END IF
            END IF
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf009
            #add-point:BEFORE FIELD pmaf009 name="input.b.page6.pmaf009"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf009
            
            #add-point:AFTER FIELD pmaf009 name="input.a.page6.pmaf009"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf009
            #add-point:ON CHANGE pmaf009 name="input.g.page6.pmaf009"
                                                                                    IF g_pmag6_d[l_ac].pmaf009 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmag6_d_t.pmaf002) AND cl_null(g_pmag6_d_t.pmaf003) THEN
                  SELECT COUNT(*) INTO l_cnt FROM pmaf_t
                   WHERE pmaf001 = g_pmaa_m.pmaa001
                     AND pmafent = g_enterprise
                     AND pmaf009 = 'Y'
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmaf_t
                   WHERE pmaf001 = g_pmaa_m.pmaa001
                     AND pmafent = g_enterprise
                     AND pmaf009 = 'Y'
                     AND pmaf002 != g_pmag6_d_t.pmaf002
                     AND pmaf003 != g_pmag6_d_t.pmaf003
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00308'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag6_d[l_ac].pmaf009 = g_pmag6_d_t.pmaf009
                  NEXT FIELD CURRENT
               END IF
            END IF
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf005
            #add-point:BEFORE FIELD pmaf005 name="input.b.page6.pmaf005"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf005
            
            #add-point:AFTER FIELD pmaf005 name="input.a.page6.pmaf005"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf005
            #add-point:ON CHANGE pmaf005 name="input.g.page6.pmaf005"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf007
            #add-point:BEFORE FIELD pmaf007 name="input.b.page6.pmaf007"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf007
            
            #add-point:AFTER FIELD pmaf007 name="input.a.page6.pmaf007"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf007
            #add-point:ON CHANGE pmaf007 name="input.g.page6.pmaf007"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmaf006
            #add-point:BEFORE FIELD pmaf006 name="input.b.page6.pmaf006"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmaf006
            
            #add-point:AFTER FIELD pmaf006 name="input.a.page6.pmaf006"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmaf006
            #add-point:ON CHANGE pmaf006 name="input.g.page6.pmaf006"
                                                                        
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page6.pmafstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmafstus
            #add-point:ON ACTION controlp INFIELD pmafstus name="input.c.page6.pmafstus"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf010
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf010
            #add-point:ON ACTION controlp INFIELD pmaf010 name="input.c.page6.pmaf010"
            
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf002
            #add-point:ON ACTION controlp INFIELD pmaf002 name="input.c.page6.pmaf002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag6_d[l_ac].pmaf002 #給予default值
            #給予arg
            CALL q_nmab001()                                  #呼叫開窗
            LET g_pmag6_d[l_ac].pmaf002 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmag6_d[l_ac].pmaf002 TO pmaf002        #顯示到畫面上
            CALL apmm801_pmaf002_ref()
            NEXT FIELD pmaf002                                #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf003
            #add-point:ON ACTION controlp INFIELD pmaf003 name="input.c.page6.pmaf003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf004
            #add-point:ON ACTION controlp INFIELD pmaf004 name="input.c.page6.pmaf004"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf011
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf011
            #add-point:ON ACTION controlp INFIELD pmaf011 name="input.c.page6.pmaf011"
            
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf008
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf008
            #add-point:ON ACTION controlp INFIELD pmaf008 name="input.c.page6.pmaf008"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf009
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf009
            #add-point:ON ACTION controlp INFIELD pmaf009 name="input.c.page6.pmaf009"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf005
            #add-point:ON ACTION controlp INFIELD pmaf005 name="input.c.page6.pmaf005"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf007
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf007
            #add-point:ON ACTION controlp INFIELD pmaf007 name="input.c.page6.pmaf007"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page6.pmaf006
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmaf006
            #add-point:ON ACTION controlp INFIELD pmaf006 name="input.c.page6.pmaf006"
                                                                        
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page6 after_row name="input.body6.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag6_d[l_ac].* = g_pmag6_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl6
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmaf_t","'6'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page6 after_row2 name="input.body6.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body6.after_input"
                                                                        
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag6_d[li_reproduce_target].* = g_pmag6_d[li_reproduce].*
 
               LET g_pmag6_d[li_reproduce_target].pmaf002 = NULL
               LET g_pmag6_d[li_reproduce_target].pmaf003 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag6_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag6_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag7_d FROM s_detail7.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_7)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body7.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag7_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'7',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag7_d.getLength()
            #add-point:資料輸入前 name="input.body7.before_input"
                                                                        
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag7_d[l_ac].* TO NULL 
            INITIALIZE g_pmag7_d_t.* TO NULL 
            INITIALIZE g_pmag7_d_o.* TO NULL 
            #公用欄位給值(單身7)
            #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmag7_d[l_ac].pmadstus = 'N'
 
 
 
            #自定義預設值(單身7)
                  LET g_pmag7_d[l_ac].pmadstus = "Y"
      LET g_pmag7_d[l_ac].pmad004 = "N"
 
            #add-point:modify段before備份 name="input.body7.insert.before_bak"
            
            #end add-point
            LET g_pmag7_d_t.* = g_pmag7_d[l_ac].*     #新輸入資料
            LET g_pmag7_d_o.* = g_pmag7_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body7.insert.after_set_entry_b"
                                                                        
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag7_d[li_reproduce_target].* = g_pmag7_d[li_reproduce].*
 
               LET g_pmag7_d[li_reproduce_target].pmad002 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body7.before_insert"
                                                                                    LET g_pmag7_d[l_ac].pmad003 = '1'
            LET g_pmag7_d_t.* = g_pmag7_d[l_ac].*
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body7.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[7] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 7
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag7_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag7_d[l_ac].pmad002 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag7_d_t.* = g_pmag7_d[l_ac].*  #BACKUP
               LET g_pmag7_d_o.* = g_pmag7_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body7.after_set_entry_b"
                                                                                          
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmad_t","'7'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl7 INTO g_pmag7_d[l_ac].pmad003,g_pmag7_d[l_ac].pmadstus,g_pmag7_d[l_ac].pmad002, 
                      g_pmag7_d[l_ac].pmad004
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag7_d_mask_o[l_ac].* =  g_pmag7_d[l_ac].*
                  CALL apmm801_pmad_t_mask()
                  LET g_pmag7_d_mask_n[l_ac].* =  g_pmag7_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body7.before_row"
                                                                        
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body7.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body7.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身7刪除前 name="input.body7.b_delete"
                                                                                          
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag7_d_t.pmad002
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmad_t',gs_keys,"'7'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmad_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身7刪除中 name="input.body7.m_delete"
                                                                                          
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身7刪除後 name="input.body7.a_delete"
                                                                                                            
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body7.after_delete"
                                                                        
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag7_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身7新增前 name="input.body7.b_a_insert"
                                                                        
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmad_t 
             WHERE pmadent = g_enterprise AND pmad001 = g_pmaa_m.pmaa001
               AND pmad002 = g_pmag7_d[l_ac].pmad002
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身7新增前 name="input.body7.b_insert"
                                                                                          
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag7_d[g_detail_idx].pmad002
               CALL apmm801_insert_b('pmad_t',gs_keys,"'7'")
                           
               #add-point:單身新增後7 name="input.body7.a_insert"
                                                                                          
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body7.after_insert"
               IF g_pmag7_d[l_ac].pmad004 = 'Y' THEN
                  UPDATE pmab_t
                     SET pmab037 = g_pmag7_d[l_ac].pmad002
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  IF SQLCA.SQLcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "upd pmab_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')                    
                     LET g_pmaa_m.pmab037 = g_pmaa_m_o.pmab037
                     DISPLAY BY NAME g_pmaa_m.pmab037
                     CANCEL INSERT
                  END IF
               END IF                                                                         
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl7
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
            ELSE
               #add-point:單身page7修改前 name="input.body7.b_update"
                                                                                          
               #end add-point
               
               #寫入修改者/修改日期資訊(單身7)
               
               #將遮罩欄位還原
               CALL apmm801_pmad_t_mask_restore('restore_mask_o')
                              
               UPDATE pmad_t SET (pmad001,pmad003,pmadstus,pmad002,pmad004) = (g_pmaa_m.pmaa001,g_pmag7_d[l_ac].pmad003, 
                   g_pmag7_d[l_ac].pmadstus,g_pmag7_d[l_ac].pmad002,g_pmag7_d[l_ac].pmad004) #自訂欄位頁簽 
 
                WHERE pmadent = g_enterprise AND pmad001 = g_pmaa_m.pmaa001
                  AND pmad002 = g_pmag7_d_t.pmad002 #項次 
                  
               #add-point:單身page7修改中 name="input.body7.m_update"
                                                                                          
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmad_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag7_d[g_detail_idx].pmad002
               LET gs_keys_bak[2] = g_pmag7_d_t.pmad002
               CALL apmm801_update_b('pmad_t',gs_keys,gs_keys_bak,"'7'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmad_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag7_d[g_detail_idx].pmad002 = g_pmag7_d_t.pmad002 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag7_d_t.pmad002
                  CALL apmm801_key_update_b(gs_keys,'pmad_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag7_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag7_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page7修改後 name="input.body7.a_update"
               IF g_pmag7_d[l_ac].pmad004 = 'Y' THEN
                  UPDATE pmab_t
                     SET pmab037 = g_pmag7_d[l_ac].pmad002
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  IF SQLCA.SQLcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "upd pmab_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')                    
                     LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
                     LET g_pmaa_m.pmab037 = g_pmaa_m_o.pmab037
                     DISPLAY BY NAME g_pmaa_m.pmab037
                  END IF
               END IF                                                                 
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad003
            #add-point:BEFORE FIELD pmad003 name="input.b.page7.pmad003"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad003
            
            #add-point:AFTER FIELD pmad003 name="input.a.page7.pmad003"
                                                                                    #此段落由子樣板a05產生
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag7_d[g_detail_idx].pmad002 IS NOT NULL AND g_pmag7_d[g_detail_idx].pmad003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag7_d[g_detail_idx].pmad002 != g_pmag7_d_t.pmad002 OR g_pmag7_d[g_detail_idx].pmad003 != g_pmag7_d_t.pmad003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmad_t WHERE "||"pmadent = '" ||g_enterprise|| "' AND "||"pmad001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmad002 = '"||g_pmag7_d[g_detail_idx].pmad002 ||"' AND "|| "pmad003 = '"||g_pmag7_d[g_detail_idx].pmad003 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmad003
            #add-point:ON CHANGE pmad003 name="input.g.page7.pmad003"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmadstus
            #add-point:BEFORE FIELD pmadstus name="input.b.page7.pmadstus"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmadstus
            
            #add-point:AFTER FIELD pmadstus name="input.a.page7.pmadstus"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmadstus
            #add-point:ON CHANGE pmadstus name="input.g.page7.pmadstus"
                                                                        
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad002
            
            #add-point:AFTER FIELD pmad002 name="input.a.page7.pmad002"
                                                                                    LET g_pmag7_d[l_ac].pmad002_desc = ''
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag7_d[l_ac].pmad002 IS NOT NULL AND g_pmag7_d[l_ac].pmad003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag7_d[l_ac].pmad002 != g_pmag7_d_t.pmad002 OR g_pmag7_d[l_ac].pmad003 != g_pmag7_d_t.pmad003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmad_t WHERE "||"pmadent = '" ||g_enterprise|| "' AND "||"pmad001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmad002 = '"||g_pmag7_d[l_ac].pmad002 ||"' AND "|| "pmad003 = '"||g_pmag7_d[l_ac].pmad003 ||"'",'std-00004',0) THEN 
                     LET g_pmag7_d[l_ac].pmad002 = g_pmag7_d_t.pmad002
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag7_d[l_ac].pmad002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag7_d[l_ac].pmad002 != g_pmag7_d_t.pmad002 OR g_pmag7_d_t.pmad002 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmag7_d[l_ac].pmad002
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="apm-00186:sub-01302|aooi716|",cl_get_progname("aooi716",g_lang,"2"),"|:EXEPROGaooi716"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooib002") THEN
                     LET g_pmag7_d[l_ac].pmad002 = g_pmag7_d_t.pmad002
                     CALL apmm801_pmad002_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmad002_ref()
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad002
            #add-point:BEFORE FIELD pmad002 name="input.b.page7.pmad002"
                                                                        
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmad002
            #add-point:ON CHANGE pmad002 name="input.g.page7.pmad002"
                                                                        
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmad004
            #add-point:BEFORE FIELD pmad004 name="input.b.page7.pmad004"
                                                                        
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmad004
            
            #add-point:AFTER FIELD pmad004 name="input.a.page7.pmad004"
                                                                        
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmad004
            #add-point:ON CHANGE pmad004 name="input.g.page7.pmad004"
            IF g_pmag7_d[l_ac].pmad004 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmag7_d_t.pmad002) THEN
                  SELECT COUNT(*) INTO l_cnt FROM pmad_t
                   WHERE pmad001 = g_pmaa_m.pmaa001
                     AND pmadent = g_enterprise
                     AND pmad004 = 'Y'
                     AND pmad003 = '1'
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmad_t
                   WHERE pmad001 = g_pmaa_m.pmaa001
                     AND pmadent = g_enterprise
                     AND pmad004 = 'Y'
                     AND pmad003 = '1'
                     AND pmad002 != g_pmag7_d_t.pmad002
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00309'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag7_d[l_ac].pmad004 = g_pmag7_d_t.pmad004
                  NEXT FIELD CURRENT
               END IF
               IF g_pmag7_d[l_ac].pmad004 = 'Y' AND g_pmag7_d[l_ac].pmad002 <> g_pmaa_m.pmab037 THEN
                  LET g_pmaa_m.pmab037 = g_pmag7_d[l_ac].pmad002
                  DISPLAY BY NAME g_pmaa_m.pmab037
               END IF
            END IF
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page7.pmad003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad003
            #add-point:ON ACTION controlp INFIELD pmad003 name="input.c.page7.pmad003"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page7.pmadstus
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmadstus
            #add-point:ON ACTION controlp INFIELD pmadstus name="input.c.page7.pmadstus"
                                                                        
            #END add-point
 
 
         #Ctrlp:input.c.page7.pmad002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad002
            #add-point:ON ACTION controlp INFIELD pmad002 name="input.c.page7.pmad002"
                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag7_d[l_ac].pmad002  #給予default值
            #給予arg
            CALL q_ooib002_1()                                 #呼叫開窗
            LET g_pmag7_d[l_ac].pmad002 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_pmag7_d[l_ac].pmad002 TO pmad002         #顯示到畫面上
            CALL apmm801_pmad002_ref()
            NEXT FIELD pmad002                                 #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.page7.pmad004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmad004
            #add-point:ON ACTION controlp INFIELD pmad004 name="input.c.page7.pmad004"
                                                                        
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page7 after_row name="input.body7.after_row"
                                                                        
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag7_d[l_ac].* = g_pmag7_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl7
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmad_t","'7'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page7 after_row2 name="input.body7.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body7.after_input"
                                                                                    #單身主要的付款條件 update 單頭資料
            LET l_pmad002 = ''
            SELECT pmad002 INTO l_pmad002 FROM pmad_t
             WHERE pmadent = g_enterprise
               AND pmad001 = g_pmaa_m.pmaa001
               AND pmad003 = '1'
               AND pmad004 = 'Y'
            IF NOT cl_null(l_pmad002) THEN
               IF l_pmad002 != g_pmaa_m.pmab037 THEN
                  UPDATE pmab_t SET pmab037 = l_pmad002
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  LET g_pmaa_m.pmab037 = l_pmad002
                  DISPLAY BY NAME g_pmaa_m.pmab037
                  CALL apmm801_pmab037_ref()
               END IF
            END IF            
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag7_d[li_reproduce_target].* = g_pmag7_d[li_reproduce].*
 
               LET g_pmag7_d[li_reproduce_target].pmad002 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag7_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag7_d.getLength()+1
            END IF
            
      END INPUT
      INPUT ARRAY g_pmag9_d FROM s_detail9.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_8)
         
         
         BEFORE INPUT
            #add-point:資料輸入前 name="input.body9.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_pmag9_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL apmm801_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'8',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_pmag9_d.getLength()
            #add-point:資料輸入前 name="input.body9.before_input"
            
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag9_d[l_ac].* TO NULL 
            INITIALIZE g_pmag9_d_t.* TO NULL 
            INITIALIZE g_pmag9_d_o.* TO NULL 
            #公用欄位給值(單身8)
            
            #自定義預設值(單身8)
            
            #add-point:modify段before備份 name="input.body9.insert.before_bak"
            
            #end add-point
            LET g_pmag9_d_t.* = g_pmag9_d[l_ac].*     #新輸入資料
            LET g_pmag9_d_o.* = g_pmag9_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b name="input.body9.insert.after_set_entry_b"
            
            #end add-point
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag9_d[li_reproduce_target].* = g_pmag9_d[li_reproduce].*
 
               LET g_pmag9_d[li_reproduce_target].pmae002 = NULL
               LET g_pmag9_d[li_reproduce_target].pmae003 = NULL
            END IF
            
 
            #add-point:modify段before insert name="input.body9.before_insert"
            
            #end add-point  
 
         BEFORE ROW     
            #add-point:modify段before row2 name="input.body9.before_row2"
            
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET g_detail_idx_list[8] = l_ac
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 8
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            LET g_rec_b = g_pmag9_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_pmag9_d[l_ac].pmae002 IS NOT NULL
               AND g_pmag9_d[l_ac].pmae003 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmag9_d_t.* = g_pmag9_d[l_ac].*  #BACKUP
               LET g_pmag9_d_o.* = g_pmag9_d[l_ac].*  #BACKUP
               CALL apmm801_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b name="input.body9.after_set_entry_b"
               
               #end add-point  
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmae_t","'8'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH apmm801_bcl8 INTO g_pmag9_d[l_ac].pmae002,g_pmag9_d[l_ac].pmae003
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_pmag9_d_mask_o[l_ac].* =  g_pmag9_d[l_ac].*
                  CALL apmm801_pmae_t_mask()
                  LET g_pmag9_d_mask_n[l_ac].* =  g_pmag9_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row name="input.body9.before_row"
            
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
 
            #其他table進行lock
            
 
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d) name="input.body9.after_delete_d"
               
               #end add-point
            ELSE
               #add-point:單身刪除前 name="input.body9.b_delete_ask"
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身8刪除前 name="input.body9.b_delete"
               
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_pmaa_m.pmaa001
               LET gs_keys[gs_keys.getLength()+1] = g_pmag9_d_t.pmae002
               LET gs_keys[gs_keys.getLength()+1] = g_pmag9_d_t.pmae003
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmae_t',gs_keys,"'8'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmae_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE apmm801_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
 
               
               #add-point:單身8刪除中 name="input.body9.m_delete"
               
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE apmm801_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:單身8刪除後 name="input.body9.a_delete"
               
               #end add-point
               LET l_count = g_pmag_d.getLength()
               
               #add-point:單身刪除後(<>d) name="input.body9.after_delete"
               
               #end add-point
            END IF 
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_pmag9_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身8新增前 name="input.body9.b_a_insert"
            
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM pmae_t 
             WHERE pmaeent = g_enterprise AND pmae001 = g_pmaa_m.pmaa001
               AND pmae002 = g_pmag9_d[l_ac].pmae002
               AND pmae003 = g_pmag9_d[l_ac].pmae003
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身8新增前 name="input.body9.b_insert"
               
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag9_d[g_detail_idx].pmae002
               LET gs_keys[3] = g_pmag9_d[g_detail_idx].pmae003
               CALL apmm801_insert_b('pmae_t',gs_keys,"'8'")
                           
               #add-point:單身新增後8 name="input.body9.a_insert"
               
               #end add-point
            ELSE    
               INITIALIZE g_pmag_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL apmm801_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後 name="input.body9.after_insert"
               
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_pmag9_d[l_ac].* = g_pmag9_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl8
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_pmag9_d[l_ac].* = g_pmag9_d_t.*
            ELSE
               #add-point:單身page8修改前 name="input.body9.b_update"
               
               #end add-point
               
               #寫入修改者/修改日期資訊(單身8)
               
               
               #將遮罩欄位還原
               CALL apmm801_pmae_t_mask_restore('restore_mask_o')
                              
               UPDATE pmae_t SET (pmae001,pmae002,pmae003) = (g_pmaa_m.pmaa001,g_pmag9_d[l_ac].pmae002, 
                   g_pmag9_d[l_ac].pmae003) #自訂欄位頁簽
                WHERE pmaeent = g_enterprise AND pmae001 = g_pmaa_m.pmaa001
                  AND pmae002 = g_pmag9_d_t.pmae002 #項次 
                  AND pmae003 = g_pmag9_d_t.pmae003
                  
               #add-point:單身page8修改中 name="input.body9.m_update"
               
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     LET g_pmag9_d[l_ac].* = g_pmag9_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmae_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  WHEN SQLCA.SQLCODE #其他錯誤
                     LET g_pmag9_d[l_ac].* = g_pmag9_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     
                  OTHERWISE
                     #資料多語言用-增/改
                     
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys_bak[1] = g_pmaa001_t
               LET gs_keys[2] = g_pmag9_d[g_detail_idx].pmae002
               LET gs_keys_bak[2] = g_pmag9_d_t.pmae002
               LET gs_keys[3] = g_pmag9_d[g_detail_idx].pmae003
               LET gs_keys_bak[3] = g_pmag9_d_t.pmae003
               CALL apmm801_update_b('pmae_t',gs_keys,gs_keys_bak,"'8'")
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL apmm801_pmae_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_pmag9_d[g_detail_idx].pmae002 = g_pmag9_d_t.pmae002 
                  AND g_pmag9_d[g_detail_idx].pmae003 = g_pmag9_d_t.pmae003 
                  ) THEN
                  LET gs_keys[01] = g_pmaa_m.pmaa001
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag9_d_t.pmae002
                  LET gs_keys[gs_keys.getLength()+1] = g_pmag9_d_t.pmae003
                  CALL apmm801_key_update_b(gs_keys,'pmae_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag9_d_t)
               LET g_log2 = util.JSON.stringify(g_pmaa_m),util.JSON.stringify(g_pmag9_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page8修改後 name="input.body9.a_update"
               
               #end add-point
            END IF
         
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmae002
            
            #add-point:AFTER FIELD pmae002 name="input.a.page9.pmae002"
            #應用 a05 樣板自動產生(Version:3)
            #160810-00008#1 160819 by lori add---(S)
            LET g_pmag9_d[l_ac].pmae002_desc = ''
            LET g_pmag9_d[l_ac].oocq005 = ''
            
            #確認資料無重複
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag9_d[g_detail_idx].pmae002 IS NOT NULL AND g_pmag9_d[g_detail_idx].pmae003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag9_d[g_detail_idx].pmae002 != g_pmag9_d_t.pmae002 OR g_pmag9_d[g_detail_idx].pmae003 != g_pmag9_d_t.pmae003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmae_t WHERE "||"pmaeent = '" ||g_enterprise|| "' AND "||"pmae001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmae002 = '"||g_pmag9_d[g_detail_idx].pmae002 ||"' AND "|| "pmae003 = '"||g_pmag9_d[g_detail_idx].pmae003 ||"'",'std-00004',0) THEN 
                     LET g_pmag9_d[l_ac].pmae002 = g_pmag9_d_t.pmae002
                     CALL apmm801_pmae002_ref(g_pmag9_d[l_ac].pmae002,'235') RETURNING g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     DISPLAY BY NAME g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     NEXT FIELD CURRENT
                  END IF
                  
                  IF NOT ap_chk_isExist(g_pmag9_d[l_ac].pmae002,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '235' AND oocq002 = ? ","sub-01303",'axmi011' ) THEN  #160318-00005#34
                     LET g_pmag9_d[l_ac].pmae002 = g_pmag9_d_t.pmae002
                     CALL apmm801_pmae002_ref(g_pmag9_d[l_ac].pmae002,'235') RETURNING g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     DISPLAY BY NAME g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     NEXT FIELD CURRENT
                  END IF

                  IF NOT ap_chk_isExist(g_pmag9_d[l_ac].pmae002,"SELECT COUNT(*) FROM oocq_t WHERE oocqent = '" ||g_enterprise||"' AND oocq001 = '235' AND oocq002 = ? AND oocqstus = 'Y' ","sub-01302",'apmi011' ) THEN #160318-00005#34
                     LET g_pmag9_d[l_ac].pmae002 = g_pmag9_d_t.pmae002
                     CALL apmm801_pmae002_ref(g_pmag9_d[l_ac].pmae002,'235') RETURNING g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     DISPLAY BY NAME g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
                     NEXT FIELD CURRENT
                  END IF
                  
               END IF
            END IF
            
            CALL apmm801_pmae002_ref(g_pmag9_d[l_ac].pmae002,'235') RETURNING g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
            DISPLAY BY NAME g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005                      
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmae002
            #add-point:BEFORE FIELD pmae002 name="input.b.page9.pmae002"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmae002
            #add-point:ON CHANGE pmae002 name="input.g.page9.pmae002"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD oocq005
            #add-point:BEFORE FIELD oocq005 name="input.b.page9.oocq005"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD oocq005
            
            #add-point:AFTER FIELD oocq005 name="input.a.page9.oocq005"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE oocq005
            #add-point:ON CHANGE oocq005 name="input.g.page9.oocq005"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD pmae003
            #add-point:BEFORE FIELD pmae003 name="input.b.page9.pmae003"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD pmae003
            
            #add-point:AFTER FIELD pmae003 name="input.a.page9.pmae003"
            #應用 a05 樣板自動產生(Version:3)
            #確認資料無重複
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag9_d[g_detail_idx].pmae002 IS NOT NULL AND g_pmag9_d[g_detail_idx].pmae003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag9_d[g_detail_idx].pmae002 != g_pmag9_d_t.pmae002 OR g_pmag9_d[g_detail_idx].pmae003 != g_pmag9_d_t.pmae003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmae_t WHERE "||"pmaeent = '" ||g_enterprise|| "' AND "||"pmae001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmae002 = '"||g_pmag9_d[g_detail_idx].pmae002 ||"' AND "|| "pmae003 = '"||g_pmag9_d[g_detail_idx].pmae003 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF



            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE pmae003
            #add-point:ON CHANGE pmae003 name="input.g.page9.pmae003"
            
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page9.pmae002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmae002
            #add-point:ON ACTION controlp INFIELD pmae002 name="input.c.page9.pmae002"
            #應用 a07 樣板自動產生(Version:3)   
            #開窗i段
            #160810-00008#1 160819 by lori add---(S)
            INITIALIZE g_qryparam.* TO NULL 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.state = 'i'   
            LET g_qryparam.default1 = g_pmag9_d[l_ac].pmae002   
            LET g_qryparam.arg1 = "235"

            CALL q_oocq002_1()      

            LET g_pmag9_d[l_ac].pmae002 = g_qryparam.return1   
            DISPLAY g_pmag9_d[l_ac].pmae002 TO pmae002    

            CALL apmm801_pmae002_ref(g_pmag9_d[l_ac].pmae002,'235') RETURNING g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005
            DISPLAY BY NAME g_pmag9_d[l_ac].pmae002_desc,g_pmag9_d[l_ac].oocq005

            NEXT FIELD pmae002             
            #160810-00008#1 160819 by lori add---(E)
            #END add-point
 
 
         #Ctrlp:input.c.page9.oocq005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD oocq005
            #add-point:ON ACTION controlp INFIELD oocq005 name="input.c.page9.oocq005"
            
            #END add-point
 
 
         #Ctrlp:input.c.page9.pmae003
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD pmae003
            #add-point:ON ACTION controlp INFIELD pmae003 name="input.c.page9.pmae003"
            
            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:單身page8 after_row name="input.body9.after_row"
            
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag9_d[l_ac].* = g_pmag9_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE apmm801_bcl8
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL apmm801_unlock_b("pmae_t","'8'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page8 after_row2 name="input.body9.after_row2"
            
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input  name="input.body9.after_input"
            
            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               LET li_reproduce = l_ac_t
               LET li_reproduce_target = l_ac
               LET g_pmag9_d[li_reproduce_target].* = g_pmag9_d[li_reproduce].*
 
               LET g_pmag9_d[li_reproduce_target].pmae002 = NULL
               LET g_pmag9_d[li_reproduce_target].pmae003 = NULL
            ELSE
               CALL FGL_SET_ARR_CURR(g_pmag9_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_pmag9_d.getLength()+1
            END IF
            
      END INPUT
 
      
 
 
 
 
{</section>}
 
{<section id="apmm801.input.other" >}
      
      #add-point:自定義input name="input.more_input"
      INPUT ARRAY g_pmag8_d FROM s_detail8.*     
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
               CALL FGL_SET_ARR_CURR(g_pmag8_d.getLength()+1)    
               LET g_insert = 'N' 
            END IF 
 
            CALL apmm801_b_fill()
            LET g_rec_b = g_pmag8_d.getLength()                             
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmag8_d[l_ac].* TO NULL    
            LET g_pmag8_d[l_ac].pmadstus_1 = "Y"    
            LET g_pmag8_d[l_ac].pmad004_1 = "N"     
            LET g_pmag8_d_t.* = g_pmag8_d[l_ac].*   
            CALL cl_show_fld_cont()
            CALL apmm801_set_entry_b(l_cmd)
            CALL apmm801_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmag8_d[li_reproduce_target].* = g_pmag8_d[li_reproduce].* 
               LET g_pmag8_d[li_reproduce_target].pmad002_1 = NULL              
               LET g_pmag8_d[li_reproduce_target].pmad003_1 = NULL              
            END IF
            LET g_pmag8_d[l_ac].pmad003_1 = '2'    
            LET g_pmag8_d_t.* = g_pmag8_d[l_ac].*  
            
         BEFORE ROW     
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code =  STATUS
               LET g_errparam.extend = "OPEN apmm801_cl:"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CLOSE apmm801_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_pmag8_d.getLength()             
                                                            
            IF g_rec_b >= l_ac                              
               AND g_pmag8_d[l_ac].pmad002_1 IS NOT NULL    
               AND g_pmag8_d[l_ac].pmad003_1 IS NOT NULL    
 
            THEN 
               LET l_cmd='u'
               LET g_pmag8_d_t.* = g_pmag8_d[l_ac].*         
               CALL apmm801_set_entry_b(l_cmd)
               CALL apmm801_set_no_entry_b(l_cmd)
               IF NOT apmm801_lock_b("pmad_t","'8'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH gapmm801_bcl8 INTO g_pmag8_d[l_ac].pmad003_1,g_pmag8_d[l_ac].pmadstus_1, 
                                              g_pmag8_d[l_ac].pmad002_1,g_pmag8_d[l_ac].pmad002_1_desc,
                                              g_pmag8_d[l_ac].pmad004_1         
                   IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = ''
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL apmm801_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            
            
         BEFORE DELETE                            #是否取消單身
         #sakura---mod---str---141230-00008#4
           #IF l_cmd = 'a' THEN
           #   CALL FGL_SET_ARR_CURR(l_ac-1)
           #   CALL g_pmag8_d.deleteElement(l_ac)
           #   NEXT FIELD pmad002_1
           #END IF
           #
           #IF g_pmag8_d[l_ac].pmad002_1 IS NOT NULL
           #   AND g_pmag8_d_t.pmad003_1 IS NOT NULL
           #
           #THEN
           #   IF NOT cl_ask_del_detail() THEN
           #      CANCEL DELETE
           #   END IF
           #   IF l_lock_sw = "Y" THEN
           #      INITIALIZE g_errparam TO NULL
           #      LET g_errparam.code =  -263
           #      LET g_errparam.extend = ""
           #      LET g_errparam.popup = TRUE
           #      CALL cl_err()
           #
           #      CANCEL DELETE
           #   END IF
           #   
           #   
           #   DELETE FROM pmad_t
           #    WHERE pmadent = g_enterprise AND pmad001 = g_pmaa_m.pmaa001 AND
           #          pmad002 = g_pmag8_d_t.pmad002_1
           #      AND pmad003 = g_pmag8_d_t.pmad003_1
           #      
           #   IF SQLCA.sqlcode THEN
           #      INITIALIZE g_errparam TO NULL
           #      LET g_errparam.code = SQLCA.sqlcode
           #      LET g_errparam.extend = "pmag_t"
           #      LET g_errparam.popup = TRUE
           #      CALL cl_err()
           #
           #      CALL s_transaction_end('N','0')
           #      CANCEL DELETE   
           #   ELSE
           #      LET g_rec_b = g_rec_b-1
           #      
           #      CALL s_transaction_end('Y','0')
           #   END IF 
           #   CLOSE apmm801_bcl8
           #   LET l_count = g_pmag_d.getLength()
           #END IF 
           #
           #   INITIALIZE gs_keys TO NULL 
           #   LET gs_keys[1] = g_pmaa_m.pmaa001
           #   LET gs_keys[2] = g_pmag8_d[g_detail_idx].pmad002_1
           #   LET gs_keys[3] = g_pmag8_d[g_detail_idx].pmad003_1
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag8_d[g_detail_idx].pmad002_1                        
               LET gs_keys[3] = g_pmag8_d[g_detail_idx].pmad003_1                        
               LET gs_keys[gs_keys.getLength()+1] = g_pmag8_d[g_detail_idx].pmad002_1    
            
               #刪除同層單身
               IF NOT apmm801_delete_b('pmad_t',gs_keys,"'8'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE gapmm801_bcl8                            CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT apmm801_key_delete_b(gs_keys,'pmad_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE gapmm801_bcl8        
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               CALL s_transaction_end('Y','0')
               CLOSE gapmm801_bcl8      
               LET g_rec_b = g_rec_b-1
               LET l_count = g_pmag_d.getLength()
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag8_d[g_detail_idx].pmad002_1  
               LET gs_keys[3] = g_pmag8_d[g_detail_idx].pmad003_1  
            END IF            
         #sakura---mod---end---141230-00008#4
 
            
         AFTER DELETE
         #sakura---mod---str---141230-00008#4         
            #CALL apmm801_delete_b('pmad_t',gs_keys,"'8'") RETURNING l_success
            #如果是最後一筆
            IF l_ac = (g_pmag8_d.getLength() + 1) THEN   
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF	            
         #sakura---mod---end---141230-00008#4
         
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM pmad_t 
             WHERE pmadent = g_enterprise AND pmad001 = g_pmaa_m.pmaa001
               AND pmad002 = g_pmag8_d[l_ac].pmad002_1   
               AND pmad003 = g_pmag8_d[l_ac].pmad003_1   
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
            
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmaa_m.pmaa001
               LET gs_keys[2] = g_pmag8_d[g_detail_idx].pmad002_1  
               LET gs_keys[3] = g_pmag8_d[g_detail_idx].pmad003_1  
               CALL apmm801_insert_b('pmad_t',gs_keys,"'8'")
                           
            ELSE    
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00006"
               LET g_errparam.extend = 'INSERT'
               LET g_errparam.popup = TRUE
               CALL cl_err()

               INITIALIZE g_pmag8_d[l_ac].* TO NULL    
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "pmad_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()
  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               IF g_pmag8_d[l_ac].pmad004_1 = 'Y' THEN         
                  UPDATE pmab_t                                
                     SET pmab087 = g_pmag8_d[l_ac].pmad002_1   
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  IF SQLCA.SQLcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "upd pmab_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')                    
                     LET g_pmaa_m.pmab087 = g_pmaa_m_o.pmab087
                     DISPLAY BY NAME g_pmaa_m.pmab087
                     CANCEL INSERT
                  END IF
               END IF  
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*    
               CLOSE gapmm801_bcl8                   
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = -263
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*       
            ELSE
 
               
               UPDATE pmad_t
                  SET (pmad003,pmadstus,pmad002,pmad004)
                         = (g_pmag8_d[l_ac].pmad003_1,    
                            g_pmag8_d[l_ac].pmadstus_1,  
                            g_pmag8_d[l_ac].pmad002_1,   
                            g_pmag8_d[l_ac].pmad004_1)   
                WHERE pmadent = g_enterprise 
                  AND pmad001 = g_pmaa_m.pmaa001
                  AND pmad002 = g_pmag8_d_t.pmad002_1    
                  AND pmad003 = g_pmag8_d_t.pmad003_1    
                   
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "pmad_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                     LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*  
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "pmad_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                     LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*   
                  OTHERWISE
                     INITIALIZE gs_keys TO NULL 
                     LET gs_keys[1]     = g_pmaa_m.pmaa001
                     LET gs_keys_bak[1] = g_pmaa001_t
                     LET gs_keys[2]     = g_pmag8_d[g_detail_idx].pmad002_1  
                     LET gs_keys_bak[2] = g_pmag8_d_t.pmad002_1              
                     LET gs_keys[3]     = g_pmag8_d[g_detail_idx].pmad003_1  
                     LET gs_keys_bak[3] = g_pmag8_d_t.pmad003_1              
                     CALL apmm801_update_b('pmad_t',gs_keys,gs_keys_bak,"'8'")
                     
               END CASE
               
               IF g_pmag8_d[l_ac].pmad004_1 = 'Y' THEN        
                  UPDATE pmab_t                               
                     SET pmab087 = g_pmag8_d[l_ac].pmad002_1  
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  IF SQLCA.SQLcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "upd pmab_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')                    
                     LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*      
                     LET g_pmaa_m.pmab087 = g_pmaa_m_o.pmab087
                     DISPLAY BY NAME g_pmaa_m.pmab087
                  END IF
               END IF   
            END IF
 
 
         AFTER FIELD pmad002_1
            LET g_pmag8_d[l_ac].pmad002_1_desc = ''
            IF  g_pmaa_m.pmaa001 IS NOT NULL AND g_pmag8_d[l_ac].pmad002_1 IS NOT NULL AND g_pmag8_d[l_ac].pmad003_1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t OR g_pmag8_d[l_ac].pmad002_1 != g_pmag8_d_t.pmad002_1 OR g_pmag8_d[l_ac].pmad003_1 != g_pmag8_d_t.pmad003_1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmad_t WHERE "||"pmadent = '" ||g_enterprise|| "' AND "||"pmad001 = '"||g_pmaa_m.pmaa001 ||"' AND "|| "pmad002 = '"||g_pmag8_d[l_ac].pmad002_1 ||"' AND "|| "pmad003 = '"||g_pmag8_d[l_ac].pmad003_1 ||"'",'std-00004',0) THEN 
                     LET g_pmag8_d[l_ac].pmad002_1 = g_pmag8_d_t.pmad002_1
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_pmag8_d[l_ac].pmad002_1) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmag8_d[l_ac].pmad002_1 != g_pmag8_d_t.pmad002_1 OR g_pmag8_d_t.pmad002_1 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmag8_d[l_ac].pmad002_1
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="apm-00184:sub-01302|aooi714|",cl_get_progname("aooi714",g_lang,"2"),"|:EXEPROGaooi714"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_ooib002_1") THEN
                     LET g_pmag8_d[l_ac].pmad002_1 = g_pmag8_d_t.pmad002_1
                     CALL apmm801_pmad002_1_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL apmm801_pmad002_1_ref()  
            
         ON CHANGE pmad004_1
            IF g_pmag8_d[l_ac].pmad004_1 = 'Y' THEN      
               LET l_cnt = 0                             
               IF cl_null(g_pmag8_d_t.pmad002_1) THEN    
                  SELECT COUNT(*) INTO l_cnt FROM pmad_t
                   WHERE pmad001 = g_pmaa_m.pmaa001
                     AND pmadent = g_enterprise
                     AND pmad004 = 'Y'
                     AND pmad003 = '2'
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM pmad_t
                   WHERE pmad001 = g_pmaa_m.pmaa001
                     AND pmadent = g_enterprise
                     AND pmad004 = 'Y'
                     AND pmad003 = '2'
                     AND pmad002 != g_pmag8_d_t.pmad002_1                        
               END IF
               
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00310'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmag8_d[l_ac].pmad004_1 = g_pmag8_d_t.pmad004_1   
                  NEXT FIELD CURRENT
               END IF
               
               IF g_pmag8_d[l_ac].pmad004_1 = 'Y' AND g_pmag8_d[l_ac].pmad002_1 <> g_pmaa_m.pmab087 THEN   
                  LET g_pmaa_m.pmab087 = g_pmag8_d[l_ac].pmad002_1                                         
                  DISPLAY BY NAME g_pmaa_m.pmab087
               END IF
            END IF

         ON ACTION controlp INFIELD pmad002_1
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmag8_d[l_ac].pmad002_1   
            CALL q_ooib002_2()                                    
            LET g_pmag8_d[l_ac].pmad002_1 = g_qryparam.return1        
            DISPLAY g_pmag8_d[l_ac].pmad002_1 TO pmad002_1           
            CALL apmm801_pmad002_1_ref()                          
            NEXT FIELD pmad002_1                                 
 
         AFTER ROW
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmag8_d[l_ac].* = g_pmag8_d_t.*      
               END IF
               CLOSE gapmm801_bcl8                       
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            CALL apmm801_unlock_b("pmad_t","'8'")
            CALL s_transaction_end('Y','0')
 
         AFTER INPUT
            #單身主要的收款條件 update 單頭資料
            LET l_pmad002 = ''
            SELECT pmad002 INTO l_pmad002 FROM pmad_t
             WHERE pmadent = g_enterprise
               AND pmad001 = g_pmaa_m.pmaa001
               AND pmad003 = '2'
               AND pmad004 = 'Y'
            IF NOT cl_null(l_pmad002) THEN
               IF l_pmad002 != g_pmaa_m.pmab087 THEN
                  UPDATE pmab_t SET pmab087 = l_pmad002
                   WHERE pmabent = g_enterprise
                     AND pmab001 = g_pmaa_m.pmaa001
                     AND pmabsite = 'ALL'
                  LET g_pmaa_m.pmab087 = l_pmad002
                  DISPLAY BY NAME g_pmaa_m.pmab087
                  CALL apmm801_pmab087_ref()
               END IF
            END IF
            
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_pmag8_d.getLength()+1)      
            LET lb_reproduce = TRUE                             
            LET li_reproduce = l_ac                             
            LET li_reproduce_target = g_pmag8_d.getLength()+1   
 
      END INPUT
 
      SUBDIALOG aoo_aooi350_01.aooi350_01_input
      SUBDIALOG aoo_aooi350_02.aooi350_02_input
      #end add-point
    
      BEFORE DIALOG 
         #CALL cl_err_collect_init()    
         #add-point:input段before dialog name="input.before_dialog"
#         IF p_cmd = 'a' THEN
#           
#         ELSE
#            CASE DIALOG.getCurrentItem()
#               WHEN "s_detail1"
#                  RETURN "pmag001"
#               WHEN "s_detail2"
#                  RETURN "pmax001"
#
#               WHEN "s_detail3"
#                  RETURN "pmay001"
# 
#               WHEN "s_detail4"
#                  RETURN "pmaz001"
#                  
#            END CASE
#         END IF
         IF cl_null(g_aw) THEN
            IF g_pmaa_m.pmaa002 = '2' THEN     #160810-00008#1 160819 by lori add
               LET g_aw = "s_detail9"          #160810-00008#1 160819 by lori add
            ELSE                               #160810-00008#1 160819 by lori add   
               LET g_aw = "s_detail5"          
            END IF                             #160810-00008#1 160819 by lori add
         END IF
         
         
         #end add-point    
         #重新導回資料到正確位置上
         CALL DIALOG.setCurrentRow("s_detail1",g_idx_group.getValue("'1',"))      
         CALL DIALOG.setCurrentRow("s_detail2",g_idx_group.getValue("'2',"))
         CALL DIALOG.setCurrentRow("s_detail3",g_idx_group.getValue("'3',"))
         CALL DIALOG.setCurrentRow("s_detail4",g_idx_group.getValue("'4',"))
         CALL DIALOG.setCurrentRow("s_detail5",g_idx_group.getValue("'5',"))
         CALL DIALOG.setCurrentRow("s_detail6",g_idx_group.getValue("'6',"))
         CALL DIALOG.setCurrentRow("s_detail7",g_idx_group.getValue("'7',"))
         CALL DIALOG.setCurrentRow("s_detail9",g_idx_group.getValue("'8',"))
 
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            #add-point:input段next_field name="input.next_field"
            
            #end add-point  
            NEXT FIELD pmaa001
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD pmag002
               WHEN "s_detail2"
                  NEXT FIELD pmax002
               WHEN "s_detail3"
                  NEXT FIELD pmay002
               WHEN "s_detail4"
                  NEXT FIELD pmaz002
               WHEN "s_detail5"
                  NEXT FIELD pmacstus
               WHEN "s_detail6"
                  NEXT FIELD pmafstus
               WHEN "s_detail7"
                  NEXT FIELD pmad003
               WHEN "s_detail9"
                  NEXT FIELD pmae002
 
               #add-point:input段modify_detail  name="input.modify_detail.other"
               
               #end add-point  
            END CASE
         END IF
      
      AFTER DIALOG
         #add-point:input段after_dialog name="input.after_dialog"
         #161109-00012#1 161109 by lori add---(S)
         CALL apmm801_set_act_visible()
         CALL apmm801_set_act_no_visible()
         #161109-00012#1 161109 by lori add---(S)
         #end add-point    
         
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept  name="input.accept"
         
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         #add-point:input段cancel name="input.cancel"
         
         #end add-point  
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         #各個page指標
         LET g_detail_idx_list[1] = 1 
         LET g_detail_idx_list[2] = 1
         LET g_detail_idx_list[3] = 1
         LET g_detail_idx_list[4] = 1
         LET g_detail_idx_list[5] = 1
         LET g_detail_idx_list[6] = 1
         LET g_detail_idx_list[7] = 1
         LET g_detail_idx_list[8] = 1
 
         CALL g_curr_diag.setCurrentRow("s_detail1",1)    
         CALL g_curr_diag.setCurrentRow("s_detail2",1)
         CALL g_curr_diag.setCurrentRow("s_detail3",1)
         CALL g_curr_diag.setCurrentRow("s_detail4",1)
         CALL g_curr_diag.setCurrentRow("s_detail5",1)
         CALL g_curr_diag.setCurrentRow("s_detail6",1)
         CALL g_curr_diag.setCurrentRow("s_detail7",1)
         CALL g_curr_diag.setCurrentRow("s_detail9",1)
 
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         #add-point:input段close name="input.close"
         
         #end add-point  
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         #add-point:input段exit name="input.exit"
         
         #end add-point
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         #各個page指標
         LET g_detail_idx_list[1] = 1 
         LET g_detail_idx_list[2] = 1
         LET g_detail_idx_list[3] = 1
         LET g_detail_idx_list[4] = 1
         LET g_detail_idx_list[5] = 1
         LET g_detail_idx_list[6] = 1
         LET g_detail_idx_list[7] = 1
         LET g_detail_idx_list[8] = 1
 
         CALL g_curr_diag.setCurrentRow("s_detail1",1)    
         CALL g_curr_diag.setCurrentRow("s_detail2",1)
         CALL g_curr_diag.setCurrentRow("s_detail3",1)
         CALL g_curr_diag.setCurrentRow("s_detail4",1)
         CALL g_curr_diag.setCurrentRow("s_detail5",1)
         CALL g_curr_diag.setCurrentRow("s_detail6",1)
         CALL g_curr_diag.setCurrentRow("s_detail7",1)
         CALL g_curr_diag.setCurrentRow("s_detail9",1)
 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
    
   #add-point:input段after input  name="input.after_input"
                  
   #end add-point    
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.show" >}
#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION apmm801_show()
   #add-point:show段define(客製用) name="show.define_customerization"
   
   #end add-point  
   DEFINE l_ac_t    LIKE type_t.num10
   #add-point:show段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="show.define"
                  
   #end add-point  
   
   #add-point:Function前置處理 name="show.before"
                     
   LET g_pmaa_m.pmab032   = ''
   LET g_pmaa_m.pmab082   = ''
   LET g_pmaa_m.pmab033   = ''
   LET g_pmaa_m.pmab034   = ''
   LET g_pmaa_m.pmab035   = ''
   LET g_pmaa_m.pmab056   = '' #sakura add
   LET g_pmaa_m.pmab037   = ''
   LET g_pmaa_m.pmab055   = '' #s983961 新增應付帳款類別
   LET g_pmaa_m.pmab038   = ''
   LET g_pmaa_m.pmab039   = ''
   LET g_pmaa_m.pmab040   = ''
   LET g_pmaa_m.pmab041   = ''
   LET g_pmaa_m.pmab042   = ''
   LET g_pmaa_m.pmab043   = ''
   LET g_pmaa_m.pmab044   = ''
   LET g_pmaa_m.pmab045   = ''
   LET g_pmaa_m.pmab046   = ''
   LET g_pmaa_m.pmab047   = ''
   LET g_pmaa_m.pmab048   = ''
   LET g_pmaa_m.pmab049   = ''
   LET g_pmaa_m.l_pmab050 = ''
   LET g_pmaa_m.pmab051   = ''
   LET g_pmaa_m.l_pmab052 = ''
   LET g_pmaa_m.pmab083   = ''
   LET g_pmaa_m.pmab084   = ''
   LET g_pmaa_m.pmab085   = ''
   LET g_pmaa_m.pmab087   = ''
   LET g_pmaa_m.pmab105   = '' #s983961 新增應收帳款類別
   LET g_pmaa_m.pmab088   = ''
   LET g_pmaa_m.pmab089   = ''
   LET g_pmaa_m.pmab090   = ''
   LET g_pmaa_m.pmab091   = ''
   LET g_pmaa_m.pmab092   = ''
   LET g_pmaa_m.pmab093   = ''
   LET g_pmaa_m.pmab094   = ''
   LET g_pmaa_m.pmab095   = ''
   LET g_pmaa_m.pmab096   = ''
   LET g_pmaa_m.pmab097   = ''
   LET g_pmaa_m.pmab098   = ''
   LET g_pmaa_m.pmab099   = ''
   LET g_pmaa_m.l_pmab100   = ''
   LET g_pmaa_m.pmab101   = ''
   LET g_pmaa_m.l_pmab102   = ''
   LET g_pmaa_m.pmab057   = ''
   LET g_pmaa_m.pmab058   = ''
   LET g_pmaa_m.pmab107   = ''
   LET g_pmaa_m.pmab108   = ''
   LET g_pmaa_m.pmab053   = ''
   LET g_pmaa_m.pmab103   = ''
   #160810-00008#1 160819 by lori add---(S)
   LET g_pmaa_m.pmab080 = ''
   LET g_pmaa_m.pmab104 = ''
   LET g_pmaa_m.pmab106 = ''   
   #160810-00008#1 160819 by lori add---(E)
   
   IF NOT cl_null(g_pmaa_m.pmaa001) THEN
      SELECT pmab032, pmab082, pmab033, pmab034, pmab035,
             pmab056,                                       #sakura add
             pmab037, pmab055,                              #150616-00047#1 06/18 s983961---add(pmab055) 
             pmab038, pmab039, pmab040, pmab041,
             pmab042, pmab043, pmab044, pmab045, pmab046,
             pmab047, pmab048, pmab049, pmab050, pmab051,
             pmab052, pmab083, pmab084, pmab085, pmab087,
             pmab105,                                       #150616-00047#1 06/18 s983961---add(pmab105)   
             pmab088, pmab089, pmab090, pmab091, pmab092,
             pmab093, pmab094, pmab095, pmab096, pmab097,
             pmab098, pmab099, pmab100, pmab101, pmab102,
             pmab057, pmab058, pmab107, pmab108, pmab053,
             pmab103,
             pmab080,pmab104,pmab106                        #160810-00008#1 160819 by lori add
        INTO g_pmaa_m.pmab032, g_pmaa_m.pmab082, g_pmaa_m.pmab033, g_pmaa_m.pmab034, g_pmaa_m.pmab035,
             g_pmaa_m.pmab056,                              #sakura
             g_pmaa_m.pmab037,g_pmaa_m.pmab055,             #150616-00047#1 06/18 s983961---add(g_pmaa_m.pmab055)
             g_pmaa_m.pmab038, g_pmaa_m.pmab039, g_pmaa_m.pmab040, g_pmaa_m.pmab041,
             g_pmaa_m.pmab042, g_pmaa_m.pmab043, g_pmaa_m.pmab044, g_pmaa_m.pmab045, g_pmaa_m.pmab046,
             g_pmaa_m.pmab047, g_pmaa_m.pmab048, g_pmaa_m.pmab049, g_pmaa_m.l_pmab050, g_pmaa_m.pmab051,
             g_pmaa_m.l_pmab052, g_pmaa_m.pmab083, g_pmaa_m.pmab084, g_pmaa_m.pmab085, g_pmaa_m.pmab087,
             g_pmaa_m.pmab105,                              #150616-00047#1 06/18 s983961---add(g_pmaa_m.pmab105)
             g_pmaa_m.pmab088, g_pmaa_m.pmab089, g_pmaa_m.pmab090, g_pmaa_m.pmab091, g_pmaa_m.pmab092,
             g_pmaa_m.pmab093, g_pmaa_m.pmab094, g_pmaa_m.pmab095, g_pmaa_m.pmab096, g_pmaa_m.pmab097,
             g_pmaa_m.pmab098, g_pmaa_m.pmab099, g_pmaa_m.l_pmab100, g_pmaa_m.pmab101, g_pmaa_m.l_pmab102,
             g_pmaa_m.pmab057, g_pmaa_m.pmab058, g_pmaa_m.pmab107, g_pmaa_m.pmab108,g_pmaa_m.pmab053,
             g_pmaa_m.pmab103,
             g_pmaa_m.pmab080,   g_pmaa_m.pmab104, g_pmaa_m.pmab106   #160810-00008#1 160819 by lori add
        FROM pmab_t
       WHERE pmab001 = g_pmaa_m.pmaa001
         AND pmabent = g_enterprise
         AND pmabsite = 'ALL'
   END IF
   
   SELECT ooff013 INTO g_pmaa_m.ooff013 FROM ooff_t
    WHERE ooffent = g_enterprise 
      AND ooff001 = '2'
      AND ooff002 = g_pmaa_m.pmaa001 
      AND ooff012 = '4'
   DISPLAY BY NAME g_pmaa_m.ooff013
   
   LET g_pmaa_m.pmab104_desc = apmm801_pmab104_ref(g_pmaa_m.pmab104)   #160810-00008#1 160819 by lori add
   LET g_pmaa_m.pmab106_desc = apmm801_pmab106_ref(g_pmaa_m.pmab106)   #160810-00008#1 160819 by lori add

   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL apmm801_b_fill() #單身填充
      CALL apmm801_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #應用 a12 樣板自動產生(Version:4)
 
 
 
   
   #顯示followup圖示
   #應用 a48 樣板自動產生(Version:3)
   CALL apmm801_set_pk_array()
   #add-point:ON ACTION agendum name="show.follow_pic"
   
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference name="show.head.reference"
                     INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa001
   CALL ap_ref_array2(g_ref_fields," SELECT pmaal003,pmaal004,pmaal005,pmaal006 FROM pmaal_t WHERE pmaalent = '"||g_enterprise||"' AND pmaal001 = ? AND pmaal002 = '"||g_dlang||"'","") RETURNING g_rtn_fields   #160810-00008#1 160819 by lori add:pmaal006 
   LET g_pmaa_m.pmaal003 = g_rtn_fields[1] 
   LET g_pmaa_m.pmaal004 = g_rtn_fields[2] 
   LET g_pmaa_m.pmaal005 = g_rtn_fields[3] 
   LET g_pmaa_m.pmaal006 = g_rtn_fields[3]     #160810-00008#1 160819 by lori add
   DISPLAY g_pmaa_m.pmaal003,g_pmaa_m.pmaal004,g_pmaa_m.pmaal005 TO pmaal003,pmaal004,pmaal005
   DISPLAY g_pmaa_m.pmaal006 TO maal006        #160810-00008#1 160819 by lori add
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaownid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaownid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaownid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaowndp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaowndp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaowndp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtdp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtdp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtdp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaamodid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaamodid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaamodid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacnfid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacnfid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacnfid_desc

   CALL apmm801_pmaa005_ref()
   CALL apmm801_pmaa006_ref()
   CALL apmm801_pmaa026_ref()
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221) RETURNING g_pmaa_m.pmaa221_desc
   CALL apmm801_pmaa222_ref()
   CALL apmm801_pmaa080_ref()
   CALL apmm801_pmaa084_ref()
   CALL apmm801_pmaa083_ref()
   CALL apmm801_pmaa086_ref()
   CALL apmm801_pmaa085_ref()
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa231) RETURNING g_pmaa_m.pmaa231_desc
   CALL apmm801_pmaa232_ref()
   CALL apmm801_pmaa090_ref()
   CALL apmm801_pmaa094_ref()
   CALL apmm801_pmaa093_ref()
   CALL apmm801_pmaa096_ref()
   CALL apmm801_pmaa095_ref()
   CALL apmm801_pmaa241_ref()
   CALL apmm801_pmaa242_ref()
   CALL apmm801_pmaa243_ref()
   CALL apmm801_pmaa244_ref()
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa245) RETURNING g_pmaa_m.pmaa245_desc
   CALL apmm801_pmaa019_ref()
   CALL apmm801_pmaa022_ref()
   CALL apmm801_pmaa023_ref()
   CALL apmm801_pmaa024_ref()
   CALL apmm801_pmaa007_ref()
   CALL apmm801_pmaa009_ref()
   CALL apmm801_pmaa011_ref()
   CALL apmm801_pmaa052_ref()
   CALL apmm801_pmaa054_ref()
   CALL apmm801_pmaa205_ref()
   CALL apmm801_pmaa081_ref()
   CALL apmm801_pmab033_ref()
   CALL apmm801_pmab034_ref()
   CALL apmm801_pmab037_ref()
   CALL apmm801_pmab039_ref()
   CALL apmm801_pmab040_ref()
   CALL apmm801_pmab041_ref()
   CALL apmm801_pmab042_ref()
   CALL apmm801_pmab043_ref()
   CALL apmm801_pmab047_ref()
   CALL apmm801_pmab083_ref()
   CALL apmm801_pmab084_ref()
   CALL apmm801_pmab087_ref()
   CALL apmm801_pmab089_ref()
   CALL apmm801_pmab090_ref()
   CALL apmm801_pmab091_ref()
   CALL apmm801_pmab092_ref()
   CALL apmm801_pmab093_ref()
   CALL apmm801_pmab097_ref()
   CALL apmm801_pmaa274_ref()
   CALL apmm801_pmaa281_ref()
   CALL apmm801_pmaa282_ref()
   CALL apmm801_pmaa283_ref()
   CALL apmm801_pmaa284_ref()
   CALL apmm801_pmaa285_ref()
   CALL apmm801_pmaa286_ref()
   CALL apmm801_pmaa287_ref()
   CALL apmm801_pmaa288_ref()
   CALL apmm801_pmaa289_ref()
   CALL apmm801_pmaa290_ref()
   CALL apmm801_pmaa291_ref()
   CALL apmm801_pmaa292_ref()
   CALL apmm801_pmaa293_ref()
   CALL apmm801_pmaa294_ref()
   CALL apmm801_pmaa295_ref()
   CALL apmm801_pmaa296_ref()
   CALL apmm801_pmaa297_ref()
   CALL apmm801_pmaa298_ref()
   CALL apmm801_pmaa299_ref()
   CALL apmm801_pmaa300_ref()
   CALL apmm801_pmaa270_visible()
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab038) RETURNING g_pmaa_m.pmab038_desc
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmab088) RETURNING g_pmaa_m.pmab088_desc
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221) RETURNING g_pmaa_m.pmaa221_desc
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa231) RETURNING g_pmaa_m.pmaa231_desc
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa245) RETURNING g_pmaa_m.pmaa245_desc
   CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab053) RETURNING g_pmaa_m.pmab053_desc
   CALL s_desc_get_acc_desc('238',g_pmaa_m.pmab103) RETURNING g_pmaa_m.pmab103_desc
   CALL s_desc_get_invoice_type_desc1(g_site,g_pmaa_m.pmab056) RETURNING g_pmaa_m.pmab056_desc #sakura add
   DISPLAY BY NAME g_pmaa_m.pmab056_desc #sakura add   
   CALL apmm801_pmab055_ref()   #150616-00047#1 06/18 s983961---add
   CALL apmm801_pmab105_ref()   #150616-00047#1 06/18 s983961---add
   #end add-point
   
   #遮罩相關處理
   LET g_pmaa_m_mask_o.* =  g_pmaa_m.*
   CALL apmm801_pmaa_t_mask()
   LET g_pmaa_m_mask_n.* =  g_pmaa_m.*
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
       g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
       g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc, 
       g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024,g_pmaa_m.pmaa024_desc, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa009_desc, 
       g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231, 
       g_pmaa_m.pmaa231_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc, 
       g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa094_desc, 
       g_pmaa_m.pmaa093,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097, 
       g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc, 
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa245, 
       g_pmaa_m.pmaa245_desc,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc, 
       g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa222,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080,g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083, 
       g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053,g_pmaa_m.pmaa053_desc, 
       g_pmaa_m.pmaa054,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa205_desc, 
       g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053,g_pmaa_m.pmab053_desc, 
       g_pmaa_m.pmab039,g_pmaa_m.pmab039_desc,g_pmaa_m.pmaa081,g_pmaa_m.pmaa081_desc,g_pmaa_m.pmab033, 
       g_pmaa_m.pmab033_desc,g_pmaa_m.pmab034,g_pmaa_m.pmab034_desc,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
       g_pmaa_m.pmab056_desc,g_pmaa_m.pmab037,g_pmaa_m.pmab037_desc,g_pmaa_m.pmab055,g_pmaa_m.pmab055_desc, 
       g_pmaa_m.pmab038,g_pmaa_m.pmab038_desc,g_pmaa_m.pmab040,g_pmaa_m.pmab040_desc,g_pmaa_m.pmab041, 
       g_pmaa_m.pmab041_desc,g_pmaa_m.pmab042,g_pmaa_m.pmab042_desc,g_pmaa_m.pmab043,g_pmaa_m.pmab043_desc, 
       g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab047_desc,g_pmaa_m.pmab048, 
       g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
       g_pmaa_m.pmab083,g_pmaa_m.pmab083_desc,g_pmaa_m.pmab084,g_pmaa_m.pmab084_desc,g_pmaa_m.pmab103, 
       g_pmaa_m.pmab103_desc,g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
       g_pmaa_m.pmab106_desc,g_pmaa_m.pmab087,g_pmaa_m.pmab087_desc,g_pmaa_m.pmab105,g_pmaa_m.pmab105_desc, 
       g_pmaa_m.pmab088,g_pmaa_m.pmab088_desc,g_pmaa_m.pmab089,g_pmaa_m.pmab089_desc,g_pmaa_m.pmab107, 
       g_pmaa_m.pmab108,g_pmaa_m.pmab090,g_pmaa_m.pmab090_desc,g_pmaa_m.pmab091,g_pmaa_m.pmab091_desc, 
       g_pmaa_m.pmab092,g_pmaa_m.pmab092_desc,g_pmaa_m.pmab093,g_pmaa_m.pmab093_desc,g_pmaa_m.pmab094, 
       g_pmaa_m.pmab095,g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab097_desc,g_pmaa_m.pmab098,g_pmaa_m.pmab099, 
       g_pmaa_m.l_pmab100,g_pmaa_m.pmab101,g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc, 
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt, 
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271, 
       g_pmaa_m.pmaa272,g_pmaa_m.day01,g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06, 
       g_pmaa_m.day07,g_pmaa_m.day08,g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13, 
       g_pmaa_m.day14,g_pmaa_m.day15,g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20, 
       g_pmaa_m.day21,g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27, 
       g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03, 
       g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa274_desc, 
       g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285, 
       g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290, 
       g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295, 
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300, 
       g_pmaa_m.pmaa300_desc
   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:3)
	  #根據當下狀態碼顯示圖片
      CASE g_pmaa_m.pmaastus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")
         
      END CASE
 
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_pmag_d.getLength()
      #add-point:show段單身reference name="show.body.reference"
      CALL apmm801_pmag002_ref()
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_pmag2_d.getLength()
      #add-point:show段單身reference name="show.body2.reference"
      CALL apmm801_pmax002_ref()
      CALL apmm801_pmax003_ref()
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag3_d.getLength()
      #add-point:show段單身reference name="show.body3.reference"
      CALL apmm801_pmay002_ref()
      CALL s_desc_get_oojdl003_desc(g_pmag3_d[l_ac].pmay003) RETURNING g_pmag3_d[l_ac].pmay003_desc
      DISPLAY BY NAME g_pmag3_d[l_ac].pmay003_desc
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag4_d.getLength()
      #add-point:show段單身reference name="show.body4.reference"
       CALL apmm801_pmaz002_ref()
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag5_d.getLength()
      #add-point:show段單身reference name="show.body5.reference"
      CALL apmm801_pmac002_ref()

      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag6_d.getLength()
      #add-point:show段單身reference name="show.body6.reference"
      CALL apmm801_pmaf002_ref()

      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag7_d.getLength()
      #add-point:show段單身reference name="show.body7.reference"
      CALL apmm801_pmad002_ref()
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_pmag9_d.getLength()
      #add-point:show段單身reference name="show.body9.reference"
      
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other name="show.other"
   FOR l_ac = 1 TO g_pmag8_d.getLength()   
      CALL apmm801_pmad002_1_ref()
   END FOR
   
  
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL apmm801_detail_show()
 
   #add-point:show段之後 name="show.after"
                     LET g_pmaa_m_o.* = g_pmaa_m.*
   #end add-point
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.detail_show" >}
#+ 第二階單身reference
PRIVATE FUNCTION apmm801_detail_show()
   #add-point:detail_show段define(客製用) name="detail_show.define_customerization"
   
   #end add-point  
   #add-point:detail_show段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="detail_show.define"
                  
   #end add-point  
   
   #add-point:Function前置處理 name="detail_show.before"
                  
   #end add-point
   
   #add-point:detail_show段之後 name="detail_show.after"
                  
   #end add-point
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.reproduce" >}
#+ 資料複製
PRIVATE FUNCTION apmm801_reproduce()
   #add-point:reproduce段define(客製用) name="reproduce.define_customerization"
   
   #end add-point   
   DEFINE l_newno     LIKE pmaa_t.pmaa001 
   DEFINE l_oldno     LIKE pmaa_t.pmaa001 
 
   DEFINE l_master    RECORD LIKE pmaa_t.* #此變數樣板目前無使用
   DEFINE l_detail    RECORD LIKE pmag_t.* #此變數樣板目前無使用
   DEFINE l_detail2    RECORD LIKE pmax_t.* #此變數樣板目前無使用
 
   DEFINE l_detail3    RECORD LIKE pmay_t.* #此變數樣板目前無使用
 
   DEFINE l_detail4    RECORD LIKE pmaz_t.* #此變數樣板目前無使用
 
   DEFINE l_detail5    RECORD LIKE pmac_t.* #此變數樣板目前無使用
 
   DEFINE l_detail6    RECORD LIKE pmaf_t.* #此變數樣板目前無使用
 
   DEFINE l_detail7    RECORD LIKE pmad_t.* #此變數樣板目前無使用
 
   DEFINE l_detail8    RECORD LIKE pmae_t.* #此變數樣板目前無使用
 
 
 
   DEFINE l_cnt       LIKE type_t.num10
   #add-point:reproduce段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="reproduce.define"
   DEFINE l_success   LIKE type_t.num5
   #end add-point   
   
   #add-point:Function前置處理  name="reproduce.pre_function"
   
   #end add-point
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   LET g_master_insert = FALSE
   
   IF g_pmaa_m.pmaa001 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
    
   LET g_pmaa001_t = g_pmaa_m.pmaa001
 
    
   LET g_pmaa_m.pmaa001 = ""
 
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #應用 a14 樣板自動產生(Version:5)    
      #公用欄位新增給值  
      LET g_pmaa_m.pmaaownid = g_user
      LET g_pmaa_m.pmaaowndp = g_dept
      LET g_pmaa_m.pmaacrtid = g_user
      LET g_pmaa_m.pmaacrtdp = g_dept 
      LET g_pmaa_m.pmaacrtdt = cl_get_current()
      LET g_pmaa_m.pmaamodid = g_user
      LET g_pmaa_m.pmaamoddt = cl_get_current()
      LET g_pmaa_m.pmaastus = 'N'
 
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前 name="reproduce.head.b_input"
   #151027-00016#9 20160108 add by beckxie---S
   #複製時清空 簡稱,全名,註記碼--lori
   LET g_pmaa_m.pmaal003 = ''
   LET g_pmaa_m.pmaal004 = ''
   LET g_pmaa_m.pmaal005 = ''
   #151027-00016#9 20160108 add by beckxie---E
   #LET g_pmaa_m.pmaa001 = ''
   LET g_pmaa_m.pmaastus = 'N'
   LET g_pmaa_m.pmaacnfid = ""
   LET g_pmaa_m.pmaacnfdt = ""
   LET g_pmaa001_t2 = g_pmaa001_t
   
#   CASE g_argv[1]
#      WHEN '1'
#         LET g_pmaa_m.pmaa002 = '1'
#         LET g_pmaa_m.pmab032 = g_dlang
#      WHEN '2'         
#         LET g_pmaa_m.pmaa002 = '2'
#         LET g_pmaa_m.pmab082 = g_dlang
#         LET g_pmaa_m.pmaa092 = '2'
#      WHEN '3'  
#         LET g_pmaa_m.pmaa002 = '2'
#         LET g_pmaa_m.pmab082 = g_dlang  
#         LET g_pmaa_m.pmaa092 = '1'         
#   END CASE
   
   LET g_pmaa_m.pmaa085 = g_site
   CALL apmm801_pmaa085_ref()
   LET g_pmaa_m.pmaa095 = g_site
   CALL apmm801_pmaa095_ref()
   
   LET g_pmaa_m.pmaa027 = ''
      
   LET g_pmaa_m.pmaa003 = ''

   LET g_pmaa_m_t.* = g_pmaa_m.*
   LET g_pmaa_m_o.* = g_pmaa_m.*
   
   INITIALIZE g_pmaa027_d TO NULL
   #151027-00016#9 20151225 add by beckxie---S
   CALL aooi350_01_clear_detail()   #清空聯絡地址頁籤
   CALL aooi350_02_clear_detail()   #清空通訊方式頁籤
   CALL g_pmag_d.clear()            #清空證照頁籤
   CALL g_pmag5_d.clear()           #清空交易夥伴關係頁籤
   CALL g_pmag6_d.clear()           #清空銀行頁籤
   #151027-00016#9 20151225 add by beckxie---E
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()
   #end add-point
   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:3)
	  #根據當下狀態碼顯示圖片
      CASE g_pmaa_m.pmaastus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")
         
      END CASE
 
 
 
   
   #清空key欄位的desc
   
   
   CALL apmm801_input("r")
   
   IF INT_FLAG AND NOT g_master_insert THEN
      LET INT_FLAG = 0
      DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
      DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
      LET INT_FLAG = 0
      INITIALIZE g_pmaa_m.* TO NULL
      INITIALIZE g_pmag_d TO NULL
      INITIALIZE g_pmag2_d TO NULL
      INITIALIZE g_pmag3_d TO NULL
      INITIALIZE g_pmag4_d TO NULL
      INITIALIZE g_pmag5_d TO NULL
      INITIALIZE g_pmag6_d TO NULL
      INITIALIZE g_pmag7_d TO NULL
      INITIALIZE g_pmag9_d TO NULL
 
      #add-point:複製取消後 name="reproduce.cancel"
      
      #end add-point
      CALL apmm801_show()
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = '' 
      LET g_errparam.code = 9001 
      LET g_errparam.popup = FALSE 
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL apmm801_set_act_visible()   
   CALL apmm801_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_pmaa001_t = g_pmaa_m.pmaa001
 
   
   #組合新增資料的條件
   LET g_add_browse = " pmaaent = " ||g_enterprise|| " AND",
                      " pmaa001 = '", g_pmaa_m.pmaa001, "' "
 
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL apmm801_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   #add-point:完成複製段落後 name="reproduce.after_reproduce"
                  
   #end add-point
   
   CALL apmm801_idx_chk()
   
   LET g_data_owner = g_pmaa_m.pmaaownid      
   LET g_data_dept  = g_pmaa_m.pmaaowndp
   
   #功能已完成,通報訊息中心
   CALL apmm801_msgcentre_notify('reproduce')
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.detail_reproduce" >}
#+ 單身自動複製
PRIVATE FUNCTION apmm801_detail_reproduce()
   #add-point:delete段define(客製用) name="detail_reproduce.define_customerization"
   
   #end add-point    
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE pmag_t.* #此變數樣板目前無使用
   DEFINE l_detail2    RECORD LIKE pmax_t.* #此變數樣板目前無使用
 
   DEFINE l_detail3    RECORD LIKE pmay_t.* #此變數樣板目前無使用
 
   DEFINE l_detail4    RECORD LIKE pmaz_t.* #此變數樣板目前無使用
 
   DEFINE l_detail5    RECORD LIKE pmac_t.* #此變數樣板目前無使用
 
   DEFINE l_detail6    RECORD LIKE pmaf_t.* #此變數樣板目前無使用
 
   DEFINE l_detail7    RECORD LIKE pmad_t.* #此變數樣板目前無使用
 
   DEFINE l_detail8    RECORD LIKE pmae_t.* #此變數樣板目前無使用
 
 
 
   #add-point:delete段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="detail_reproduce.define"
   DEFINE l_success  LIKE type_t.num5
   #end add-point    
   
   #add-point:Function前置處理  name="detail_reproduce.pre_function"
   
   #end add-point
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE apmm801_detail
   
   #add-point:單身複製前1 name="detail_reproduce.body.table1.b_insert"
   LET g_pmaa001_t = g_pmaa001_t2
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmag_t
    WHERE pmagent = g_enterprise AND pmag001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail 
      #更新key欄位
      SET pmag001 = g_pmaa_m.pmaa001
 
      #更新共用欄位
      #應用 a13 樣板自動產生(Version:4)
      #, pmagstus = "Y" 
 
 
#應用 a13 樣板自動產生(Version:4)
      #, pmaxstus = "Y" 
 
 
#應用 a13 樣板自動產生(Version:4)
      #, pmacstus = "Y" 
 
 
#應用 a13 樣板自動產生(Version:4)
      #, pmafstus = "Y" 
 
 
#應用 a13 樣板自動產生(Version:4)
      #, pmadstus = "Y" 
 
 
 
 
   #add-point:單身修改前 name="detail_reproduce.body.table1.b_update"
   #151027-00016#9 20151225 add by beckxie---S
   DELETE FROM apmm801_detail 
    WHERE pmagent = g_enterprise 
      AND pmag001 = g_pmaa_m.pmaa001
   #151027-00016#9 20151225 add by beckxie---E
   DISPLAY "SQLCA.SQLERRD[3]:",SQLCA.SQLERRD[3]
   #end add-point                                       
  
   #將資料塞回原table   
   INSERT INTO pmag_t SELECT * FROM apmm801_detail
   
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   
   #add-point:單身複製中1 name="detail_reproduce.body.table1.m_insert"
   
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後1 name="detail_reproduce.body.table1.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table2.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmax_t 
    WHERE pmaxent = g_enterprise AND pmax001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmax001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table2.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmax_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table2.m_insert"
                  
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table2.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table3.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmay_t 
    WHERE pmayent = g_enterprise AND pmay001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmay001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table3.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmay_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table3.m_insert"
                  
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table3.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table4.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmaz_t 
    WHERE pmazent = g_enterprise AND pmaz001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmaz001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table4.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmaz_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table4.m_insert"
                  
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table4.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table5.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmac_t 
    WHERE pmacent = g_enterprise AND pmac001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmac001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table5.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmac_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table5.m_insert"
   #151027-00016#9 20151225 add by beckxie---S
   DELETE FROM pmac_t 
    WHERE pmacent = g_enterprise 
      AND pmac001 = g_pmaa_m.pmaa001
      AND pmac002 != g_pmaa_m.pmaa001
   #151027-00016#9 20151225 add by beckxie---E              
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table5.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table6.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmaf_t 
    WHERE pmafent = g_enterprise AND pmaf001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmaf001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table6.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmaf_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table6.m_insert"
   #151027-00016#9 20151225 add by beckxie---S
   DELETE FROM pmaf_t
    WHERE pmafent = g_enterprise 
      AND pmaf001 = g_pmaa_m.pmaa001
   #151027-00016#9 20151225 add by beckxie---E
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table6.a_insert"
                  
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table7.b_insert"
                  
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmad_t 
    WHERE pmadent = g_enterprise AND pmad001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmad001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table7.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmad_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table7.m_insert"
                  
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table7.a_insert"
             
   #end add-point
 
   #add-point:單身複製前 name="detail_reproduce.body.table8.b_insert"
   
   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM pmae_t 
    WHERE pmaeent = g_enterprise AND pmae001 = g_pmaa001_t
 
    INTO TEMP apmm801_detail
 
   #將key修正為調整後   
   UPDATE apmm801_detail SET pmae001 = g_pmaa_m.pmaa001
 
  
   #add-point:單身修改前 name="detail_reproduce.body.table8.b_update"
   
   #end add-point    
 
   #將資料塞回原table   
   INSERT INTO pmae_t SELECT * FROM apmm801_detail
   
   #add-point:單身複製中 name="detail_reproduce.body.table8.m_insert"
   
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE apmm801_detail
   
   #add-point:單身複製後 name="detail_reproduce.body.table8.a_insert"
   
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_pmaa001_t = g_pmaa_m.pmaa001
 
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.delete" >}
#+ 資料刪除
PRIVATE FUNCTION apmm801_delete()
   #add-point:delete段define(客製用) name="delete.define_customerization"
   
   #end add-point     
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="delete.define"
                     DEFINE l_success       LIKE type_t.num5
   #end add-point     
   
   #add-point:Function前置處理  name="delete.pre_function"
   
   #end add-point
   
   IF g_pmaa_m.pmaa001 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   LET g_master_multi_table_t.pmaal001 = g_pmaa_m.pmaa001
LET g_master_multi_table_t.pmaal004 = g_pmaa_m.pmaal004
LET g_master_multi_table_t.pmaal003 = g_pmaa_m.pmaal003
LET g_master_multi_table_t.pmaal006 = g_pmaa_m.pmaal006
LET g_master_multi_table_t.pmaal005 = g_pmaa_m.pmaal005
 
   
   CALL s_transaction_begin()
 
   OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
   IF SQLCA.SQLCODE THEN   #(ver:78)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN apmm801_cl:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
      LET g_errparam.popup = TRUE 
      CLOSE apmm801_cl
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
   
   #檢查是否允許此動作
   IF NOT apmm801_action_chk() THEN
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_pmaa_m_mask_o.* =  g_pmaa_m.*
   CALL apmm801_pmaa_t_mask()
   LET g_pmaa_m_mask_n.* =  g_pmaa_m.*
   
   CALL apmm801_show()
   
   #add-point:delete段before ask name="delete.before_ask"
   #150429-00011#8 Add-S By Ken 150515
   CALL cl_err_collect_init()
   IF NOT apmm801_pmaa001_chk() THEN
      CALL cl_err_collect_show()
      RETURN
   END IF
   CALL cl_err_collect_show()
   #150429-00011#8 Add-E By Ken 150515
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前 name="delete.head.b_delete"
 
      #end add-point   
      
      #應用 a47 樣板自動產生(Version:4)
      #刪除相關文件
      CALL apmm801_set_pk_array()
      #add-point:相關文件刪除前 name="delete.befroe.related_document_remove"
      
      #end add-point   
      CALL cl_doc_remove()  
 
 
 
  
  
      #資料備份
      LET g_pmaa001_t = g_pmaa_m.pmaa001
 
 
      DELETE FROM pmaa_t
       WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001
 
       
      #add-point:單頭刪除中 name="delete.head.m_delete"
                                    
      #end add-point
       
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_pmaa_m.pmaa001,":",SQLERRMESSAGE  
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF
      
      #add-point:單頭刪除後 name="delete.head.a_delete"
      
      DELETE FROM pmaal_t
       WHERE pmaalent = g_enterprise AND pmaal001 = g_pmaa_m.pmaa001
       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'del pmaal_t'
         LET g_errparam.popup = FALSE
         CALL cl_err()
 
         CALL s_transaction_end('N','0')
         RETURN
      END IF   
      
      DELETE FROM pmab_t
       WHERE pmabent = g_enterprise 
         AND pmab001 = g_pmaa_m.pmaa001
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'del pmab_t'
         LET g_errparam.popup = FALSE
         CALL cl_err()
 
         CALL s_transaction_end('N','0')
         RETURN
      END IF   
      
      #刪除ooff_t備註
      LET l_success = ''
      CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
      IF NOT l_success THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ooff_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      IF NOT cl_null(g_pmaa_m.pmaa027) THEN
         IF NOT s_aooi350_del(g_pmaa_m.pmaa027) THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "del oofa_t"
            LET g_errparam.popup = FALSE
            CALL cl_err()

            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF 
      
      #end add-point
  
      #add-point:單身刪除前 name="delete.body.b_delete"
                                    
      #end add-point
      
      DELETE FROM pmag_t
       WHERE pmagent = g_enterprise AND pmag001 = g_pmaa_m.pmaa001
 
 
      #add-point:單身刪除中 name="delete.body.m_delete"
                                    
      #end add-point
         
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF    
 
      #add-point:單身刪除後 name="delete.body.a_delete"
                                    
      #end add-point
      
            
                                                               
      #add-point:單身刪除前 name="delete.body.b_delete2"
                                    
      #end add-point
      DELETE FROM pmax_t
       WHERE pmaxent = g_enterprise AND
             pmax001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete2"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete2"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete3"
                                    
      #end add-point
      DELETE FROM pmay_t
       WHERE pmayent = g_enterprise AND
             pmay001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete3"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete3"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete4"
                                    
      #end add-point
      DELETE FROM pmaz_t
       WHERE pmazent = g_enterprise AND
             pmaz001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete4"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete4"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete5"
                                    
      #end add-point
      DELETE FROM pmac_t
       WHERE pmacent = g_enterprise AND
             pmac001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete5"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete5"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete6"
                                    
      #end add-point
      DELETE FROM pmaf_t
       WHERE pmafent = g_enterprise AND
             pmaf001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete6"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete6"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete7"
                                    
      #end add-point
      DELETE FROM pmad_t
       WHERE pmadent = g_enterprise AND
             pmad001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete7"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete7"
                                    
      #end add-point
 
      #add-point:單身刪除前 name="delete.body.b_delete8"
      
      #end add-point
      DELETE FROM pmae_t
       WHERE pmaeent = g_enterprise AND
             pmae001 = g_pmaa_m.pmaa001
      #add-point:單身刪除中 name="delete.body.m_delete8"
      
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:單身刪除後 name="delete.body.a_delete8"
      
      #end add-point
 
 
 
 
      
      #修改歷程記錄(刪除)
      LET g_log1 = util.JSON.stringify(g_pmaa_m)   #(ver:78)
      IF NOT cl_log_modified_record(g_log1,'') THEN    #(ver:78)
         CLOSE apmm801_cl
         CALL s_transaction_end('N','0')
         RETURN
      END IF
             
      CLEAR FORM
      CALL g_pmag_d.clear() 
      CALL g_pmag2_d.clear()       
      CALL g_pmag3_d.clear()       
      CALL g_pmag4_d.clear()       
      CALL g_pmag5_d.clear()       
      CALL g_pmag6_d.clear()       
      CALL g_pmag7_d.clear()       
      CALL g_pmag9_d.clear()       
 
     
      CALL apmm801_ui_browser_refresh()  
      #CALL apmm801_ui_headershow()  
      #CALL apmm801_ui_detailshow()
 
      #add-point:多語言刪除 name="delete.lang.before_delete"
      
      #end add-point
      
      #單頭多語言刪除
      INITIALIZE l_var_keys_bak TO NULL 
   INITIALIZE l_field_keys   TO NULL 
   LET l_var_keys_bak[01] = g_enterprise
   LET l_field_keys[01] = 'pmaalent'
   LET l_var_keys_bak[02] = g_master_multi_table_t.pmaal001
   LET l_field_keys[02] = 'pmaal001'
   CALL cl_multitable_delete(l_field_keys,l_var_keys_bak,'pmaal_t')
 
      
      #單身多語言刪除
      
      
      
      
      
      
      
      
 
   
      #add-point:多語言刪除 name="delete.lang.delete"
      
      #end add-point
      
      IF g_browser_cnt > 0 THEN 
         #CALL apmm801_browser_fill("")
         CALL apmm801_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
         DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
      ELSE
         CLEAR FORM
      END IF
      
      CALL s_transaction_end('Y','0')
   ELSE
      CALL s_transaction_end('N','0')
   END IF
 
   CLOSE apmm801_cl
 
   #功能已完成,通報訊息中心
   CALL apmm801_msgcentre_notify('delete')
    
END FUNCTION
 
{</section>}
 
{<section id="apmm801.b_fill" >}
#+ 單身陣列填充
PRIVATE FUNCTION apmm801_b_fill()
   #add-point:b_fill段define(客製用) name="b_fill.define_customerization"
   
   #end add-point     
   DEFINE p_wc2      STRING
   DEFINE li_idx     LIKE type_t.num10
   #add-point:b_fill段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="b_fill.define"
                  
   #end add-point     
   
   #add-point:Function前置處理  name="b_fill.pre_function"
   
   #end add-point
   
   #清空第一階單身
   CALL g_pmag_d.clear()
   CALL g_pmag2_d.clear()
   CALL g_pmag3_d.clear()
   CALL g_pmag4_d.clear()
   CALL g_pmag5_d.clear()
   CALL g_pmag6_d.clear()
   CALL g_pmag7_d.clear()
   CALL g_pmag9_d.clear()
 
 
   #add-point:b_fill段sql_before name="b_fill.sql_before"
   CALL g_pmag8_d.clear()              
   INITIALIZE g_pmaa027_d TO NULL
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()
   #end add-point
   
   #判斷是否填充
   IF apmm801_fill_chk(1) THEN
      #切換上下筆時不重組SQL
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
      #add-point:b_fill段long_sql_if name="b_fill.long_sql_if"
      
      #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmag002,pmag003,pmag004,pmag007,pmag008,pmagstus ,t1.oocql004 FROM pmag_t", 
                
                     " INNER JOIN pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmag001 ",
 
                     #"",
                     
                     "",
                     #下層單身所需的join條件
 
                                    " LEFT JOIN oocql_t t1 ON t1.oocqlent="||g_enterprise||" AND t1.oocql001='2036' AND t1.oocql002=pmag002 AND t1.oocql003='"||g_dlang||"' ",
 
                     " WHERE pmagent=? AND pmag001=?"
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段sql_before name="b_fill.body.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table1) THEN
            LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmag_t.pmag002,pmag_t.pmag003"
         
         #add-point:單身填充控制 name="b_fill.sql"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb FROM g_sql
         DECLARE b_fill_cs CURSOR FOR apmm801_pb
      END IF
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
   #  OPEN b_fill_cs USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag_d[l_ac].pmag002,g_pmag_d[l_ac].pmag003, 
          g_pmag_d[l_ac].pmag004,g_pmag_d[l_ac].pmag007,g_pmag_d[l_ac].pmag008,g_pmag_d[l_ac].pmagstus, 
          g_pmag_d[l_ac].pmag002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill.fill"
                                                      
         #end add-point
      
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = l_ac
               LET g_errparam.code = 9035 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
            END IF
            EXIT FOREACH
         END IF
         
         LET l_ac = l_ac + 1
      END FOREACH
      LET g_error_show = 0
   
   END IF
    
   #判斷是否填充
   IF apmm801_fill_chk(2) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body2.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmax002,pmax003,pmaxstus ,t2.rtaxl003 ,t3.oocql004 FROM pmax_t", 
                
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmax001 ",
 
                     "",
                     
                                    " LEFT JOIN rtaxl_t t2 ON t2.rtaxlent="||g_enterprise||" AND t2.rtaxl001=pmax002 AND t2.rtaxl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t3 ON t3.oocqlent="||g_enterprise||" AND t3.oocql001='2002' AND t3.oocql002=pmax003 AND t3.oocql003='"||g_dlang||"' ",
 
                     " WHERE pmaxent=? AND pmax001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body2.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table2) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table2 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmax_t.pmax002,pmax_t.pmax003"
         
         #add-point:單身填充控制 name="b_fill.sql2"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb2 FROM g_sql
         DECLARE b_fill_cs2 CURSOR FOR apmm801_pb2
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs2 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs2 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag2_d[l_ac].pmax002,g_pmag2_d[l_ac].pmax003, 
          g_pmag2_d[l_ac].pmaxstus,g_pmag2_d[l_ac].pmax002_desc,g_pmag2_d[l_ac].pmax003_desc   #(ver:78) 
 
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill2.fill"
                                                      
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(3) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body3.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmay002,pmay003,pmay004,pmay005 ,t4.oocql004 FROM pmay_t",   
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmay001 ",
 
                     "",
                     
                                    " LEFT JOIN oocql_t t4 ON t4.oocqlent="||g_enterprise||" AND t4.oocql001='2073' AND t4.oocql002=pmay002 AND t4.oocql003='"||g_dlang||"' ",
 
                     " WHERE pmayent=? AND pmay001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body3.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table3) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table3 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmay_t.pmay002,pmay_t.pmay003"
         
         #add-point:單身填充控制 name="b_fill.sql3"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb3 FROM g_sql
         DECLARE b_fill_cs3 CURSOR FOR apmm801_pb3
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs3 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs3 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag3_d[l_ac].pmay002,g_pmag3_d[l_ac].pmay003, 
          g_pmag3_d[l_ac].pmay004,g_pmag3_d[l_ac].pmay005,g_pmag3_d[l_ac].pmay002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill3.fill"
                                                      
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(4) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body4.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmaz002,pmaz003 ,t5.oocql004 FROM pmaz_t",   
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmaz001 ",
 
                     "",
                     
                                    " LEFT JOIN oocql_t t5 ON t5.oocqlent="||g_enterprise||" AND t5.oocql001='2074' AND t5.oocql002=pmaz002 AND t5.oocql003='"||g_dlang||"' ",
 
                     " WHERE pmazent=? AND pmaz001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body4.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table4) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table4 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmaz_t.pmaz002"
         
         #add-point:單身填充控制 name="b_fill.sql4"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb4 FROM g_sql
         DECLARE b_fill_cs4 CURSOR FOR apmm801_pb4
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs4 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs4 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag4_d[l_ac].pmaz002,g_pmag4_d[l_ac].pmaz003, 
          g_pmag4_d[l_ac].pmaz002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill4.fill"
                                                      
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(5) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body5.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmacstus,pmac003,pmac004,pmac002 ,t6.pmaal004 FROM pmac_t",   
              
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmac001 ",
 
                     "",
                     
                                    " LEFT JOIN pmaal_t t6 ON t6.pmaalent="||g_enterprise||" AND t6.pmaal001=pmac002 AND t6.pmaal002='"||g_dlang||"' ",
 
                     " WHERE pmacent=? AND pmac001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body5.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table5) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table5 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmac_t.pmac002,pmac_t.pmac003"
         
         #add-point:單身填充控制 name="b_fill.sql5"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb5 FROM g_sql
         DECLARE b_fill_cs5 CURSOR FOR apmm801_pb5
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs5 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs5 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag5_d[l_ac].pmacstus,g_pmag5_d[l_ac].pmac003, 
          g_pmag5_d[l_ac].pmac004,g_pmag5_d[l_ac].pmac002,g_pmag5_d[l_ac].pmac002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill5.fill"
 
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(6) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body6.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmafstus,pmaf010,pmaf002,pmaf003,pmaf004,pmaf011,pmaf008,pmaf009, 
             pmaf005,pmaf007,pmaf006 ,t7.nmabl003 ,t8.mhbel003 FROM pmaf_t",   
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmaf001 ",
 
                     "",
                     
                                    " LEFT JOIN nmabl_t t7 ON t7.nmablent="||g_enterprise||" AND t7.nmabl001=pmaf002 AND t7.nmabl002='"||g_dlang||"' ",
               " LEFT JOIN mhbel_t t8 ON t8.mhbelent="||g_enterprise||" AND t8.mhbel001=pmaf011 AND t8.mhbel002='"||g_dlang||"' ",
 
                     " WHERE pmafent=? AND pmaf001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body6.fill_sql"
                                    
         #end add-point
         IF NOT cl_null(g_wc2_table6) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table6 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmaf_t.pmaf002,pmaf_t.pmaf003"
         
         #add-point:單身填充控制 name="b_fill.sql6"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb6 FROM g_sql
         DECLARE b_fill_cs6 CURSOR FOR apmm801_pb6
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs6 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs6 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag6_d[l_ac].pmafstus,g_pmag6_d[l_ac].pmaf010, 
          g_pmag6_d[l_ac].pmaf002,g_pmag6_d[l_ac].pmaf003,g_pmag6_d[l_ac].pmaf004,g_pmag6_d[l_ac].pmaf011, 
          g_pmag6_d[l_ac].pmaf008,g_pmag6_d[l_ac].pmaf009,g_pmag6_d[l_ac].pmaf005,g_pmag6_d[l_ac].pmaf007, 
          g_pmag6_d[l_ac].pmaf006,g_pmag6_d[l_ac].pmaf002_desc,g_pmag6_d[l_ac].pmaf011_desc   #(ver:78) 
 
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill6.fill"
                                                      
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(7) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body7.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmad003,pmadstus,pmad002,pmad004 ,t9.ooibl004 FROM pmad_t",   
              
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmad001 ",
 
                     "",
                     
                                    " LEFT JOIN ooibl_t t9 ON t9.ooiblent="||g_enterprise||" AND t9.ooibl002=pmad002 AND t9.ooibl003='"||g_dlang||"' ",
 
                     " WHERE pmadent=? AND pmad001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body7.fill_sql"
                                          LET g_sql = g_sql CLIPPED," AND pmad003 = '1'"  
         #end add-point
         IF NOT cl_null(g_wc2_table7) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table7 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmad_t.pmad002"
         
         #add-point:單身填充控制 name="b_fill.sql7"
                                    
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb7 FROM g_sql
         DECLARE b_fill_cs7 CURSOR FOR apmm801_pb7
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs7 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs7 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag7_d[l_ac].pmad003,g_pmag7_d[l_ac].pmadstus, 
          g_pmag7_d[l_ac].pmad002,g_pmag7_d[l_ac].pmad004,g_pmag7_d[l_ac].pmad002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill7.fill"
                                                      
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF apmm801_fill_chk(8) THEN
      IF (g_action_choice = "query" OR cl_null(g_action_choice))
         #add-point:b_fill段long_sql_if name="b_fill.body8.long_sql_if"
         
         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT pmae002,pmae003 ,t10.oocql004 FROM pmae_t",   
                     " INNER JOIN  pmaa_t ON pmaaent = " ||g_enterprise|| " AND pmaa001 = pmae001 ",
 
                     "",
                     
                                    " LEFT JOIN oocql_t t10 ON t10.oocqlent="||g_enterprise||" AND t10.oocql001='235' AND t10.oocql002=pmae002 AND t10.oocql003='"||g_dlang||"' ",
 
                     " WHERE pmaeent=? AND pmae001=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段fill_sql name="b_fill.body8.fill_sql"
         
         #end add-point
         IF NOT cl_null(g_wc2_table8) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table8 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY pmae_t.pmae002,pmae_t.pmae003"
         
         #add-point:單身填充控制 name="b_fill.sql8"
         
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE apmm801_pb8 FROM g_sql
         DECLARE b_fill_cs8 CURSOR FOR apmm801_pb8
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs8 USING g_enterprise,g_pmaa_m.pmaa001   #(ver:78)
                                               
      FOREACH b_fill_cs8 USING g_enterprise,g_pmaa_m.pmaa001 INTO g_pmag9_d[l_ac].pmae002,g_pmag9_d[l_ac].pmae003, 
          g_pmag9_d[l_ac].pmae002_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充 name="b_fill8.fill"
         
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
 
   
   #add-point:browser_fill段其他table處理 name="browser_fill.other_fill"
   IF (apmm801_fill_chk(8) AND (cl_null(g_wc2_table8) OR g_wc2_table8.trim() = '1=1'))
    OR((NOT cl_null(g_wc2_table8) AND g_wc2_table8.trim() <> '1=1')) THEN
      #150127-00003#1 Modify-S By Ken 150426
      #LET g_sql = "SELECT  UNIQUE pmad003,pmadstus,pmad002,,pmad004 FROM pmad_t",   
      #            " INNER JOIN pmaa_t ON pmaa001 = pmad001 ",
      #            " WHERE pmadent=? AND pmad001=?"  
      LET g_sql = "SELECT  UNIQUE pmad003,pmadstus,pmad002,t8.ooibl004,pmad004 FROM pmad_t",   
                  " INNER JOIN pmaa_t ON pmaa001 = pmad001 ",                 
                  " LEFT JOIN ooibl_t t8 ON t8.ooiblent='"||g_enterprise||"' AND t8.ooibl002=pmad002 AND t8.ooibl003='"||g_dlang||"' ",                                    
                  " WHERE pmadent=? AND pmad001=?"                    
      #150127-00003#1 Modify-E
      LET g_sql = g_sql CLIPPED," AND pmad003 = '2'"        
   
      IF NOT cl_null(g_wc2_table8) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table8 CLIPPED
      END IF
      
      LET g_sql = g_sql, " ORDER BY pmad_t.pmad002,pmad_t.pmad003"
     
     #160810-00008#1 160819 by lori mod---(S)      
     #PREPARE apmm801_pb8 FROM g_sql
     #DECLARE b_fill_cs8 CURSOR FOR apmm801_pb8
      PREPARE apmm801_pmad_pb FROM g_sql
      DECLARE b_fill_pmad_cs CURSOR FOR apmm801_pmad_pb    
     #160810-00008#1 160819 by lori mod---(E)
     
      LET l_ac = 1
      
     #OPEN b_fill_cs8 USING g_enterprise,g_pmaa_m.pmaa001      #160810-00008#1 160819 by lori mark
     OPEN b_fill_pmad_cs USING g_enterprise,g_pmaa_m.pmaa001   #160810-00008#1 160819 by lori add 
                                               
     #FOREACH b_fill_cs8 INTO g_pmag8_d[l_ac].pmad003_1,g_pmag8_d[l_ac].pmadstus_1,        #160810-00008#1 160819 by lori mark
      FOREACH b_fill_pmad_cs INTO g_pmag8_d[l_ac].pmad003_1,g_pmag8_d[l_ac].pmadstus_1,    #160810-00008#1 160819 by lori add
                                  g_pmag8_d[l_ac].pmad002_1,g_pmag8_d[l_ac].pmad002_1_desc,g_pmag8_d[l_ac].pmad004_1
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "FOREACH:"
            LET g_errparam.popup = TRUE
            CALL cl_err()
   
            EXIT FOREACH
         END IF
   
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code =  9035
            LET g_errparam.extend =  ''
            LET g_errparam.popup = FALSE
            CALL cl_err()
   
            EXIT FOREACH
         END IF
      END FOREACH
   END IF
   
   CALL g_pmag8_d.deleteElement(g_pmag8_d.getLength())
   
  #FREE apmm801_pb8       #160810-00008#1 160819 by lori mark
   FREE apmm801_pmad_pb   #160810-00008#1 160819 by lori add
   
   IF NOT cl_null(g_pmaa_m.pmaa027) THEN
      LET g_pmaa027_d = g_pmaa_m.pmaa027
      CALL aooi350_01_b_fill(g_pmaa027_d)
      CALL aooi350_02_b_fill(g_pmaa027_d)
   END IF   
   #end add-point
   
   CALL g_pmag_d.deleteElement(g_pmag_d.getLength())
   CALL g_pmag2_d.deleteElement(g_pmag2_d.getLength())
   CALL g_pmag3_d.deleteElement(g_pmag3_d.getLength())
   CALL g_pmag4_d.deleteElement(g_pmag4_d.getLength())
   CALL g_pmag5_d.deleteElement(g_pmag5_d.getLength())
   CALL g_pmag6_d.deleteElement(g_pmag6_d.getLength())
   CALL g_pmag7_d.deleteElement(g_pmag7_d.getLength())
   CALL g_pmag9_d.deleteElement(g_pmag9_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE apmm801_pb
   FREE apmm801_pb2
 
   FREE apmm801_pb3
 
   FREE apmm801_pb4
 
   FREE apmm801_pb5
 
   FREE apmm801_pb6
 
   FREE apmm801_pb7
 
   FREE apmm801_pb8
 
 
   
   LET li_idx = l_ac
   
   #遮罩相關處理
   FOR l_ac = 1 TO g_pmag_d.getLength()
      LET g_pmag_d_mask_o[l_ac].* =  g_pmag_d[l_ac].*
      CALL apmm801_pmag_t_mask()
      LET g_pmag_d_mask_n[l_ac].* =  g_pmag_d[l_ac].*
   END FOR
   
   LET g_pmag2_d_mask_o.* =  g_pmag2_d.*
   FOR l_ac = 1 TO g_pmag2_d.getLength()
      LET g_pmag2_d_mask_o[l_ac].* =  g_pmag2_d[l_ac].*
      CALL apmm801_pmax_t_mask()
      LET g_pmag2_d_mask_n[l_ac].* =  g_pmag2_d[l_ac].*
   END FOR
   LET g_pmag3_d_mask_o.* =  g_pmag3_d.*
   FOR l_ac = 1 TO g_pmag3_d.getLength()
      LET g_pmag3_d_mask_o[l_ac].* =  g_pmag3_d[l_ac].*
      CALL apmm801_pmay_t_mask()
      LET g_pmag3_d_mask_n[l_ac].* =  g_pmag3_d[l_ac].*
   END FOR
   LET g_pmag4_d_mask_o.* =  g_pmag4_d.*
   FOR l_ac = 1 TO g_pmag4_d.getLength()
      LET g_pmag4_d_mask_o[l_ac].* =  g_pmag4_d[l_ac].*
      CALL apmm801_pmaz_t_mask()
      LET g_pmag4_d_mask_n[l_ac].* =  g_pmag4_d[l_ac].*
   END FOR
   LET g_pmag5_d_mask_o.* =  g_pmag5_d.*
   FOR l_ac = 1 TO g_pmag5_d.getLength()
      LET g_pmag5_d_mask_o[l_ac].* =  g_pmag5_d[l_ac].*
      CALL apmm801_pmac_t_mask()
      LET g_pmag5_d_mask_n[l_ac].* =  g_pmag5_d[l_ac].*
   END FOR
   LET g_pmag6_d_mask_o.* =  g_pmag6_d.*
   FOR l_ac = 1 TO g_pmag6_d.getLength()
      LET g_pmag6_d_mask_o[l_ac].* =  g_pmag6_d[l_ac].*
      CALL apmm801_pmaf_t_mask()
      LET g_pmag6_d_mask_n[l_ac].* =  g_pmag6_d[l_ac].*
   END FOR
   LET g_pmag7_d_mask_o.* =  g_pmag7_d.*
   FOR l_ac = 1 TO g_pmag7_d.getLength()
      LET g_pmag7_d_mask_o[l_ac].* =  g_pmag7_d[l_ac].*
      CALL apmm801_pmad_t_mask()
      LET g_pmag7_d_mask_n[l_ac].* =  g_pmag7_d[l_ac].*
   END FOR
   LET g_pmag9_d_mask_o.* =  g_pmag9_d.*
   FOR l_ac = 1 TO g_pmag9_d.getLength()
      LET g_pmag9_d_mask_o[l_ac].* =  g_pmag9_d[l_ac].*
      CALL apmm801_pmae_t_mask()
      LET g_pmag9_d_mask_n[l_ac].* =  g_pmag9_d[l_ac].*
   END FOR
 
   
   LET l_ac = li_idx
   
   CALL cl_ap_performance_next_end()
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.delete_b" >}
#+ 刪除單身後其他table連動
PRIVATE FUNCTION apmm801_delete_b(ps_table,ps_keys_bak,ps_page)
   #add-point:delete_b段define(客製用) name="delete_b.define_customerization"
   
   #end add-point     
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:delete_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="delete_b.define"
                  
   #end add-point     
   
   #add-point:Function前置處理  name="delete_b.pre_function"
   
   #end add-point
   
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete"
                                    
      #end add-point    
      DELETE FROM pmag_t
       WHERE pmagent = g_enterprise AND
         pmag001 = ps_keys_bak[1] AND pmag002 = ps_keys_bak[2] AND pmag003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = ":",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_pmag_d.deleteElement(li_idx) 
      END IF 
 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete2"
                                    
      #end add-point    
      DELETE FROM pmax_t
       WHERE pmaxent = g_enterprise AND
             pmax001 = ps_keys_bak[1] AND pmax002 = ps_keys_bak[2] AND pmax003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete2"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'2'" THEN 
         CALL g_pmag2_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete2"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete3"
                                    
      #end add-point    
      DELETE FROM pmay_t
       WHERE pmayent = g_enterprise AND
             pmay001 = ps_keys_bak[1] AND pmay002 = ps_keys_bak[2] AND pmay003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete3"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'3'" THEN 
         CALL g_pmag3_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete3"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete4"
                                    
      #end add-point    
      DELETE FROM pmaz_t
       WHERE pmazent = g_enterprise AND
             pmaz001 = ps_keys_bak[1] AND pmaz002 = ps_keys_bak[2]
      #add-point:delete_b段刪除中 name="delete_b.m_delete4"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'4'" THEN 
         CALL g_pmag4_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete4"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete5"
                                    
      #end add-point    
      DELETE FROM pmac_t
       WHERE pmacent = g_enterprise AND
             pmac001 = ps_keys_bak[1] AND pmac002 = ps_keys_bak[2] AND pmac003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete5"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'5'" THEN 
         CALL g_pmag5_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete5"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'6',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete6"
                                    
      #end add-point    
      DELETE FROM pmaf_t
       WHERE pmafent = g_enterprise AND
             pmaf001 = ps_keys_bak[1] AND pmaf002 = ps_keys_bak[2] AND pmaf003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete6"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'6'" THEN 
         CALL g_pmag6_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete6"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'7',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete7"
                                    
      #end add-point    
      DELETE FROM pmad_t
       WHERE pmadent = g_enterprise AND
             pmad001 = ps_keys_bak[1] AND pmad002 = ps_keys_bak[2]
      #add-point:delete_b段刪除中 name="delete_b.m_delete7"
                                    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'7'" THEN 
         CALL g_pmag7_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete7"
                                    
      #end add-point    
   END IF
 
   LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前 name="delete_b.b_delete8"
      
      #end add-point    
      DELETE FROM pmae_t
       WHERE pmaeent = g_enterprise AND
             pmae001 = ps_keys_bak[1] AND pmae002 = ps_keys_bak[2] AND pmae003 = ps_keys_bak[3]
      #add-point:delete_b段刪除中 name="delete_b.m_delete8"
      
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'8'" THEN 
         CALL g_pmag9_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後 name="delete_b.a_delete8"
      
      #end add-point    
   END IF
 
 
   
 
   
   #add-point:delete_b段other name="delete_b.other"
                     LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      DELETE FROM pmad_t
       WHERE pmadent = g_enterprise AND
          pmad001 = ps_keys_bak[1] AND pmad002 = ps_keys_bak[2] AND pmad003 = ps_keys_bak[3]

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "pmad_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

      END IF
   END IF
   #end add-point  
   
   RETURN TRUE
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.insert_b" >}
#+ 新增單身後其他table連動
PRIVATE FUNCTION apmm801_insert_b(ps_table,ps_keys,ps_page)
   #add-point:insert_b段define(客製用) name="insert_b.define_customerization"
   
   #end add-point     
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:insert_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="insert_b.define"
                  
   #end add-point     
   
   #add-point:Function前置處理  name="insert_b.pre_function"
   
   #end add-point
   
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert"
 
      #end add-point 
      INSERT INTO pmag_t
                  (pmagent,
                   pmag001,
                   pmag002,pmag003
                   ,pmag004,pmag007,pmag008,pmagstus) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_pmag_d[g_detail_idx].pmag004,g_pmag_d[g_detail_idx].pmag007,g_pmag_d[g_detail_idx].pmag008, 
                       g_pmag_d[g_detail_idx].pmagstus)
      #add-point:insert_b段資料新增中 name="insert_b.m_insert"
                                    
      #end add-point 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_pmag_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert"
                                    
      #end add-point 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert2"
 
      #end add-point 
      INSERT INTO pmax_t
                  (pmaxent,
                   pmax001,
                   pmax002,pmax003
                   ,pmaxstus) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_pmag2_d[g_detail_idx].pmaxstus)
      #add-point:insert_b段資料新增中 name="insert_b.m_insert2"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'2'" THEN 
         CALL g_pmag2_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert2"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert3"
     
      #end add-point 
      INSERT INTO pmay_t
                  (pmayent,
                   pmay001,
                   pmay002,pmay003
                   ,pmay004,pmay005) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_pmag3_d[g_detail_idx].pmay004,g_pmag3_d[g_detail_idx].pmay005)
      #add-point:insert_b段資料新增中 name="insert_b.m_insert3"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'3'" THEN 
         CALL g_pmag3_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert3"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert4"
              
      #end add-point 
      INSERT INTO pmaz_t
                  (pmazent,
                   pmaz001,
                   pmaz002
                   ,pmaz003) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_pmag4_d[g_detail_idx].pmaz003)
      #add-point:insert_b段資料新增中 name="insert_b.m_insert4"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'4'" THEN 
         CALL g_pmag4_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert4"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert5"
                                
      #end add-point 
      INSERT INTO pmac_t
                  (pmacent,
                   pmac001,
                   pmac002,pmac003
                   ,pmacstus,pmac004) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_pmag5_d[g_detail_idx].pmacstus,g_pmag5_d[g_detail_idx].pmac004)
      #add-point:insert_b段資料新增中 name="insert_b.m_insert5"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'5'" THEN 
         CALL g_pmag5_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert5"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'6',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert6"
                                 
      #end add-point 
      INSERT INTO pmaf_t
                  (pmafent,
                   pmaf001,
                   pmaf002,pmaf003
                   ,pmafstus,pmaf010,pmaf004,pmaf011,pmaf008,pmaf009,pmaf005,pmaf007,pmaf006) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_pmag6_d[g_detail_idx].pmafstus,g_pmag6_d[g_detail_idx].pmaf010,g_pmag6_d[g_detail_idx].pmaf004, 
                       g_pmag6_d[g_detail_idx].pmaf011,g_pmag6_d[g_detail_idx].pmaf008,g_pmag6_d[g_detail_idx].pmaf009, 
                       g_pmag6_d[g_detail_idx].pmaf005,g_pmag6_d[g_detail_idx].pmaf007,g_pmag6_d[g_detail_idx].pmaf006) 
 
      #add-point:insert_b段資料新增中 name="insert_b.m_insert6"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'6'" THEN 
         CALL g_pmag6_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert6"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'7',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert7"
                                    
      #end add-point 
      INSERT INTO pmad_t
                  (pmadent,
                   pmad001,
                   pmad002
                   ,pmad003,pmadstus,pmad004) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_pmag7_d[g_detail_idx].pmad003,g_pmag7_d[g_detail_idx].pmadstus,g_pmag7_d[g_detail_idx].pmad004) 
 
      #add-point:insert_b段資料新增中 name="insert_b.m_insert7"
                                    
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'7'" THEN 
         CALL g_pmag7_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert7"
                                    
      #end add-point
   END IF
 
   LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前 name="insert_b.before_insert8"
      
      #end add-point 
      INSERT INTO pmae_t
                  (pmaeent,
                   pmae001,
                   pmae002,pmae003
                   ) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   )
      #add-point:insert_b段資料新增中 name="insert_b.m_insert8"
      
      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'8'" THEN 
         CALL g_pmag9_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後 name="insert_b.after_insert8"
      
      #end add-point
   END IF
 
 
   
 
   
   #add-point:insert_b段other name="insert_b.other"
                     LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      INSERT INTO pmad_t
                  (pmadent,
                   pmad001,
                   pmad002,
                   pmad003,
                   pmadstus,
                   pmad004) 
            VALUES(g_enterprise,
                   ps_keys[1],
                   ps_keys[2],
                   ps_keys[3],
                   g_pmag8_d[g_detail_idx].pmadstus_1, 
                   g_pmag8_d[g_detail_idx].pmad004_1)  

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "pmad_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

      END IF
   END IF

   #end add-point     
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.update_b" >}
#+ 修改單身後其他table連動
PRIVATE FUNCTION apmm801_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   #add-point:update_b段define(客製用) name="update_b.define_customerization"
   
   #end add-point   
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num10 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="update_b.define"
                  
   #end add-point   
   
   #add-point:Function前置處理  name="update_b.pre_function"
   
   #end add-point
   
   LET g_update = TRUE   
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmag_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update"
                                    
      #end add-point 
      
      #將遮罩欄位還原
      CALL apmm801_pmag_t_mask_restore('restore_mask_o')
               
      UPDATE pmag_t 
         SET (pmag001,
              pmag002,pmag003
              ,pmag004,pmag007,pmag008,pmagstus) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_pmag_d[g_detail_idx].pmag004,g_pmag_d[g_detail_idx].pmag007,g_pmag_d[g_detail_idx].pmag008, 
                  g_pmag_d[g_detail_idx].pmagstus) 
         WHERE pmagent = g_enterprise AND pmag001 = ps_keys_bak[1] AND pmag002 = ps_keys_bak[2] AND pmag003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update"
                                    
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmag_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmag_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
 
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmag_t_mask_restore('restore_mask_n')
               
      #add-point:update_b段修改後 name="update_b.after_update"
                                    
      #end add-point  
   END IF
   
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
   
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmax_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update2"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmax_t_mask_restore('restore_mask_o')
               
      UPDATE pmax_t 
         SET (pmax001,
              pmax002,pmax003
              ,pmaxstus) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_pmag2_d[g_detail_idx].pmaxstus) 
         WHERE pmaxent = g_enterprise AND pmax001 = ps_keys_bak[1] AND pmax002 = ps_keys_bak[2] AND pmax003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update2"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmax_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmax_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmax_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update2"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmay_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update3"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmay_t_mask_restore('restore_mask_o')
               
      UPDATE pmay_t 
         SET (pmay001,
              pmay002,pmay003
              ,pmay004,pmay005) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_pmag3_d[g_detail_idx].pmay004,g_pmag3_d[g_detail_idx].pmay005) 
         WHERE pmayent = g_enterprise AND pmay001 = ps_keys_bak[1] AND pmay002 = ps_keys_bak[2] AND pmay003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update3"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmay_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmay_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmay_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update3"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmaz_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update4"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmaz_t_mask_restore('restore_mask_o')
               
      UPDATE pmaz_t 
         SET (pmaz001,
              pmaz002
              ,pmaz003) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_pmag4_d[g_detail_idx].pmaz003) 
         WHERE pmazent = g_enterprise AND pmaz001 = ps_keys_bak[1] AND pmaz002 = ps_keys_bak[2]
      #add-point:update_b段修改中 name="update_b.m_update4"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmaz_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmaz_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmaz_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update4"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmac_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update5"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmac_t_mask_restore('restore_mask_o')
               
      UPDATE pmac_t 
         SET (pmac001,
              pmac002,pmac003
              ,pmacstus,pmac004) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_pmag5_d[g_detail_idx].pmacstus,g_pmag5_d[g_detail_idx].pmac004) 
         WHERE pmacent = g_enterprise AND pmac001 = ps_keys_bak[1] AND pmac002 = ps_keys_bak[2] AND pmac003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update5"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmac_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmac_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmac_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update5"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'6',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmaf_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update6"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmaf_t_mask_restore('restore_mask_o')
               
      UPDATE pmaf_t 
         SET (pmaf001,
              pmaf002,pmaf003
              ,pmafstus,pmaf010,pmaf004,pmaf011,pmaf008,pmaf009,pmaf005,pmaf007,pmaf006) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_pmag6_d[g_detail_idx].pmafstus,g_pmag6_d[g_detail_idx].pmaf010,g_pmag6_d[g_detail_idx].pmaf004, 
                  g_pmag6_d[g_detail_idx].pmaf011,g_pmag6_d[g_detail_idx].pmaf008,g_pmag6_d[g_detail_idx].pmaf009, 
                  g_pmag6_d[g_detail_idx].pmaf005,g_pmag6_d[g_detail_idx].pmaf007,g_pmag6_d[g_detail_idx].pmaf006)  
 
         WHERE pmafent = g_enterprise AND pmaf001 = ps_keys_bak[1] AND pmaf002 = ps_keys_bak[2] AND pmaf003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update6"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmaf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmaf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmaf_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update6"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'7',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmad_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update7"
                                    
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmad_t_mask_restore('restore_mask_o')
               
      UPDATE pmad_t 
         SET (pmad001,
              pmad002
              ,pmad003,pmadstus,pmad004) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_pmag7_d[g_detail_idx].pmad003,g_pmag7_d[g_detail_idx].pmadstus,g_pmag7_d[g_detail_idx].pmad004)  
 
         WHERE pmadent = g_enterprise AND pmad001 = ps_keys_bak[1] AND pmad002 = ps_keys_bak[2]
      #add-point:update_b段修改中 name="update_b.m_update7"
                                    
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmad_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmad_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmad_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update7"
                                    
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmae_t" THEN
      #add-point:update_b段修改前 name="update_b.before_update8"
      
      #end add-point  
      
      #將遮罩欄位還原
      CALL apmm801_pmae_t_mask_restore('restore_mask_o')
               
      UPDATE pmae_t 
         SET (pmae001,
              pmae002,pmae003
              ) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ) 
         WHERE pmaeent = g_enterprise AND pmae001 = ps_keys_bak[1] AND pmae002 = ps_keys_bak[2] AND pmae003 = ps_keys_bak[3]
      #add-point:update_b段修改中 name="update_b.m_update8"
      
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmae_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "pmae_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL apmm801_pmae_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後 name="update_b.after_update8"
      
      #end add-point  
   END IF
 
   #子表處理
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
 
   
 
   
   #add-point:update_b段other name="update_b.other"
   LET ls_group = "'8',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "pmad_t" THEN
      UPDATE pmad_t 
         SET (pmad001,
              pmad002,pmad003,
              pmadstus,pmad004) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],
              g_pmag8_d[g_detail_idx].pmadstus_1,g_pmag8_d[g_detail_idx].pmad004_1)   
         WHERE pmadent = g_enterprise AND pmad001 = ps_keys_bak[1] AND pmad002 = ps_keys_bak[2] AND pmad003 = ps_keys_bak[3]
      CASE
         WHEN SQLCA.sqlerrd[3] = 0 
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = "std-00009"
            LET g_errparam.extend = "pmad_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()

            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode 
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "pmad_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()
  
            CALL s_transaction_end('N','0')
         OTHERWISE            
      END CASE
   END IF
   
   #end add-point  
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.key_update_b" >}
#+ 上層單身key欄位變動後, 連帶修正下層單身key欄位
PRIVATE FUNCTION apmm801_key_update_b(ps_keys_bak,ps_table)
   #add-point:update_b段define(客製用) name="key_update_b.define_customerization"
   
   #end add-point
   DEFINE ps_keys_bak       DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table          STRING
   DEFINE l_field_key       DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak    DYNAMIC ARRAY OF STRING
   DEFINE l_new_key         DYNAMIC ARRAY OF STRING
   DEFINE l_old_key         DYNAMIC ARRAY OF STRING
   #add-point:update_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="key_update_b.define"
   
   #end add-point
   
   #add-point:Function前置處理  name="key_update_b.pre_function"
   
   #end add-point
   
 
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.key_delete_b" >}
#+ 上層單身刪除後, 連帶刪除下層單身key欄位
PRIVATE FUNCTION apmm801_key_delete_b(ps_keys_bak,ps_table)
   #add-point:delete_b段define(客製用) name="key_delete_b.define_customerization"
   
   #end add-point
   DEFINE ps_keys_bak       DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table          STRING
   DEFINE l_field_keys      DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak    DYNAMIC ARRAY OF STRING
   DEFINE l_new_key         DYNAMIC ARRAY OF STRING
   DEFINE l_old_key         DYNAMIC ARRAY OF STRING
   #add-point:delete_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="key_delete_b.define"
   
   #end add-point
   
   #add-point:Function前置處理  name="key_delete_b.pre_function"
   
   #end add-point
   
 
   
   RETURN TRUE
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.lock_b" >}
#+ 連動lock其他單身table資料
PRIVATE FUNCTION apmm801_lock_b(ps_table,ps_page)
   #add-point:lock_b段define(客製用) name="lock_b.define_customerization"
   
   #end add-point   
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="lock_b.define"
                  
   #end add-point   
   
   #add-point:Function前置處理  name="lock_b.pre_function"
   
   #end add-point
    
   #先刷新資料
   #CALL apmm801_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1',"
   #僅鎖定自身table
   LET ls_group = "pmag_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN apmm801_bcl USING g_enterprise,
                                       g_pmaa_m.pmaa001,g_pmag_d[g_detail_idx].pmag002,g_pmag_d[g_detail_idx].pmag003  
                                               
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
                                    
   #鎖定整組table
   #LET ls_group = "'2',"
   #僅鎖定自身table
   LET ls_group = "pmax_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl2 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag2_d[g_detail_idx].pmax002,g_pmag2_d[g_detail_idx].pmax003 
 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl2:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'3',"
   #僅鎖定自身table
   LET ls_group = "pmay_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl3 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag3_d[g_detail_idx].pmay002,g_pmag3_d[g_detail_idx].pmay003 
 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl3:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'4',"
   #僅鎖定自身table
   LET ls_group = "pmaz_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl4 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag4_d[g_detail_idx].pmaz002
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl4:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'5',"
   #僅鎖定自身table
   LET ls_group = "pmac_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl5 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag5_d[g_detail_idx].pmac002,g_pmag5_d[g_detail_idx].pmac003 
 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl5:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'6',"
   #僅鎖定自身table
   LET ls_group = "pmaf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl6 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag6_d[g_detail_idx].pmaf002,g_pmag6_d[g_detail_idx].pmaf003 
 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl6:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'7',"
   #僅鎖定自身table
   LET ls_group = "pmad_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl7 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag7_d[g_detail_idx].pmad002
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl7:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'8',"
   #僅鎖定自身table
   LET ls_group = "pmae_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN apmm801_bcl8 USING g_enterprise,
                                             g_pmaa_m.pmaa001,g_pmag9_d[g_detail_idx].pmae002,g_pmag9_d[g_detail_idx].pmae003 
 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "apmm801_bcl8:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
 
   
 
   
   #add-point:lock_b段other name="lock_b.other"
                     #鎖定整組table
   #LET ls_group = "'8',"
   #僅鎖定自身table
   LET ls_group = "pmad_t"
   IF ls_group.getIndexOf(ps_table,1) THEN 
      OPEN gapmm801_bcl8 USING g_enterprise,g_pmaa_m.pmaa001,g_pmag8_d[g_detail_idx].pmad002_1,
                               g_pmag8_d[g_detail_idx].pmad003_1 
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "gapmm801_bcl8"   
         LET g_errparam.popup = TRUE
         CALL cl_err()

         RETURN FALSE
      END IF
   END IF

   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.unlock_b" >}
#+ 連動unlock其他單身table資料
PRIVATE FUNCTION apmm801_unlock_b(ps_table,ps_page)
   #add-point:unlock_b段define(客製用) name="unlock_b.define_customerization"
   
   #end add-point  
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="unlock_b.define"
                  
   #end add-point  
   
   #add-point:Function前置處理  name="unlock_b.pre_function"
   
   #end add-point
    
   LET ls_group = "'1',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl
   END IF
   
   LET ls_group = "'2',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl2
   END IF
 
   LET ls_group = "'3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl3
   END IF
 
   LET ls_group = "'4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl4
   END IF
 
   LET ls_group = "'5',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl5
   END IF
 
   LET ls_group = "'6',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl6
   END IF
 
   LET ls_group = "'7',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl7
   END IF
 
   LET ls_group = "'8',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE apmm801_bcl8
   END IF
 
 
   
 
 
   #add-point:unlock_b段other name="unlock_b.other"
   LET ls_group = "'8',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE gapmm801_bcl8   
   END IF
   

   #end add-point  
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_entry" >}
#+ 單頭欄位開啟設定
PRIVATE FUNCTION apmm801_set_entry(p_cmd)
   #add-point:set_entry段define(客製用) name="set_entry.define_customerization"
   
   #end add-point       
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_entry.define"
                  
   #end add-point       
   
   #add-point:Function前置處理  name="set_entry.pre_function"
   
   #end add-point
   
   CALL cl_set_comp_entry("",TRUE)
   
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("pmaa001",TRUE)
      CALL cl_set_comp_entry("",TRUE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,TRUE)
      END IF
      #add-point:set_entry段欄位控制 name="set_entry.field_control"
      CALL cl_set_comp_entry("pmaa085",TRUE)
      CALL cl_set_comp_entry("pmaa095",TRUE)
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後 name="set_entry.after_control"
   CALL cl_set_comp_entry("pmaa005,pmaa220,pmaa080",TRUE)
   CALL cl_set_comp_entry("pmaa037,pmaa038,pmaa039,pmaa040,pmaa041",TRUE)
   CALL cl_set_comp_entry("pmaa042,pmaa043,pmaa044,pmaa045,pmaa046",TRUE)
   CALL cl_set_comp_entry("l_pmab050,l_pmab052,l_pmab100,l_pmab102",TRUE)
   CALL cl_set_comp_entry("pmaa085,pmaa095",TRUE)
   #end add-point 
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_no_entry" >}
#+ 單頭欄位關閉設定
PRIVATE FUNCTION apmm801_set_no_entry(p_cmd)
   #add-point:set_no_entry段define(客製用) name="set_no_entry.define_customerization"
   
   #end add-point     
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_no_entry.define"
                  
   #end add-point     
   
   #add-point:Function前置處理  name="set_no_entry.pre_function"
   
   #end add-point
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("pmaa001",FALSE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,FALSE)
      END IF
      #add-point:set_no_entry段欄位控制 name="set_no_entry.field_control"
      CALL cl_set_comp_entry("pmaa085",FALSE)
      CALL cl_set_comp_entry("pmaa095",FALSE)
      #end add-point 
   END IF 
   
   IF p_cmd = 'u' THEN  #docno,ld欄位確認是絕對關閉
      CALL cl_set_comp_entry("",FALSE)
   END IF 
 
#  IF p_cmd = 'u' THEN  #docdt欄位依照設定關閉(FALSE則為設定不同意修正) #(ver:78)
      IF NOT cl_chk_update_docdt() THEN
         CALL cl_set_comp_entry("",FALSE)
      END IF
#  END IF 
   
   #add-point:set_no_entry段欄位控制後 name="set_no_entry.after_control"
   IF g_pmaa_m.pmaa004 != '3' THEN
      CALL cl_set_comp_entry("pmaa005",FALSE)
   END IF
   
   IF g_pmaa_m.pmaa036 = 'N' THEN
      CALL cl_set_comp_entry("pmaa037,pmaa038,pmaa039,pmaa040,pmaa041",FALSE)
      CALL cl_set_comp_entry("pmaa042,pmaa043,pmaa044,pmaa045,pmaa046",FALSE)
   END IF
   
   IF g_pmaa_m.pmab049 = 'N' THEN
      CALL cl_set_comp_entry("l_pmab050",FALSE)
   END IF

   IF g_pmaa_m.pmab051 = 'N' THEN
      CALL cl_set_comp_entry("l_pmab052",FALSE)
   END IF

   IF g_pmaa_m.pmab099 = 'N' THEN
      CALL cl_set_comp_entry("l_pmab100",FALSE)
   END IF

   IF g_pmaa_m.pmab101 = 'N' THEN
      CALL cl_set_comp_entry("l_pmab102",FALSE)
   END IF
   IF NOT s_aooi500_comp_entry(g_prog,'pmaaunit') THEN
      CALL cl_set_comp_entry("pmaa085,pmaa095",FALSE)
   END IF
   #end add-point 
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_entry_b" >}
#+ 單身欄位開啟設定
PRIVATE FUNCTION apmm801_set_entry_b(p_cmd)
   #add-point:set_entry_b段define(客製用) name="set_entry_b.define_customerization"
   
   #end add-point     
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_entry_b.define"
                  
   #end add-point     
   
   #add-point:Function前置處理  name="set_entry_b.pre_function"
   
   #end add-point
    
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("",TRUE)
      #add-point:set_entry段欄位控制 name="set_entry_b.field_control"
      
      #end add-point  
   END IF
   
   #add-point:set_entry_b段 name="set_entry_b.set_entry_b"
                  
   #end add-point  
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_no_entry_b" >}
#+ 單身欄位關閉設定
PRIVATE FUNCTION apmm801_set_no_entry_b(p_cmd)
   #add-point:set_no_entry_b段define(客製用) name="set_no_entry_b.define_customerization"
   
   #end add-point    
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_no_entry_b.define"
                  
   #end add-point    
   
   #add-point:Function前置處理  name="set_no_entry_b.pre_function"
   
   #end add-point
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("",FALSE)
      #add-point:set_no_entry_b段欄位控制 name="set_no_entry_b.field_control"
      
      #end add-point 
   END IF 
   
   #add-point:set_no_entry_b段 name="set_no_entry_b.set_no_entry_b"
                  
   #end add-point     
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_act_visible" >}
#+ 單頭權限開啟
PRIVATE FUNCTION apmm801_set_act_visible()
   #add-point:set_act_visible段define(客製用) name="set_act_visible.define_customerization"
   
   #end add-point   
   #add-point:set_act_visible段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_act_visible.define"
   
   #end add-point   
   #add-point:set_act_visible段 name="set_act_visible.set_act_visible"
   
   #ken---add---s
   CALL cl_set_act_visible("modify_credit",TRUE)
   CALL cl_set_act_visible("modify,delete,modify_detail,modify_credit,open_aooi350",TRUE)
   #ken---add---e
   CALL cl_set_act_visible("insert,modify, modify_detail,reproduce,delete,statechange",TRUE)
   
   CALL cl_set_act_visible("open_axmm201,open_axmm202",TRUE)   #160810-00008#1 160819 by lori add  
   #end add-point   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_act_no_visible" >}
#+ 單頭權限關閉
PRIVATE FUNCTION apmm801_set_act_no_visible()
   #add-point:set_act_no_visible段define(客製用) name="set_act_no_visible.define_customerization"
   
   #end add-point   
   #add-point:set_act_no_visible段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_act_no_visible.define"
   
   #end add-point   
   #add-point:set_act_no_visible段 name="set_act_no_visible.set_act_no_visible"
   
   #ken---add---s
   IF cl_null(g_pmaa_m.pmaa001) THEN
      CALL cl_set_act_visible("modify_credit",FALSE)
   END IF
   
   IF g_pmaa_m.pmaastus <> 'N' THEN
      CALL cl_set_act_visible("modify,delete,modify_detail,modify_credit,open_aooi350",FALSE)
   END IF
   
   IF cl_null(g_pmaa_m.pmaa027) THEN
      CALL cl_set_act_visible("open_aooi350",FALSE)      
   END IF
   #ken---add---e
   #aoos010申請流程控管
   IF  cl_get_para(g_enterprise,g_site,'E-CIR-0044')='Y' THEN
      CALL cl_set_act_visible("insert,modify, modify_detail,reproduce,delete,statechange",FALSE)
   END IF
   
   #160810-00008#1 160819 by lori add---(S)
   IF cl_null(g_pmaa_m.pmaa001) OR g_pmaa_m.pmaa002 = '1' THEN   
      CALL cl_set_act_visible("open_axmm201,open_axmm202",FALSE)  
   END IF
   #160810-00008#1 160819 by lori add---(E)   
   #end add-point   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_act_visible_b" >}
#+ 單身權限開啟
PRIVATE FUNCTION apmm801_set_act_visible_b()
   #add-point:set_act_visible_b段define(客製用) name="set_act_visible_b.define_customerization"
   
   #end add-point   
   #add-point:set_act_visible_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_act_visible_b.define"
   
   #end add-point   
   #add-point:set_act_visible_b段 name="set_act_visible_b.set_act_visible_b"
   
   #end add-point   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.set_act_no_visible_b" >}
#+ 單身權限關閉
PRIVATE FUNCTION apmm801_set_act_no_visible_b()
   #add-point:set_act_no_visible_b段define(客製用) name="set_act_no_visible_b.define_customerization"
   
   #end add-point   
   #add-point:set_act_no_visible_b段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_act_no_visible_b.define"
   
   #end add-point   
   #add-point:set_act_no_visible_b段 name="set_act_no_visible_b.set_act_no_visible_b"
   
   #end add-point   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.default_search" >}
#+ 外部參數搜尋
PRIVATE FUNCTION apmm801_default_search()
   #add-point:default_search段define(客製用) name="default_search.define_customerization"
   
   #end add-point  
   DEFINE li_idx     LIKE type_t.num10
   DEFINE li_cnt     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE ls_where   STRING
   #add-point:default_search段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="default_search.define"
                  
   #end add-point  
   
   #add-point:Function前置處理 name="default_search.before"
                  
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " pmaa001 = '", g_argv[02], "' AND "
   END IF
   
 
   
   #add-point:default_search段after sql name="default_search.after_sql"
   
   #end add-point  
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      #若無外部參數則預設為1=2
      LET g_default = FALSE
      
      #預設查詢條件
      CALL cl_qbe_get_default_qryplan() RETURNING ls_where
      IF NOT cl_null(ls_where) THEN
         CALL util.JSON.parse(ls_where, la_wc)
         INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
         INITIALIZE g_wc2_table2 TO NULL
 
         INITIALIZE g_wc2_table3 TO NULL
 
         INITIALIZE g_wc2_table4 TO NULL
 
         INITIALIZE g_wc2_table5 TO NULL
 
         INITIALIZE g_wc2_table6 TO NULL
 
         INITIALIZE g_wc2_table7 TO NULL
 
         INITIALIZE g_wc2_table8 TO NULL
 
 
         FOR li_idx = 1 TO la_wc.getLength()
            CASE
               WHEN la_wc[li_idx].tableid = "pmaa_t" 
                  LET g_wc = la_wc[li_idx].wc
               WHEN la_wc[li_idx].tableid = "pmag_t" 
                  LET g_wc2_table1 = la_wc[li_idx].wc
               WHEN la_wc[li_idx].tableid = "pmax_t" 
                  LET g_wc2_table2 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmay_t" 
                  LET g_wc2_table3 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmaz_t" 
                  LET g_wc2_table4 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmac_t" 
                  LET g_wc2_table5 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmaf_t" 
                  LET g_wc2_table6 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmad_t" 
                  LET g_wc2_table7 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "pmae_t" 
                  LET g_wc2_table8 = la_wc[li_idx].wc
 
 
               WHEN la_wc[li_idx].tableid = "EXTENDWC"
                  LET g_wc2_extend = la_wc[li_idx].wc
            END CASE
         END FOR
         IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
            OR NOT cl_null(g_wc2_table2)
 
            OR NOT cl_null(g_wc2_table3)
 
            OR NOT cl_null(g_wc2_table4)
 
            OR NOT cl_null(g_wc2_table5)
 
            OR NOT cl_null(g_wc2_table6)
 
            OR NOT cl_null(g_wc2_table7)
 
            OR NOT cl_null(g_wc2_table8)
 
 
            OR NOT cl_null(g_wc2_extend)
            THEN
            #組合g_wc2
            IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
               LET g_wc2 = g_wc2_table1
            END IF
            IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
            END IF
 
            IF g_wc2_table3 <> " 1=1" AND NOT cl_null(g_wc2_table3) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
            END IF
 
            IF g_wc2_table4 <> " 1=1" AND NOT cl_null(g_wc2_table4) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
            END IF
 
            IF g_wc2_table5 <> " 1=1" AND NOT cl_null(g_wc2_table5) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table5
            END IF
 
            IF g_wc2_table6 <> " 1=1" AND NOT cl_null(g_wc2_table6) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table6
            END IF
 
            IF g_wc2_table7 <> " 1=1" AND NOT cl_null(g_wc2_table7) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table7
            END IF
 
            IF g_wc2_table8 <> " 1=1" AND NOT cl_null(g_wc2_table8) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table8
            END IF
 
 
            IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
            END IF
         
            IF g_wc2.subString(1,5) = " AND " THEN
               LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
            END IF
         END IF
      END IF
    
      IF cl_null(g_wc) AND cl_null(g_wc2) THEN
         LET g_wc = " 1=2"
      END IF
   END IF
   
   #add-point:default_search段結束前 name="default_search.after"
   #150613-00016#1 150614 by lori mod---(S)
#   IF NOT cl_null(g_argv[1]) AND cl_null(g_argv[2]) THEN            
#      CASE g_argv[1]                                                 
#         WHEN '1'                                                    
#            LET ls_wc = ls_wc, " AND pmaa002 IN ('1','3') AND "     
#            LET g_wc = g_wc, " AND pmaa002 IN ('1','3') "           
#         WHEN '2'
#            LET ls_wc = ls_wc, " AND pmaa002 IN ('2','3') AND pmaa092 = '2' AND pmaa230 = '1' AND "   
#            LET g_wc = g_wc, " AND pmaa002 IN ('2','3') AND pmaa092 = '2' AND pmaa230 = '1' "          
#         WHEN '3' 
#            LET ls_wc = ls_wc, " AND pmaa002 IN ('2','3') AND pmaa092 = '1' AND pmaa230 = '1' AND "
#            LET g_wc = g_wc, " AND pmaa002 IN ('2','3') AND pmaa092 = '1' AND pmaa230 = '1' "
#         OTHERWISE
#            LET ls_wc = ''
#            LET g_wc = " 1=1"  
#      END CASE
#   END IF
   #150613-00016#1 150614 by lori mod---(E)
   #end add-point  
 
   IF g_wc.getIndexOf(" 1=2", 1) THEN
      LET g_default = TRUE
   END IF
 
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.state_change" >}
   #應用 a09 樣板自動產生(Version:17)
#+ 確認碼變更 
PRIVATE FUNCTION apmm801_statechange()
   #add-point:statechange段define(客製用) name="statechange.define_customerization"
   
   #end add-point  
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="statechange.define"
         DEFINE l_success LIKE type_t.num5 
DEFINE l_para_data LIKE type_t.chr80         
   #end add-point  
   
   #add-point:Function前置處理 name="statechange.before"
 
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_pmaa_m.pmaa001 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   CALL s_transaction_begin()
   
   OPEN apmm801_cl USING g_enterprise,g_pmaa_m.pmaa001
   IF STATUS THEN
      CLOSE apmm801_cl
      CALL s_transaction_end('N','0')
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN apmm801_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN
   END IF
   
   #顯示最新的資料
   EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
       g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
       g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
       g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
       g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
       g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
       g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
       g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
       g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
       g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
       g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
       g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
       g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
       g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
       g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
       g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
       g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
   
 
   #檢查是否允許此動作
   IF NOT apmm801_action_chk() THEN
      CLOSE apmm801_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #將資料顯示到畫面上
   DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
       g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
       g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc, 
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
       g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc, 
       g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024,g_pmaa_m.pmaa024_desc, 
       g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa009_desc, 
       g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231, 
       g_pmaa_m.pmaa231_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc, 
       g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa094_desc, 
       g_pmaa_m.pmaa093,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097, 
       g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc, 
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa245, 
       g_pmaa_m.pmaa245_desc,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc, 
       g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa222,g_pmaa_m.pmaa222_desc, 
       g_pmaa_m.pmaa080,g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083, 
       g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085,g_pmaa_m.pmaa085_desc, 
       g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053,g_pmaa_m.pmaa053_desc, 
       g_pmaa_m.pmaa054,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
       g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
       g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
       g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
       g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa205_desc, 
       g_pmaa_m.pmaa206,g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053,g_pmaa_m.pmab053_desc, 
       g_pmaa_m.pmab039,g_pmaa_m.pmab039_desc,g_pmaa_m.pmaa081,g_pmaa_m.pmaa081_desc,g_pmaa_m.pmab033, 
       g_pmaa_m.pmab033_desc,g_pmaa_m.pmab034,g_pmaa_m.pmab034_desc,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
       g_pmaa_m.pmab056_desc,g_pmaa_m.pmab037,g_pmaa_m.pmab037_desc,g_pmaa_m.pmab055,g_pmaa_m.pmab055_desc, 
       g_pmaa_m.pmab038,g_pmaa_m.pmab038_desc,g_pmaa_m.pmab040,g_pmaa_m.pmab040_desc,g_pmaa_m.pmab041, 
       g_pmaa_m.pmab041_desc,g_pmaa_m.pmab042,g_pmaa_m.pmab042_desc,g_pmaa_m.pmab043,g_pmaa_m.pmab043_desc, 
       g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab047_desc,g_pmaa_m.pmab048, 
       g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080,g_pmaa_m.pmab082, 
       g_pmaa_m.pmab083,g_pmaa_m.pmab083_desc,g_pmaa_m.pmab084,g_pmaa_m.pmab084_desc,g_pmaa_m.pmab103, 
       g_pmaa_m.pmab103_desc,g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc,g_pmaa_m.pmab085,g_pmaa_m.pmab106, 
       g_pmaa_m.pmab106_desc,g_pmaa_m.pmab087,g_pmaa_m.pmab087_desc,g_pmaa_m.pmab105,g_pmaa_m.pmab105_desc, 
       g_pmaa_m.pmab088,g_pmaa_m.pmab088_desc,g_pmaa_m.pmab089,g_pmaa_m.pmab089_desc,g_pmaa_m.pmab107, 
       g_pmaa_m.pmab108,g_pmaa_m.pmab090,g_pmaa_m.pmab090_desc,g_pmaa_m.pmab091,g_pmaa_m.pmab091_desc, 
       g_pmaa_m.pmab092,g_pmaa_m.pmab092_desc,g_pmaa_m.pmab093,g_pmaa_m.pmab093_desc,g_pmaa_m.pmab094, 
       g_pmaa_m.pmab095,g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab097_desc,g_pmaa_m.pmab098,g_pmaa_m.pmab099, 
       g_pmaa_m.l_pmab100,g_pmaa_m.pmab101,g_pmaa_m.l_pmab102,g_pmaa_m.ooff013,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc, 
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp, 
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt, 
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271, 
       g_pmaa_m.pmaa272,g_pmaa_m.day01,g_pmaa_m.day02,g_pmaa_m.day03,g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06, 
       g_pmaa_m.day07,g_pmaa_m.day08,g_pmaa_m.day09,g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13, 
       g_pmaa_m.day14,g_pmaa_m.day15,g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20, 
       g_pmaa_m.day21,g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27, 
       g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02,g_pmaa_m.week03, 
       g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274,g_pmaa_m.pmaa274_desc, 
       g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282,g_pmaa_m.pmaa282_desc, 
       g_pmaa_m.pmaa283,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285, 
       g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287,g_pmaa_m.pmaa287_desc, 
       g_pmaa_m.pmaa288,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290, 
       g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc, 
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295, 
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc, 
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300, 
       g_pmaa_m.pmaa300_desc
 
   CASE g_pmaa_m.pmaastus
      WHEN "N"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
      WHEN "Y"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")
      WHEN "X"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")
      
   END CASE
 
   #add-point:資料刷新後 name="statechange.after_refresh"
   
   #end add-point
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_pmaa_m.pmaastus
            
            WHEN "N"
               HIDE OPTION "open"
            WHEN "Y"
               HIDE OPTION "valid"
            WHEN "X"
               HIDE OPTION "void"
         END CASE
     
      #add-point:menu前 name="statechange.before_menu"
         CASE g_pmaa_m.pmaastus
            WHEN "X"
               HIDE OPTION "valid"
            WHEN "Y"
               HIDE OPTION "void"
         END CASE    
      #end add-point
      
      
	  
      ON ACTION open
         IF cl_auth_chk_act("open") THEN
            LET lc_state = "N"
            #add-point:action控制 name="statechange.open"
                                                      
            #end add-point
         END IF
         EXIT MENU
      ON ACTION valid
         IF cl_auth_chk_act("valid") THEN
            LET lc_state = "Y"
            #add-point:action控制 name="statechange.valid"
            
            #end add-point
         END IF
         EXIT MENU
      ON ACTION void
         IF cl_auth_chk_act("void") THEN
            LET lc_state = "X"
            #add-point:action控制 name="statechange.void"
            
            #end add-point
         END IF
         EXIT MENU
 
      #add-point:stus控制 name="statechange.more_control"
                                    
      #end add-point
      
   END MENU
   
   #確認被選取的狀態碼在清單中
   IF (lc_state <> "N" 
      AND lc_state <> "Y"
      AND lc_state <> "X"
      ) OR 
      g_pmaa_m.pmaastus = lc_state OR cl_null(lc_state) THEN
      CLOSE apmm801_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:stus修改前 name="statechange.b_update"
   CALL cl_err_collect_init()   #150828-00004#1 20150831 add by beckxie
   LET l_success = TRUE          
   CASE 
      WHEN lc_state = 'Y' AND g_pmaa_m.pmaastus = 'N'  
#         CALL s_apmm801_conf_chk(g_argv[1],g_pmaa_m.pmaa001,g_pmaa_m.pmaastus) RETURNING l_success,g_errno
         CALL s_apmm801_conf_chk(g_pmaa_m.pmaa002,g_pmaa_m.pmaa001,g_pmaa_m.pmaastus) RETURNING l_success,g_errno
         IF l_success THEN
            IF cl_ask_confirm('aim-00108') THEN
               CALL s_transaction_begin()
               CALL s_apmm801_conf_upd(g_pmaa_m.pmaa001) RETURNING l_success,g_errno
               IF NOT l_success THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_pmaa_m.pmaa001
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  #160511-00037#4 20160519 add by beckxie---S
                   #160604-00009#42--add--ZN--STR--
                  CALL cl_get_para(g_enterprise,g_site,'E-CIR-0065') RETURNING l_para_data
                  IF l_para_data='1' THEN 
                     
                  ELSE
                     #160604-00009#42--add--ZN--END--  
                    IF cl_ask_confirm('apm-01111') THEN
                     CALL s_pmab_ins_pmab() #160511-00037#1 20160519 add by beckxie
                    END IF
                   END IF                     
                  #160511-00037#4 20160519 add by beckxie---E
                  CALL s_transaction_end('Y','1')
               END IF
            ELSE
               CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
               RETURN            
            END IF
         ELSE
             #150828-00004#1 20150831 mark by beckxie---S
#            IF NOT cl_null(g_errno) THEN
#               INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#                  
#            END IF
             #150828-00004#1 20150831 mark by beckxie---E
            CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
            CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
            RETURN            
         END IF         
      WHEN lc_state = 'X' AND g_pmaa_m.pmaastus = 'N'  
         CALL s_apmm801_invalid_chk(g_pmaa_m.pmaa001,g_pmaa_m.pmaastus) RETURNING l_success,g_errno
         IF l_success THEN
            IF cl_ask_confirm('art-00039') THEN
               CALL s_transaction_begin()
               CALL s_apmm801_invalid_upd(g_pmaa_m.pmaa001) RETURNING l_success,g_errno
               IF NOT l_success THEN
                   #150828-00004#1 20150831 mark by beckxie---S
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  CALL s_transaction_end('N','0')
                  #150828-00004#1 20150831 mark by beckxie---E
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
                  RETURN
               ELSE
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('Y','1')
               END IF
            ELSE
               CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
               CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
               RETURN
            END IF
         ELSE
             #150828-00004#1 20150831 mark by beckxie---S
#            INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
             #150828-00004#1 20150831 mark by beckxie---E
            CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
            CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
            RETURN    
         END IF
      WHEN lc_state = 'N' AND g_pmaa_m.pmaastus = 'Y'  
         CALL s_apmm801_unconf_chk(g_pmaa_m.pmaa001,g_pmaa_m.pmaastus) RETURNING l_success,g_errno
         IF l_success THEN
            IF cl_ask_confirm('aim-00110') THEN
               CALL s_transaction_begin()
               CALL s_apmm801_unconf_upd(g_pmaa_m.pmaa001) RETURNING l_success,g_errno
               IF NOT l_success THEN
                   #150828-00004#1 20150831 mark by beckxie---S
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                   #150828-00004#1 20150831 mark by beckxie---E
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('Y','1')
               END IF
            ELSE
               CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
               CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
               RETURN
            END IF
         ELSE
             #150828-00004#1 20150831 mark by beckxie---S
#            INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
             #150828-00004#1 20150831 mark by beckxie---E
            CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
            CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
            RETURN    
         END IF
      WHEN lc_state = 'N' AND g_pmaa_m.pmaastus = 'X'
         CALL s_apmm801_valid_chk(g_pmaa_m.pmaa001,g_pmaa_m.pmaastus) RETURNING l_success,g_errno
         IF l_success THEN
            IF cl_ask_confirm('art-00038') THEN
               CALL s_transaction_begin()
               CALL s_apmm801_valid_upd(g_pmaa_m.pmaa001) RETURNING l_success,g_errno
               IF NOT l_success THEN
                   #150828-00004#1 20150831 mark by beckxie---S
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                   #150828-00004#1 20150831 mark by beckxie---E
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
                  CALL s_transaction_end('Y','1')
               END IF
            ELSE
               CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
               CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
               RETURN
            END IF
         ELSE
             #150828-00004#1 20150831 mark by beckxie---S
#            INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_pmaa_m.pmaa001
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
             #150828-00004#1 20150831 mark by beckxie---E
            CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
            CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
            RETURN    
         END IF
      OTHERWISE
         CALL cl_err_collect_show()   #150828-00004#1 20150831 add by beckxie
         CALL s_transaction_end('N','0')     #160812-00017#8 Add By Ken 160816
         RETURN
   END CASE    
   #end add-point
   
   LET g_pmaa_m.pmaamodid = g_user
   LET g_pmaa_m.pmaamoddt = cl_get_current()
   LET g_pmaa_m.pmaastus = lc_state
   
   #異動狀態碼欄位/修改人/修改日期
   UPDATE pmaa_t 
      SET (pmaastus,pmaamodid,pmaamoddt) 
        = (g_pmaa_m.pmaastus,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt)     
    WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001
 
    
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")
         
      END CASE
    
      #撈取異動後的資料
      EXECUTE apmm801_master_referesh USING g_pmaa_m.pmaa001 INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002, 
          g_pmaa_m.pmaa089,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006, 
          g_pmaa_m.pmaa026,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016, 
          g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023, 
          g_pmaa_m.pmaa024,g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010, 
          g_pmaa_m.pmaa011,g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090, 
          g_pmaa_m.pmaa091,g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097, 
          g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246, 
          g_pmaa_m.pmaa247,g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222, 
          g_pmaa_m.pmaa080,g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051, 
          g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057, 
          g_pmaa_m.pmaa058,g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036, 
          g_pmaa_m.pmaa037,g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042, 
          g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069, 
          g_pmaa_m.pmaa072,g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205, 
          g_pmaa_m.pmaa206,g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid, 
          g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid, 
          g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275, 
          g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285, 
          g_pmaa_m.pmaa286,g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291, 
          g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297, 
          g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc, 
          g_pmaa_m.pmaa026_desc,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc, 
          g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc, 
          g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc, 
          g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc, 
          g_pmaa_m.pmaa222_desc,g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc, 
          g_pmaa_m.pmaa085_desc,g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc, 
          g_pmaa_m.pmaa081_desc,g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc, 
          g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc, 
          g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc, 
          g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc, 
          g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc, 
          g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc 
 
      
      #將資料顯示到畫面上
      DISPLAY BY NAME g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003, 
          g_pmaa_m.pmaal006,g_pmaa_m.pmaal005,g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005, 
          g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc, 
          g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
          g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc, 
          g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024,g_pmaa_m.pmaa024_desc, 
          g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa007_desc,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009, 
          g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa027, 
          g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa231_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc, 
          g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091,g_pmaa_m.pmaa091_desc,g_pmaa_m.pmaa092, 
          g_pmaa_m.pmaa094,g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096, 
          g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc, 
          g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244, 
          g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa245,g_pmaa_m.pmaa245_desc,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
          g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221, 
          g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa222,g_pmaa_m.pmaa222_desc,g_pmaa_m.pmaa080,g_pmaa_m.pmaa080_desc, 
          g_pmaa_m.pmaa084,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086, 
          g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085,g_pmaa_m.pmaa085_desc,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
          g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054,g_pmaa_m.pmaa054_desc, 
          g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa074,g_pmaa_m.pmaa059, 
          g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037,g_pmaa_m.pmaa038,g_pmaa_m.pmaa039, 
          g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043,g_pmaa_m.pmaa044,g_pmaa_m.pmaa045, 
          g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072,g_pmaa_m.pmaa070,g_pmaa_m.pmaa071, 
          g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa206, 
          g_pmaa_m.pmab032,g_pmaa_m.pmab057,g_pmaa_m.pmab058,g_pmaa_m.pmab053,g_pmaa_m.pmab053_desc, 
          g_pmaa_m.pmab039,g_pmaa_m.pmab039_desc,g_pmaa_m.pmaa081,g_pmaa_m.pmaa081_desc,g_pmaa_m.pmab033, 
          g_pmaa_m.pmab033_desc,g_pmaa_m.pmab034,g_pmaa_m.pmab034_desc,g_pmaa_m.pmab035,g_pmaa_m.pmab056, 
          g_pmaa_m.pmab056_desc,g_pmaa_m.pmab037,g_pmaa_m.pmab037_desc,g_pmaa_m.pmab055,g_pmaa_m.pmab055_desc, 
          g_pmaa_m.pmab038,g_pmaa_m.pmab038_desc,g_pmaa_m.pmab040,g_pmaa_m.pmab040_desc,g_pmaa_m.pmab041, 
          g_pmaa_m.pmab041_desc,g_pmaa_m.pmab042,g_pmaa_m.pmab042_desc,g_pmaa_m.pmab043,g_pmaa_m.pmab043_desc, 
          g_pmaa_m.pmab044,g_pmaa_m.pmab045,g_pmaa_m.pmab046,g_pmaa_m.pmab047,g_pmaa_m.pmab047_desc, 
          g_pmaa_m.pmab048,g_pmaa_m.pmab049,g_pmaa_m.l_pmab050,g_pmaa_m.pmab051,g_pmaa_m.l_pmab052,g_pmaa_m.pmab080, 
          g_pmaa_m.pmab082,g_pmaa_m.pmab083,g_pmaa_m.pmab083_desc,g_pmaa_m.pmab084,g_pmaa_m.pmab084_desc, 
          g_pmaa_m.pmab103,g_pmaa_m.pmab103_desc,g_pmaa_m.pmab104,g_pmaa_m.pmab104_desc,g_pmaa_m.pmab085, 
          g_pmaa_m.pmab106,g_pmaa_m.pmab106_desc,g_pmaa_m.pmab087,g_pmaa_m.pmab087_desc,g_pmaa_m.pmab105, 
          g_pmaa_m.pmab105_desc,g_pmaa_m.pmab088,g_pmaa_m.pmab088_desc,g_pmaa_m.pmab089,g_pmaa_m.pmab089_desc, 
          g_pmaa_m.pmab107,g_pmaa_m.pmab108,g_pmaa_m.pmab090,g_pmaa_m.pmab090_desc,g_pmaa_m.pmab091, 
          g_pmaa_m.pmab091_desc,g_pmaa_m.pmab092,g_pmaa_m.pmab092_desc,g_pmaa_m.pmab093,g_pmaa_m.pmab093_desc, 
          g_pmaa_m.pmab094,g_pmaa_m.pmab095,g_pmaa_m.pmab096,g_pmaa_m.pmab097,g_pmaa_m.pmab097_desc, 
          g_pmaa_m.pmab098,g_pmaa_m.pmab099,g_pmaa_m.l_pmab100,g_pmaa_m.pmab101,g_pmaa_m.l_pmab102,g_pmaa_m.ooff013, 
          g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid, 
          g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid, 
          g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt, 
          g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.day01,g_pmaa_m.day02,g_pmaa_m.day03, 
          g_pmaa_m.day04,g_pmaa_m.day05,g_pmaa_m.day06,g_pmaa_m.day07,g_pmaa_m.day08,g_pmaa_m.day09, 
          g_pmaa_m.day10,g_pmaa_m.day11,g_pmaa_m.day12,g_pmaa_m.day13,g_pmaa_m.day14,g_pmaa_m.day15, 
          g_pmaa_m.day16,g_pmaa_m.day17,g_pmaa_m.day18,g_pmaa_m.day19,g_pmaa_m.day20,g_pmaa_m.day21, 
          g_pmaa_m.day22,g_pmaa_m.day23,g_pmaa_m.day24,g_pmaa_m.day25,g_pmaa_m.day26,g_pmaa_m.day27, 
          g_pmaa_m.day28,g_pmaa_m.day29,g_pmaa_m.day30,g_pmaa_m.day31,g_pmaa_m.week01,g_pmaa_m.week02, 
          g_pmaa_m.week03,g_pmaa_m.week04,g_pmaa_m.week05,g_pmaa_m.week06,g_pmaa_m.week07,g_pmaa_m.pmaa274, 
          g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276,g_pmaa_m.pmaa281,g_pmaa_m.pmaa281_desc, 
          g_pmaa_m.pmaa282,g_pmaa_m.pmaa282_desc,g_pmaa_m.pmaa283,g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284, 
          g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286,g_pmaa_m.pmaa286_desc, 
          g_pmaa_m.pmaa287,g_pmaa_m.pmaa287_desc,g_pmaa_m.pmaa288,g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289, 
          g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc, 
          g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc,g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294, 
          g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc, 
          g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc,g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299, 
          g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300,g_pmaa_m.pmaa300_desc
   END IF
 
   #add-point:stus修改後 name="statechange.a_update"
                  
   #end add-point
 
   #add-point:statechange段結束前 name="statechange.after"
                  
   #end add-point  
 
   CLOSE apmm801_cl
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL apmm801_msgcentre_notify('statechange:'||lc_state)
   
END FUNCTION
 
 
 
 
{</section>}
 
{<section id="apmm801.idx_chk" >}
#+ 顯示正確的單身資料筆數
PRIVATE FUNCTION apmm801_idx_chk()
   #add-point:idx_chk段define(客製用) name="idx_chk.define_customerization"
   
   #end add-point  
   #add-point:idx_chk段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="idx_chk.define"
                  
   #end add-point  
   
   #add-point:Function前置處理  name="idx_chk.pre_function"
   
   #end add-point
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_pmag_d.getLength() THEN
         LET g_detail_idx = g_pmag_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail2")
      IF g_detail_idx > g_pmag2_d.getLength() THEN
         LET g_detail_idx = g_pmag2_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag2_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag2_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_pmag3_d.getLength() THEN
         LET g_detail_idx = g_pmag3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_pmag4_d.getLength() THEN
         LET g_detail_idx = g_pmag4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag4_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 5 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail5")
      IF g_detail_idx > g_pmag5_d.getLength() THEN
         LET g_detail_idx = g_pmag5_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag5_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag5_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 6 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail6")
      IF g_detail_idx > g_pmag6_d.getLength() THEN
         LET g_detail_idx = g_pmag6_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag6_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag6_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 7 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail7")
      IF g_detail_idx > g_pmag7_d.getLength() THEN
         LET g_detail_idx = g_pmag7_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag7_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag7_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 8 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail9")
      IF g_detail_idx > g_pmag9_d.getLength() THEN
         LET g_detail_idx = g_pmag9_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_pmag9_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_pmag9_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other name="idx_chk.other"
   IF g_current_page = 8 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail8")
      IF g_detail_idx > g_pmag8_d.getLength() THEN               
         LET g_detail_idx = g_pmag8_d.getLength()               
      END IF                                                    
      IF g_detail_idx = 0 AND g_pmag8_d.getLength() <> 0 THEN   
         LET g_detail_idx = 1                                   
      END IF                                                    
      DISPLAY g_detail_idx TO FORMONLY.idx                      
      DISPLAY g_pmag8_d.getLength() TO FORMONLY.cnt             
   END IF
   #150915-00006#1 20150915 add by beckxie---S
   CASE g_touch
     WHEN 1
        CALL gfrm_curr.ensureFieldVisible("pmac_t.pmacstus")
     WHEN 2
        CALL gfrm_curr.ensureElementVisible("page18")
     WHEN 3
        CALL gfrm_curr.ensureElementVisible("page19")
     WHEN 4
        CALL gfrm_curr.ensureFieldVisible("pmaf_t.pmafstus")
     WHEN 5
        CALL gfrm_curr.ensureFieldVisible("pmad_t.pmad003")
     WHEN 6
        CALL gfrm_curr.ensureFieldVisible("pmad003_1")
     WHEN 7
        CALL gfrm_curr.ensureFieldVisible("pmaa_t.pmaa271")
     WHEN 8
        CALL gfrm_curr.ensureFieldVisible("pmag_t.pmag002")
     WHEN 9
        CALL gfrm_curr.ensureFieldVisible("pmax_t.pmax002")
     WHEN 10
        CALL gfrm_curr.ensureFieldVisible("pmay_t.pmay002")
     WHEN 11
        CALL gfrm_curr.ensureFieldVisible("pmaz_t.pmaz002")
     WHEN 12
        CALL gfrm_curr.ensureFieldVisible("pmaa_t.pmaa281")
     WHEN 13
        CALL gfrm_curr.ensureFieldVisible("pmaa_t.pmaa291")
   END CASE
   #150915-00006#1 20150915 add by beckxie---E
   #end add-point  
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.b_fill2" >}
#+ 單身陣列填充2
PRIVATE FUNCTION apmm801_b_fill2(pi_idx)
   #add-point:b_fill2段define(客製用) name="b_fill2.define_customerization"
   
   #end add-point
   DEFINE pi_idx                 LIKE type_t.num10
   DEFINE li_ac                  LIKE type_t.num10
   DEFINE li_detail_idx_tmp      LIKE type_t.num10
   DEFINE ls_chk                 LIKE type_t.chr1
   #add-point:b_fill2段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="b_fill2.define"
                  
   #end add-point
   
   #add-point:Function前置處理  name="b_fill2.pre_function"
   
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
   LET li_detail_idx_tmp = g_detail_idx
   
 
      
 
      
   #add-point:單身填充後 name="b_fill2.after_fill"
                  
   #end add-point
    
   LET l_ac = li_ac
   
   CALL apmm801_detail_show()
   
   LET g_detail_idx = li_detail_idx_tmp
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.fill_chk" >}
#+ 單身填充確認
PRIVATE FUNCTION apmm801_fill_chk(ps_idx)
   #add-point:fill_chk段define(客製用) name="fill_chk.define_customerization"
   
   #end add-point
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="fill_chk.define"
                  
   #end add-point
   
   #add-point:Function前置處理 name="fill_chk.before_chk"
   
   #end add-point
   
   #此funtion功能暫時停用(2015/1/12)
   #無論傳入值為何皆回傳true(代表要填充該單身)
 
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1')  AND 
      (cl_null(g_wc2_table2) OR g_wc2_table2.trim() = '1=1')  AND 
      (cl_null(g_wc2_table3) OR g_wc2_table3.trim() = '1=1')  AND 
      (cl_null(g_wc2_table4) OR g_wc2_table4.trim() = '1=1')  AND 
      (cl_null(g_wc2_table5) OR g_wc2_table5.trim() = '1=1')  AND 
      (cl_null(g_wc2_table6) OR g_wc2_table6.trim() = '1=1')  AND 
      (cl_null(g_wc2_table7) OR g_wc2_table7.trim() = '1=1')  AND 
      (cl_null(g_wc2_table8) OR g_wc2_table8.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk name="fill_chk.other_chk"
                                    
      #end add-point
      RETURN TRUE
   END IF
   
   #add-point:fill_chk段after_chk name="fill_chk.after_chk"
   
   #end add-point
   
   RETURN TRUE
 
END FUNCTION
 
{</section>}
 
{<section id="apmm801.status_show" >}
PRIVATE FUNCTION apmm801_status_show()
   #add-point:status_show段define(客製用) name="status_show.define_customerization"
   
   #end add-point
   #add-point:status_show段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="status_show.define"
   
   #end add-point
   
   #add-point:status_show段status_show name="status_show.status_show"
   
   #end add-point
END FUNCTION
 
{</section>}
 
{<section id="apmm801.mask_functions" >}
&include "erp/apm/apmm801_mask.4gl"
 
{</section>}
 
{<section id="apmm801.signature" >}
   
 
{</section>}
 
{<section id="apmm801.set_pk_array" >}
   #應用 a51 樣板自動產生(Version:8)
#+ 給予pk_array內容
PRIVATE FUNCTION apmm801_set_pk_array()
   #add-point:set_pk_array段define name="set_pk_array.define_customerization"
   
   #end add-point
   #add-point:set_pk_array段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="set_pk_array.define"
   
   #end add-point
   
   #add-point:Function前置處理 name="set_pk_array.before"
   
   #end add-point  
   
   #若l_ac<=0代表沒有資料
   IF l_ac <= 0 THEN
      RETURN
   END IF
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_pmaa_m.pmaa001
   LET g_pk_array[1].column = 'pmaa001'
 
   
   #add-point:set_pk_array段之後 name="set_pk_array.after"
   
   #end add-point  
   
END FUNCTION
 
 
 
 
{</section>}
 
{<section id="apmm801.other_dialog" readonly="Y" >}
   
 
{</section>}
 
{<section id="apmm801.msgcentre_notify" >}
#應用 a66 樣板自動產生(Version:6)
PRIVATE FUNCTION apmm801_msgcentre_notify(lc_state)
   #add-point:msgcentre_notify段define name="msgcentre_notify.define_customerization"
   
   #end add-point   
   DEFINE lc_state LIKE type_t.chr80
   #add-point:msgcentre_notify段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="msgcentre_notify.define"
   
   #end add-point
   
   #add-point:Function前置處理  name="msgcentre_notify.pre_function"
   
   #end add-point
   
   INITIALIZE g_msgparam TO NULL
 
   #action-id與狀態填寫
   LET g_msgparam.state = lc_state
 
   #PK資料填寫
   CALL apmm801_set_pk_array()
   #單頭資料填寫
   LET g_msgparam.data[1] = util.JSON.stringify(g_pmaa_m)
 
   #add-point:msgcentre其他通知 name="msgcentre_notify.process"
   
   #end add-point
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL cl_msgcentre_notify()
 
END FUNCTION
 
 
 
 
{</section>}
 
{<section id="apmm801.action_chk" >}
#+ 修改/刪除前行為檢查(是否可允許此動作), 若有其他行為須管控也可透過此段落
PRIVATE FUNCTION apmm801_action_chk()
   #add-point:action_chk段define(客製用) name="action_chk.define_customerization"
   
   #end add-point
   #add-point:action_chk段define (請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="action_chk.define"
   
   #end add-point
   
   #add-point:action_chk段action_chk name="action_chk.action_chk"
   #160818-00017#26--s
   SELECT pmaastus INTO g_pmaa_m.pmaastus FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001
   IF (g_action_choice="modify" OR g_action_choice="delete" OR g_action_choice="modify_detail")  THEN
      LET g_errno = NULL
      CASE g_pmaa_m.pmaastus  
        WHEN "Y"
           LET g_errno = 'sub-00178'
        WHEN "X"
           LET g_errno = 'sub-00229'
      
      END CASE
      
      IF NOT cl_null(g_errno) THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = g_errno
         LET g_errparam.extend = g_pmaa_m.pmaastus
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_errno = NULL
         CALL apmm801_set_act_visible()
         CALL apmm801_set_act_no_visible()
         CALL apmm801_show()
         RETURN FALSE
      END IF
   END IF
   #160818-00017#26---e
   #end add-point
      
   RETURN TRUE
   
END FUNCTION
 
{</section>}
 
{<section id="apmm801.other_function" readonly="Y" >}

PUBLIC FUNCTION apmm801_pmaa005_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa005
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa005_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa005_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa006_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa006
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='261' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa006_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa006_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa026_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa026
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='250' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa026_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa026_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa222_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa222
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2072' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa222_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa222_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa080_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa080
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='251' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa080_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa080_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa084_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa084
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='256' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa084_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa084_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa083_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa083
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='255' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa083_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa083_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa086_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa086
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa086_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa086_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa085_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa085
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa085_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa085_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa232_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa232
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2072' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa232_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa232_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa090_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa090
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='281' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa090_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa090_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa094_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa094
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='286' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa094_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa094_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa093_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa093
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='285' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa093_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa093_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa096_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa096
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa096_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa096_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa095_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa095
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa095_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa095_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa241_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa241
   CALL ap_ref_array2(g_ref_fields,"SELECT dbaal003 FROM dbaal_t WHERE dbaalent='"||g_enterprise||"' AND dbaal001=? AND dbaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa241_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa241_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa242_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa242
   CALL ap_ref_array2(g_ref_fields,"SELECT dbaal003 FROM dbaal_t WHERE dbaalent='"||g_enterprise||"' AND dbaal001=? AND dbaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa242_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa242_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa243_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa243
   CALL ap_ref_array2(g_ref_fields,"SELECT dbaal003 FROM dbaal_t WHERE dbaalent='"||g_enterprise||"' AND dbaal001=? AND dbaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa243_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa243_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa244_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa244
   CALL ap_ref_array2(g_ref_fields,"SELECT dbaal003 FROM dbaal_t WHERE dbaalent='"||g_enterprise||"' AND dbaal001=? AND dbaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa244_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa244_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa019_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa019
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa019_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa019_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa022_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa022
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa022_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa022_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa023_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa023
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='254' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa023_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa023_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa024_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa024
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='260' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa024_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa024_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa007_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa007
   CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa007_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa007_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa009_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa009
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='4' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa009_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa009_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa011_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa011
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa011_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa011_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa052_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa052
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa052_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa052_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa054_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa054
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa054_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa054_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa205_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa205
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2031' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa205_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa205_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab033_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab033
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab033_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab033_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab034_ref()
   DEFINE l_ooef019   LIKE ooef_t.ooef019

   INITIALIZE g_ref_fields TO NULL
   SELECT ooef019 INTO l_ooef019 FROM ooef_t
    WHERE ooef001 = g_site
      AND ooefent = g_enterprise
   IF NOT cl_null(l_ooef019) THEN
      LET g_ref_fields[1] = l_ooef019
      LET g_ref_fields[2] = g_pmaa_m.pmab034
      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001=? AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields 
      LET g_pmaa_m.pmab034_desc = '', g_rtn_fields[1] , ''
   END IF
   DISPLAY BY NAME g_pmaa_m.pmab034_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab039_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab039
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='264' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab039_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab039_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab040_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab040
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab040_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab040_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab041_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab041
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab041_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab041_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab042_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab042
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab042_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab042_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab097_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab097
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab097_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab097_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab043_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab043
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab043_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab043_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa081_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa081
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='253' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa081_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa081_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa274_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa274
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='274' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa274_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa274_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab047_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab047
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab047_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab047_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa281_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa281
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2037' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa281_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa281_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab083_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab083
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab083_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab083_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa282_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa282
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2038' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa282_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa282_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab084_ref()
   DEFINE l_ooef019   LIKE ooef_t.ooef019

   INITIALIZE g_ref_fields TO NULL
   SELECT ooef019 INTO l_ooef019 FROM ooef_t
    WHERE ooef001 = g_site
      AND ooefent = g_enterprise
   IF NOT cl_null(l_ooef019) THEN
      LET g_ref_fields[1] = l_ooef019
      LET g_ref_fields[2] = g_pmaa_m.pmab084
      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001=? AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields 
      LET g_pmaa_m.pmab084_desc = '', g_rtn_fields[1] , ''
   END IF
   DISPLAY BY NAME g_pmaa_m.pmab084_desc

END FUNCTION

PUBLIC FUNCTION apmm801_pmab089_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab089
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='295' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab089_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab089_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa283_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa283
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2039' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa283_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa283_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab090_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab090
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab090_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab090_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa284_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa284
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2040' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa284_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa284_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa285_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa285
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2041' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa285_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa285_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab091_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab091
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab091_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab091_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa286_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa286
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2042' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa286_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa286_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab092_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab092
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab092_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab092_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa287_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa287
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2043' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa287_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa287_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab093_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab093
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='262' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab093_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab093_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa288_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa288
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2044' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa288_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa288_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa289_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa289
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2045' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa289_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa289_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa290_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa290
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2046' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa290_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa290_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa291_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa291
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2061' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa291_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa291_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa292_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa292
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2062' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa292_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa292_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa293_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa293
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2063' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa293_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa293_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa294_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa294
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2064' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa294_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa294_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa295_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa295
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2065' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa295_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa295_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa296_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa296
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2066' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa296_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa296_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa297_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa297
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2067' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa297_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa297_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa298_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa298
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2068' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa298_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa298_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa299_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa299
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2069' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa299_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa299_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa300_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa300
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2070' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaa300_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaa300_desc
END FUNCTION
################################################################################
# Descriptions...: 供應商編號檢查
# Memo...........: 
# Usage..........: CALL apmm801_chk_pmaa001()
#                  RETURNING r_success
# Input parameter: 無
# Return code....: r_success
# Date & Author..: 
# Modify.........:2016/08/29 By Lori
################################################################################
PUBLIC FUNCTION apmm801_chk_pmaa001()
   DEFINE r_success   LIKE type_t.num5   #160810-00008#1 160829 by lori add
   DEFINE l_cnt       LIKE type_t.num5
  
   #160810-00008#1 160829 by lori mark---(S)               
   #LET g_errno = ''
   #LET l_cnt = 0
   #SELECT COUNT(*) INTO l_cnt FROM pmaa_t
   # WHERE pmaaent = g_enterprise
   #   AND pmaa001 = g_pmaa_m.pmaa001
   #IF l_cnt > 0 THEN
   #   #輸入的交易對象編號已存在 交易對象主檔 中
   #   LET g_errno = 'apm-00240'
   #END IF
   #
   #IF cl_null(g_errno) AND g_pmaa_m.pmaa004 = '1' THEN
   #   LET g_pmaa_m.pmaa005 = g_pmaa_m.pmaa001
   #   CALL apmm801_pmaa005_ref()
   #END IF   
   #160810-00008#1 160829 by lori mark---(E)
    
   #160810-00008#1 160829 by lori add---(S)
   LET r_success = TRUE
   
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt
     FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_pmaa_m.pmaa001
      AND pmaa002 <> g_pmaa_m.pmaa002
      AND pmaa002 <> '3'   
      
   IF l_cnt > 0 THEN
      #存在相同的交易對象編號是否為同一個交易對象？
      IF cl_ask_confirm('apm-00578') THEN
         LET g_pmaa_m.pmaamoddt = cl_get_current()
         UPDATE pmaa_t SET pmaa002 = '3',
                           pmaamodid = g_user,
                           pmaamoddt = g_pmaa_m.pmaamoddt
          WHERE pmaaent = g_enterprise
            AND pmaa001 = g_pmaa_m.pmaa001  
            
         LET g_master_insert = TRUE
         
         EXECUTE apmm801_master_referesh 
           USING g_pmaa_m.pmaa001 
            INTO g_pmaa_m.pmaa001,g_pmaa_m.pmaa002,g_pmaa_m.pmaa089, 
                 g_pmaa_m.pmaa003,g_pmaa_m.pmaastus,g_pmaa_m.pmaa004,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa026, 
                 g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa202,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018, 
                 g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa023,g_pmaa_m.pmaa024, 
                 g_pmaa_m.pmaa025,g_pmaa_m.pmaa007,g_pmaa_m.pmaa008,g_pmaa_m.pmaa009,g_pmaa_m.pmaa010,g_pmaa_m.pmaa011, 
                 g_pmaa_m.pmaa027,g_pmaa_m.pmaa230,g_pmaa_m.pmaa231,g_pmaa_m.pmaa232,g_pmaa_m.pmaa090,g_pmaa_m.pmaa091, 
                 g_pmaa_m.pmaa092,g_pmaa_m.pmaa094,g_pmaa_m.pmaa093,g_pmaa_m.pmaa096,g_pmaa_m.pmaa097,g_pmaa_m.pmaa241, 
                 g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa245,g_pmaa_m.pmaa246,g_pmaa_m.pmaa247, 
                 g_pmaa_m.pmaa248,g_pmaa_m.pmaa095,g_pmaa_m.pmaa220,g_pmaa_m.pmaa221,g_pmaa_m.pmaa222,g_pmaa_m.pmaa080, 
                 g_pmaa_m.pmaa084,g_pmaa_m.pmaa083,g_pmaa_m.pmaa086,g_pmaa_m.pmaa085,g_pmaa_m.pmaa051,g_pmaa_m.pmaa052, 
                 g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058, 
                 g_pmaa_m.pmaa074,g_pmaa_m.pmaa059,g_pmaa_m.pmaa075,g_pmaa_m.pmaa047,g_pmaa_m.pmaa036,g_pmaa_m.pmaa037, 
                 g_pmaa_m.pmaa038,g_pmaa_m.pmaa039,g_pmaa_m.pmaa040,g_pmaa_m.pmaa041,g_pmaa_m.pmaa042,g_pmaa_m.pmaa043, 
                 g_pmaa_m.pmaa044,g_pmaa_m.pmaa045,g_pmaa_m.pmaa046,g_pmaa_m.pmaa068,g_pmaa_m.pmaa069,g_pmaa_m.pmaa072, 
                 g_pmaa_m.pmaa070,g_pmaa_m.pmaa071,g_pmaa_m.pmaa073,g_pmaa_m.pmaa204,g_pmaa_m.pmaa205,g_pmaa_m.pmaa206, 
                 g_pmaa_m.pmaa081,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp, 
                 g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt, 
                 g_pmaa_m.pmaa270,g_pmaa_m.pmaa271,g_pmaa_m.pmaa272,g_pmaa_m.pmaa274,g_pmaa_m.pmaa275,g_pmaa_m.pmaa276, 
                 g_pmaa_m.pmaa281,g_pmaa_m.pmaa282,g_pmaa_m.pmaa283,g_pmaa_m.pmaa284,g_pmaa_m.pmaa285,g_pmaa_m.pmaa286, 
                 g_pmaa_m.pmaa287,g_pmaa_m.pmaa288,g_pmaa_m.pmaa289,g_pmaa_m.pmaa290,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292, 
                 g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298, 
                 g_pmaa_m.pmaa299,g_pmaa_m.pmaa300,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006_desc,g_pmaa_m.pmaa026_desc, 
                 g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa022_desc,g_pmaa_m.pmaa023_desc,g_pmaa_m.pmaa024_desc,g_pmaa_m.pmaa007_desc, 
                 g_pmaa_m.pmaa009_desc,g_pmaa_m.pmaa011_desc,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa091_desc, 
                 g_pmaa_m.pmaa094_desc,g_pmaa_m.pmaa093_desc,g_pmaa_m.pmaa096_desc,g_pmaa_m.pmaa097_desc,g_pmaa_m.pmaa241_desc, 
                 g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa222_desc, 
                 g_pmaa_m.pmaa080_desc,g_pmaa_m.pmaa084_desc,g_pmaa_m.pmaa083_desc,g_pmaa_m.pmaa086_desc,g_pmaa_m.pmaa085_desc, 
                 g_pmaa_m.pmaa052_desc,g_pmaa_m.pmaa053_desc,g_pmaa_m.pmaa054_desc,g_pmaa_m.pmaa205_desc,g_pmaa_m.pmaa081_desc, 
                 g_pmaa_m.pmaaownid_desc,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp_desc, 
                 g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaa274_desc,g_pmaa_m.pmaa281_desc,g_pmaa_m.pmaa282_desc, 
                 g_pmaa_m.pmaa283_desc,g_pmaa_m.pmaa284_desc,g_pmaa_m.pmaa285_desc,g_pmaa_m.pmaa286_desc,g_pmaa_m.pmaa287_desc, 
                 g_pmaa_m.pmaa288_desc,g_pmaa_m.pmaa289_desc,g_pmaa_m.pmaa290_desc,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292_desc, 
                 g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297_desc, 
                 g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300_desc
         
         CALL apmm801_pmaa_t_mask()
         CALL apmm801_show()

         RETURN r_success
      END IF   
   END IF
   
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_pmaa_m.pmaa001
      
   IF l_cnt > 0 THEN
      #輸入的交易對象編號已存在 交易對象主檔 中
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00240'
      LET g_errparam.extend = g_pmaa_m.pmaa001
      LET g_errparam.popup = TRUE
      CALL cl_err()
      
      LET r_success = FALSE
   ELSE
      IF g_pmaa_m.pmaa004 = '1' THEN
         LET g_pmaa_m.pmaa005 = g_pmaa_m.pmaa001
         CALL apmm801_pmaa005_ref()
      END IF
   END IF
   #160810-00008#1 160829 by lori add---(E)
   
   RETURN r_success   #160810-00008#1 160829 by lori add
   
END FUNCTION

PUBLIC FUNCTION apmm801_pmaa270_visible()
   CASE g_pmaa_m.pmaa270
      WHEN '1'
         CALL cl_set_comp_visible('group42',TRUE)
         CALL cl_set_comp_visible('group43',FALSE)
         CALL apmm801_pmaa271_show()
      WHEN '2'
         CALL cl_set_comp_visible('group42',FALSE)
         CALL cl_set_comp_visible('group43',TRUE)
         CALL apmm801_pmaa272_show()
      OTHERWISE
         CALL cl_set_comp_visible('group42',TRUE)
         CALL cl_set_comp_visible('group43',FALSE)
         CALL apmm801_pmaa271_show()
   END CASE
END FUNCTION

PUBLIC FUNCTION apmm801_set_ui_init()
#   CASE g_argv[1] 
#      WHEN '1'
#         CALL cl_set_comp_visible('group33',TRUE)
#         CALL cl_set_comp_visible('group34',FALSE)         
#         CALL cl_set_comp_visible('page_6',TRUE)
#         CALL cl_set_comp_visible('page_7',TRUE)
#         CALL cl_set_comp_visible('page_8',TRUE)   
#         CALL cl_set_comp_visible('page_9',FALSE)           
#         CALL cl_set_comp_visible('page_13',FALSE)
#         CALL cl_set_comp_visible('page_10',FALSE)
#         CALL cl_set_comp_visible('page_11',FALSE)
#         CALL cl_set_comp_visible('page_12',FALSE)
#         CALL cl_set_comp_visible('pmaa085',TRUE)
#         CALL cl_set_comp_visible('pmaa085_desc',TRUE)
#         CALL cl_set_comp_visible('pmaa095',FALSE)
#         CALL cl_set_comp_visible('pmaa095_desc',FALSE)
#         CALL apmm801_set_title_visible('1')
#         CALL cl_set_comp_visible('page16',TRUE)
#         CALL cl_set_comp_visible('page17',FALSE)
#      WHEN '2' 
#         CALL cl_set_comp_visible('group33',FALSE)
#         CALL cl_set_comp_visible('group34',TRUE)         
#         CALL cl_set_comp_visible('page_6',FALSE)
#         CALL cl_set_comp_visible('page_7',FALSE)
#         CALL cl_set_comp_visible('page_8',FALSE)   
#         CALL cl_set_comp_visible('page_9',TRUE)           
#         CALL cl_set_comp_visible('page_13',TRUE)
#         CALL cl_set_comp_visible('page_10',TRUE)
#         CALL cl_set_comp_visible('page_11',TRUE)
#         CALL cl_set_comp_visible('page_12',TRUE)
#         CALL cl_set_comp_visible('pmaa085',FALSE)
#         CALL cl_set_comp_visible('pmaa085_desc',FALSE)
#         CALL cl_set_comp_visible('pmaa095',TRUE)         
#         CALL cl_set_comp_visible('pmaa095_desc',TRUE)         
#         CALL apmm801_set_title_visible('2')
#         CALL cl_set_comp_visible('page16',FALSE)
#         CALL cl_set_comp_visible('page17',TRUE)
#      WHEN '3' 
#         CALL cl_set_comp_visible('group33',FALSE)
#         CALL cl_set_comp_visible('group34',TRUE)  
#         CALL cl_set_comp_visible('Grid_gen4',FALSE)  
#         CALL cl_set_comp_visible('bpage_1',FALSE)         
#         CALL cl_set_comp_visible('page_6',FALSE)
#         CALL cl_set_comp_visible('page_7',FALSE)
#         CALL cl_set_comp_visible('page_8',FALSE)   
#         CALL cl_set_comp_visible('page_9',TRUE)           
#         CALL cl_set_comp_visible('page_13',TRUE)
#         CALL cl_set_comp_visible('page_10',FALSE)
#         CALL cl_set_comp_visible('page_11',FALSE)
#         CALL cl_set_comp_visible('page_12',FALSE)
#         CALL cl_set_comp_visible('pmaa085',FALSE)
#         CALL cl_set_comp_visible('pmaa085_desc',FALSE)
#         CALL cl_set_comp_visible('pmaa095',TRUE)         
#         CALL cl_set_comp_visible('pmaa095_desc',TRUE)         
#         CALL apmm801_set_title_visible('3')
#         CALL cl_set_comp_visible('page16',FALSE)
#         CALL cl_set_comp_visible('page17',TRUE)
#   END CASE
   
END FUNCTION

PUBLIC FUNCTION apmm801_set_title_visible(p_pmaa002)
   DEFINE p_pmaa002  LIKE pmaa_t.pmaa002
   DEFINE l_gzze003  LIKE gzze_t.gzze003
   DEFINE l_ooef006  LIKE ooef_t.ooef006

   IF NOT cl_null(p_pmaa002) THEN
      #供應商
      CASE p_pmaa002
         WHEN '1'
            LET l_gzze003 = cl_getmsg('apm-00050',g_dlang)         
            CALL cl_set_comp_att_text('pmaa001',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00051',g_dlang)        
            CALL cl_set_comp_att_text('pmaal004',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00077',g_dlang)
            CALL cl_set_comp_att_text('pmaal003',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00412',g_dlang)
            CALL cl_set_comp_att_text('pmaa009',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00413',g_dlang)
            CALL cl_set_comp_att_text('pmaa010',l_gzze003) 
         WHEN '2'
            LET l_gzze003 = cl_getmsg('apm-00244',g_dlang)         
            CALL cl_set_comp_att_text('pmaa001',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00246',g_dlang)        
            CALL cl_set_comp_att_text('pmaal004',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00245',g_dlang)
            CALL cl_set_comp_att_text('pmaal003',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00414',g_dlang)
            CALL cl_set_comp_att_text('pmaa009',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00415',g_dlang)
            CALL cl_set_comp_att_text('pmaa010',l_gzze003) 
         WHEN '3'
            LET l_gzze003 = cl_getmsg('apm-00488',g_dlang)         
            CALL cl_set_comp_att_text('pmaa001',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00489',g_dlang)        
            CALL cl_set_comp_att_text('pmaal004',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00490',g_dlang)
            CALL cl_set_comp_att_text('pmaal003',l_gzze003)
            CALL cl_set_comp_att_text('b_pmaa001_desc',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00491',g_dlang)
            CALL cl_set_comp_att_text('pmaa009',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00492',g_dlang)
            CALL cl_set_comp_att_text('pmaa010',l_gzze003)
            
            LET l_gzze003 = cl_getmsg('apm-00493',g_dlang)
            CALL cl_set_comp_att_text('group34',l_gzze003)   
      END CASE
      
      LET l_ooef006 = ' '
      SELECT ooef006 INTO l_ooef006 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_site
      IF l_ooef006 = 'TW' OR l_ooef006 = 'tw' THEN
         LET l_gzze003 = cl_getmsg('apm-00084',g_dlang)         
         CALL cl_set_comp_att_text('pmaa003',l_gzze003)
      END IF
   END IF
END FUNCTION

PUBLIC FUNCTION apmm801_set_required(p_cmd)
   DEFINE p_cmd     LIKE type_t.chr1
   IF g_pmaa_m.pmaa051 = '2' OR g_pmaa_m.pmaa051 = '3' THEN
      CALL cl_set_comp_required("pmaa053,pmaa054,pmaa055",TRUE)
   END IF
   IF g_pmaa_m.pmaa004 = '3' THEN
      CALL cl_set_comp_required("pmaa005",TRUE)
   END IF
   IF g_pmaa_m.pmab049 = 'Y' THEN
      CALL cl_set_comp_required("pmab050",TRUE)
   END IF

   IF g_pmaa_m.pmab051 = 'Y' THEN
      CALL cl_set_comp_required("pmab052",TRUE)
   END IF

   IF g_pmaa_m.pmab099 = 'Y' THEN
      CALL cl_set_comp_required("pmab100",TRUE)
   END IF

   IF g_pmaa_m.pmab101 = 'Y' THEN
      CALL cl_set_comp_required("pmab102",TRUE)
   END IF
   #當客戶經營類型為'經銷商'時,'採購渠道'必填 20150625 add by beckxie---S
   IF g_pmaa_m.pmaa092 = '2' THEN
      CALL cl_set_comp_required("pmaa231",TRUE)
   END IF
   #當客戶經營類型為'經銷商'時,'採購渠道'必填 20150625 add by beckxie---E
   
   #160810-00008#1 160819 by lori add---(S)
   IF g_pmaa_m.pmaa002 <> '1' AND g_pmaa_m.pmaa092 = '1' THEN
      CALL cl_set_comp_required("pmab082,pmab083,pmab085,pmab105,pmab107,pmab108,l_pmab100,l_pmab102",TRUE)
   END IF
   #160810-00008#1 160819 by lori add---(E)
END FUNCTION

PUBLIC FUNCTION apmm801_set_no_required(p_cmd)
   DEFINE p_cmd     LIKE type_t.chr1
   CALL cl_set_comp_required("pmaa053,pmaa054,pmaa055",FALSE)
   CALL cl_set_comp_required("pmaa005",FALSE)
   CALL cl_set_comp_required("pmab050,pmab052,pmab100,pmab102",FALSE)
   CALL cl_set_comp_required("pmaa231",FALSE)   #20150625 add by beckxie
   CALL cl_set_comp_required("pmab082,pmab083,pmab085,pmab105,pmab107,pmab108,l_pmab100,l_pmab102",FALSE)   #160810-00008#1 160819 by lori add
END FUNCTION

PUBLIC FUNCTION apmm801_pmab037_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab037
   CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab037_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab037_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmab087_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmab087
   CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmab087_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmab087_desc
END FUNCTION
#將 pmaa271的資料 解析出他該顯示的內容
PUBLIC FUNCTION apmm801_pmaa271_show()
   DEFINE tok         base.StringTokenizer
   DEFINE l_chr       LIKE type_t.chr10
   
   LET g_pmaa_m.day01 = 'N'
   LET g_pmaa_m.day02 = 'N'
   LET g_pmaa_m.day03 = 'N'
   LET g_pmaa_m.day04 = 'N'
   LET g_pmaa_m.day05 = 'N'
   LET g_pmaa_m.day06 = 'N'
   LET g_pmaa_m.day07 = 'N'
   LET g_pmaa_m.day08 = 'N'
   LET g_pmaa_m.day09 = 'N'
   LET g_pmaa_m.day10 = 'N'
   LET g_pmaa_m.day11 = 'N'
   LET g_pmaa_m.day12 = 'N'
   LET g_pmaa_m.day13 = 'N'
   LET g_pmaa_m.day14 = 'N'
   LET g_pmaa_m.day15 = 'N'
   LET g_pmaa_m.day16 = 'N'
   LET g_pmaa_m.day17 = 'N'
   LET g_pmaa_m.day18 = 'N'
   LET g_pmaa_m.day19 = 'N'
   LET g_pmaa_m.day20 = 'N'
   LET g_pmaa_m.day21 = 'N'
   LET g_pmaa_m.day22 = 'N'
   LET g_pmaa_m.day23 = 'N'
   LET g_pmaa_m.day24 = 'N'
   LET g_pmaa_m.day25 = 'N'
   LET g_pmaa_m.day26 = 'N'
   LET g_pmaa_m.day27 = 'N'
   LET g_pmaa_m.day28 = 'N'
   LET g_pmaa_m.day29 = 'N'
   LET g_pmaa_m.day30 = 'N'
   LET g_pmaa_m.day31 = 'N'
   
   LET tok = base.StringTokenizer.create(g_pmaa_m.pmaa271,",")
   
   WHILE tok.hasMoreTokens()
      LET l_chr = tok.nextToken()
      CASE l_chr
         WHEN '01' LET g_pmaa_m.day01 = 'Y'
         WHEN '02' LET g_pmaa_m.day02 = 'Y'
         WHEN '03' LET g_pmaa_m.day03 = 'Y'
         WHEN '04' LET g_pmaa_m.day04 = 'Y'
         WHEN '05' LET g_pmaa_m.day05 = 'Y'
         WHEN '06' LET g_pmaa_m.day06 = 'Y'
         WHEN '07' LET g_pmaa_m.day07 = 'Y'
         WHEN '08' LET g_pmaa_m.day08 = 'Y'
         WHEN '09' LET g_pmaa_m.day09 = 'Y'
         WHEN '10' LET g_pmaa_m.day10 = 'Y'
         WHEN '11' LET g_pmaa_m.day11 = 'Y'
         WHEN '12' LET g_pmaa_m.day12 = 'Y'
         WHEN '13' LET g_pmaa_m.day13 = 'Y'
         WHEN '14' LET g_pmaa_m.day14 = 'Y'
         WHEN '15' LET g_pmaa_m.day15 = 'Y'
         WHEN '16' LET g_pmaa_m.day16 = 'Y'
         WHEN '17' LET g_pmaa_m.day17 = 'Y'
         WHEN '18' LET g_pmaa_m.day18 = 'Y'
         WHEN '19' LET g_pmaa_m.day19 = 'Y'
         WHEN '20' LET g_pmaa_m.day20 = 'Y'
         WHEN '21' LET g_pmaa_m.day21 = 'Y'
         WHEN '22' LET g_pmaa_m.day22 = 'Y'
         WHEN '23' LET g_pmaa_m.day23 = 'Y'
         WHEN '24' LET g_pmaa_m.day24 = 'Y'
         WHEN '25' LET g_pmaa_m.day25 = 'Y'
         WHEN '26' LET g_pmaa_m.day26 = 'Y'
         WHEN '27' LET g_pmaa_m.day27 = 'Y'
         WHEN '28' LET g_pmaa_m.day28 = 'Y'
         WHEN '29' LET g_pmaa_m.day29 = 'Y'
         WHEN '30' LET g_pmaa_m.day30 = 'Y'
         WHEN '31' LET g_pmaa_m.day31 = 'Y'
      END CASE
   END WHILE
END FUNCTION
#將 pmaa272的資料 解析出他該顯示的內容
PUBLIC FUNCTION apmm801_pmaa272_show()
   DEFINE tok         base.StringTokenizer
   DEFINE l_chr       LIKE type_t.chr10
   
   LET g_pmaa_m.week01 = 'N'
   LET g_pmaa_m.week02 = 'N'
   LET g_pmaa_m.week03 = 'N'
   LET g_pmaa_m.week04 = 'N'
   LET g_pmaa_m.week05 = 'N'
   LET g_pmaa_m.week06 = 'N'
   LET g_pmaa_m.week07 = 'N'
         
   LET tok = base.StringTokenizer.create(g_pmaa_m.pmaa272,",")

   WHILE tok.hasMoreTokens()
      LET l_chr = tok.nextToken()
      CASE l_chr
         WHEN '01' LET g_pmaa_m.week01 = 'Y'
         WHEN '02' LET g_pmaa_m.week02 = 'Y'
         WHEN '03' LET g_pmaa_m.week03 = 'Y'
         WHEN '04' LET g_pmaa_m.week04 = 'Y'
         WHEN '05' LET g_pmaa_m.week05 = 'Y'
         WHEN '06' LET g_pmaa_m.week06 = 'Y'
         WHEN '07' LET g_pmaa_m.week07 = 'Y'
      END CASE
   END WHILE
END FUNCTION

PUBLIC FUNCTION apmm801_pmag002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag_d[l_ac].pmag002
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2036' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag_d[l_ac].pmag002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag_d[l_ac].pmag002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmax002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag2_d[l_ac].pmax002
   CALL ap_ref_array2(g_ref_fields,"SELECT rtaxl003 FROM rtaxl_t WHERE rtaxlent='"||g_enterprise||"' AND rtaxl001=? AND rtaxl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag2_d[l_ac].pmax002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag2_d[l_ac].pmax002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmax003_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag2_d[l_ac].pmax003
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2002' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag2_d[l_ac].pmax003_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag2_d[l_ac].pmax003_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmay002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag3_d[l_ac].pmay002
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2073' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag3_d[l_ac].pmay002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag3_d[l_ac].pmay002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaz002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag4_d[l_ac].pmaz002
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2074' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag4_d[l_ac].pmaz002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag4_d[l_ac].pmaz002_desc
END FUNCTION
#依pmaa270 的選擇結果 將pmaa271,pmaa272的值組合出來
PUBLIC FUNCTION apmm801_combine_pmaa270()
  
   CASE g_pmaa_m.pmaa270
      WHEN '1'
         CALL apmm801_combine_days()
      WHEN '2'
         CALL apmm801_combine_weeks()
   END CASE
END FUNCTION

PUBLIC FUNCTION apmm801_combine_days()
   DEFINE l_str      LIKE pmaa_t.pmaa271
   
   LET l_str = ''
   IF g_pmaa_m.day01 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "01"
      ELSE
         LET l_str = l_str CLIPPED,",01"
      END IF
   END IF

   IF g_pmaa_m.day02 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "02"
      ELSE
         LET l_str = l_str CLIPPED,",02"
      END IF
   END IF

   IF g_pmaa_m.day03 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "03"
      ELSE
         LET l_str = l_str CLIPPED,",03"
      END IF
   END IF

   IF g_pmaa_m.day04 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "04"
      ELSE
         LET l_str = l_str CLIPPED,",04"
      END IF
   END IF

   IF g_pmaa_m.day05 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "05"
      ELSE
         LET l_str = l_str CLIPPED,",05"
      END IF
   END IF

   IF g_pmaa_m.day06 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "06"
      ELSE
         LET l_str = l_str CLIPPED,",06"
      END IF
   END IF

   IF g_pmaa_m.day07 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "07"
      ELSE
         LET l_str = l_str CLIPPED,",07"
      END IF
   END IF

   IF g_pmaa_m.day08 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "08"
      ELSE
         LET l_str = l_str CLIPPED,",08"
      END IF
   END IF

   IF g_pmaa_m.day09 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "09"
      ELSE
         LET l_str = l_str CLIPPED,",09"
      END IF
   END IF

   IF g_pmaa_m.day10 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "10"
      ELSE
         LET l_str = l_str CLIPPED,",10"
      END IF
   END IF

   IF g_pmaa_m.day11 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "11"
      ELSE
         LET l_str = l_str CLIPPED,",11"
      END IF
   END IF

   IF g_pmaa_m.day12 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "12"
      ELSE
         LET l_str = l_str CLIPPED,",12"
      END IF
   END IF

   IF g_pmaa_m.day13 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "13"
      ELSE
         LET l_str = l_str CLIPPED,",13"
      END IF
   END IF

   IF g_pmaa_m.day14 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "14"
      ELSE
         LET l_str = l_str CLIPPED,",14"
      END IF
   END IF

   IF g_pmaa_m.day15 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "15"
      ELSE
         LET l_str = l_str CLIPPED,",15"
      END IF
   END IF

   IF g_pmaa_m.day16 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "16"
      ELSE
         LET l_str = l_str CLIPPED,",16"
      END IF
   END IF

   IF g_pmaa_m.day17 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "17"
      ELSE
         LET l_str = l_str CLIPPED,",17"
      END IF
   END IF

   IF g_pmaa_m.day18 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "18"
      ELSE
         LET l_str = l_str CLIPPED,",18"
      END IF
   END IF

   IF g_pmaa_m.day19 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "19"
      ELSE
         LET l_str = l_str CLIPPED,",19"
      END IF
   END IF

   IF g_pmaa_m.day20 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "20"
      ELSE
         LET l_str = l_str CLIPPED,",20"
      END IF
   END IF

   IF g_pmaa_m.day21 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "21"
      ELSE
         LET l_str = l_str CLIPPED,",21"
      END IF
   END IF

   IF g_pmaa_m.day22 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "22"
      ELSE
         LET l_str = l_str CLIPPED,",22"
      END IF
   END IF

   IF g_pmaa_m.day23 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "23"
      ELSE
         LET l_str = l_str CLIPPED,",23"
      END IF
   END IF

   IF g_pmaa_m.day24 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "24"
      ELSE
         LET l_str = l_str CLIPPED,",24"
      END IF
   END IF

   IF g_pmaa_m.day25 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "25"
      ELSE
         LET l_str = l_str CLIPPED,",25"
      END IF
   END IF

   IF g_pmaa_m.day26 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "26"
      ELSE
         LET l_str = l_str CLIPPED,",26"
      END IF
   END IF

   IF g_pmaa_m.day27 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "27"
      ELSE
         LET l_str = l_str CLIPPED,",27"
      END IF
   END IF

   IF g_pmaa_m.day28 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "28"
      ELSE
         LET l_str = l_str CLIPPED,",28"
      END IF
   END IF

   IF g_pmaa_m.day29 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "29"
      ELSE
         LET l_str = l_str CLIPPED,",29"
      END IF
   END IF

   IF g_pmaa_m.day30 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "30"
      ELSE
         LET l_str = l_str CLIPPED,",30"
      END IF
   END IF

   IF g_pmaa_m.day31 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "31"
      ELSE
         LET l_str = l_str CLIPPED,",31"
      END IF
   END IF
   
   LET g_pmaa_m.pmaa271 = l_str
END FUNCTION

PUBLIC FUNCTION apmm801_combine_weeks()
   DEFINE l_str      LIKE pmaa_t.pmaa272
   
   LET l_str = ''
   IF g_pmaa_m.week01 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "01"
      ELSE
         LET l_str = l_str CLIPPED,",01"
      END IF
   END IF

   IF g_pmaa_m.week02 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "02"
      ELSE
         LET l_str = l_str CLIPPED,",02"
      END IF
   END IF

   IF g_pmaa_m.week03 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "03"
      ELSE
         LET l_str = l_str CLIPPED,",03"
      END IF
   END IF

   IF g_pmaa_m.week04 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "04"
      ELSE
         LET l_str = l_str CLIPPED,",04"
      END IF
   END IF

   IF g_pmaa_m.week05 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "05"
      ELSE
         LET l_str = l_str CLIPPED,",05"
      END IF
   END IF

   IF g_pmaa_m.week06 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "06"
      ELSE
         LET l_str = l_str CLIPPED,",06"
      END IF
   END IF

   IF g_pmaa_m.week07 = 'Y' THEN
      IF cl_null(l_str) THEN
         LET l_str = "07"
      ELSE
         LET l_str = l_str CLIPPED,",07"
      END IF
   END IF
   
   LET g_pmaa_m.pmaa272 = l_str
END FUNCTION

PUBLIC FUNCTION apmm801_pmac002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag5_d[l_ac].pmac002
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag5_d[l_ac].pmac002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag5_d[l_ac].pmac002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmaf002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag6_d[l_ac].pmaf002
   CALL ap_ref_array2(g_ref_fields,"SELECT nmabl003 FROM nmabl_t WHERE nmablent='"||g_enterprise||"' AND nmabl001=? AND nmabl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag6_d[l_ac].pmaf002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag6_d[l_ac].pmaf002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmad002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag7_d[l_ac].pmad002
   CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag7_d[l_ac].pmad002_desc = '', g_rtn_fields[1] , ''
   #DISPLAY BY NAME g_pmag7_d[l_ac].pmad002_desc
END FUNCTION

PUBLIC FUNCTION apmm801_pmad002_1_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmag8_d[l_ac].pmad002_1  
   CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmag8_d[l_ac].pmad002_1_desc = '', g_rtn_fields[1] , ''   
   #DISPLAY BY NAME g_pmag8_d[l_ac].pmad002_1_desc
END FUNCTION

PUBLIC FUNCTION apmm801_chk_uni_business_no()
   DEFINE l_cnt            LIKE type_t.num5
   DEFINE l_pmaa002          LIKE pmaa_t.pmaa002

   LET g_errno = ''
   LET g_pmaa002_flag = ''
   LET l_cnt = 0
   IF NOT cl_null(g_pmaa_m.pmaa001) THEN
      SELECT COUNT(*) INTO l_cnt FROM pmaa_t
       WHERE pmaa003 = g_pmaa_m.pmaa003
         AND pmaaent = g_enterprise
         AND pmaa001 != g_pmaa_m.pmaa001
         AND pmaastus = 'N'
   ELSE
      SELECT COUNT(*) INTO l_cnt FROM pmaa_t
       WHERE pmaa003 = g_pmaa_m.pmaa003
         AND pmaaent = g_enterprise
         AND pmaastus = 'N'
   END IF

   IF l_cnt > 0 THEN
      LET g_errno = 'art-00267'
      RETURN
   END IF 
   
   SELECT COUNT(*) INTO l_cnt FROM pmaa_t
    WHERE pmaa003 = g_pmaa_m.pmaa003
      AND pmaaent = g_enterprise
   IF l_cnt = 1 THEN
      SELECT pmaa002 INTO l_pmaa002 FROM pmaa_t
       WHERE pmaa003 = g_pmaa_m.pmaa003
         AND pmaaent = g_enterprise
#      IF g_argv[1] = '1' THEN
#         CASE l_pmaa002 
#            WHEN '1'                #一樣是供應商 
#               LET g_pmaa002_flag = '1'
#            WHEN '2'                #主檔資料是 供應商,這一次輸入的資料為客戶
#               LET g_pmaa002_flag = '2'
#            WHEN '3'                #已經是客商
#               LET g_pmaa002_flag = '1'
#         END CASE
#      END IF
#
#      IF g_argv[1] = '2' THEN
#         CASE l_pmaa002 
#            WHEN '1'                #主檔資料是 客戶,這一次輸入的資料為供應商
#               LET g_pmaa002_flag = '2'
#            WHEN '2'                #一樣是客戶
#               LET g_pmaa002_flag = '1'
#            WHEN '3'                #已經是客商
#               LET g_pmaa002_flag = '1'
#         END CASE
#      END IF
#      
#      IF g_argv[1] = '3' THEN
#         CASE l_pmaa002 
#            WHEN '1'                #主檔資料是 交易對象,這一次輸入的資料為供應商
#               LET g_pmaa002_flag = '3'
#            WHEN '2'                #主檔資料是 交易對象,這一次輸入的資料為客戶
#               LET g_pmaa002_flag = '1'
#            WHEN '3'                #已經是客商
#               LET g_pmaa002_flag = '1'
#         END CASE
#      END IF
   ELSE
      IF l_cnt > 1 THEN
         #交易對象檔中重複出現相同的代號,需請相關人員對資料正確性進行確認
         LET g_errno = 'art-00266'
      END IF
   END IF
END FUNCTION
#信用額度頁籤輸入
PUBLIC FUNCTION apmm801_input2(p_cmd)
   DEFINE p_cmd       LIKE type_t.chr10
   
   IF cl_null(g_pmaa_m.pmaa001) THEN       
      RETURN
   END IF

   LET g_pmaa_m_o.* = g_pmaa_m.*
   LET g_pmaa_m.pmaamodid = g_user
   LET g_pmaa_m.pmaamoddt = cl_get_current()
   
   CALL cl_set_comp_entry("pmaa051,pmaa052,pmaa053,pmaa054,pmaa055",TRUE)
   
  #160810-00008#1 160819 by lori mark---(S) 
  #CALL cl_set_comp_entry("pmaa056,pmaa057,pmaa058,pmaa059,pmaa060",TRUE)
  #CALL cl_set_comp_entry("pmaa061,pmaa062,pmaa063,pmaa064,pmaa065",TRUE)
  #CALL cl_set_comp_entry("pmaa066,pmaa067",TRUE)
  #160810-00008#1 160819 by lori mark---(E)
  
   CALL cl_set_comp_entry("pmaa056,pmaa057,pmaa058,pmaa059",TRUE)   #160810-00008# 160819 by lori add
   CALL cl_set_comp_entry("pmaa074,pmaa075",TRUE)                   #160810-00008# 160819 by lori add
   
   DISPLAY BY NAME g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,
                   g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa059,  #g_pmaa_m.pmaa060,   #160810-00008#1 160819 by lori mark:pmaa060
                  #g_pmaa_m.pmaa061,g_pmaa_m.pmaa062,g_pmaa_m.pmaa063,g_pmaa_m.pmaa064,g_pmaa_m.pmaa065,      #160810-00008#1 160819 by lori mark
                  #g_pmaa_m.pmaa066,g_pmaa_m.pmaa067                                                          #160810-00008#1 160819 by lori mark
                   g_pmaa_m.pmaa074,g_pmaa_m.pmaa075                                                          #160810-00008# 160819 by lori add
   CALL s_transaction_begin()
   
   INPUT BY NAME g_pmaa_m.pmaa051,g_pmaa_m.pmaa052,g_pmaa_m.pmaa053,g_pmaa_m.pmaa054,g_pmaa_m.pmaa055,
                 g_pmaa_m.pmaa056,g_pmaa_m.pmaa057,g_pmaa_m.pmaa058,g_pmaa_m.pmaa059,   #g_pmaa_m.pmaa060,   #160810-00008#1 160819 by lori mark:pmaa060
                #g_pmaa_m.pmaa061,g_pmaa_m.pmaa062,g_pmaa_m.pmaa063,g_pmaa_m.pmaa064,g_pmaa_m.pmaa065,       #160810-00008#1 160819 by lori mark
                #g_pmaa_m.pmaa066,g_pmaa_m.pmaa067                                                           #160810-00008#1 160819 by lori mark
                 g_pmaa_m.pmaa074,g_pmaa_m.pmaa075                                                           #160810-00008# 160819 by lori add
                 WITHOUT DEFAULTS
      BEFORE INPUT
      
      AFTER FIELD pmaa051
         CALL apmm801_set_no_required(p_cmd)
         CALL apmm801_set_required(p_cmd) 
 
      AFTER FIELD pmaa052
         LET g_pmaa_m.pmaa052_desc = ' '
         DISPLAY BY NAME g_pmaa_m.pmaa052_desc
         IF NOT cl_null(g_pmaa_m.pmaa052) THEN
            IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa052 != g_pmaa_m_t.pmaa052 OR g_pmaa_m_t.pmaa052 IS NULL )) THEN
               IF g_pmaa_m.pmaa052 != g_pmaa_m.pmaa001 OR g_pmaa_m.pmaa001 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa052
                  #160318-00025#24  by 07900 --add-str
                  LET g_errshow = TRUE #是否開窗                   
                  LET g_chkparam.err_str[1] ="apm-00044:sub-01302|apmm100|",cl_get_progname("apmm100",g_lang,"2"),"|:EXEPROGapm100"
                  #160318-00025#24  by 07900 --add-end
                  IF NOT cl_chk_exist("v_pmaa001_2") THEN
                     LET g_pmaa_m.pmaa052 = g_pmaa_m_t.pmaa052
                     CALL apmm801_pmaa052_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
         END IF
         CALL apmm801_pmaa052_ref()  

      #160512-00005#2 160515 by lori add---(S)
      AFTER FIELD pmaa053
         LET g_pmaa_m.pmaa053_desc = ' '
         DISPLAY BY NAME g_pmaa_m.pmaa053_desc
         IF NOT cl_null(g_pmaa_m.pmaa053) THEN
            IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa053 != g_pmaa_m_t.pmaa053 OR g_pmaa_m_t.pmaa053 IS NULL )) THEN
               INITIALIZE g_chkparam.* TO NULL
               LET g_chkparam.arg1 = g_pmaa_m.pmaa053
               IF NOT cl_chk_exist("v_xmaj001") THEN
                  LET g_pmaa_m.pmaa053 = g_pmaa_m_t.pmaa053
                  CALL apmm801_pmaa053_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF
         END IF
         CALL apmm801_pmaa053_ref()
      #160512-00005#2 160515 by lori add---(E)  
            
      AFTER FIELD pmaa054
         LET g_pmaa_m.pmaa054_desc = ' '
         DISPLAY BY NAME g_pmaa_m.pmaa054_desc
         IF NOT cl_null(g_pmaa_m.pmaa054) THEN
            IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa054 != g_pmaa_m_t.pmaa054 OR g_pmaa_m_t.pmaa054 IS NULL )) THEN
               INITIALIZE g_chkparam.* TO NULL
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_pmaa_m.pmaa054
               #160318-00025#24  by 07900 --add-str
               LET g_errshow = TRUE #是否開窗                   
               LET g_chkparam.err_str[1] ="aoo-00176:sub-01302|aooi150|",cl_get_progname("aooi150",g_lang,"2"),"|:EXEPROGaooi150"
               #160318-00025#24  by 07900 --add-end
               IF NOT cl_chk_exist("v_ooaj002") THEN
                  LET g_pmaa_m.pmaa054 = g_pmaa_m_t.pmaa054
                  CALL apmm801_pmaa054_ref()
                  NEXT FIELD CURRENT                  
               END IF
            END IF
         END IF
         CALL apmm801_pmaa054_ref()              
 
      AFTER FIELD pmaa055
         IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa055,"0.000","1","","","azz-00079",1) THEN
            NEXT FIELD pmaa055
         END IF 
 
      AFTER FIELD pmaa056
         IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa056,"0.000","1","","","azz-00079",1) THEN
            NEXT FIELD pmaa056
         END IF
 
      AFTER FIELD pmaa058
         IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa058,"0.000","1","","","azz-00079",1) THEN
            NEXT FIELD pmaa058
         END IF
 
      AFTER FIELD pmaa059
         IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa059,"0.000","1","","","azz-00079",1) THEN
            NEXT FIELD pmaa059
         END IF

     #160810-00008#1 160819 by lori mark---(S)
     #AFTER FIELD pmaa060
     #   IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa060,"0.000","1","100.000","1","azz-00087",1) THEN
     #      NEXT FIELD pmaa060
     #   END IF
     #
     #AFTER FIELD pmaa062
     #   IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa062,"0.000","1","100.000","1","azz-00087",1) THEN
     #      NEXT FIELD pmaa062
     #   END IF
     #
     #AFTER FIELD pmaa064
     #   IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa064,"0.000","1","100.000","1","azz-00087",1) THEN
     #      NEXT FIELD pmaa064
     #   END IF
     #160810-00008#1 160819 by lori mark---(E)

     #160810-00008# 160819 by lori add---(S)
      AFTER FIELD pmaa074
         IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa074,"0.000","1","","","azz-00079",1) THEN
            NEXT FIELD pmaa074
         END IF      
     #160810-00008# 160819 by lori add---(E)
     
      ON ACTION controlp INFIELD pmaa052
         INITIALIZE g_qryparam.* TO NULL
         LET g_qryparam.state = 'i'
         LET g_qryparam.reqry = FALSE
         LET g_qryparam.default1 = g_pmaa_m.pmaa052      #給予default值
         #CALL q_pmaa001()                                #呼叫開窗   #160908-00032#2 mark by rainy
         CALL q_pmaa001_4()                               #呼叫開窗    #160908-00032#2 by rainy 開窗改為 q_pmaa001_4()
         LET g_pmaa_m.pmaa052 = g_qryparam.return1       #將開窗取得的值回傳到變數
         DISPLAY g_pmaa_m.pmaa052 TO pmaa052             #顯示到畫面上
         CALL apmm801_pmaa052_ref()
         NEXT FIELD pmaa052                              #返回原欄位 

      #160512-00005#2 160515 by lori add---(S)
      ON ACTION controlp INFIELD pmaa053
		   INITIALIZE g_qryparam.* TO NULL
         LET g_qryparam.state = 'i'
		   LET g_qryparam.reqry = FALSE
		   LET g_qryparam.default1 = g_pmaa_m.pmaa053
		   
         CALL q_xmaj001()
         
         LET g_pmaa_m.pmaa053 = g_qryparam.return1
         DISPLAY g_qryparam.return1 TO pmaa053 
         CALL apmm801_pmaa053_ref()
         NEXT FIELD pmaa053                           
      #160512-00005#2 160515 by lori add---(E)
            
      ON ACTION controlp INFIELD pmaa054
         INITIALIZE g_qryparam.* TO NULL
         LET g_qryparam.state = 'i'
         LET g_qryparam.reqry = FALSE
         LET g_qryparam.default1 = g_pmaa_m.pmaa054      #給予default值
         LET g_qryparam.arg1 = g_site
         CALL q_ooaj002_1()                              #呼叫開窗
         LET g_pmaa_m.pmaa054 = g_qryparam.return1       #將開窗取得的值回傳到變數
         DISPLAY g_pmaa_m.pmaa054 TO pmaa054             #顯示到畫面上
         CALL apmm801_pmaa054_ref()
         NEXT FIELD pmaa054                              #返回原欄位 
         
      AFTER INPUT
         IF INT_FLAG THEN
            CALL s_transaction_end('N','0')
            EXIT INPUT
         END IF
         
         UPDATE pmaa_t SET pmaa051   = g_pmaa_m.pmaa051,
                           pmaa052   = g_pmaa_m.pmaa052,
                           pmaa053   = g_pmaa_m.pmaa053,
                           pmaa054   = g_pmaa_m.pmaa054,
                           pmaa055   = g_pmaa_m.pmaa055,
                           pmaa056   = g_pmaa_m.pmaa056,
                           pmaa057   = g_pmaa_m.pmaa057,
                           pmaa058   = g_pmaa_m.pmaa058,
                           pmaa059   = g_pmaa_m.pmaa059,
                          #160810-00008#1 160819 by lori mark---(S) 
                          #pmaa060   = g_pmaa_m.pmaa060,
                          #pmaa061   = g_pmaa_m.pmaa061,
                          #pmaa062   = g_pmaa_m.pmaa062,
                          #pmaa063   = g_pmaa_m.pmaa063,
                          #pmaa064   = g_pmaa_m.pmaa064,
                          #pmaa065   = g_pmaa_m.pmaa065,
                          #pmaa066   = g_pmaa_m.pmaa066,
                          #pmaa067   = g_pmaa_m.pmaa067,
                          #160810-00008#1 160819 by lori mark---(E)
                           pmaa074   = g_pmaa_m.pmaa074,   #160810-00008#1 160819 by lori add
                           pmaa075   = g_pmaa_m.pmaa075,   #160810-00008#1 160819 by lori add
                           pmaamodid = g_pmaa_m.pmaamodid,
                           pmaamoddt = g_pmaa_m.pmaamoddt
          WHERE pmaaent = g_enterprise
            AND pmaa001 = g_pmaa_m.pmaa001
           
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00009"
               LET g_errparam.extend = "pmaa_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CALL s_transaction_end('N','0')
               CONTINUE INPUT
            WHEN SQLCA.sqlcode #其他錯誤
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "pmaa_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CALL s_transaction_end('N','0')
               CONTINUE INPUT
         END CASE

         #160512-00005#2 160515 by lori add---(S)
         UPDATE pmab_t SET pmab002 = g_pmaa_m.pmaa051,
                           pmab003 = g_pmaa_m.pmaa052,
                           pmab004 = g_pmaa_m.pmaa053,
                           pmab005 = g_pmaa_m.pmaa054,
                           pmab006 = g_pmaa_m.pmaa055,
                           pmab007 = g_pmaa_m.pmaa056,
                           pmab008 = g_pmaa_m.pmaa057,
                           pmab009 = g_pmaa_m.pmaa058,
                           pmab010 = g_pmaa_m.pmaa059,
                          #160810-00008#1 160819 by lori mark---(S) 
                          #pmab011 = g_pmaa_m.pmaa060,
                          #pmab012 = g_pmaa_m.pmaa061,
                          #pmab013 = g_pmaa_m.pmaa062,
                          #pmab014 = g_pmaa_m.pmaa063,
                          #pmab015 = g_pmaa_m.pmaa064,
                          #pmab016 = g_pmaa_m.pmaa065,
                          #160810-00008#1 160819 by lori mark---(E) 
                           pmaa074   = g_pmaa_m.pmaa074,   #160810-00008#1 160819 by lori add
                           pmaa075   = g_pmaa_m.pmaa075,   #160810-00008#1 160819 by lori add
                           pmabmodid = g_pmaa_m.pmaamodid,
                           pmabmoddt = g_pmaa_m.pmaamoddt
          WHERE pmabent = g_enterprise
            AND pmabsite = 'ALL'
            
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00009"
               LET g_errparam.extend = "pmbb_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CALL s_transaction_end('N','0')
               CONTINUE INPUT
            WHEN SQLCA.sqlcode #其他錯誤
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "pmbb_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CALL s_transaction_end('N','0')
               CONTINUE INPUT
         END CASE            
         #160512-00005#2 160515 by lori add---(E)
         
         CALL s_transaction_end('Y','0')
         
   END INPUT 
   
   CALL cl_set_comp_entry("pmaa051,pmaa052,pmaa053,pmaa054,pmaa055",FALSE)
  #160810-00008#1 160819 by lori mark---(S) 
  #CALL cl_set_comp_entry("pmaa056,pmaa057,pmaa058,pmaa059,pmaa060",FALSE)
  #CALL cl_set_comp_entry("pmaa061,pmaa062,pmaa063,pmaa064,pmaa065",FALSE)
  #CALL cl_set_comp_entry("pmaa066,pmaa067",FALSE)
  #160810-00008#1 160819 by lori mark---(E)

   CALL cl_set_comp_entry("pmaa056,pmaa057,pmaa058,pmaa059",FALSE)   #160810-00008#1 160819 by lori add
   CALL cl_set_comp_entry("pmaa074,pmaa075",FALSE)                   #160810-00008#1 160819 by lori add 
END FUNCTION

PUBLIC FUNCTION apmm801_refresh_main_pmad()
   DEFINE l_cnt      LIKE type_t.num5

   LET g_errno = ''
   #IF g_argv[1] = '1' THEN   #160331-00041#1 160408 by sakura mark
      IF cl_null(g_pmaa_m.pmab037) THEN
         RETURN
      END IF

      UPDATE pmad_t SET pmad004 = 'N'
       WHERE pmad001 = g_pmaa_m.pmaa001
         AND pmadent = g_enterprise
         AND pmad003 = '1'
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "upd pmad_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         LET g_errno = SQLCA.sqlcode
         RETURN
      END IF

      LET l_cnt = 0
      SELECT COUNT(*) INTO l_cnt FROM pmad_t
       WHERE pmad001 = g_pmaa_m.pmaa001
         AND pmad002 = g_pmaa_m.pmab037
         AND pmadent = g_enterprise
         AND pmad003 = '1'

      IF l_cnt > 0 THEN
         UPDATE pmad_t SET pmad004 = 'Y' 
          WHERE pmad001 = g_pmaa_m.pmaa001
            AND pmad002 = g_pmaa_m.pmab037
            AND pmadent = g_enterprise
            AND pmad003 = '1'
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "upd pmad_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()

            LET g_errno = SQLCA.sqlcode
            RETURN
         END IF
      ELSE
         INSERT INTO pmad_t(pmadent,pmad001,pmad002,
                            pmad003,pmad004,pmadstus)
                     VALUES(g_enterprise,g_pmaa_m.pmaa001,
                            g_pmaa_m.pmab037,'1','Y','Y')
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "ins pmad_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()

            LET g_errno = SQLCA.sqlcode
            RETURN
         END IF
      END IF

   #ELSE   #160331-00041#1 160408 by sakura mark

      IF cl_null(g_pmaa_m.pmab087) THEN
         RETURN
      END IF

      UPDATE pmad_t SET pmad004 = 'N'
       WHERE pmad001 = g_pmaa_m.pmaa001
         AND pmadent = g_enterprise
         AND pmad003 = '2'
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "upd pmad_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         LET g_errno = SQLCA.sqlcode
         RETURN
      END IF

      LET l_cnt = 0
      SELECT COUNT(*) INTO l_cnt FROM pmad_t
       WHERE pmad001 = g_pmaa_m.pmaa001
         AND pmad002 = g_pmaa_m.pmab087
         AND pmadent = g_enterprise
         AND pmad003 = '2'

      IF l_cnt > 0 THEN
         UPDATE pmad_t SET pmad004 = 'Y' 
          WHERE pmad001 = g_pmaa_m.pmaa001
            AND pmad002 = g_pmaa_m.pmab087
            AND pmadent = g_enterprise
            AND pmad003 = '2'
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "upd pmad_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()

            LET g_errno = SQLCA.sqlcode
            RETURN
         END IF
      ELSE
         INSERT INTO pmad_t(pmadent,pmad001,pmad002,
                            pmad003,pmad004,pmadstus)
                     VALUES(g_enterprise,g_pmaa_m.pmaa001,
                            g_pmaa_m.pmab087,'2','Y','Y')
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "ins pmad_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()

            LET g_errno = SQLCA.sqlcode
            RETURN
         END IF
      END IF

   #END IF   #160331-00041#1 160408 by sakura mark


END FUNCTION

################################################################################
# Descriptions...: 確認客戶庫存管理選項是否可以勾選
# Memo...........: 勾選客戶代管否的flag='Y'時,需判斷是否已經有簽訂供應商合約經營方式為 13.寄銷，如果有則不允許使用者做修改
# Usage..........: CALL apmm801_pmaa248_chk(p_pmaa001)
#                  RETURNING r_success
# Input parameter: p_pmaa001      經銷商編號
# Return code....: r_success      TRUE/FALSE
# Date & Author..: 2015-05-04 By Ken
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmaa248_chk(p_pmaa001)
DEFINE p_pmaa001          LIKE pmaa_t.pmaa001
DEFINE l_cnt              LIKE type_t.num5
DEFINE r_success          LIKE type_t.num5

   LET r_success = TRUE
   
   SELECT COUNT(*) INTO l_cnt
     FROM stce_t
    WHERE stceent = g_enterprise
      AND stce009 = p_pmaa001
      AND stce005 = '13'
      
   IF l_cnt > 0 THEN
      LET r_success = FALSE
   END IF   
   
   RETURN r_success   
END FUNCTION

################################################################################
# Descriptions...: 檢查供應商、經銷商、客戶編號是否有存在相同合同資料
# Memo...........:
# Usage..........: CALL apmm801_pmaa001_chk()
#                  RETURNING r_success
# Input parameter: 
# Return code....: r_success      TRUE/FALSE
# Date & Author..: 2015/05/15 By Ken
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmaa001_chk()
DEFINE l_cnt           LIKE type_t.num5
DEFINE r_success       LIKE type_t.num5

  LET r_success = TRUE
  
  #檢查是否存在供應商合約中
  LET l_cnt = 0
  SELECT COUNT(*) INTO l_cnt 
    FROM stan_t 
   WHERE stanent = g_enterprise
     AND stan005 = g_pmaa_m.pmaa001
  IF l_cnt > 0 THEN
     INITIALIZE g_errparam TO NULL
     LET g_errparam.code = "apm-00900"
     LET g_errparam.extend = ''
     LET g_errparam.popup = TRUE
     LET g_errparam.replace[1] = g_pmaa_m.pmaa001
     LET r_success = FALSE
     CALL cl_err() 
  ELSE #供應商合約主檔沒有資料，往申請單確認是否資料
     LET l_cnt = 0    
     SELECT COUNT(*) INTO l_cnt 
       FROM staj_t 
      WHERE stajent  = g_enterprise
        AND staj005  = g_pmaa_m.pmaa001     
        AND stajstus!= 'X'
     IF l_cnt > 0 THEN
        INITIALIZE g_errparam TO NULL
        LET g_errparam.code = "apm-00901"
        LET g_errparam.extend = ''
        LET g_errparam.popup = TRUE
        LET g_errparam.replace[1] = g_pmaa_m.pmaa001
        LET r_success = FALSE
        CALL cl_err()         
     END IF  
  END IF 
  
  #檢查是否存在經銷商合約中
  LET l_cnt = 0
  SELECT COUNT(*) INTO l_cnt 
    FROM stce_t 
   WHERE stceent = g_enterprise
     AND stce009 = g_pmaa_m.pmaa001
  IF l_cnt > 0 THEN
     INITIALIZE g_errparam TO NULL
     LET g_errparam.code = "adb-00424"
     LET g_errparam.extend = ''
     LET g_errparam.popup = TRUE
     LET g_errparam.replace[1] = g_pmaa_m.pmaa001
     LET r_success = FALSE
     CALL cl_err() 
  ELSE  #經銷商合約主檔沒有資料，往申請單確認是否資料
     LET l_cnt = 0    
     SELECT COUNT(*) INTO l_cnt 
       FROM stca_t 
      WHERE stcaent  = g_enterprise
        AND stca009  = g_pmaa_m.pmaa001     
        AND stcastus!= 'X'
     IF l_cnt > 0 THEN
        INITIALIZE g_errparam TO NULL
        LET g_errparam.code = "adb-00425"
        LET g_errparam.extend = ''
        LET g_errparam.popup = TRUE
        LET g_errparam.replace[1] = g_pmaa_m.pmaa001
        LET r_success = FALSE
        CALL cl_err()         
     END IF
  END IF   
  
  #檢查是否存在專櫃合約中
  LET l_cnt = 0
  SELECT COUNT(*) INTO l_cnt 
    FROM stfa_t 
   WHERE stfaent = g_enterprise
     AND stfa010 = g_pmaa_m.pmaa001
  IF l_cnt > 0 THEN
     INITIALIZE g_errparam TO NULL
     LET g_errparam.code = "apm-00902"
     LET g_errparam.extend = ''
     LET g_errparam.popup = TRUE
     LET g_errparam.replace[1] = g_pmaa_m.pmaa001
     LET r_success = FALSE
     CALL cl_err() 
  ELSE  #專櫃合約主檔沒有資料，往申請單確認是否資料
     LET l_cnt = 0    
     SELECT COUNT(*) INTO l_cnt 
       FROM stea_t 
      WHERE steaent  = g_enterprise
        AND stea010  = g_pmaa_m.pmaa001     
        AND steastus!= 'X'
     IF l_cnt > 0 THEN
        INITIALIZE g_errparam TO NULL
        LET g_errparam.code = "apm-00903"
        LET g_errparam.extend = ''
        LET g_errparam.popup = TRUE
        LET g_errparam.replace[1] = g_pmaa_m.pmaa001
        LET r_success = FALSE
        CALL cl_err()         
     END IF  
  END IF      
  
  RETURN r_success
END FUNCTION

PRIVATE FUNCTION apmm801_pmab055_ref()
  INITIALIZE g_ref_fields TO NULL
  LET g_ref_fields[1] = g_pmaa_m.pmab055
  CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='3211' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
  LET g_pmaa_m.pmab055_desc = '', g_rtn_fields[1] , ''
  DISPLAY BY NAME g_pmaa_m.pmab055_desc
END FUNCTION

PRIVATE FUNCTION apmm801_pmab105_ref()
  INITIALIZE g_ref_fields TO NULL
  LET g_ref_fields[1] = g_pmaa_m.pmab105
  CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='3111' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
  LET g_pmaa_m.pmab105_desc = '', g_rtn_fields[1] , ''
  DISPLAY BY NAME g_pmaa_m.pmab105_desc
END FUNCTION

PRIVATE FUNCTION apmm801_set_comp_visible(p_cmd)
   DEFINE p_cmd     LIKE type_t.chr1
   #150616-00034#1 20150622 add by beckxie---S
   CALL cl_set_comp_visible('pmaa241,pmaa242,pmaa243,pmaa244,pmaa245,pmaa246,pmaa247,pmaa248',TRUE)
   CALL cl_set_comp_visible('pmaa241_desc,pmaa242_desc,pmaa243_desc,pmaa244_desc,pmaa245_desc',TRUE)
   CALL cl_set_comp_visible('page_10,page_11,page_12',TRUE)
   #150616-00034#1 20150622 add by beckxie---E
   #無開單修改by玟進 20151029 add by beckxie---S
   CALL cl_set_comp_visible('page_2,page_9,page_13,page17',TRUE)
   CALL cl_set_comp_visible('page_3,page_6,page_8,page16,page_7,bpage_1',TRUE)
   #無開單修改by玟進 20151029 add by beckxie---E
   
   CALL cl_set_comp_visible('page20',TRUE)   #160810-00008#1 160819 by lori add
END FUNCTION

PRIVATE FUNCTION apmm801_set_comp_no_visible(p_cmd)
   DEFINE p_cmd     LIKE type_t.chr1
   #無開單修改by玟進 20151029 mark by beckxie---S
   #150616-00034#1 20150622 add by beckxie---S
   #IF g_pmaa_m.pmaa092 ='1' OR (g_pmaa_m.pmaa092 IS NULL) THEN
   #   CALL cl_set_comp_visible('pmaa241,pmaa242,pmaa243,pmaa244,pmaa245,pmaa246,pmaa247,pmaa248',FALSE)
   #   CALL cl_set_comp_visible('pmaa241_desc,pmaa242_desc,pmaa243_desc,pmaa244_desc,pmaa245_desc',FALSE)
   #END IF
   #IF g_pmaa_m.pmaa092='2' THEN
   #   CALL cl_set_comp_visible('page_10,page_11,page_12',FALSE)
   #END IF
   #150616-00034#1 20150622 add by beckxie---E
   #無開單修改by玟進 20151029 mark by beckxie---E
   
   #無開單修改by玟進 20151029 add by beckxie---S
   #150616-00034#1 20150622 add by beckxie---S
   #依客戶經營類型顯隱 1:一般 2:經銷商
   IF g_pmaa_m.pmaa092 ='1' OR (g_pmaa_m.pmaa092 IS NULL) THEN
      CALL cl_set_comp_visible('pmaa241,pmaa242,pmaa243,pmaa244,pmaa245,pmaa246,pmaa247,pmaa248',FALSE)
      CALL cl_set_comp_visible('pmaa241_desc,pmaa242_desc,pmaa243_desc,pmaa244_desc,pmaa245_desc',FALSE)
      CALL cl_set_comp_visible('page_10,page_11,page_12',FALSE)
   END IF
   IF g_pmaa_m.pmaa092 !='2' AND g_pmaa_m.pmaa002 !='3' THEN
      CALL cl_set_comp_visible('bpage_1',FALSE)      
   END IF
   #150616-00034#1 20150622 add by beckxie---E
   
   #依交易對象類型顯隱 1:供應商 2:客戶
   IF g_pmaa_m.pmaa002='1' THEN
      CALL cl_set_comp_visible('page_2,page_9,page_13,page17',FALSE)
      CALL cl_set_comp_visible('page20',FALSE)   #160810-00008#1 160819 by lori add
   END IF
   IF g_pmaa_m.pmaa002='2' THEN
      CALL cl_set_comp_visible('page_3,page_6,page_8,page16,page_7',FALSE)
   END IF
   #無開單修改by玟進 20151029 add by beckxie---E
END FUNCTION

################################################################################
# Descriptions...: 取信用評核等級說明
# Memo...........:
# Usage..........: CALL apmm801_pmaa053_ref()
# Input parameter: 無
# Return code....: 無
# Date & Author..: 2016/05/15 By Lori   #160512-00005#2
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmaa053_ref()
   LET g_pmaa_m.pmaa053_desc = ''
   
   SELECT xmajl003 INTO g_pmaa_m.pmaa053_desc
     FROM xmajl_t
    WHERE xmajlent = g_enterprise
      AND xmajl001 = g_pmaa_m.pmaa053
      AND xmajl002 = g_dlang
      
   DISPLAY BY NAME g_pmaa_m.pmaa053_desc 
END FUNCTION

################################################################################
# Descriptions...: 取得標籤說明和標籤群組
# Memo...........:
# Usage..........: CALL apmm801_pmae002_ref(p_pmae002,p_oocq001)
#                  RETURNING r_pmae002_desc,r_oocq005
# Input parameter: p_pmae002        標籤編號
#                : p_oocq001        ACC編號
# Return code....: r_pmae002_desc   標籤說明
#                : r_oocq005        標籤群組
# Date & Author..: 2016/08/19 By Lori     #160810-00008#1
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmae002_ref(p_pmae002,p_oocq001)
   DEFINE p_pmae002      LIKE pmae_t.pmae002
   DEFINE p_oocq001      LIKE oocq_t.oocq001
   DEFINE r_pmae002_desc LIKE oocql_t.oocql004
   DEFINE r_oocq005      LIKE oocq_t.oocq005

   LET r_pmae002_desc = ''
   LET r_oocq005 = ''

   LET r_pmae002_desc = s_desc_get_acc_desc(p_oocq001,p_pmae002)
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_pmae002
   CALL ap_ref_array2(g_ref_fields,"SELECT oocq005 FROM oocq_t WHERE oocqent='"||g_enterprise||"' AND oocq001='"||p_oocq001||"' AND oocq002 = ? ","") RETURNING g_rtn_fields
   LET r_oocq005 = '', g_rtn_fields[1] , ''
   
   RETURN r_pmae002_desc,r_oocq005
END FUNCTION

################################################################################
# Descriptions...: 取價方式說明
# Memo...........:
# Usage..........: CALL apmm801_pmab104_ref(p_pmab104)
#                  RETURNING r_pmab104_desc
# Input parameter: p_pmab104      取價方式
# Return code....: r_pmab104_desc 取價方式說明
# Date & Author..: 2016/08/19 By Lori   #160810-00008#1
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmab104_ref(p_pmab104)
   DEFINE p_pmab104      LIKE pmab_t.pmab104
   DEFINE r_pmab104_desc LIKE xmahl_t.xmahl003

   LET r_pmab104_desc = ''
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_pmab104
   CALL ap_ref_array2(g_ref_fields,"SELECT xmahl003 FROM xmahl_t WHERE xmahlent='"||g_enterprise||"' AND xmahl001=? AND xmahl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_pmab104_desc = g_rtn_fields[1]
   
   RETURN r_pmab104_desc
END FUNCTION

################################################################################
# Descriptions...: 發票類型說明
# Memo...........:
# Usage..........: CALL apmm801_pmab106_ref(p_pmab106)
#                  RETURNING r_pmab016_desc
# Input parameter: p_pmab106      發票類型
# Return code....: r_pmab016_desc 發票類型說明
# Date & Author..: 2016/08/19 By Lori   #160810-00008#1
# Modify.........:
################################################################################
PRIVATE FUNCTION apmm801_pmab106_ref(p_pmab106)
   DEFINE p_pmab106      LIKE pmab_t.pmab106
   DEFINE r_pmab016_desc LIKE isacl_t.isacl004
   DEFINE l_success      LIKE type_t.num5
   
   LET r_pmab016_desc = ''

   IF cl_null(g_ooef019) THEN
      LET l_success = ''
      CALL s_tax_get_ooef019(g_site) RETURNING l_success,g_ooef019
   END IF
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_pmab106
   CALL ap_ref_array2(g_ref_fields,"SELECT isacl004 FROM isacl_t WHERE isaclent='"||g_enterprise||"' AND isacl001='"||g_ooef019||"' AND isacl002=? AND isacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_pmab016_desc = '', g_rtn_fields[1] , ''
   
   RETURN r_pmab016_desc
END FUNCTION

 
{</section>}
 
