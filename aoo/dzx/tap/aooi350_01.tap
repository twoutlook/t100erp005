<add_points prog="aooi350_01" std_prog="aooi350_01" erpver="1.0" module="AOO" ver="2" env="s" zone="t10dev" booking="Y" type="S" identity="s">
  <other>
    <code_template value="F" status="" />
    <free_style value="N" status="" />
  </other>
  <point name="construct.c.page1.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb009  #顯示到畫面上

            NEXT FIELD oofb009                     #返回原欄位

]]>
</point>
  <point name="dialog.aooi350_01_display" cite_std="N" status="" ver="1" src="s" new="Y" order="1" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 被主程式嵌入的地址資料顯示模式
# Memo...........: 
# Usage..........: CALL aooi350_01_display()
# Input parameter: None
# Return code....: None
# Date & Author..: 2014/02/24 By Saki
# Modify.........:
################################################################################
DIALOG aooi350_01_display()
   DISPLAY ARRAY g_oofb_d TO s_detail1_aooi350_01.* ATTRIBUTE(COUNT=g_d_cnt_i35001)

      BEFORE DISPLAY
         CALL FGL_SET_ARR_CURR(g_d_idx_i35001)
         #單身不連動, 所以進入單身時, 要重新顯示單身筆數
         DISPLAY g_d_idx_i35001, g_d_cnt_i35001 TO FORMONLY.idx, FORMONLY.cnt

      BEFORE ROW
         LET g_d_idx_i35001 = DIALOG.getCurrentRow("s_detail1_aooi350_01")
         DISPLAY g_d_idx_i35001 TO FORMONLY.idx
         # 點的當筆放入g_appoint_idx中, 可讓雙擊直接進入指定筆
         LET g_appoint_idx = g_d_idx_i35001

   END DISPLAY
END DIALOG]]>
</point>
  <point name="function.aooi350_01_b_fill" cite_std="N" status="" ver="1" src="s" new="Y" order="1" mark_hard="N">
<![CDATA[# 單身陣列填充
PUBLIC FUNCTION aooi350_01_b_fill(p_oofb002)
   DEFINE l_sql      STRING
   DEFINE p_oofb002   LIKE oofb_t.oofb002
   DEFINE l_ac1      LIKE type_t.num5
   LET l_sql = " SELECT oofbstus,oofb001,oofb008,oofb009,'',oofb010,oofb019,oofb011,oofb022,'',oofb012,'',oofb013,oofb014,'',oofb015,'',oofb016,'',oofb017,oofb020,oofb021,oofb018 ",
               "   FROM oofb_t WHERE oofbent = '",g_enterprise,"' AND oofb002 = '",p_oofb002,"'"
   IF NOT cl_null(g_wc2_i35001) THEN
      LET l_sql = l_sql CLIPPED, " AND ",g_wc2_i35001 CLIPPED
   END IF
   LET l_sql = l_sql, " ORDER BY oofb008,oofb009"  
   PREPARE aooi350_01_pb FROM l_sql
   DECLARE b_fill_curs CURSOR FOR aooi350_01_pb 
   
   CALL g_oofb_d.clear()
   LET l_ac1 = 1
   FOREACH b_fill_curs INTO g_oofb_d[l_ac1].*
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
      IF cl_null(g_oofb_d[l_ac1].oofb015) THEN
         LET g_oofb_d[l_ac1].oofb015 = ' '
      END IF
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb009
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb009_desc = g_rtn_fields[1]
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb009_desc  
  
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb012
      CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb012_desc = g_rtn_fields[1]
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb012_desc 
                  
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb012
      LET g_ref_fields[2] = g_oofb_d[l_ac1].oofb014
      CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb014_desc = g_rtn_fields[1]
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb014_desc
                  
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb012
      LET g_ref_fields[2] = g_oofb_d[l_ac1].oofb014
      LET g_ref_fields[3] = g_oofb_d[l_ac1].oofb015
      CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb015_desc = g_rtn_fields[1]
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb015_desc
                  
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb012
      LET g_ref_fields[2] = g_oofb_d[l_ac1].oofb014
      LET g_ref_fields[3] = g_oofb_d[l_ac1].oofb015
      LET g_ref_fields[4] = g_oofb_d[l_ac1].oofb016
      CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb016_desc = g_rtn_fields[1]
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb016_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_oofb_d[l_ac1].oofb022
      CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_oofb_d[l_ac1].oofb022_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_oofb_d[l_ac1].oofb022_desc
               
      LET l_ac1 = l_ac1 + 1
      IF l_ac1 > g_max_rec THEN
         #CALL cl_err( "", 9035, 0 )
         EXIT FOREACH
      END IF
      
   END FOREACH 
   CALL g_oofb_d.deleteElement(g_oofb_d.getLength())   
   LET g_rec_b = l_ac1 - 1
   DISPLAY g_rec_b TO FORMONLY.cnt
   #將總筆數, 目前筆數指定到共用變數中
   IF g_rec_b > 0 THEN
      LET g_d_idx_i35001 = 1
   ELSE
      LET g_d_idx_i35001 = 0
   END IF
   LET g_d_cnt_i35001 = g_rec_b
   CLOSE b_fill_curs
   FREE aooi350_01_pb
END FUNCTION]]>
</point>
  <point name="dialog.aooi350_01_construct" cite_std="N" status="" ver="1" src="s" new="Y" order="2" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 被主程式嵌入的地址查詢模式
# Memo...........: 
# Usage..........: CALL aooi350_01_construct()
# Input parameter: None
# Return code....: None
# Date & Author..: 2014/02/24 By Saki
# Modify.........:
################################################################################
DIALOG aooi350_01_construct()
   DEFINE ls_result   STRING

   CONSTRUCT g_wc2_i35001 ON oofbstus,oofb001,oofb008,oofb009,oofb010,
                             oofb019,oofb011,oofb022,oofb012,oofb013,oofb014,
                             oofb015,oofb016,oofb017,oofb020,oofb021,oofb018
        FROM s_detail1_aooi350_01[1].oofbstus,s_detail1_aooi350_01[1].oofb001,
             s_detail1_aooi350_01[1].oofb008,s_detail1_aooi350_01[1].oofb009,
             s_detail1_aooi350_01[1].oofb010,s_detail1_aooi350_01[1].oofb019,
             s_detail1_aooi350_01[1].oofb011,s_detail1_aooi350_01[1].oofb022,
             s_detail1_aooi350_01[1].oofb012,s_detail1_aooi350_01[1].oofb013,
             s_detail1_aooi350_01[1].oofb014,s_detail1_aooi350_01[1].oofb015,
             s_detail1_aooi350_01[1].oofb016,s_detail1_aooi350_01[1].oofb017,
             s_detail1_aooi350_01[1].oofb020,s_detail1_aooi350_01[1].oofb021,
             s_detail1_aooi350_01[1].oofb018

      AFTER FIELD oofbcrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

      AFTER FIELD oofbmoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
            
         ON ACTION controlp INFIELD oofb009
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            #給予arg
            LET g_qryparam.arg1 = "1" #
            CALL q_oocq002()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb009              #顯示到畫面上
            NEXT FIELD oofb009                          #返回原欄位     

         ON ACTION controlp INFIELD oofb022
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_dbad001_1()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb022              #顯示到畫面上
            NEXT FIELD oofb022                          #返回原欄位
            
         ON ACTION controlp INFIELD oofb012
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_oocg001()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb012              #顯示到畫面上
            NEXT FIELD oofb012                          #返回原欄位

         ON ACTION controlp INFIELD oofb013
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_oocn002_2()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb013              #顯示到畫面上
            NEXT FIELD oofb013                         #返回原欄位
            
         ON ACTION controlp INFIELD oofb014
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_ooci002()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb014             #顯示到畫面上
            NEXT FIELD oofb014                        #返回原欄位      

         ON ACTION controlp INFIELD oofb015
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_oock003()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb015             #顯示到畫面上
            NEXT FIELD oofb015                        #返回原欄位 
            
         ON ACTION controlp INFIELD oofb016
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            CALL q_oocm004()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb016             #顯示到畫面上
            NEXT FIELD oofb016                        #返回原欄位             
   END CONSTRUCT
END DIALOG]]>
</point>
  <point name="function.aooi350_01_clear_detail" cite_std="N" status="" ver="1" src="s" new="Y" order="2" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 清除畫面上聯絡地址單身
# Memo...........: 
# Usage..........: CALL aooi350_01_clear_detail()
# Input parameter: None
# Return code....: None
# Date & Author..: 2014/02/24 By Saki
# Modify.........:
################################################################################
PUBLIC FUNCTION aooi350_01_clear_detail()
   CALL g_oofb_d.clear()
END FUNCTION]]>
</point>
  <point name="dialog.aooi350_01_input" cite_std="N" status="" ver="1" src="s" new="Y" order="3" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 被主程式嵌入的地址輸入模式
# Memo...........: 
# Usage..........: CALL aooi350_01_construct()
# Input parameter: None
# Return code....: None
# Date & Author..: 2014/02/24 By Saki
# Modify.........:
################################################################################
DIALOG aooi350_01_input()
   DEFINE l_ac_t          LIKE type_t.num5        #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num5
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   {</Local define>}
   #add-point:input段define
   DEFINE l_oofb         RECORD LIKE oofb_t.*
   DEFINE l_forupd_sql   STRING
   DEFINE l_lock_sw      LIKE type_t.chr1 
   DEFINE l_success      LIKE type_t.num5
   DEFINE l_wc           STRING
   DEFINE l_n            LIKE type_t.num5

   
   
   INPUT ARRAY g_oofb_d FROM s_detail1_aooi350_01.*
      ATTRIBUTE(COUNT = g_d_cnt_i35001,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                INSERT ROW = FALSE,
                DELETE ROW = g_detail_delete,
                APPEND ROW = g_detail_insert)
         
         #自訂ACTION
         #add-point:單身前置處理

         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理
            LET l_forupd_sql = " SELECT oofbstus,oofb001,oofb008,oofb009,'',oofb010,oofb019,oofb011,oofb022,'',oofb012,'',oofb013,oofb014,'',oofb015,'',oofb016,'',oofb017,oofb020,oofb021,oofb018 ",
                               " FROM oofb_t WHERE oofbent = '",g_enterprise,"' AND oofb002 = '",g_pmaa027_d,"' AND oofb001 = ? FOR UPDATE"
            LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)  
            PREPARE aooi350_01_dialog_b FROM l_forupd_sql
            DECLARE aooi350_01_dialog_bcl CURSOR FOR aooi350_01_dialog_b
            IF g_appoint_idx > 0 THEN
               CALL DIALOG.setCurrentRow("s_detail1_aooi350_01",g_appoint_idx)
            END IF
         BEFORE ROW
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET l_lock_sw = 'N'            #DEFAULT
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()

            LET g_rec_b = g_oofb_d.getLength()
            
            IF g_rec_b >= l_ac THEN  
               LET l_cmd='u'
               LET g_oofb_d_t.* = g_oofb_d[l_ac].*  #BACKUP
               OPEN aooi350_01_dialog_bcl USING g_oofb_d[l_ac].oofb001                      
               IF SQLCA.sqlcode THEN
                  CALL cl_err("aooi350_01_dialog_bcl",SQLCA.sqlcode,1)
               ELSE                                       
                  FETCH aooi350_01_dialog_bcl INTO g_oofb_d[l_ac].*
                  IF SQLCA.sqlcode THEN
                     LET l_lock_sw = "Y"
                  END IF
                  IF cl_null(g_oofb_d[l_ac].oofb015) THEN
                     LET g_oofb_d[l_ac].oofb015 = ' '
                  END IF
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb009_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc  
  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb012_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc 
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
                  CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
                  LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc

                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
                  CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc
               
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF

            IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                CALL cl_set_comp_required('oofb022',TRUE)
            ELSE
               CALL cl_set_comp_required('oofb022',FALSE)
            END IF
            
         BEFORE INSERT
            CALL s_transaction_begin()
            LET l_cmd = 'a'
            INITIALIZE g_oofb_d_t.* TO NULL
            INITIALIZE g_oofb_d[l_ac].* TO NULL 
            
            LET g_oofb_d_t.* = g_oofb_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()   
            LET g_oofb_d[l_ac].oofbstus = 'Y'
            LET g_oofb_d[l_ac].oofb010 = 'N'
         AFTER INSERT
            IF INT_FLAG THEN
               CALL cl_err('',9001,1)
               LET INT_FLAG = 0
#               CANCEL INSERT
            END IF
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            LET l_oofb.oofbent = g_enterprise
            LET l_oofb.oofbstus =g_oofb_d[l_ac].oofbstus
            LET l_success = NULL
            LET l_wc = " oofbent = '",g_enterprise,"' "
            CALL s_aooi350_get_idno('oofb001','oofb_t',l_wc) RETURNING l_success,l_oofb.oofb001        
            LET l_oofb.oofb002 = g_pmaa027_d
            LET l_oofb.oofb008 = g_oofb_d[l_ac].oofb008
            LET l_oofb.oofb009 = g_oofb_d[l_ac].oofb009
            LET l_oofb.oofb010 = g_oofb_d[l_ac].oofb010 
            LET l_oofb.oofb011 = g_oofb_d[l_ac].oofb011
            LET l_oofb.oofb012 = g_oofb_d[l_ac].oofb012
            LET l_oofb.oofb013 = g_oofb_d[l_ac].oofb013
            LET l_oofb.oofb014 = g_oofb_d[l_ac].oofb014
            LET l_oofb.oofb015 = g_oofb_d[l_ac].oofb015
            LET l_oofb.oofb016 = g_oofb_d[l_ac].oofb016
            LET l_oofb.oofb017 = g_oofb_d[l_ac].oofb017
            LET l_oofb.oofb018 = g_oofb_d[l_ac].oofb018
            LET l_oofb.oofb019 = g_oofb_d[l_ac].oofb019
            LET l_oofb.oofb020 = g_oofb_d[l_ac].oofb020
            LET l_oofb.oofb021 = g_oofb_d[l_ac].oofb021
            LET l_oofb.oofb022 = g_oofb_d[l_ac].oofb022
            LET l_oofb.oofbownid = g_user
            LET l_oofb.oofbowndp = g_dept
            LET l_oofb.oofbcrtid = g_user
            LET l_oofb.oofbcrtdp = g_dept 
            LET l_oofb.oofbcrtdt = cl_get_current()
            LET l_oofb.oofbmodid = g_user
            LET l_oofb.oofbmoddt = cl_get_current()
            SELECT COUNT(*) INTO l_count FROM oofb_t 
             WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = g_pmaa027_d
                        
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INSERT INTO oofb_t VALUES(l_oofb.*)
                    
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,0)
               END IF
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_oofb_d[l_ac].* TO NULL
               CALL s_transaction_end('N',0)
#               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("oofb_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N',0)                   
#               CANCEL INSERT
            ELSE
              
               CALL s_transaction_end('Y',0)
               
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
 
        BEFORE DELETE                            #是否取消單身
            IF NOT cl_null(g_oofb_d[l_ac].oofb001) THEN

               IF NOT cl_ask_del_detail() THEN
#                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
#                  CANCEL DELETE
               END IF
               DELETE FROM oofb_t
                WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = g_pmaa027_d
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N',0)
#                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  CALL s_transaction_end('Y',1)
               END IF 
               CLOSE aooi350_01_dialog_bcl
               LET l_count = g_oofb_d.getLength()
            END IF 
            
         ON ROW CHANGE
            IF INT_FLAG THEN
               CALL cl_err('',9001,1)
               LET INT_FLAG = 0
               LET g_oofb_d[l_ac].* = g_oofb_d_t.*
               CLOSE aooi350_01_dialog_bcl
               CALL s_transaction_end('N',0)
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               CALL cl_err(l_oofb.oofb001,-263,1)
               LET g_oofb_d[l_ac].* = g_oofb_d_t.*
            ELSE
               UPDATE oofb_t SET (oofbstus,oofb008,oofb009,oofb010,oofb019,oofb011,oofb012,oofb013,oofb014,oofb015,oofb016,oofb017,oofb018,oofb020,oofb021,oofb022)= (g_oofb_d[l_ac].oofbstus,g_oofb_d[l_ac].oofb008,g_oofb_d[l_ac].oofb009,g_oofb_d[l_ac].oofb010,g_oofb_d[l_ac].oofb019,g_oofb_d[l_ac].oofb011,g_oofb_d[l_ac].oofb012,
                                  g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017,g_oofb_d[l_ac].oofb018,g_oofb_d[l_ac].oofb020,g_oofb_d[l_ac].oofb021,g_oofb_d[l_ac].oofb022)
                WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = g_pmaa027_d 
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,1)   
                  LET g_oofb_d[l_ac].* = g_oofb_d_t.*
                  CALL s_transaction_end('N',0) 
               ELSE
                  CALL s_transaction_end('Y',0)                
               END IF

            END IF
            
         AFTER ROW
            CLOSE aooi350_01_dialog_bcl
        
            #end add-point
          
         #---------------------<  Detail: page1  >---------------------
         #----<<oofbstus>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofbstus
            #add-point:BEFORE FIELD oofbstus

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofbstus
            
            #add-point:AFTER FIELD oofbstus

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofbstus
            #add-point:ON CHANGE oofbstus

            #END add-point
 
         #----<<oofb001>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb001
            #add-point:BEFORE FIELD oofb001

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb001
            
            #add-point:AFTER FIELD oofb001
            IF  g_oofb_d[g_detail_idx].oofb001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_oofb_d[g_detail_idx].oofb001 != g_oofb_d_t.oofb001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE "||"oofbent = '" ||g_enterprise|| "' AND "||"oofb001 = '"||g_oofb_d[g_detail_idx].oofb001 ||"'",'std-00004',1) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb001
            #add-point:ON CHANGE oofb001

            #END add-point
 
         #----<<oofb008>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb008
            #add-point:BEFORE FIELD oofb008

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb008
            
            #add-point:AFTER FIELD oofb008
           IF g_oofb_d[l_ac].oofb008 <> g_oofb_d_t.oofb008 OR g_oofb_d_t.oofb008 IS NULL THEN
              IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                  CALL cl_set_comp_required('oofb022',TRUE)
              ELSE
                 CALL cl_set_comp_required('oofb022',FALSE)
              END IF
            END IF 
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb008
            #add-point:ON CHANGE oofb008

            #END add-point
 
         #----<<oofb009>>----
         #此段落由子樣板a02產生
         AFTER FIELD oofb009
            
            #add-point:AFTER FIELD oofb009
            IF NOT cl_null(g_oofb_d[l_ac].oofb009) THEN
               CALL s_azzi650_chk_exist('1',g_oofb_d[l_ac].oofb009) RETURNING l_success
               IF NOT l_success THEN
                  LET g_oofb_d[l_ac].oofb009 = g_oofb_d_t.oofb009
                  LET g_oofb_d[l_ac].oofb009_desc = g_oofb_d_t.oofb009_desc
                  NEXT FIELD oofb009
               END IF   
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb009
            #add-point:BEFORE FIELD oofb009
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb009
            #add-point:ON CHANGE oofb009

            #END add-point
 
         #----<<oofb010>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb010
            #add-point:BEFORE FIELD oofb010

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb010
            
            #add-point:AFTER FIELD oofb010
            IF NOT cl_null(g_oofb_d[l_ac].oofb008) AND g_oofb_d[l_ac].oofb010 = 'Y' THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb010 != g_oofb_d_t.oofb010))) THEN
                  LET l_n = 0
                  SELECT COUNT(*) INTO l_n FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = g_pmaa027_d
                     AND oofb008 = g_oofb_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                   IF l_n > 0 THEN
                      CALL cl_err(g_oofb_d[l_ac].oofb010,'aoo-00156',1)
                      LET g_oofb_d[l_ac].oofb010 = 'N'
                      NEXT FIELD oofb010
                   END IF
                END IF
             END IF
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb010
            #add-point:ON CHANGE oofb010

            #END add-point
 
         #----<<oofb019>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb019
            #add-point:BEFORE FIELD oofb019

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb019
            
            #add-point:AFTER FIELD oofb019
            IF NOT cl_null(g_oofb_d[l_ac].oofb019) THEN
                IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb019 != g_oofb_d_t.oofb019) OR g_oofb_d_t.oofb019 IS NULL)) THEN
                   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE oofbent = '" ||g_enterprise|| "' AND oofb002 = '"|| g_pmaa027_d ||  "' AND oofb019 = '"||g_oofb_d[l_ac].oofb019 ||"'",'std-00004',1) THEN 
                      LET g_oofb_d[l_ac].oofb019 = g_oofb_d_t.oofb019
                      NEXT FIELD oofb019
                   END IF
                END IF
            END IF
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb019
            #add-point:ON CHANGE oofb019

            #END add-point
 
         #----<<oofb011>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb011
            #add-point:BEFORE FIELD oofb011

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb011
            
            #add-point:AFTER FIELD oofb011

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb011
            #add-point:ON CHANGE oofb011

            #END add-point
       #此段落由子樣板a02產生
         AFTER FIELD oofb022            
            IF NOT cl_null(g_oofb_d[l_ac].oofb022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_ref_fields TO NULL
               LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
               CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
               LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
               DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_oofb_d[l_ac].oofb022
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_dbad001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_oofb_d[l_ac].oofb022 = g_oofb_d_t.oofb022
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
                  CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc                  
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            IF g_oofb_d[l_ac].oofb022 <> g_oofb_d_t.oofb022 OR cl_null(g_oofb_d[l_ac].oofb022) THEN
               IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                   CALL cl_set_comp_required('oofb022',TRUE)
               ELSE
                  CALL cl_set_comp_required('oofb022',FALSE)
               END IF
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
            CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc
 
         #----<<oofb012>>----
         #此段落由子樣板a02產生
         AFTER FIELD oofb012
            
            #add-point:AFTER FIELD oofb012
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb012 = g_oofb_d_t.oofb012
               LET g_oofb_d[l_ac].oofb012_desc = g_oofb_d_t.oofb012_desc
               NEXT FIELD oofb012
            END IF           
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb012
            #add-point:BEFORE FIELD oofb012
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb012
            #add-point:ON CHANGE oofb012

            #END add-point
 
         #----<<oofb013>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb013
            #add-point:BEFORE FIELD oofb013

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb013
            
            #add-point:AFTER FIELD oofb013
           IF NOT cl_null(g_oofb_d[l_ac].oofb013) THEN
               SELECT oocn003,oocn004,oocn005,oocn006 INTO g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017
                FROM oocn_t
               WHERE oocnent=g_enterprise
                 AND oocn001 = g_oofb_d[l_ac].oofb012
                 AND oocn002 = g_oofb_d[l_ac].oofb013
            END IF
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016
            DISPLAY BY NAME g_oofb_d[l_ac].oofb017

            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb013 = g_oofb_d_t.oofb013
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb017 = g_oofb_d_t.oofb017
               NEXT FIELD oofb013
            END IF   
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb013
            #add-point:ON CHANGE oofb013

            #END add-point
 
         #----<<oofb014>>----
         #此段落由子樣板a02產生
         AFTER FIELD oofb014
            
            #add-point:AFTER FIELD oofb014
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb014_desc = g_oofb_d_t.oofb014_desc
               NEXT FIELD oofb014
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb014
            #add-point:BEFORE FIELD oofb014
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb014
            #add-point:ON CHANGE oofb014

            #END add-point
 
         #----<<oofb015>>----
         #此段落由子樣板a02產生
         AFTER FIELD oofb015
            
            #add-point:AFTER FIELD oofb015
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb015_desc = g_oofb_d_t.oofb015_desc
               NEXT FIELD oofb015
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb015
            #add-point:BEFORE FIELD oofb015
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb015
            #add-point:ON CHANGE oofb015

            #END add-point
 
         #----<<oofb016>>----
         #此段落由子樣板a02產生
         AFTER FIELD oofb016
            
            #add-point:AFTER FIELD oofb016
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb016_desc = g_oofb_d_t.oofb016_desc
               NEXT FIELD oofb016
            END IF
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF            
            INITIALIZE g_ref_fields TO NULL
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN LET g_oofb_d[l_ac].oofb015=' ' END IF
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb016
            #add-point:BEFORE FIELD oofb016
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb016
            #add-point:ON CHANGE oofb016

            #END add-point
 
         #----<<oofb017>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017
            #add-point:BEFORE FIELD oofb017

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017
            
            #add-point:AFTER FIELD oofb017

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb017
            #add-point:ON CHANGE oofb017

            #END add-point
 
         #----<<oofb018>>----
         #此段落由子樣板a01產生
         BEFORE FIELD oofb018
            #add-point:BEFORE FIELD oofb018

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb018
            
            #add-point:AFTER FIELD oofb018

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb018
            #add-point:ON CHANGE oofb018

            #END add-point
 
 
         #---------------------<  Detail: page1  >---------------------
         #----<<oofbstus>>----
         #Ctrlp:input.c.page1_aooi350_01.oofbstus
         ON ACTION controlp INFIELD oofbstus
            #add-point:ON ACTION controlp INFIELD oofbstus

            #END add-point
 
         #----<<oofb001>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb001
         ON ACTION controlp INFIELD oofb001
            #add-point:ON ACTION controlp INFIELD oofb001

            #END add-point
 
         #----<<oofb008>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb008
         ON ACTION controlp INFIELD oofb008
            #add-point:ON ACTION controlp INFIELD oofb008

            #END add-point
 
         #----<<oofb009>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb009
         ON ACTION controlp INFIELD oofb009
            #add-point:ON ACTION controlp INFIELD oofb009
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb009             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb009 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb009 TO oofb009              #顯示到畫面上

            NEXT FIELD oofb009                          #返回原欄位

            #END add-point
 
         #----<<oofb010>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb010
         ON ACTION controlp INFIELD oofb010
            #add-point:ON ACTION controlp INFIELD oofb010

            #END add-point
 
         #----<<oofb019>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb019
         ON ACTION controlp INFIELD oofb019
            #add-point:ON ACTION controlp INFIELD oofb019

            #END add-point
         ON ACTION controlp INFIELD oofb022
            #add-point:ON ACTION controlp INFIELD oofb022
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb022             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_dbad001_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb022 = g_qryparam.return1              

            DISPLAY g_oofb_d[l_ac].oofb022 TO oofb022              #

            NEXT FIELD oofb022                          #返回原欄位
 
         #----<<oofb011>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb011
         ON ACTION controlp INFIELD oofb011
            #add-point:ON ACTION controlp INFIELD oofb011

            #END add-point
 
         #----<<oofb012>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb012
         ON ACTION controlp INFIELD oofb012
            #add-point:ON ACTION controlp INFIELD oofb012
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb012             #給予default值

            #給予arg

            CALL q_oocg001()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb012 TO oofb012              #顯示到畫面上
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            NEXT FIELD oofb012                          #返回原欄位

            #END add-point
 
         #----<<oofb013>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb013
         ON ACTION controlp INFIELD oofb013
            #add-point:ON ACTION controlp INFIELD oofb013
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb013             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb012             #給予default值
            LET g_qryparam.default3 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default4 = g_oofb_d[l_ac].oofb015             #給予default值
            LET g_qryparam.default5 = g_oofb_d[l_ac].oofb016             #給予default值
            LET g_qryparam.default6 = g_oofb_d[l_ac].oofb017             #給予default值
            
            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oocn001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            
            CALL q_oocn002_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb013 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return2              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return3              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return4              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb016 = g_qryparam.return5              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb017 = g_qryparam.return6              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb013 TO oofb013              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb012 TO oofb012              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb015              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb016              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb017 TO oofb017              #顯示到畫面上           
            
            #重新顯示州省、縣市、行政地區的名稱
            
            NEXT FIELD oofb013                          #返回原欄位
            #END add-point
 
         #----<<oofb014>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb014
         ON ACTION controlp INFIELD oofb014
            #add-point:ON ACTION controlp INFIELD oofb014
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb012             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb014             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " ooci001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF

            CALL q_ooci002_2()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return2              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb012              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb014              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb014                          #返回原欄位
            #END add-point
 
         #----<<oofb015>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb015
         ON ACTION controlp INFIELD oofb015
            #add-point:ON ACTION controlp INFIELD oofb015
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb015             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oock001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oock002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF

            CALL q_oock003_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return2              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb015              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb015                   
            #END add-point
 
         #----<<oofb016>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb016
         ON ACTION controlp INFIELD oofb016
            #add-point:ON ACTION controlp INFIELD oofb016
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb015             #給予default值
            LET g_qryparam.default3 = g_oofb_d[l_ac].oofb016             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oocm001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm003 = '",g_oofb_d[l_ac].oofb015,"'"
            END IF
            
            CALL q_oocm004_2()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return2              #將開窗取得的值回傳到變數            
            LET g_oofb_d[l_ac].oofb016 = g_qryparam.return3              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb015              #顯示到畫面上            
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb016              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            #END add-point
 
         #----<<oofb017>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb017
         ON ACTION controlp INFIELD oofb017
            #add-point:ON ACTION controlp INFIELD oofb017

            #END add-point
 
         #----<<oofb018>>----
         #Ctrlp:input.c.page1_aooi350_01.oofb018
         ON ACTION controlp INFIELD oofb018
            #add-point:ON ACTION controlp INFIELD oofb018

            #END add-point
 
 
 
         AFTER INPUT
            #add-point:單身輸入後處理

            ##end add-point
            
      END INPUT
END DIALOG]]>
</point>
  <point name="function.aooi350_01_oofb_chk" cite_std="N" status="" ver="1" src="s" new="Y" order="3" mark_hard="N">
<![CDATA[# 國家地區、州省、縣市、郵政編號相關欄位檢查
PRIVATE FUNCTION aooi350_01_oofb_chk(p_oofb012,p_oofb013,p_oofb014,p_oofb015,p_oofb016)
DEFINE p_oofb012    LIKE oofb_t.oofb012
DEFINE p_oofb013    LIKE oofb_t.oofb013
DEFINE p_oofb014    LIKE oofb_t.oofb014
DEFINE p_oofb015    LIKE oofb_t.oofb015
DEFINE p_oofb016    LIKE oofb_t.oofb016
DEFINE l_oocg001    LIKE oocg_t.oocg001
DEFINE l_oocgstus   LIKE oocg_t.oocgstus
DEFINE l_sql        STRING 


IF NOT cl_null(p_oofb012) THEN 
   LET l_oocg001 = ''
   LET l_oocgstus = ''   
   SELECT oocg001,oocgstus INTO l_oocg001,l_oocgstus FROM oocg_t 
    WHERE oocg001 = p_oofb012 AND oocgent = g_enterprise
   IF cl_null(l_oocg001) THEN
      CALL cl_err(p_oofb012,'aoo-00013',1)
      RETURN FALSE
   END IF 
   IF l_oocgstus != 'Y' THEN 
      CALL cl_err(p_oofb012,'aoo-00035',1)
      RETURN FALSE
   END IF 
END IF 

IF NOT cl_null(p_oofb013) THEN 
   LET l_oocg001 = ''
   LET l_oocgstus = ''   
   SELECT oocn002,oocnstus INTO l_oocg001,l_oocgstus FROM oocn_t
    WHERE oocn001 = p_oofb012 AND oocn002 = p_oofb013 AND oocnent = g_enterprise
   IF cl_null(l_oocg001) THEN
      CALL cl_err(p_oofb014,'aoo-00151',1)
      RETURN FALSE
   END IF 
   IF l_oocgstus != 'Y' THEN 
      CALL cl_err(p_oofb014,'aoo-00152',1)
      RETURN FALSE
   END IF  
END IF 
    
IF NOT cl_null(p_oofb014) THEN 
   LET l_oocg001 = ''
   LET l_oocgstus = ''
   SELECT ooci002,oocistus INTO l_oocg001,l_oocgstus FROM ooci_t
    WHERE ooci001 = p_oofb012 AND ooci002 = p_oofb014 AND oocient = g_enterprise
   IF cl_null(l_oocg001) THEN
      CALL cl_err(p_oofb014,'aoo-00014',1)
      RETURN FALSE
   END IF 
   IF l_oocgstus != 'Y' THEN 
      CALL cl_err(p_oofb014,'aoo-00143',1)
      RETURN FALSE
   END IF  
END IF 

IF NOT cl_null(p_oofb015) THEN 
   LET l_oocg001 = ''
   LET l_oocgstus = ''
   LET l_sql = "SELECT oock003,oockstus FROM oock_t",
               " WHERE oock001 = '",p_oofb012,"' AND oock003 = '",p_oofb015,"' AND oockent = '",g_enterprise,"'"
   IF NOT cl_null(p_oofb014) THEN 
      LET l_sql = l_sql ," AND oock002='",p_oofb014,"'"
   END IF
   PREPARE pre_oofb015 FROM l_sql
   EXECUTE pre_oofb015 INTO l_oocg001,l_oocgstus
   IF cl_null(l_oocg001) THEN
      CALL cl_err(p_oofb015,'aoo-00015',1)
      RETURN FALSE
   END IF 
   IF l_oocgstus != 'Y' THEN 
      CALL cl_err(p_oofb015,'aoo-00036',1)
      RETURN FALSE
   END IF  
END IF 

IF NOT cl_null(p_oofb016) THEN 
   LET l_oocg001 = ''
   LET l_oocgstus = ''
   LET l_sql = "SELECT oocm004,oocmstus FROM oocm_t",
               " WHERE oocm001 = '",p_oofb012,"' AND oocm004 = '",p_oofb016,"' AND oocment = '",g_enterprise,"'"
   IF NOT cl_null(p_oofb014) THEN 
      LET l_sql = l_sql ," AND oocm002='",p_oofb014,"'"
   END IF
   IF NOT cl_null(p_oofb015) THEN
      LET l_sql = l_sql ," AND oocm003='",p_oofb015,"'"
   END IF   
   PREPARE pre_oofb016 FROM l_sql
   EXECUTE pre_oofb016 INTO l_oocg001,l_oocgstus
   IF cl_null(l_oocg001) THEN
      CALL cl_err(p_oofb016,'aoo-00022',1)
      RETURN FALSE
   END IF 
   IF l_oocgstus != 'Y' THEN 
      CALL cl_err(p_oofb016,'aoo-00144',1)
      RETURN FALSE
   END IF  
END IF 

RETURN TRUE
END FUNCTION]]>
</point>
  <point name="function.aooi350_01_show_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="4" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL aooi350_01_show_ref(p_oofb012,p_oofb014,p_oofb015,p_oofb016)
#                  RETURNING 回传参数
# Input parameter: p_oofb012   國家/地區
#                : p_oofb014   州/省/直轄市
#                : p_oofb015   縣/市
#                : p_oofb016   行政區域
# Return code....: 無
# Date & Author..: 140311 By Sarah
# Modify.........:
################################################################################
PRIVATE FUNCTION aooi350_01_show_ref(p_oofb012,p_oofb014,p_oofb015,p_oofb016)
DEFINE p_oofb012       LIKE oofb_t.oofb012
DEFINE p_oofb014       LIKE oofb_t.oofb014
DEFINE p_oofb015       LIKE oofb_t.oofb015
DEFINE p_oofb016       LIKE oofb_t.oofb016

   IF cl_null(p_oofb015) THEN LET p_oofb015 = ' ' END IF
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_oofb012
   CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_oofb_d[l_ac].oofb012_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_oofb012
   LET g_ref_fields[2] = p_oofb014
   CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_oofb_d[l_ac].oofb014_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_oofb012
   LET g_ref_fields[2] = p_oofb014
   LET g_ref_fields[3] = p_oofb015
   CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_oofb_d[l_ac].oofb015_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_oofb012
   LET g_ref_fields[2] = p_oofb014
   LET g_ref_fields[3] = p_oofb015
   LET g_ref_fields[4] = p_oofb016
   CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_oofb_d[l_ac].oofb016_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
   
END FUNCTION]]>
</point>
  <point name="construct.c.page1.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_oocg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb012  #顯示到畫面上

            NEXT FIELD oofb012                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_oocn002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb013  #顯示到畫面上

            NEXT FIELD oofb013                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_ooci002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb014  #顯示到畫面上

            NEXT FIELD oofb014                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_oock003()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb015  #顯示到畫面上

            NEXT FIELD oofb015                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            LET g_qryparam.reqry = FALSE
            CALL q_oocm004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb016  #顯示到畫面上

            NEXT FIELD oofb016                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb009  #顯示到畫面上

            NEXT FIELD oofb009                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb012  #顯示到畫面上

            NEXT FIELD oofb012                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocn002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb013  #顯示到畫面上

            NEXT FIELD oofb013                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooci002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb014  #顯示到畫面上

            NEXT FIELD oofb014                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oock003()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb015  #顯示到畫面上

            NEXT FIELD oofb015                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1_aooi350_01.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocm004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO oofb016  #顯示到畫面上

            NEXT FIELD oofb016                     #返回原欄位

]]>
</point>
  <point name="global.import" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="global.inc" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[GLOBALS "../4gl/aooi350_01.inc"]]>
</point>
  <point name="global.variable" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#GLOBALS
#   DEFINE g_detail_insert   LIKE type_t.num5   #單身的新增權限
#   DEFINE g_detail_delete   LIKE type_t.num5   #單身的刪除權限
#   DEFINE g_wc2_i35001      STRING             #單身QBE條件
#   DEFINE g_d_idx_i35001    LIKE type_t.num5   #單身所在筆數
#   DEFINE g_d_cnt_i35001    LIKE type_t.num5   #單身總筆數
#   DEFINE g_pmaa027_d       LIKE pmaa_t.pmaa027
#   DEFINE g_appoint_idx     LIKE type_t.num5   #指定進入單身行數
#END GLOBALS]]>
</point>
  <point name="input.a.page1.oofb001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_oofb_d[l_ac].oofb001) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb001 != g_oofb_d_t.oofb001))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE "||"oofbent = '" ||g_enterprise|| "' AND "||"oofb001 = '"||g_oofb_d[l_ac].oofb001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1.oofb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb008) AND g_oofb_d[l_ac].oofb010 = 'Y' THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb008 != g_oofb_d_t.oofb008))) THEN
                  LET l_n = 0
                  SELECT COUNT(*) INTO l_n FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = p_oofb002 
                     AND oofb008 = g_oofb_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                   IF l_n > 0 THEN 
                      CALL cl_err(g_oofb_d[l_ac].oofb008,'aoo-00156',0)
                      LET g_oofb_d[l_ac].oofb008 = g_oofb_d_t.oofb008
                      NEXT FIELD oofb008
                   END IF 
                END IF   
             END IF]]>
</point>
  <point name="input.a.page1.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb009) THEN
               LET l_n = 0
               SELECT COUNT(*) INTO l_n FROM oocq_t
                WHERE oocqent =  g_enterprise
                  AND oocq001 = '1'
                  AND oocq002 = g_oofb_d[l_ac].oofb009
               IF l_n = 0 THEN
                  CALL cl_err('','aoo-00081',1)
                  LET g_oofb_d[l_ac].oofb009 = g_oofb_d_t.oofb009
                  LET g_oofb_d[l_ac].oofb009_desc = g_oofb_d_t.oofb009_desc
                  NEXT FIELD oofb009
               END IF

               LET l_n = 0
               SELECT COUNT(*) INTO l_n FROM oocq_t
               WHERE oocqent =  g_enterprise
                 AND oocq001 = '1'
                 AND oocq002 = g_oofb_d[l_ac].oofb009
                 AND oocqstus= 'Y'
               IF l_n = 0 THEN
                  CALL cl_err('','aoo-00082',1)
                  LET g_oofb_d[l_ac].oofb009 = g_oofb_d_t.oofb009
                  LET g_oofb_d[l_ac].oofb009_desc = g_oofb_d_t.oofb009_desc
                  NEXT FIELD oofb009
               END IF
            END IF  
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb009_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc
]]>
</point>
  <point name="input.a.page1.oofb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb008) AND g_oofb_d[l_ac].oofb010 = 'Y' THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb010 != g_oofb_d_t.oofb010))) THEN
                  LET l_n = 0
                  SELECT COUNT(*) INTO l_n FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = p_oofb002 
                     AND oofb008 = g_oofb_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                   IF l_n > 0 THEN 
                      CALL cl_err(g_oofb_d[l_ac].oofb010,'aoo-00156',0)
                      LET g_oofb_d[l_ac].oofb010 = 'N'
                      NEXT FIELD oofb010
                   END IF 
                END IF   
             END IF ]]>
</point>
  <point name="input.a.page1.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb012 = g_oofb_d_t.oofb012
               LET g_oofb_d[l_ac].oofb012_desc = g_oofb_d_t.oofb012_desc
               NEXT FIELD oofb012
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb012_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc 
]]>
</point>
  <point name="input.a.page1.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[           IF NOT cl_null(g_oofb_d[l_ac].oofb013) THEN
               SELECT oocn003,oocn004,oocn005,oocn006 INTO g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017
                FROM oocn_t
               WHERE oocnent=g_enterprise
                 AND oocn001 = g_oofb_d[l_ac].oofb012
                 AND oocn002 = g_oofb_d[l_ac].oofb013
            END IF 
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016  
            DISPLAY BY NAME g_oofb_d[l_ac].oofb017 
            
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN 
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb013 = g_oofb_d_t.oofb013
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb017 = g_oofb_d_t.oofb017
               NEXT FIELD oofb013
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
                  
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
                  
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
            
            ]]>
</point>
  <point name="input.a.page1.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb014_desc = g_oofb_d_t.oofb014_desc
               NEXT FIELD oofb014
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
]]>
</point>
  <point name="input.a.page1.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb015_desc = g_oofb_d_t.oofb015_desc
               NEXT FIELD oofb015
            END IF
           INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc]]>
</point>
  <point name="input.a.page1.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb016_desc = g_oofb_d_t.oofb016_desc
               NEXT FIELD oofb016
            END IF
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc]]>
</point>
  <point name="input.a.page1.oofb019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF  NOT cl_null(g_oofb_d[l_ac].oofb019) THEN 
                IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb019 != g_oofb_d_t.oofb019) OR g_oofb_d_t.oofb019 IS NULL)) THEN
                   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE "||"oofbent = '" ||g_enterprise|| "' AND "||"oofb019 = '"||g_oofb_d[l_ac].oofb019 ||"'",'std-00004',0) THEN 
                      LET g_oofb_d[l_ac].oofb019 = g_oofb_d_t.oofb019
                      NEXT FIELD oofb019
                   END IF
                END IF   
            END IF]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                        #此段落由子樣板a05產生
            IF  g_oofb_d[g_detail_idx].oofb001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_oofb_d[g_detail_idx].oofb001 != g_oofb_d_t.oofb001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE "||"oofbent = '" ||g_enterprise|| "' AND "||"oofb001 = '"||g_oofb_d[g_detail_idx].oofb001 ||"'",'std-00004',1) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[           IF g_oofb_d[l_ac].oofb008 <> g_oofb_d_t.oofb008 OR g_oofb_d_t.oofb008 IS NULL THEN
              IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                  CALL cl_set_comp_required('oofb022',TRUE)
              ELSE
                 CALL cl_set_comp_required('oofb022',FALSE)
              END IF
            END IF            ]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb009) THEN
               CALL s_azzi650_chk_exist('1',g_oofb_d[l_ac].oofb009) RETURNING l_success
               IF NOT l_success THEN
                  LET g_oofb_d[l_ac].oofb009 = g_oofb_d_t.oofb009
                  LET g_oofb_d[l_ac].oofb009_desc = g_oofb_d_t.oofb009_desc
                  NEXT FIELD oofb009
               END IF   
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc
]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb008) AND g_oofb_d[l_ac].oofb010 = 'Y' THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb010 != g_oofb_d_t.oofb010))) THEN
                  LET l_n = 0
                  SELECT COUNT(*) INTO l_n FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = p_oofb002
                     AND oofb008 = g_oofb_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                   IF l_n > 0 THEN
                      CALL cl_err(g_oofb_d[l_ac].oofb010,'aoo-00156',1)
                      LET g_oofb_d[l_ac].oofb010 = 'N'
                      NEXT FIELD oofb010
                   END IF
                END IF
             END IF]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb012 = g_oofb_d_t.oofb012
               LET g_oofb_d[l_ac].oofb012_desc = g_oofb_d_t.oofb012_desc
               NEXT FIELD oofb012
            END IF           
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc
]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[           IF NOT cl_null(g_oofb_d[l_ac].oofb013) THEN
               SELECT oocn003,oocn004,oocn005,oocn006 INTO g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017
                FROM oocn_t
               WHERE oocnent=g_enterprise
                 AND oocn001 = g_oofb_d[l_ac].oofb012
                 AND oocn002 = g_oofb_d[l_ac].oofb013
            END IF
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016
            DISPLAY BY NAME g_oofb_d[l_ac].oofb017

            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb013 = g_oofb_d_t.oofb013
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb017 = g_oofb_d_t.oofb017
               NEXT FIELD oofb013
            END IF   
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc            ]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb014 = g_oofb_d_t.oofb014
               LET g_oofb_d[l_ac].oofb014_desc = g_oofb_d_t.oofb014_desc
               NEXT FIELD oofb014
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb015 = g_oofb_d_t.oofb015
               LET g_oofb_d[l_ac].oofb015_desc = g_oofb_d_t.oofb015_desc
               NEXT FIELD oofb015
            END IF            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT aooi350_01_oofb_chk(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016) THEN 
               LET g_oofb_d[l_ac].oofb016 = g_oofb_d_t.oofb016
               LET g_oofb_d[l_ac].oofb016_desc = g_oofb_d_t.oofb016_desc
               NEXT FIELD oofb016
            END IF
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF            
            INITIALIZE g_ref_fields TO NULL
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN LET g_oofb_d[l_ac].oofb015=' ' END IF
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb019) THEN
                IF l_cmd = 'a' OR ( l_cmd = 'u' AND ( l_cmd = 'u' AND (g_oofb_d[l_ac].oofb019 != g_oofb_d_t.oofb019) OR g_oofb_d_t.oofb019 IS NULL)) THEN
                   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oofb_t WHERE oofbent = '" ||g_enterprise|| "' AND oofb002 = '"||p_oofb002 || "' AND oofb019 = '"||g_oofb_d[l_ac].oofb019 ||"'",'std-00004',1) THEN 
                      LET g_oofb_d[l_ac].oofb019 = g_oofb_d_t.oofb019
                      NEXT FIELD oofb019
                   END IF
                END IF
            END IF]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_oofb_d[l_ac].oofb022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_ref_fields TO NULL
               LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
               CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
               LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
               DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_oofb_d[l_ac].oofb022
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_dbad001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_oofb_d[l_ac].oofb022 = g_oofb_d_t.oofb022
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
                  CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc                  
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
            CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc

           IF g_oofb_d[l_ac].oofb022 <> g_oofb_d_t.oofb022 OR cl_null(g_oofb_d[l_ac].oofb022) THEN
              IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                  CALL cl_set_comp_required('oofb022',TRUE)
              ELSE
                 CALL cl_set_comp_required('oofb022',FALSE)
              END IF
            END IF]]>
</point>
  <point name="input.a.page1_aooi350_01.oofbstus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         ]]>
</point>
  <point name="input.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)          ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)         ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1_aooi350_01.oofbstus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.before_close" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   ]]>
</point>
  <point name="input.before_input" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL aooi350_01_b_fill(p_oofb002)
            LET g_rec_b = g_oofb_d.getLength()
            
         BEFORE ROW
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET l_lock_sw = 'N'            #DEFAULT
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()

            CALL aooi350_01_b_fill(p_oofb002)
            #LET g_rec_b = g_oofb_d.getLength()
            
            IF g_rec_b >= l_ac THEN  
               LET l_cmd='u'
               LET g_oofb_d_t.* = g_oofb_d[l_ac].*  #BACKUP
               OPEN aooi350_01_bcl USING g_oofb_d[l_ac].oofb001                      
               IF SQLCA.sqlcode THEN
                  CALL cl_err("aooi350_01_bcl",SQLCA.sqlcode,1)
               ELSE                                       
                  FETCH aooi350_01_bcl INTO g_oofb_d[l_ac].*
                  IF SQLCA.sqlcode THEN
                     LET l_lock_sw = "Y"
                  END IF
                  IF cl_null(g_oofb_d[l_ac].oofb015) THEN
                     LET g_oofb_d[l_ac].oofb015 = ' '
                  END IF
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb009
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='1' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb009_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb009_desc  
  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb012_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc 
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
                  CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
                  
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
                  LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
                  LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
                  LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc

                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_oofb_d[l_ac].oofb022
                  CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_oofb_d[l_ac].oofb022_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_oofb_d[l_ac].oofb022_desc
               
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            IF g_oofb_d[l_ac].oofb008 = '3' AND cl_null(g_oofb_d[l_ac].oofb022) THEN
                CALL cl_set_comp_required('oofb022',TRUE)
            ELSE
               CALL cl_set_comp_required('oofb022',FALSE)
            END IF      
            
         BEFORE INSERT
            CALL s_transaction_begin()
            LET l_cmd = 'a'
            INITIALIZE g_oofb_d_t.* TO NULL
            INITIALIZE g_oofb_d[l_ac].* TO NULL 
            
            LET g_oofb_d_t.* = g_oofb_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()   
            LET g_oofb_d[l_ac].oofbstus = 'Y'
            LET g_oofb_d[l_ac].oofb010 = 'N'
            
         AFTER INSERT
            IF INT_FLAG THEN
               CALL cl_err('',9001,1)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            LET l_oofb.oofbent = g_enterprise
            LET l_oofb.oofbstus =g_oofb_d[l_ac].oofbstus
            LET l_success = NULL
            LET l_wc = " oofbent = '",g_enterprise,"' "
            CALL s_aooi350_get_idno('oofb001','oofb_t',l_wc) RETURNING l_success,l_oofb.oofb001        
            LET l_oofb.oofb002 = p_oofb002
            LET l_oofb.oofb008 = g_oofb_d[l_ac].oofb008
            LET l_oofb.oofb009 = g_oofb_d[l_ac].oofb009
            LET l_oofb.oofb010 = g_oofb_d[l_ac].oofb010 
            LET l_oofb.oofb011 = g_oofb_d[l_ac].oofb011
            LET l_oofb.oofb012 = g_oofb_d[l_ac].oofb012
            LET l_oofb.oofb013 = g_oofb_d[l_ac].oofb013
            LET l_oofb.oofb014 = g_oofb_d[l_ac].oofb014
            LET l_oofb.oofb015 = g_oofb_d[l_ac].oofb015
            LET l_oofb.oofb016 = g_oofb_d[l_ac].oofb016
            LET l_oofb.oofb017 = g_oofb_d[l_ac].oofb017
            LET l_oofb.oofb018 = g_oofb_d[l_ac].oofb018
            LET l_oofb.oofb019 = g_oofb_d[l_ac].oofb019
            LET l_oofb.oofb020 = g_oofb_d[l_ac].oofb020
            LET l_oofb.oofb021 = g_oofb_d[l_ac].oofb021
            LET l_oofb.oofb022 = g_oofb_d[l_ac].oofb022
            LET l_oofb.oofbownid = g_user
            LET l_oofb.oofbowndp = g_dept
            LET l_oofb.oofbcrtid = g_user
            LET l_oofb.oofbcrtdp = g_dept 
            LET l_oofb.oofbcrtdt = cl_get_current()
            LET l_oofb.oofbmodid = g_user
            LET l_oofb.oofbmoddt = cl_get_current()
            SELECT COUNT(*) INTO l_count FROM oofb_t 
             WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = p_oofb002
                        
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INSERT INTO oofb_t VALUES(l_oofb.*)
                    
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,1)
               END IF
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_oofb_d[l_ac].* TO NULL
               CALL s_transaction_end('N',0)
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("oofb_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N',0)                   
               CANCEL INSERT
            ELSE
              
               CALL s_transaction_end('Y',0)
               
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
 
        BEFORE DELETE                            #是否取消單身
            IF NOT cl_null(g_oofb_d[l_ac].oofb001) THEN

               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               DELETE FROM oofb_t
                WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = p_oofb002
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N',0)
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  CALL s_transaction_end('Y',0)
               END IF 
               CLOSE aooi350_01_bcl
               LET l_count = g_oofb_d.getLength()
            END IF 
            
         ON ROW CHANGE
            IF INT_FLAG THEN
               CALL cl_err('',9001,1)
               LET INT_FLAG = 0
               LET g_oofb_d[l_ac].* = g_oofb_d_t.*
               CLOSE aooi350_01_bcl
               CALL s_transaction_end('N',0)
               EXIT DIALOG 
            END IF
            
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err(l_oofb.oofb001,-263,1)
               LET g_oofb_d[l_ac].* = g_oofb_d_t.*
            ELSE
               UPDATE oofb_t SET (oofbstus,oofb008,oofb009,oofb010,oofb019,oofb011,oofb012,oofb013,oofb014,oofb015,oofb016,oofb017,oofb018,oofb020,oofb021,oofb022)= (g_oofb_d[l_ac].oofbstus,g_oofb_d[l_ac].oofb008,g_oofb_d[l_ac].oofb009,g_oofb_d[l_ac].oofb010,g_oofb_d[l_ac].oofb019,g_oofb_d[l_ac].oofb011,g_oofb_d[l_ac].oofb012,
                                  g_oofb_d[l_ac].oofb013,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017,g_oofb_d[l_ac].oofb018,g_oofb_d[l_ac].oofb020,g_oofb_d[l_ac].oofb021,g_oofb_d[l_ac].oofb022)
                WHERE oofbent = g_enterprise AND oofb001 = g_oofb_d[l_ac].oofb001 AND oofb002 = p_oofb002 
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("oofb_t",SQLCA.sqlcode,1)   
                  LET g_oofb_d[l_ac].* = g_oofb_d_t.*
                  CALL s_transaction_end('N',0) 
               ELSE
                  CALL s_transaction_end('Y',0)                
               END IF

            END IF
            
         AFTER ROW
            CLOSE aooi350_01_bcl
        ]]>
</point>
  <point name="input.c.page1.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb009             #給予default值
            LET g_qryparam.where = ''
            #給予arg
            LET g_qryparam.arg1 = "1" #應用分類

            CALL q_oocq002()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb009 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb009 TO oofb009              #顯示到畫面上

            NEXT FIELD oofb009                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb012             #給予default值

            #給予arg
            LET g_qryparam.where = ''
            CALL q_oocg001()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb012 TO oofb012              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb012_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc 

            NEXT FIELD oofb012                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb013             #給予default值
            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = "oocn001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF   
            #給予arg

            CALL q_oocn002()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb013 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb013 TO oofb013              #顯示到畫面上
            
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN 
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc
                  
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc
                  
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
            
            IF NOT cl_null(g_oofb_d[l_ac].oofb013) THEN
               SELECT oocn003,oocn004,oocn005,oocn006 INTO g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016,g_oofb_d[l_ac].oofb017
                FROM oocn_t
               WHERE oocnent=g_enterprise
                 AND oocn001 = g_oofb_d[l_ac].oofb012
                 AND oocn002 = g_oofb_d[l_ac].oofb013
            END IF 
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016 
            DISPLAY BY NAME g_oofb_d[l_ac].oofb017 
            NEXT FIELD oofb013                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = '' 
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb014             #給予default值
            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = "ooci001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF   
            #給予arg

            CALL q_ooci002()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb014              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc


            NEXT FIELD oofb014                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb015             #給予default值

            #給予arg
            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oock001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF 
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oock002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF
            CALL q_oock003()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb015              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl005 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc

            NEXT FIELD oofb015                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb016             #給予default值

            #給予arg
            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oocm001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF 
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF 
            IF NOT cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm003 = '",g_oofb_d[l_ac].oofb015,"'"
            END IF 
            CALL q_oocm004()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb016              #顯示到畫面上
            IF cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_oofb_d[l_ac].oofb015 = ' '
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc

            NEXT FIELD oofb016                          #返回原欄位

]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb009             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb009 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb009 TO oofb009              #顯示到畫面上

            NEXT FIELD oofb009                          #返回原欄位

]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb012             #給予default值

            #給予arg

            CALL q_oocg001()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb012 TO oofb012              #顯示到畫面上
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            NEXT FIELD oofb012                          #返回原欄位

]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb013             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb012             #給予default值
            LET g_qryparam.default3 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default4 = g_oofb_d[l_ac].oofb015             #給予default值
            LET g_qryparam.default5 = g_oofb_d[l_ac].oofb016             #給予default值
            LET g_qryparam.default6 = g_oofb_d[l_ac].oofb017             #給予default值
            
            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oocn001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            
            CALL q_oocn002_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb013 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return2              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return3              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return4              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb016 = g_qryparam.return5              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb017 = g_qryparam.return6              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb013 TO oofb013              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb012 TO oofb012              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb015              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb016              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb017 TO oofb017              #顯示到畫面上           
            
            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb013                          #返回原欄位]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb012             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb014             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " ooci001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF

            CALL q_ooci002_2()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb012 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return2              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb012              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb014 TO oofb014              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb014                          #返回原欄位]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb015             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oock001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oock002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF

            CALL q_oock003_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return2              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb015 TO oofb015              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb015                          #返回原欄位]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = ''
            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb014             #給予default值
            LET g_qryparam.default2 = g_oofb_d[l_ac].oofb015             #給予default值
            LET g_qryparam.default3 = g_oofb_d[l_ac].oofb016             #給予default值

            #給予arg

            IF NOT cl_null(g_oofb_d[l_ac].oofb012) THEN
               LET g_qryparam.where = " oocm001 = '",g_oofb_d[l_ac].oofb012,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb014) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm002 = '",g_oofb_d[l_ac].oofb014,"'"
            END IF
            IF NOT cl_null(g_oofb_d[l_ac].oofb015) THEN
               LET g_qryparam.where = g_qryparam.where," AND oocm003 = '",g_oofb_d[l_ac].oofb015,"'"
            END IF
            
            CALL q_oocm004_2()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb014 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_oofb_d[l_ac].oofb015 = g_qryparam.return2              #將開窗取得的值回傳到變數            
            LET g_oofb_d[l_ac].oofb016 = g_qryparam.return3              #將開窗取得的值回傳到變數

            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb014              #顯示到畫面上
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb015              #顯示到畫面上            
            DISPLAY g_oofb_d[l_ac].oofb016 TO oofb016              #顯示到畫面上

            #重新顯示州省、縣市、行政地區的名稱
            CALL aooi350_01_show_ref(g_oofb_d[l_ac].oofb012,g_oofb_d[l_ac].oofb014,g_oofb_d[l_ac].oofb015,g_oofb_d[l_ac].oofb016)            
            
            NEXT FIELD oofb016                          #返回原欄位]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_oofb_d[l_ac].oofb022             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_dbad001_1()                                #呼叫開窗

            LET g_oofb_d[l_ac].oofb022 = g_qryparam.return1              

            DISPLAY g_oofb_d[l_ac].oofb022 TO oofb022              #

            NEXT FIELD oofb022                          #返回原欄位

]]>
</point>
  <point name="input.c.page1_aooi350_01.oofbstus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      DEFINE p_oofb002      LIKE oofb_t.oofb002
   DEFINE l_oofb         RECORD LIKE oofb_t.*
   DEFINE l_forupd_sql   STRING
   DEFINE l_lock_sw      LIKE type_t.chr1 
   DEFINE l_success      LIKE type_t.num5
   DEFINE l_wc           STRING
   DEFINE l_n            LIKE type_t.num5
]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1_aooi350_01.oofbstus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.get_var" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      p_oofb002 ]]>
</point>
  <point name="input.more_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      ]]>
</point>
  <point name="input.post_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[       CLOSE aooi350_01_bcl]]>
</point>
  <point name="input.pre_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   WHENEVER ERROR CALL cl_err_msg_log
   CALL cl_set_combo_scc('oofb008','9')
   CALL cl_set_combo_scc('oofb009','1')
   CALL aooi350_01_b_fill(p_oofb002)
   LET l_forupd_sql = " SELECT oofbstus,oofb001,oofb008,oofb009,'',oofb010,oofb019,oofb011,oofb022,'',oofb012,'',oofb013,oofb014,'',oofb015,'',oofb016,'',oofb017,oofb020,oofb021,oofb018 ",
                      " FROM oofb_t WHERE oofbent = '",g_enterprise,"' AND oofb002 = '",p_oofb002,"' AND oofb001 = ? FOR UPDATE"
   LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)  
   PREPARE aooi350_01_b FROM l_forupd_sql
   DECLARE aooi350_01_bcl CURSOR FOR aooi350_01_b 
   LET INT_FLAG = FALSE   
   LET g_errshow = 1]]>
</point>
  <point name="show.body.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb012_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocil004 FROM oocil_t WHERE oocilent='"||g_enterprise||"' AND oocil001=? AND oocil002=? AND oocil003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb014_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oockl003 FROM oockl_t WHERE oocklent='"||g_enterprise||"' AND oockl001=? AND oockl002=? AND oockl003=? AND oockl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb015_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oofb_d[l_ac].oofb012
            LET g_ref_fields[2] = g_oofb_d[l_ac].oofb014
            LET g_ref_fields[3] = g_oofb_d[l_ac].oofb015
            LET g_ref_fields[4] = g_oofb_d[l_ac].oofb016
            CALL ap_ref_array2(g_ref_fields,"SELECT oocml006 FROM oocml_t WHERE oocmlent='"||g_enterprise||"' AND oocml001=? AND oocml002=? AND oocml003=? AND oocml004=? AND oocml005='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_oofb_d[l_ac].oofb016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_oofb_d[l_ac].oofb016_desc
]]>
</point>
  <point name="global.memo" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.argv" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb022" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb022" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page1_aooi350_01.oofb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page1_aooi350_01.oofb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page1_aooi350_01.oofb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page1_aooi350_01.oofb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.other" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <section id="aooi350_01.description" ver="97" status="" src="s">
<![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:2,PR版次:2) Build-000236
#+ 
#+ Filename...: aooi350_01
#+ Description: ...
#+ Creator....: 02587(2013/08/30)
#+ Modifier...: 00413(2014/03/03)
#+ Buildtype..: 應用 c02b 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
</section>
  <section id="aooi350_01.global" ver="4" status="" src="s">
<![CDATA[{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_oofb_d        RECORD
       oofbstus LIKE oofb_t.oofbstus, 
   oofb001 LIKE oofb_t.oofb001, 
   oofb008 LIKE oofb_t.oofb008, 
   oofb009 LIKE oofb_t.oofb009, 
   oofb009_desc LIKE type_t.chr500, 
   oofb010 LIKE oofb_t.oofb010, 
   oofb019 LIKE oofb_t.oofb019, 
   oofb011 LIKE oofb_t.oofb011, 
   oofb022 LIKE oofb_t.oofb022, 
   oofb022_desc LIKE type_t.chr500, 
   oofb012 LIKE oofb_t.oofb012, 
   oofb012_desc LIKE type_t.chr500, 
   oofb013 LIKE oofb_t.oofb013, 
   oofb014 LIKE oofb_t.oofb014, 
   oofb014_desc LIKE type_t.chr500, 
   oofb015 LIKE oofb_t.oofb015, 
   oofb015_desc LIKE type_t.chr500, 
   oofb016 LIKE oofb_t.oofb016, 
   oofb016_desc LIKE type_t.chr500, 
   oofb017 LIKE oofb_t.oofb017, 
   oofb020 LIKE oofb_t.oofb020, 
   oofb021 LIKE oofb_t.oofb021, 
   oofb018 LIKE oofb_t.oofb018
       END RECORD
 
 
DEFINE g_oofb_d          DYNAMIC ARRAY OF type_g_oofb_d
DEFINE g_oofb_d_t        type_g_oofb_d
 
 
DEFINE g_oofb001_t   LIKE oofb_t.oofb001    #Key值備份
 
 
DEFINE l_ac                  LIKE type_t.num5
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rec_b               LIKE type_t.num5  
DEFINE g_detail_idx          LIKE type_t.num5  
 
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
    
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point	
]]>
</section>
  <section id="aooi350_01.input" ver="5" status="" src="s">
<![CDATA[#+ 資料輸入
PUBLIC FUNCTION aooi350_01(--)
   #add-point:input段變數傳入
   {<point name="input.get_var"/>}
   #end add-point
   )
   DEFINE l_ac_t          LIKE type_t.num5        #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num5
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   #add-point:input段define
   {<point name="input.define"/>}
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_aooi350_01 WITH FORM cl_ap_formpath("aoo","aooi350_01")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #輸入前處理
   #add-point:單身前置處理
   {<point name="input.pre_input"/>}
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT ARRAY g_oofb_d FROM s_detail1_aooi350_01.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = FALSE,
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
         
         #自訂ACTION
         #add-point:單身前置處理
         {<point name="input.action"/>}
         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理
            {<point name="input.before_input"/>}
            #end add-point
          
                  #此段落由子樣板a01產生
         BEFORE FIELD oofbstus
            #add-point:BEFORE FIELD oofbstus
            {<point name="input.b.page1_aooi350_01.oofbstus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofbstus
            
            #add-point:AFTER FIELD oofbstus
            {<point name="input.a.page1_aooi350_01.oofbstus" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofbstus
            #add-point:ON CHANGE oofbstus
            {<point name="input.g.page1_aooi350_01.oofbstus" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb001
            #add-point:BEFORE FIELD oofb001
            {<point name="input.b.page1_aooi350_01.oofb001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb001
            
            #add-point:AFTER FIELD oofb001
            {<point name="input.a.page1_aooi350_01.oofb001" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb001
            #add-point:ON CHANGE oofb001
            {<point name="input.g.page1_aooi350_01.oofb001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb008
            #add-point:BEFORE FIELD oofb008
            {<point name="input.b.page1_aooi350_01.oofb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb008
            
            #add-point:AFTER FIELD oofb008
            {<point name="input.a.page1_aooi350_01.oofb008" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb008
            #add-point:ON CHANGE oofb008
            {<point name="input.g.page1_aooi350_01.oofb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb009
            
            #add-point:AFTER FIELD oofb009
            {<point name="input.a.page1_aooi350_01.oofb009" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb009
            #add-point:BEFORE FIELD oofb009
            {<point name="input.b.page1_aooi350_01.oofb009" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb009
            #add-point:ON CHANGE oofb009
            {<point name="input.g.page1_aooi350_01.oofb009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb010
            #add-point:BEFORE FIELD oofb010
            {<point name="input.b.page1_aooi350_01.oofb010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb010
            
            #add-point:AFTER FIELD oofb010
            {<point name="input.a.page1_aooi350_01.oofb010" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb010
            #add-point:ON CHANGE oofb010
            {<point name="input.g.page1_aooi350_01.oofb010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb019
            #add-point:BEFORE FIELD oofb019
            {<point name="input.b.page1_aooi350_01.oofb019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb019
            
            #add-point:AFTER FIELD oofb019
            {<point name="input.a.page1_aooi350_01.oofb019" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb019
            #add-point:ON CHANGE oofb019
            {<point name="input.g.page1_aooi350_01.oofb019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb011
            #add-point:BEFORE FIELD oofb011
            {<point name="input.b.page1_aooi350_01.oofb011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb011
            
            #add-point:AFTER FIELD oofb011
            {<point name="input.a.page1_aooi350_01.oofb011" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb011
            #add-point:ON CHANGE oofb011
            {<point name="input.g.page1_aooi350_01.oofb011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb022
            
            #add-point:AFTER FIELD oofb022
            {<point name="input.a.page1_aooi350_01.oofb022" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb022
            #add-point:BEFORE FIELD oofb022
            {<point name="input.b.page1_aooi350_01.oofb022" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb022
            #add-point:ON CHANGE oofb022
            {<point name="input.g.page1_aooi350_01.oofb022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb012
            
            #add-point:AFTER FIELD oofb012
            {<point name="input.a.page1_aooi350_01.oofb012" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb012
            #add-point:BEFORE FIELD oofb012
            {<point name="input.b.page1_aooi350_01.oofb012" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb012
            #add-point:ON CHANGE oofb012
            {<point name="input.g.page1_aooi350_01.oofb012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb013
            #add-point:BEFORE FIELD oofb013
            {<point name="input.b.page1_aooi350_01.oofb013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb013
            
            #add-point:AFTER FIELD oofb013
            {<point name="input.a.page1_aooi350_01.oofb013" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb013
            #add-point:ON CHANGE oofb013
            {<point name="input.g.page1_aooi350_01.oofb013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb014
            
            #add-point:AFTER FIELD oofb014
            {<point name="input.a.page1_aooi350_01.oofb014" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb014
            #add-point:BEFORE FIELD oofb014
            {<point name="input.b.page1_aooi350_01.oofb014" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb014
            #add-point:ON CHANGE oofb014
            {<point name="input.g.page1_aooi350_01.oofb014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb015
            
            #add-point:AFTER FIELD oofb015
            {<point name="input.a.page1_aooi350_01.oofb015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb015
            #add-point:BEFORE FIELD oofb015
            {<point name="input.b.page1_aooi350_01.oofb015" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb015
            #add-point:ON CHANGE oofb015
            {<point name="input.g.page1_aooi350_01.oofb015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb016
            
            #add-point:AFTER FIELD oofb016
            {<point name="input.a.page1_aooi350_01.oofb016" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb016
            #add-point:BEFORE FIELD oofb016
            {<point name="input.b.page1_aooi350_01.oofb016" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE oofb016
            #add-point:ON CHANGE oofb016
            {<point name="input.g.page1_aooi350_01.oofb016" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017
            #add-point:BEFORE FIELD oofb017
            {<point name="input.b.page1_aooi350_01.oofb017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017
            
            #add-point:AFTER FIELD oofb017
            {<point name="input.a.page1_aooi350_01.oofb017" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb017
            #add-point:ON CHANGE oofb017
            {<point name="input.g.page1_aooi350_01.oofb017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb020
            #add-point:BEFORE FIELD oofb020
            {<point name="input.b.page1_aooi350_01.oofb020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb020
            
            #add-point:AFTER FIELD oofb020
            {<point name="input.a.page1_aooi350_01.oofb020" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb020
            #add-point:ON CHANGE oofb020
            {<point name="input.g.page1_aooi350_01.oofb020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb021
            #add-point:BEFORE FIELD oofb021
            {<point name="input.b.page1_aooi350_01.oofb021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb021
            
            #add-point:AFTER FIELD oofb021
            {<point name="input.a.page1_aooi350_01.oofb021" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb021
            #add-point:ON CHANGE oofb021
            {<point name="input.g.page1_aooi350_01.oofb021" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb018
            #add-point:BEFORE FIELD oofb018
            {<point name="input.b.page1_aooi350_01.oofb018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb018
            
            #add-point:AFTER FIELD oofb018
            {<point name="input.a.page1_aooi350_01.oofb018" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE oofb018
            #add-point:ON CHANGE oofb018
            {<point name="input.g.page1_aooi350_01.oofb018" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page1_aooi350_01.oofbstus
         ON ACTION controlp INFIELD oofbstus
            #add-point:ON ACTION controlp INFIELD oofbstus
            {<point name="input.c.page1_aooi350_01.oofbstus" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb001
         ON ACTION controlp INFIELD oofb001
            #add-point:ON ACTION controlp INFIELD oofb001
            {<point name="input.c.page1_aooi350_01.oofb001" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb008
         ON ACTION controlp INFIELD oofb008
            #add-point:ON ACTION controlp INFIELD oofb008
            {<point name="input.c.page1_aooi350_01.oofb008" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb009
         ON ACTION controlp INFIELD oofb009
            #add-point:ON ACTION controlp INFIELD oofb009
            {<point name="input.c.page1_aooi350_01.oofb009" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb010
         ON ACTION controlp INFIELD oofb010
            #add-point:ON ACTION controlp INFIELD oofb010
            {<point name="input.c.page1_aooi350_01.oofb010" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb019
         ON ACTION controlp INFIELD oofb019
            #add-point:ON ACTION controlp INFIELD oofb019
            {<point name="input.c.page1_aooi350_01.oofb019" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb011
         ON ACTION controlp INFIELD oofb011
            #add-point:ON ACTION controlp INFIELD oofb011
            {<point name="input.c.page1_aooi350_01.oofb011" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb022
         ON ACTION controlp INFIELD oofb022
            #add-point:ON ACTION controlp INFIELD oofb022
            {<point name="input.c.page1_aooi350_01.oofb022" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb012
         ON ACTION controlp INFIELD oofb012
            #add-point:ON ACTION controlp INFIELD oofb012
            {<point name="input.c.page1_aooi350_01.oofb012" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb013
         ON ACTION controlp INFIELD oofb013
            #add-point:ON ACTION controlp INFIELD oofb013
            {<point name="input.c.page1_aooi350_01.oofb013" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb014
         ON ACTION controlp INFIELD oofb014
            #add-point:ON ACTION controlp INFIELD oofb014
            {<point name="input.c.page1_aooi350_01.oofb014" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb015
         ON ACTION controlp INFIELD oofb015
            #add-point:ON ACTION controlp INFIELD oofb015
            {<point name="input.c.page1_aooi350_01.oofb015" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb016
         ON ACTION controlp INFIELD oofb016
            #add-point:ON ACTION controlp INFIELD oofb016
            {<point name="input.c.page1_aooi350_01.oofb016" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb017
         ON ACTION controlp INFIELD oofb017
            #add-point:ON ACTION controlp INFIELD oofb017
            {<point name="input.c.page1_aooi350_01.oofb017" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb020
         ON ACTION controlp INFIELD oofb020
            #add-point:ON ACTION controlp INFIELD oofb020
            {<point name="input.c.page1_aooi350_01.oofb020" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb021
         ON ACTION controlp INFIELD oofb021
            #add-point:ON ACTION controlp INFIELD oofb021
            {<point name="input.c.page1_aooi350_01.oofb021" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aooi350_01.oofb018
         ON ACTION controlp INFIELD oofb018
            #add-point:ON ACTION controlp INFIELD oofb018
            {<point name="input.c.page1_aooi350_01.oofb018" />}
            #END add-point
 
 
 
         #自訂ACTION
         #add-point:單身其他段落處理(EX:on row change, etc...)
         {<point name="input.other"/>}
         #end add-point
 
         AFTER INPUT
            #add-point:單身輸入後處理
            {<point name="input.after_input"/>}
            #end add-point
            
      END INPUT
      
 
      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前
   {<point name="input.before_close"/>}
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_aooi350_01 
   
   #add-point:input段after input 
   {<point name="input.post_input"/>}
   #end add-point    
   
END FUNCTION
]]>
</section>
  <section id="aooi350_01.other_dialog" ver="1" status="" src="s">
<![CDATA[{<point name="other.dialog"/>}
]]>
</section>
  <section id="aooi350_01.other_function" ver="2" status="" src="s">
<![CDATA[{<point name="other.function"/>}
]]>
</section>
</add_points>