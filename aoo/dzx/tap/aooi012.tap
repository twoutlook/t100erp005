<?xml version="1.0" encoding="UTF-8"?>
<add_points env="s" ver="1.0" prog="aooi012" std_prog="aooi012" module="aoo" native="N" >
          <point name="global.memo"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="global.import"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="global.variable" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="main.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="main.init" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="main.servicecall"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="main.exit"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="init.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="init.init"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="ui_dialog.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="ui_dialog.more_displayarray" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="menu.modify"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="menu.query"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.c.page1.oocgstus"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="construct.c.page1.oocg001"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocg001()
            DISPLAY g_qryparam.return1 TO oocg001
            NEXT FIELD oocg001
]]>

          </point>
          <point name="query.c.page1.oocgl003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.c.page1.oocgl004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="construct.c.page1.oocg002"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocg002()
            DISPLAY g_qryparam.return1 TO oocg002
            NEXT FIELD oocg002
]]>

          </point>
          <point name="query.c.page1.oocg003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.c.page1.oocg004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.c.page1.oocg005"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="query.more_construct" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.define" ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[   DEFINE l_cnt           LIKE type_t.num5]]>

          </point>
          <point name="modify.before_row" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.before_insert" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.b_insert" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.after_insert" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.a_insert" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.b_delete" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.a_delete" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.after_delete" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.b_update" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.on_row_change" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="modify.a_update" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgstus"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgstus"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgstus"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocg001"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocg001"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            IF  NOT cl_null(g_oocg_d[l_ac].oocg001)  THEN 
               IF  p_cmd = 'a'  OR ( p_cmd = 'u' AND (g_oocg_d[l_ac].oocg001 != g_oocg_d_t.oocg001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM oocg_t WHERE "||"oocgent = '" ||g_enterprise|| "' AND "||"oocg001 = '"||g_oocg_d[l_ac].oocg001 ||"'",'std-00004',0) THEN 
                     LET g_oocg_d[l_ac].oocg001 = g_oocg_d_t.oocg001 
                     NEXT FIELD oocg001
                  END IF
               END IF
            END IF            
]]>

          </point>
          <point name="input.g.page1.oocg001"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgl003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgl003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgl003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgl004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgl004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgl004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocg002"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            IF NOT cl_null(g_oocg_d[l_ac].oocg002) THEN
               IF g_oocg_d[l_ac].oocg002 != g_oocg_d_t.oocg002 OR g_oocg_d_t.oocg002 IS NULL THEN
                  CALL aooi012_chk_oocg002()
                  IF NOT cl_null(g_errno) THEN
                     CALL cl_err(g_oocg_d[l_ac].oocg002,g_errno,1)
                     LET g_oocg_d[l_ac].oocg002 = g_oocg_d_t.oocg002
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oocg_d[l_ac].oocg002
            CALL ap_ref_array(g_ref_fields,"SELECT oocel003 FROM oocel_t WHERE oocelent='"||g_enterprise||"' AND oocel001=? AND oocel002='"||g_lang||"'") RETURNING g_oocg_d[l_ac].oocg002_desc
            DISPLAY BY NAME g_oocg_d[l_ac].oocg002_desc
]]>

          </point>
          <point name="input.b.page1.oocg002"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[]]>

          </point>
          <point name="input.g.page1.oocg002"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocg003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocg003"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            IF NOT cl_null(g_oocg_d[l_ac].oocg003) THEN
               LET l_cnt = 0
               SELECT COUNT(*) INTO l_cnt FROM oocg_t
                WHERE oocgent = g_enterprise
                  AND oocg001 != g_oocg_d[l_ac].oocg001
                  AND oocg003 = g_oocg_d[l_ac].oocg003
               IF l_cnt > 0 THEN
                  CALL cl_ask_pressanykey('aoop-00001')
               END IF
            END IF
]]>

          </point>
          <point name="input.g.page1.oocg003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocg004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocg004"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            IF NOT cl_null(g_oocg_d[l_ac].oocg004) THEN
               LET l_cnt = 0
               SELECT COUNT(*) INTO l_cnt FROM oocg_t
                WHERE oocgent = g_enterprise
                  AND oocg001 != g_oocg_d[l_ac].oocg001
                  AND oocg004 = g_oocg_d[l_ac].oocg004
               IF l_cnt > 0 THEN
                  CALL cl_ask_pressanykey('aoop-00001')
               END IF
            END IF
]]>

          </point>
          <point name="input.g.page1.oocg004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocg005"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocg005"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            IF NOT cl_null(g_oocg_d[l_ac].oocg005) THEN
               LET l_cnt = 0
               SELECT COUNT(*) INTO l_cnt FROM oocg_t
                WHERE oocgent = g_enterprise
                  AND oocg001 != g_oocg_d[l_ac].oocg001
                  AND oocg005 = g_oocg_d[l_ac].oocg005
               IF l_cnt > 0 THEN
                  CALL cl_ask_pressanykey('aoop-00001')
               END IF
            END IF
]]>

          </point>
          <point name="input.g.page1.oocg005"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgmodu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgmodu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgmodu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgdate"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgdate"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgdate"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgoriu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgoriu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgoriu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgorid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgorid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgorid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocguser"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocguser"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocguser"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgdept"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgdept"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgdept"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.b.page1.oocgbuid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.a.page1.oocgbuid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.g.page1.oocgbuid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgstus"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocg001"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[]]>

          </point>
          <point name="input.c.page1.oocgl003"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgl004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocg002"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_oocg_d[l_ac].oocg002
            CALL q_ooce001_1() 
            LET g_oocg_d[l_ac].oocg002 = g_qryparam.return1
            DISPLAY BY NAME g_oocg_d[l_ac].oocg002
            NEXT FIELD oocg002
]]>

          </point>
          <point name="input.c.page1.oocg003"  ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[]]>

          </point>
          <point name="input.c.page1.oocg004"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocg005"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgmodu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgdate"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgoriu"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgorid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocguser"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgdept"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="input.c.page1.oocgbuid"  ver="1.0" status="" src="s" cite_std="N"/>
          <point name="b_fill.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="b_fill.fill" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="bfill.foreach" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="detail_show.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="detail_show.before" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="detail_show.reference" ver="1.0" status="" src="s" cite_std="N" >
<![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_oocg_d[l_ac].oocg002
            CALL ap_ref_array2(g_ref_fields,"SELECT oocel003 FROM oocel_t WHERE oocelent='"||g_enterprise||"' AND oocel001=? AND oocel002='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_oocg_d[l_ac].oocg002_desc = g_rtn_fields[1]
            DISPLAY BY NAME g_oocg_d[l_ac].oocg002_desc

   INITIALIZE g_ref_fields TO NULL 
   LET g_ref_fields[1] = g_oocg_d[l_ac].oocg001
   CALL ap_ref_array2(g_ref_fields," SELECT oocgl003,oocgl004 FROM oocgl_t WHERE oocgl001 = ? AND oocgl002 = '"||g_dlang||"'","") RETURNING g_rtn_fields 
   LET g_oocg_d[l_ac].oocgl003 = g_rtn_fields[1] 
   LET g_oocg_d[l_ac].oocgl004 = g_rtn_fields[2] 
   DISPLAY BY NAME g_oocg_d[l_ac].oocgl003,g_oocg_d[l_ac].oocgl004
]]>

          </point>
          <point name="detail_show.after" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="set_entry_b.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="set_no_entry_b.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="default_search.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="statechange.define" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="statechange.before" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="statechange.b_update" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="statechange.a_update" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="statechange.after" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="other.function" ver="1.0" status="" src="s" cite_std="N"/>
          <point name="function.aooi012_chk_oocg002" ver="1.0" status="" src="s" cite_std="N">
<![CDATA[# 檢查所在洲別資料是否存在ooce_t 且stus= 'Y'
PRIVATE FUNCTION aooi012_chk_oocg002()
DEFINE l_oocestus    LIKE ooce_t.oocestus
   SELECT oocestus INTO l_oocestus FROM ooce_t
    WHERE ooce001 = g_oocg_d[l_ac].oocg002
      AND ooceent = g_enterprise
   CASE WHEN SQLCA.SQLCODE = 100      LET g_errno = 'aoo-00007'
        WHEN l_oocestus='N'           LET g_errno = 'aoo-00004'
        OTHERWISE                     LET g_errno = SQLCA.SQLCODE USING '-------'
   END CASE
END FUNCTION]]>
</point></add_points>

